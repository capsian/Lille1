<!doctype html>
<html lang="fr">
<head>
<title>√âv√®nements et probabilit√©s</title>
<!-- 2021-03-09 mar. 07:44 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="Org-mode">
<meta name="author" content="Sylvain Salvati">

<link  href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
<style>
/* org mode styles on top of twbs */

html {
    position: relative;
    min-height: 100%;
}

body {
    font-size: 18px;
    margin-bottom: 105px;
}

footer {
    position: absolute;
    bottom: 0;
    width: 100%;
    height: 101px;
    background-color: #f5f5f5;
}

footer > div {
    padding: 10px;
}

footer p {
    margin: 0 0 5px;
    text-align: center;
    font-size: 16px;
}

#table-of-contents {
    margin-top: 20px;
    margin-bottom: 20px;
}

blockquote p {
    font-size: 18px;
}

pre {
    font-size: 16px;
}

.footpara {
    display: inline-block;
}

figcaption {
  font-size: 16px;
  color: #666;
  font-style: italic;
  padding-bottom: 15px;
}

/* from twbs docs */

.bs-docs-sidebar.affix {
    position: static;
}
@media (min-width: 768px) {
    .bs-docs-sidebar {
        padding-left: 20px;
    }
}

/* All levels of nav */
.bs-docs-sidebar .nav > li > a {
    display: block;
    padding: 4px 20px;
    font-size: 14px;
    font-weight: 500;
    color: #999;
}
.bs-docs-sidebar .nav > li > a:hover,
.bs-docs-sidebar .nav > li > a:focus {
    padding-left: 19px;
    color: #A1283B;
    text-decoration: none;
    background-color: transparent;
    border-left: 1px solid #A1283B;
}
.bs-docs-sidebar .nav > .active > a,
.bs-docs-sidebar .nav > .active:hover > a,
.bs-docs-sidebar .nav > .active:focus > a {
    padding-left: 18px;
    font-weight: bold;
    color: #A1283B;
    background-color: transparent;
    border-left: 2px solid #A1283B;
}

/* Nav: second level (shown on .active) */
.bs-docs-sidebar .nav .nav {
    display: none; /* Hide by default, but at >768px, show it */
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 30px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav > li > a:focus {
    padding-left: 29px;
}
.bs-docs-sidebar .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav > .active:focus > a {
    padding-left: 28px;
    font-weight: 500;
}

/* Nav: third level (shown on .active) */
.bs-docs-sidebar .nav .nav .nav {
    padding-bottom: 10px;
}
.bs-docs-sidebar .nav .nav .nav > li > a {
    padding-top: 1px;
    padding-bottom: 1px;
    padding-left: 40px;
    font-size: 12px;
    font-weight: normal;
}
.bs-docs-sidebar .nav .nav .nav > li > a:hover,
.bs-docs-sidebar .nav .nav .nav > li > a:focus {
    padding-left: 39px;
}
.bs-docs-sidebar .nav .nav .nav > .active > a,
.bs-docs-sidebar .nav .nav .nav > .active:hover > a,
.bs-docs-sidebar .nav .nav .nav > .active:focus > a {
    padding-left: 38px;
    font-weight: 500;
}

.code-highlighted { background-color: #ffff00; }

/* .verbatim { color: #3e9409;
            background-color: #f5fbf4; }*/
.verbatim {
    color: #337ab7;
    background-color: #d9edf7; }


/* Show and affix the side nav when space allows it */
@media (min-width: 992px) {
    .bs-docs-sidebar .nav > .active > ul {
        display: block;
    }
    /* Widen the fixed sidebar */
    .bs-docs-sidebar.affix,
    .bs-docs-sidebar.affix-bottom {
        width: 213px;
    }
    .bs-docs-sidebar.affix {
        position: fixed; /* Undo the static from mobile first approach */
        top: 20px;
    }
    .bs-docs-sidebar.affix-bottom {
        position: absolute; /* Undo the static from mobile first approach */
    }
    .bs-docs-sidebar.affix .bs-docs-sidenav,.bs-docs-sidebar.affix-bottom .bs-docs-sidenav {
        margin-top: 0;
        margin-bottom: 0
    }
}
@media (min-width: 1200px) {
    /* Widen the fixed sidebar again */
    .bs-docs-sidebar.affix-bottom,
    .bs-docs-sidebar.affix {
        width: 263px;
    }
}
</style>
<style>body { margin-bottom: 0px; }</style><script>
$(function() {
    'use strict';

    $('.bs-docs-sidebar li').first().addClass('active');

    $(document.body).scrollspy({target: '.bs-docs-sidebar'});

    $('.bs-docs-sidebar').affix();
});
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }

</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "center",
  displayIndent: "2em",
  messageStyle: "none",
  "HTML-CSS": {
    scale: 100,
    styles: {
      ".MathJax_Display": {
        "font-size": "100%"
      }
    }
  },
  "SVG": {
    scale: 100,
    styles: {
      ".MathJax_SVG_Display": {
        "font-size": "100%",
        "margin-left": "-2.281em"
      }
    }
  }
});
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"></script>
</head>
<body>
<div id="content" class="container">
<div class="row"><div class="col-md-3 col-md-push-9"><nav id="table-of-contents">
<div id="text-table-of-contents" class="bs-docs-sidebar">
<ul class="nav">
<li><a href="#sec-1">1. Une premi√®re application : v√©rification d'identit√©s polynomiales</a>
<ul class="nav">
<li><a href="#sec-1-1">1.1. Exercice</a></li>
</ul>
</li>
<li><a href="#sec-2">2. Un peu de probabilit√©s</a>
<ul class="nav">
<li><a href="#sec-2-1">2.1. D√©finition espace probabiliste discret</a></li>
<li><a href="#sec-2-2">2.2. Quelques propri√©t√©s</a></li>
<li><a href="#sec-2-3">2.3. Ind√©pendance et probabilit√© conditionnelle</a></li>
</ul>
</li>
</ul>
</div>
</nav>
</div><div class="col-md-9 col-md-pull-3"><h1 class="title">√âv√®nements et probabilit√©s</h1>
<p>
Le but de ce cours est d'introduire la notion d'algorithmes randomis√©s et de
revoir quelques notions de probabilit√© pour analyser les performances de
quelques algorithmes simples.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Une premi√®re application : v√©rification d'identit√©s polynomiales</h2>
<div class="outline-text-2" id="text-1">
<p>
On souhaite v√©rifier l'√©galit√© entre un produite de mon√¥mes et d'un polyn√¥me
r√©duit. Par exemple :
</p>

<p>
\[(x+1)(x-2)(x+3)(x-4)(x+5)(x-6)\equiv x^6 - 7x^3 + 25\]
</p>

<p>
Pour v√©rifier que l'√©galit√© est correcte, il suffit d√©velopper et r√©duire le
membre de gauche, puis de v√©rifier que l'on obtient deux polyn√¥mes identiques.
Plus g√©n√©ralement, cette m√©thode peut s'appliquer pour v√©rifier l'√©galit√© de
n'importe quelle paire de polyn√¥me :
\[F(x) = G(x)\]
</p>


<p>
N√©anmoins, d√©velopper un produit de mon√¥mes tel que :
\[F(x) = \prod_{i=1}^d(x-a_i)\]
Il faut d√©velopper les i premiers mon√¥me, puis multiplier le r√©sultat par le
i√®me mon√¥me. Cela requiert de calculer de l'ordre de i produits et de i-1
sommes, en gros 2i-1 op√©rations. Ainsi calculer la forme r√©duite de F(x)
requiert d<sup>2</sup> op√©rations.
</p>

<p>
Si maintenant, nous abandonnons l'id√©e de faire un calcul exact et que nous
nous contentons de faire un test probabiliste, nous pouvons √™tre bien plus
efficace. Supposons que F(x) et G(x) sont de degr√© d. Choisissons un entier n
au hasard dans l'ensemble {1,&#x2026;,100d} et calculons F(n) et G(n), si F(n) ‚â†
G(n) les deux polyn√¥mes ne sont pas √©quivalents et si F(n) = G(n), nous
consid√©rons (avec la possibilit√© que nous nous trompions) que les deux
polyn√¥mes sont √©gaux.
</p>

<p>
Essayons d'√©valuer qu'elles sont nos chances de nous tromper :
</p>
<ul class="org-ul">
<li>un polyn√¥me de degr√© au plus d a au plus d racines
</li>
<li>en particulier le polyn√¥me F(x) - G(x) a au plus d racines
</li>
<li>il y a au plus d nombres n dans {1,&#x2026;,100d} tels que F(n) = G(n)
</li>
<li>il y a au plus 1 chance sur 100 que F(x) ‚â† G(x) et que nous ayons tir√© au
hasard un nombre n tel que F(n) = G(n)
</li>
<li>ainsi lorsque nous consid√©rons que F(x) = G(x) nous le faisons avec une
confiance de 99%.
</li>
</ul>

<p>
Calculer F(n) et G(n) se fait en temps lin√©aire en d. Ainsi notre algorithme
probabiliste est plus efficace que l'algorithme exact.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Exercice</h3>
<div class="outline-text-3" id="text-1-1">
<p>
√âcrire une fonction python qui r√©alise ce test (penser √† utiliser le module
<code>random</code>) :
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">test_poly</span><span style="color: #707183;">(</span>f, g, d<span style="color: #707183;">)</span>:
    <span style="color: #036A07;">"""Si f et g sont de fonctions qui impl&#233;mentent des polyn&#244;mes de degr&#233;s au plus</span>
<span style="color: #036A07;">       d, renvoie False si f &#8800; g et True avec une confiance de 99% que f = g."""</span>
    <span style="color: #0000FF;">return</span> <span style="color: #D0372D;">True</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Un peu de probabilit√©s</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> D√©finition espace probabiliste discret</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Un espace probabiliste discret est donn√© par :
</p>
<ol class="org-ol">
<li>un ensemble Œ© d√©nombrable 
</li>
<li>une fonction de probabilit√© Pr : ùêè(Œ©) ‚Üí ‚Ñù (ùêè(Œ©) est l'ensemble des parties
de Œ©, on les appelle des <i>√©v√®nements</i>) telle que :
<ul class="org-ul">
<li>0 ‚â§ Pr(E) ‚â§ 1
</li>
<li>Pr(Œ©) = 1
</li>
<li>pour toute s√©quence (finie ou non) d'ensembles E‚ÇÅ, E‚ÇÇ, E‚ÇÉ, &#x2026;

<p>
\[Pr\left(\bigcup_{i\geq 1} E_i\right) = \sum_{i\geq 1} Pr(E_i)\]
</p>
</li>
</ul>
</li>
</ol>

<p>
NB: pour donner Pr, il suffit de conna√Ætre sa valeur sur tous les ensembles
singletons (√† 1 √©l√©ment) de Œ©.
</p>


<p>
Dans l'exemple sur les polyn√¥mes, Œ© = {1,&#x2026;, 100d} et Pr est d√©finie de
sorte que Pr({i}) = 1/100d.
</p>

<p>
Comme les √©v√®nements sont des ensembles, on peut √©crire E‚ÇÅ ‚à© E‚ÇÇ pour
l'√©v√®nement tel que E‚ÇÅ et E‚ÇÇ arrivent, E‚ÇÅ ‚à™ E‚ÇÇ pour l'√©v√®nement tel que E‚ÇÅ ou
E‚ÇÇ arrivent. Par exemple, lorsque l'on tire deux d√©s, Œ© est l'ensemble des
r√©sultats possibles d'un jet, E‚ÇÅ celui des jets tels que le premier d√© vaut
1, E‚ÇÇ celui des jets tels que le second d√©  vaut 1, alors E‚ÇÅ ‚à© E‚ÇÇ est
l'√©v√®nement o√π les deux d√©s valent 1 et E‚ÇÅ ‚à™ E‚ÇÇ celui o√π l'un des deux d√©s
vaut 1. De fa√ßon similaire on note E‚ÇÅ - E‚ÇÇ l'√©v√®nement qui v√©rifie E‚ÇÅ mais
pas E‚ÇÇ. Et la notation ¬¨E est utilis√©e comme une abr√©viation de Œ© - E.
</p>
</div>
</div>


<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Quelques propri√©t√©s</h3>
<div class="outline-text-3" id="text-2-2">
</div><div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1"><span class="section-number-4">2.2.1</span> Lemme 1</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Pour toute paire d'√©v√®nements E‚ÇÅ et E‚ÇÇ,
\[Pr(E_1 \cup E_2) = Pr(E_1) + Pr(E_2) - Pr(E_1\cap E_2)\]
</p>
</div>
<ol class="org-ol"><li><a id="sec-2-2-1-1" name="sec-2-2-1-1"></a>Preuve<br ><div class="outline-text-5" id="text-2-2-1-1">
<p>
Par d√©finition
\[Pr(E_1) = Pr(E_1 - (E_1\cap E_2)) + Pr(E_1\cap E_2)\]
\[Pr(E_2) = Pr(E_2 - (E_1\cap E_2)) + Pr(E_1\cap E_2)\]
\[Pr(E_1\cup E_2) = Pr(E_1 - (E_1\cap E_2))+ Pr(E_2 - (E_1\cap E_2))+
     Pr(E_1\cap E_2)\]
En combinant ces identit√©s on obtient le r√©sultat.
</p>
</div>
</li></ol>
</div>
<div id="outline-container-sec-2-2-2" class="outline-4">
<h4 id="sec-2-2-2"><span class="section-number-4">2.2.2</span> Lemme 2</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
Pour toute s√©quence finie ou infinie d'√©v√®nements E‚ÇÅ, E‚ÇÇ, &#x2026;,
\[Pr\left(\bigcup_{i\geq 1} E_i\right) \leq \sum_{i\geq 1}Pr(E_i)\] 
</p>


<p>
NB: ce lemme diff√®re de la d√©finition o√π les √©v√®nements sont consid√©r√©s disjoints
</p>
</div>
</div>
<div id="outline-container-sec-2-2-3" class="outline-4">
<h4 id="sec-2-2-3"><span class="section-number-4">2.2.3</span> Retour √† l'exemple</h4>
<div class="outline-text-4" id="text-2-2-3">
<p>
Dans l'exemple sur le test de l'√©galit√© de polyn√¥me, l'√©v√®nement que
l'algorithme retourne un mauvaise r√©ponse contient au plus d √©l√©ments et
ainsi Pr(l'algorithme se trompe) ‚â§ d / 100d = 1/100. Pour am√©liorer la
pr√©cision, il nous suffirait de prendre un entier au hasard dans {1,&#x2026;,
1000d}. La probabilit√© d'erreur est alors 1/1000. N√©anmoins, nous sommes
limit√©s par la pr√©cision des machines que nous utilisons.
</p>

<p>
Une autre approche consiste √† lancer l'algorithme plusieurs fois. On utilise
le fait que l'algorithme ne se trompe que si il consid√®re que les polyn√¥mes
sont √©gaux. Ainsi si on obtient que F(x) ‚â† G(x) alors on s'arr√™te.
</p>

<p>
R√©p√©ter un choix al√©atoire dans un espace probabiliste s'appelle <i>sampling</i>
</p>

<p>
R√©p√©ter un choix al√©atoire dans un espace probabiliste s'appelle <i>sampling</i>.
On pourrait le faire en √©liminant les valeurs d√©j√† utilis√©e ou non. Mais
cela n'a pas vraiment d'impact su la pr√©cision, mais a un impact sur
l'efficacit√©.
</p>

<p>
Ainsi r√©p√©ter k fois notre algorithme nous donne une probabilit√© d'erreur de
(1/100)<sup>k</sup>.
</p>
</div>
</div>


<div id="outline-container-sec-2-2-4" class="outline-4">
<h4 id="sec-2-2-4"><span class="section-number-4">2.2.4</span> Exercice</h4>
<div class="outline-text-4" id="text-2-2-4">
<p>
√âcrire une fonction python qui r√©alise ce test de sorte que la confiance
soit sup√©rieur √† un seuil :
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">test_poly_precis</span><span style="color: #707183;">(</span>f, g, d, seuil<span style="color: #707183;">)</span>:
    <span style="color: #036A07;">"""Si f et g sont de fonctions qui impl&#233;mentent des polyn&#244;mes de degr&#233;s au plus</span>
<span style="color: #036A07;">       d, renvoie False si f &#8800; g et True avec une confiance de 1-seuil que f = g."""</span>
    <span style="color: #0000FF;">return</span> <span style="color: #D0372D;">True</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Ind√©pendance et probabilit√© conditionnelle</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Deux √©v√®nements E et F sont ind√©pendant ssi :
\[Pr(E \cap F) = Pr(E) Pr(F)\]
Plus g√©n√©ralement des √©v√®nements E‚ÇÅ, E‚ÇÇ, &#x2026;, E‚Çñ sont deux √† deux
ind√©pendants ssi pour tout sous-ensemble I ‚äÜ [1, k],
\[Pr\left(\bigcap_{i\in I}E_i\right) = \prod_{i\in I} Pr(E_i)\]
</p>

<p>
La justification de la confiance de notre algorithme de sampling vient du
fait que nous ayons fait des choix al√©atoires ind√©pendants.
</p>

<p>
La probabilit√© conditionnelle de E en sachant que F est (avec Pr(F) &gt; 0) :
\[Pr(E \mid F) = \frac{Pr(E\cap F)}{Pr(F)}\]
</p>


<p>
Intuitivement, il s'agit de la probabilit√© de E ‚à© F relativement aux
√©v√®nements d√©finis par F. On renormalise la probabilit√© de E ‚à© F par rapport
√† celle de F. Une forme utile (toujours avec Pr(F) &gt; 0) est :
\[Pr(E \mid F)Pr(F) = Pr(E\cap F)\]
</p>

<p>
On remarque que lorsque E et F sont ind√©pendants et Pr(F) ‚â† 0, nous avons :
\[Pr(E \mid F) = \frac{Pr(E\cap F)}{Pr(F)} = \frac{Pr(E)Pr(F)}{Pr(F)} = Pr(E)\]
</p>
</div>



<div id="outline-container-sec-2-3-1" class="outline-4">
<h4 id="sec-2-3-1"><span class="section-number-4">2.3.1</span> Exercices</h4>
<div class="outline-text-4" id="text-2-3-1">
</div><ol class="org-ol"><li><a id="sec-2-3-1-1" name="sec-2-3-1-1"></a>Encore un jeu de d√©s<br ><div class="outline-text-5" id="text-2-3-1-1">
<p>
On tire deux d√®s √† 6 faces. Donner la probabilit√© des √©v√®nements suivants
en consid√©rant que les r√©sultats des d√©s sont ind√©pendants :
</p>
<ol class="org-ol">
<li>Les deux d√©s portent le m√™me nombre.
</li>
<li>Le nombre qui appara√Æt sur le premier d√© est plus grand que celui du second.
</li>
<li>La somme des d√©s est paire.
</li>
</ol>
</div>
</li>



<li><a id="sec-2-3-1-2" name="sec-2-3-1-2"></a>Un test m√©dical s√ªr ?<br ><div class="outline-text-5" id="text-2-3-1-2">
<p>
Une firme pharmaceutique propose un nouveau test tr√®s efficace pour une
maladie :
</p>
<ul class="org-ul">
<li>La probabilit√© d'un faux n√©gatif est tr√®s faible : une personne atteinte
a une probabilit√© de 0.999 d'avoir une test positif.
</li>
<li>La probabilit√© d'un faux positif est √©galement tr√®s faible : une personne
saine a une probabilit√© 0.005 d'avoir un test positif.
</li>
</ul>

<p>
Il y 2% des personnes qui sont atteintes pas la maladie. Si une personne
est choisie au hasard dans la population et que son test est positif,
quelle est la probabilit√© qu'elle soit malade ?
</p>
</div>
</li>


<li><a id="sec-2-3-1-3" name="sec-2-3-1-3"></a>Un tir al√©atoire de Von Neumann<br ><div class="outline-text-5" id="text-2-3-1-3">
<p>
On suppose que nous avons un fonction <code>flip()</code> qui renvoie la valeur <code>True</code>
avec une probabilit√© <code>p</code> inconnue et <code>False</code> avec une probabilit√© <code>1-p</code>.
Nous allons √©tudier l'algorithme suivant :
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">tir</span><span style="color: #707183;">()</span>:
    <span style="color: #0000FF;">while</span> <span style="color: #D0372D;">True</span>:
        <span style="color: #BA36A5;">t1</span> = flip<span style="color: #707183;">()</span>
        <span style="color: #BA36A5;">t2</span> = flip<span style="color: #707183;">()</span>
        <span style="color: #0000FF;">if</span> t1 <span style="color: #0000FF;">and</span> <span style="color: #0000FF;">not</span> t2:
            <span style="color: #0000FF;">return</span> <span style="color: #D0372D;">True</span>
        <span style="color: #0000FF;">if</span> t2 <span style="color: #0000FF;">and</span> <span style="color: #0000FF;">not</span> t1:
            <span style="color: #0000FF;">return</span> <span style="color: #D0372D;">False</span>
</pre>
</div>

<ol class="org-ol">
<li>Quelle est la probabilit√© que pendant un tour de boucle la fonction
retourne <code>True</code> ?
</li>
<li>Quelle est la probabilit√© que pendant un tour de boucle la fonction
retourne <code>False</code> ?
</li>
<li>Quelle est la probabilit√© que la boucle tourne ind√©finiment ?
</li>
<li>Quelle est la probabilit√© que la fonction retourne <code>True</code> ?
</li>
<li>Quelle est la probabilit√© que la fonction retourne <code>False</code> ?
</li>
</ol>
</div>
</li>



<li><a id="sec-2-3-1-4" name="sec-2-3-1-4"></a>Tirer un nombre<br ><div class="outline-text-5" id="text-2-3-1-4">
<p>
On suppose que nous disposons d'une fonction <code>flip()</code> qui renvoie la valeur
<code>True</code> avec probabilit√© 1/2 et <code>False</code> avec probabilit√© 1/2.
Nous allons √©tudier l'algorithme suivant:
</p>
<div class="org-src-container">

<pre class="src src-python"><span style="color: #0000FF;">def</span> <span style="color: #006699;">tir</span><span style="color: #707183;">(</span>n<span style="color: #707183;">)</span>:
    <span style="color: #BA36A5;">v</span> = <span style="color: #D0372D;">1</span>
    <span style="color: #BA36A5;">c</span> = <span style="color: #D0372D;">0</span>
    <span style="color: #0000FF;">while</span> <span style="color: #D0372D;">True</span>:
        <span style="color: #BA36A5;">v</span> = <span style="color: #D0372D;">2</span>*v
        <span style="color: #BA36A5;">c</span> = <span style="color: #D0372D;">2</span>*c + <span style="color: #D0372D;">1</span> <span style="color: #0000FF;">if</span> flip<span style="color: #707183;">()</span> <span style="color: #0000FF;">else</span> <span style="color: #D0372D;">0</span>
        <span style="color: #0000FF;">if</span> v &gt;= n:
            <span style="color: #0000FF;">if</span> c &lt; n:
                <span style="color: #0000FF;">return</span> c
            <span style="color: #0000FF;">else</span>:
                <span style="color: #BA36A5;">v</span> = v - n
                <span style="color: #BA36A5;">c</span> = c - n
</pre>
</div>
<p>
On consid√®re l'invariant suivant :
</p>
<blockquote>
<p>
c est distribu√© uniform√©ment dans {0,&#x2026;, v-1}
</p>
</blockquote>
<p>
c'est-√†-dire qu'√† chaque tour de boucle, pour tout i, c a la valeur i dans
{0,&#x2026;,v-1} avec une probabilit√© 1/v.
</p>

<ol class="org-ol">
<li>Montrer que l'invariant est v√©rifi√© :
<ul class="org-ul">
<li>avant la boucle
</li>
<li>apr√®s les deux affectations du d√©but de boucle
</li>
<li>en fin de boucle
</li>
</ul>
</li>
<li>Quelle est la probabilit√© que la boucle termine?
</li>
<li>Quelle est la probabilit√© que l'algorithme termine?
</li>
<li>Avec quelle probabilit√©, l'algorithme renvoie-t-il la valeur i?
</li>
<li>Comparer cet algorithme avec l'algorithme <code>_randbelow_with_getrandbits</code>
de la librairie <a href="https://github.com/python/cpython/blob/0554044ddccdb7bf1fa4a8bc880e7a7b59f6479c/Lib/random.py#L240"><code>random</code> de python</a>.
</li>
</ol>
</div>
</li></ol>
</div>
</div>
</div>
</div></div></div>
</body>
</html>
