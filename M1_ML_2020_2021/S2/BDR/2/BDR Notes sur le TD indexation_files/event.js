!function(a,b){"use strict";"function"==typeof define&&define.amd?define('core/loglevel', b):"object"==typeof module&&module.exports?module.exports=b():a.log=b()}(this,function(){"use strict";function a(a,b){var c=a[b];if("function"==typeof c.bind)return c.bind(a);try{return Function.prototype.bind.call(c,a)}catch(d){return function(){return Function.prototype.apply.apply(c,[a,arguments])}}}function b(b){return"debug"===b&&(b="log"),typeof console!==h&&(void 0!==console[b]?a(console,b):void 0!==console.log?a(console,"log"):g)}function c(a,b){for(var c=0;c<i.length;c++){var d=i[c];this[d]=c<a?g:this.methodFactory(d,a,b)}this.log=this.debug}function d(a,b,d){return function(){typeof console!==h&&(c.call(this,b,d),this[a].apply(this,arguments))}}function e(a,c,e){return b(a)||d.apply(this,arguments)}function f(a,b,d){function f(a){var b=(i[a]||"silent").toUpperCase();if(typeof window!==h){try{return void(window.localStorage[l]=b)}catch(c){}try{window.document.cookie=encodeURIComponent(l)+"="+b+";"}catch(c){}}}function g(){var a;if(typeof window!==h){try{a=window.localStorage[l]}catch(b){}if(typeof a===h)try{var c=window.document.cookie,d=c.indexOf(encodeURIComponent(l)+"=");d!==-1&&(a=/^([^;]+)/.exec(c.slice(d))[1])}catch(b){}return void 0===k.levels[a]&&(a=void 0),a}}var j,k=this,l="loglevel";a&&(l+=":"+a),k.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},k.methodFactory=d||e,k.getLevel=function(){return j},k.setLevel=function(b,d){if("string"==typeof b&&void 0!==k.levels[b.toUpperCase()]&&(b=k.levels[b.toUpperCase()]),!("number"==typeof b&&b>=0&&b<=k.levels.SILENT))throw"log.setLevel() called with invalid level: "+b;if(j=b,d!==!1&&f(b),c.call(k,b,a),typeof console===h&&b<k.levels.SILENT)return"No console available for logging"},k.setDefaultLevel=function(a){g()||k.setLevel(a,!1)},k.enableAll=function(a){k.setLevel(k.levels.TRACE,a)},k.disableAll=function(a){k.setLevel(k.levels.SILENT,a)};var m=g();null==m&&(m=null==b?"WARN":b),k.setLevel(m,!1)}var g=function(){},h="undefined",i=["trace","debug","info","warn","error"],j=new f,k={};j.getLogger=function(a){if("string"!=typeof a||""===a)throw new TypeError("You must supply a name when creating a logger.");var b=k[a];return b||(b=k[a]=new f(a,j.getLevel(),j.methodFactory)),b};var l=typeof window!==h?window.log:void 0;return j.noConflict=function(){return typeof window!==h&&window.log===j&&(window.log=l),j},j});
define('core/tree', ["jquery"],function(a){var b={ITEM:"[role=treeitem]",GROUP:"[role=treeitem]:has([role=group]), [role=treeitem][aria-owns], [role=treeitem][data-requires-ajax=true]",CLOSED_GROUP:"[role=treeitem]:has([role=group])[aria-expanded=false], [role=treeitem][aria-owns][aria-expanded=false], [role=treeitem][data-requires-ajax=true][aria-expanded=false]",FIRST_ITEM:"[role=treeitem]:first",VISIBLE_ITEM:"[role=treeitem]:visible",UNLOADED_AJAX_ITEM:"[role=treeitem][data-requires-ajax=true][data-loaded=false][aria-expanded=true]"},c=function(c,d){this.treeRoot=a(c),this.treeRoot.data("activeItem",null),this.selectCallback=d,this.keys={tab:9,enter:13,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,asterisk:106},this.initialiseNodes(this.treeRoot),this.setActiveItem(this.treeRoot.find(b.FIRST_ITEM)),this.refreshVisibleItemsCache(),this.bindEventHandlers()};return c.prototype.registerEnterCallback=function(a){this.enterCallback=a},c.prototype.refreshVisibleItemsCache=function(){this.treeRoot.data("visibleItems",this.treeRoot.find(b.VISIBLE_ITEM))},c.prototype.getVisibleItems=function(){return this.treeRoot.data("visibleItems")},c.prototype.setActiveItem=function(a){var b=this.treeRoot.data("activeItem");a!==b&&(b&&(b.attr("tabindex","-1"),b.attr("aria-selected","false")),a.attr("tabindex","0"),a.attr("aria-selected","true"),this.treeRoot.data("activeItem",a),"function"==typeof this.selectCallback&&this.selectCallback(a))},c.prototype.isGroupItem=function(a){return a.is(b.GROUP)},c.prototype.getGroupFromItem=function(a){var b=this.treeRoot.find("#"+a.attr("aria-owns")),c=a.children("[role=group]");return b.length>c.length?b:c},c.prototype.isGroupCollapsed=function(a){return"false"===a.attr("aria-expanded")},c.prototype.isGroupCollapsible=function(a){return"false"!==a.attr("data-collapsible")},c.prototype.initialiseNodes=function(c){this.removeAllFromTabOrder(c),this.setAriaSelectedFalseOnItems(c);var d=this;c.find(b.UNLOADED_AJAX_ITEM).each(function(){var b=a(this);d.collapseGroup(b),d.expandGroup(b)})},c.prototype.removeAllFromTabOrder=function(b){b.find("*").attr("tabindex","-1"),this.getGroupFromItem(a(b)).find("*").attr("tabindex","-1")},c.prototype.setAriaSelectedFalseOnItems=function(a){a.find(b.ITEM).attr("aria-selected","false")},c.prototype.expandAllGroups=function(){var c=this;this.treeRoot.find(b.CLOSED_GROUP).each(function(){var b=a(this);c.expandGroup(a(this)).done(function(){c.expandAllChildGroups(b)})})},c.prototype.expandAllChildGroups=function(c){var d=this;this.getGroupFromItem(c).find(b.CLOSED_GROUP).each(function(){var b=a(this);d.expandGroup(a(this)).done(function(){d.expandAllChildGroups(b)})})},c.prototype.expandGroup=function(b){var c=a.Deferred();if("false"!==b.attr("data-expandable")&&this.isGroupCollapsed(b))if("true"===b.attr("data-requires-ajax")&&"true"!==b.attr("data-loaded")){b.attr("data-loaded",!1);var d=b.closest("[data-ajax-loader]").attr("data-ajax-loader"),e=this;b.addClass("loading"),require([d],function(a){a.load(b).done(function(){b.attr("data-loaded",!0),e.initialiseNodes(b),e.finishExpandingGroup(b),b.removeClass("loading"),c.resolve()})})}else this.finishExpandingGroup(b),c.resolve();else c.resolve();return c},c.prototype.finishExpandingGroup=function(a){var b=this.getGroupFromItem(a);b.attr("aria-hidden","false"),a.attr("aria-expanded","true"),this.refreshVisibleItemsCache()},c.prototype.collapseGroup=function(a){if(this.isGroupCollapsible(a)&&!this.isGroupCollapsed(a)){var b=this.getGroupFromItem(a);b.attr("aria-hidden","true"),a.attr("aria-expanded","false"),this.refreshVisibleItemsCache()}},c.prototype.toggleGroup=function(a){"true"===a.attr("aria-expanded")?this.collapseGroup(a):this.expandGroup(a)},c.prototype.handleKeyDown=function(c,d){var e=this.getVisibleItems().index(c);if(d.altKey||d.ctrlKey||d.metaKey||d.shiftKey&&d.keyCode!=this.keys.tab)return!0;switch(d.keyCode){case this.keys.home:return this.getVisibleItems().first().focus(),d.stopPropagation(),!1;case this.keys.end:return this.getVisibleItems().last().focus(),d.stopPropagation(),!1;case this.keys.enter:var f=c.children("a").length?c.children("a"):c.children().not(b.GROUP).find("a");return f.length?"function"==typeof this.enterCallback?this.enterCallback(c):window.location.href=f.first().attr("href"):this.isGroupItem(c)&&this.toggleGroup(c,!0),d.stopPropagation(),!1;case this.keys.space:return this.isGroupItem(c)&&this.toggleGroup(c,!0),d.stopPropagation(),!1;case this.keys.left:var g=function(b){b.getVisibleItems().filter(function(){return b.getGroupFromItem(a(this)).has(c).length}).focus()};return this.isGroupItem(c)?this.isGroupCollapsed(c)?g(this):this.collapseGroup(c):g(this),d.stopPropagation(),!1;case this.keys.right:return this.isGroupItem(c)&&(this.isGroupCollapsed(c)?this.expandGroup(c):this.getGroupFromItem(c).find(b.ITEM).first().focus()),d.stopPropagation(),!1;case this.keys.up:if(e>0){var h=this.getVisibleItems().eq(e-1);h.focus()}return d.stopPropagation(),!1;case this.keys.down:if(e<this.getVisibleItems().length-1){var i=this.getVisibleItems().eq(e+1);i.focus()}return d.stopPropagation(),!1;case this.keys.asterisk:return this.expandAllGroups(),d.stopPropagation(),!1}return!0},c.prototype.handleClick=function(a,b){return!!(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)||(a.focus(),this.isGroupItem(a)&&this.toggleGroup(a),b.stopPropagation(),!0)},c.prototype.handleFocus=function(a,b){return this.setActiveItem(a),b.stopPropagation(),!0},c.prototype.bindEventHandlers=function(){var c=this;this.treeRoot.on({click:function(b){return c.handleClick(a(this),b)},keydown:function(b){return c.handleKeyDown(a(this),b)},focus:function(b){return c.handleFocus(a(this),b)}},b.ITEM)},c});
define('core/chartjs', ["core/chartjs-lazy"],function(a){return a});
define('core/truncate', ["jquery"],function(a){var b=/(\s*\S+|\s)$/,c=/^(\S*)/,d=/\s/,e=function(a,b){if(null==this)throw TypeError();var c=String(a),d=c.length,e=b?Number(b):0;if(e!=e&&(e=0),e<=-1||e>=d)return"";e=0|e;var f,g=c.charCodeAt(e),h=e+1,i=1;return g>=55296&&g<=56319&&d>h&&(f=c.charCodeAt(h),f>=56320&&f<=57343&&(i=2)),i},f=function(a){for(var b=0,c=0;c<a.length;c+=e(a,c))b++;return b},g=function(a,b){if(!a.length)return 0;var c=0,d=0;do c+=e(a,c),d++;while(c<a.length&&d<b);return c};return a.truncate=function(b,c){return a("<div></div>").append(b).truncate(c).html()},a.fn.truncate=function(e){isNaN(parseFloat(e))||(e={length:e});var h=a.extend({},a.truncate.defaults,e);return this.each(function(){var e=a(this);h.noBreaks&&e.find("br").replaceWith(" ");var i=h.ellipsis.length,j=e.text(),k=f(j),l=k-h.length+i;if(!(k<h.length)){if(h.stripTags&&e.text(j),h.words&&l>0){var m=j.slice(0,g(j,h.length-i)+1),n=m.replace(b,""),o=f(n),p=!m.match(d);l=h.keepFirstWord&&0===o?k-f(c.exec(j)[0])-i:p&&0===o?k-h.length+i:k-o-1}l>k&&(l=k-h.length),l<0||!l&&!h.truncated||a.each(e.contents().get().reverse(),function(b,c){var d=a(c),e=d.text(),j=f(e);if(j<=l)return h.truncated=!0,l-=j,void d.remove();if(3===c.nodeType){var k=j-l;return k=k>=0?g(e,k):0,a(c.splitText(k)).replaceWith(h.ellipsis),!1}return d.truncate(a.extend(h,{length:j-l+i})),!1})}})},a.truncate.defaults={stripTags:!1,words:!1,keepFirstWord:!1,noBreaks:!1,length:1/0,ellipsis:"â€¦"},{truncate:a.truncate}});
define('core/popover_region_controller', ["jquery","core/str","core/custom_interaction_events"],function(a,b,c){var d={CONTENT:".popover-region-content",CONTENT_CONTAINER:".popover-region-content-container",MENU_CONTAINER:".popover-region-container",MENU_TOGGLE:".popover-region-toggle",CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},e=function(b){this.root=a(b),this.content=this.root.find(d.CONTENT),this.contentContainer=this.root.find(d.CONTENT_CONTAINER),this.menuContainer=this.root.find(d.MENU_CONTAINER),this.menuToggle=this.root.find(d.MENU_TOGGLE),this.isLoading=!1,this.promises={closeHandlers:a.Deferred(),navigationHandlers:a.Deferred()},this.registerBaseEventListeners()};return e.prototype.events=function(){return{menuOpened:"popoverregion:menuopened",menuClosed:"popoverregion:menuclosed",startLoading:"popoverregion:startLoading",stopLoading:"popoverregion:stopLoading"}},e.prototype.getContentContainer=function(){return this.contentContainer},e.prototype.getContent=function(){return this.content},e.prototype.isMenuOpen=function(){return!this.root.hasClass("collapsed")},e.prototype.toggleMenu=function(){this.isMenuOpen()?this.closeMenu():this.openMenu()},e.prototype.closeMenu=function(){this.isMenuOpen()&&(this.root.addClass("collapsed"),this.menuContainer.attr("aria-expanded","false"),this.menuContainer.attr("aria-hidden","true"),this.updateButtonAriaLabel(),this.root.trigger(this.events().menuClosed))},e.prototype.openMenu=function(){this.isMenuOpen()||(this.root.removeClass("collapsed"),this.menuContainer.attr("aria-expanded","true"),this.menuContainer.attr("aria-hidden","false"),this.updateButtonAriaLabel(),this.promises.closeHandlers.resolve(),this.promises.navigationHandlers.resolve(),this.root.trigger(this.events().menuOpened))},e.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?b.get_string("hidepopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):b.get_string("showpopoverwindow").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},e.prototype.startLoading=function(){this.isLoading=!0,this.getContentContainer().addClass("loading"),this.getContentContainer().attr("aria-busy","true"),this.root.trigger(this.events().startLoading)},e.prototype.stopLoading=function(){this.isLoading=!1,this.getContentContainer().removeClass("loading"),this.getContentContainer().attr("aria-busy","false"),this.root.trigger(this.events().stopLoading)},e.prototype.focusMenuToggle=function(){this.menuToggle.focus()},e.prototype.contentItemHasFocus=function(){return this.getContentItemWithFocus().length>0},e.prototype.getContentItemWithFocus=function(){var b=a(document.activeElement),c=this.getContent().children(),d=c.filter(b);return d.length||(d=c.has(b)),d},e.prototype.focusContentItem=function(a){a.is(d.CAN_RECEIVE_FOCUS)?a.focus():a.find(d.CAN_RECEIVE_FOCUS).first().focus()},e.prototype.focusFirstContentItem=function(){this.focusContentItem(this.getContent().children().first())},e.prototype.focusLastContentItem=function(){this.focusContentItem(this.getContent().children().last())},e.prototype.focusNextContentItem=function(){var a=this.getContentItemWithFocus();a.length&&a.next()&&this.focusContentItem(a.next())},e.prototype.focusPreviousContentItem=function(){var a=this.getContentItemWithFocus();a.length&&a.prev()&&this.focusContentItem(a.prev())},e.prototype.registerBaseEventListeners=function(){c.define(this.root,[c.events.activate,c.events.escape]),this.root.on(c.events.activate,d.MENU_TOGGLE,function(){this.toggleMenu()}.bind(this)),this.promises.closeHandlers.done(function(){this.root.on(c.events.escape,function(){this.closeMenu(),this.focusMenuToggle()}.bind(this)),a("html").click(function(b){var c=a(b.target);this.root.is(c)||this.root.has(c).length||this.closeMenu()}.bind(this)),c.define(this.getContentContainer(),[c.events.scrollBottom])}.bind(this))},e.prototype.registerListNavigationEventListeners=function(){c.define(this.root,[c.events.down]),this.root.on(c.events.down,function(a,b){this.isMenuOpen()?this.contentItemHasFocus()?this.focusNextContentItem():this.focusFirstContentItem():(this.openMenu(),this.focusFirstContentItem()),b.originalEvent.preventDefault()}.bind(this)),this.promises.navigationHandlers.done(function(){c.define(this.root,[c.events.up,c.events.home,c.events.end]),this.root.on(c.events.up,function(a,b){this.focusPreviousContentItem(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(c.events.home,function(a,b){this.focusFirstContentItem(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(c.events.end,function(a,b){this.focusLastContentItem(),b.originalEvent.preventDefault()}.bind(this))}.bind(this))},e});
define('core/chart_bar', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype._horizontal=!1,b.prototype._stacked=!1,b.prototype.TYPE="bar",b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setHorizontal(c.horizontal),d.setStacked(c.stacked),d},b.prototype._setDefaults=function(){a.prototype._setDefaults.apply(this,arguments);var b=this.getYAxis(0,!0);b.setMin(0)},b.prototype.getHorizontal=function(){return this._horizontal},b.prototype.getStacked=function(){return this._stacked},b.prototype.setHorizontal=function(a){var b=this.getXAxis(0,!0);null===b.getMin()&&b.setMin(0),this._horizontal=Boolean(a)},b.prototype.setStacked=function(a){this._stacked=Boolean(a)},b});
define('core/chart_output_base', ["jquery"],function(a){function b(b,c){this._node=a(b),this._chart=c}return b.prototype.update=function(){throw new Error("Not supported.")},b});
define('core/url', ["jquery","core/config"],function(a,b){return{fileUrl:function(a,c){var d=b.wwwroot+a;return"/"!=c.charAt(0)&&(c="/"+c),d+=b.slasharguments?c:"?file="+encodeURIComponent(c)},relativeUrl:function(c,d,e){if(0===c.indexOf("http:")||0===c.indexOf("https:")||c.indexOf("://")>=0)throw new Error("relativeUrl function does not accept absolute urls");"/"!=c.charAt(0)&&(c="/"+c),"admin"!==b.admin&&(c=c.replace(/^\/admin\//,"/"+b.admin+"/")),d=d||{},e&&(d.sesskey=b.sesskey);var f="";return Object.keys(d).length&&(f=a.map(d,function(a,b){return b+"="+a}).join("&")),""!==f?b.wwwroot+c+"?"+f:b.wwwroot+c},imageUrl:function(a,b){return M.util.image_url(a,b)}}});
define('core/chart_output', ["core/chart_output_chartjs"],function(a){var b=a;return b});
define('core/auto_rows', ["jquery"],function(a){var b={ELEMENT:"[data-auto-rows]"},c={ROW_CHANGE:"autorows:rowchange"},d=function(a){var b=a.attr("rows"),c=a.data("min-rows"),d=a.attr("data-max-rows"),e=a.height(),f=a.innerHeight(),g=f-e,h=a[0].scrollHeight,i=(h-g)/(e/b);return a.css("height",""),i<c?c:d&&i>=d?d:i},e=function(b){var e=a(b.target),f=e.data("min-rows"),g=e.attr("rows");"undefined"==typeof f&&e.data("min-rows",g);var h=d(e);h!=g&&(e.attr("rows",h),e.trigger(c.ROW_CHANGE))},f=function(c){a(c).data("auto-rows")?a(c).on("input propertychange",e.bind(this)):a(c).on("input propertychange",b.ELEMENT,e.bind(this))};return{init:f,events:c}});
define('core/icon_system_standard', ["core/icon_system","core/url","core/mustache"],function(a,b,c){var d=function(){a.apply(this,arguments)};return d.prototype=Object.create(a.prototype),d.prototype.renderIcon=function(a,d,e,f){var g=b.imageUrl(a,d),h={attributes:[{name:"src",value:g},{name:"alt",value:e},{name:"title",value:e}]};"undefined"!=typeof e&&""!=e||h.attributes.push({name:"aria-hidden",value:"true"});var i=c.render(f,h);return i.trim()},d.prototype.getTemplateName=function(){return"core/pix_icon"},d});
define('core/adapter', [],function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=j.writeRtpDescription(a.kind,b);if(f+=j.writeIceParameters(a.iceGatherer.getLocalParameters()),f+=j.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":e||"active"),f+="a=mid:"+a.mid+"\r\n",f+=a.rtpSender&&a.rtpReceiver?"a=sendrecv\r\n":a.rtpSender?"a=sendonly\r\n":a.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",a.rtpSender){var g=a.rtpSender._initialTrackId||a.rtpSender.track.id;a.rtpSender._initialTrackId=g;var h="msid:"+(d?d.id:"-")+" "+g+"\r\n";f+="a="+h,f+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+h,a.sendEncodingParameters[0].rtx&&(f+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+h,f+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return f+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+j.localCName+"\r\n",a.rtpSender&&a.sendEncodingParameters[0].rtx&&(f+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+j.localCName+"\r\n"),f}function e(a,b){var c=!1;return a=JSON.parse(JSON.stringify(a)),a.filter(function(a){if(a&&(a.urls||a.url)){var d=a.urls||a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var e="string"==typeof d;return e&&(d=[d]),d=d.filter(function(a){var d=0===a.indexOf("turn:")&&a.indexOf("transport=udp")!==-1&&a.indexOf("turn:[")===-1&&!c;return d?(c=!0,!0):0===a.indexOf("stun:")&&b>=14393&&a.indexOf("?transport=udp")===-1}),delete a.url,a.urls=e?d[0]:d,!!d.length}})}function f(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},d=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},e=function(a,b,c,e){var f=d(a.parameters.apt,c),g=d(b.parameters.apt,e);return f&&g&&f.name.toLowerCase()===g.name.toLowerCase()};return a.codecs.forEach(function(d){for(var f=0;f<b.codecs.length;f++){var g=b.codecs[f];if(d.name.toLowerCase()===g.name.toLowerCase()&&d.clockRate===g.clockRate){if("rtx"===d.name.toLowerCase()&&d.parameters&&g.parameters.apt&&!e(d,g,a.codecs,b.codecs))continue;g=JSON.parse(JSON.stringify(g)),g.numChannels=Math.min(d.numChannels,g.numChannels),c.codecs.push(g),g.rtcpFeedback=g.rtcpFeedback.filter(function(a){for(var b=0;b<d.rtcpFeedback.length;b++)if(d.rtcpFeedback[b].type===a.type&&d.rtcpFeedback[b].parameter===a.parameter)return!0;return!1});break}}}),a.headerExtensions.forEach(function(a){for(var d=0;d<b.headerExtensions.length;d++){var e=b.headerExtensions[d];if(a.uri===e.uri){c.headerExtensions.push(e);break}}}),c}function g(a,b,c){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)!==-1}function h(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});return c||a.addRemoteCandidate(b),!c}function i(a,b){var c=new Error(b);return c.name=a,c.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[a],c}var j=a("sdp");b.exports=function(a,b){function c(b,c){c.addTrack(b),c.dispatchEvent(new a.MediaStreamTrackEvent("addtrack",{track:b}))}function k(b,c){c.removeTrack(b),c.dispatchEvent(new a.MediaStreamTrackEvent("removetrack",{track:b}))}function l(b,c,d,e){var f=new Event("track");f.track=c,f.receiver=d,f.transceiver={receiver:d},f.streams=e,a.setTimeout(function(){b._dispatchEvent("track",f)})}var m=function(c){var d=this,f=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){d[a]=f[a].bind(f)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this.localDescription=null,this.remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",c=JSON.parse(JSON.stringify(c||{})),this.usingBundle="max-bundle"===c.bundlePolicy,"negotiate"===c.rtcpMuxPolicy)throw i("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(c.rtcpMuxPolicy||(c.rtcpMuxPolicy="require"),c.iceTransportPolicy){case"all":case"relay":break;default:c.iceTransportPolicy="all"}switch(c.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:c.bundlePolicy="balanced"}if(c.iceServers=e(c.iceServers||[],b),this._iceGatherers=[],c.iceCandidatePoolSize)for(var g=c.iceCandidatePoolSize;g>0;g--)this._iceGatherers.push(new a.RTCIceGatherer({iceServers:c.iceServers,gatherPolicy:c.iceTransportPolicy}));else c.iceCandidatePoolSize=0;this._config=c,this.transceivers=[],this._sdpSessionId=j.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};m.prototype.onicecandidate=null,m.prototype.onaddstream=null,m.prototype.ontrack=null,m.prototype.onremovestream=null,m.prototype.onsignalingstatechange=null,m.prototype.oniceconnectionstatechange=null,m.prototype.onconnectionstatechange=null,m.prototype.onicegatheringstatechange=null,m.prototype.onnegotiationneeded=null,m.prototype.ondatachannel=null,m.prototype._dispatchEvent=function(a,b){this._isClosed||(this.dispatchEvent(b),"function"==typeof this["on"+a]&&this["on"+a](b))},m.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",a)},m.prototype.getConfiguration=function(){return this._config},m.prototype.getLocalStreams=function(){return this.localStreams},m.prototype.getRemoteStreams=function(){return this.remoteStreams},m.prototype._createTransceiver=function(a,b){var c=this.transceivers.length>0,d={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&c)d.iceTransport=this.transceivers[0].iceTransport,d.dtlsTransport=this.transceivers[0].dtlsTransport;else{var e=this._createIceAndDtlsTransports();d.iceTransport=e.iceTransport,d.dtlsTransport=e.dtlsTransport}return b||this.transceivers.push(d),d},m.prototype.addTrack=function(b,c){if(this._isClosed)throw i("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var d=this.transceivers.find(function(a){return a.track===b});if(d)throw i("InvalidAccessError","Track already exists.");for(var e,f=0;f<this.transceivers.length;f++)this.transceivers[f].track||this.transceivers[f].kind!==b.kind||(e=this.transceivers[f]);return e||(e=this._createTransceiver(b.kind)),this._maybeFireNegotiationNeeded(),this.localStreams.indexOf(c)===-1&&this.localStreams.push(c),e.track=b,e.stream=c,e.rtpSender=new a.RTCRtpSender(b,e.dtlsTransport),e.rtpSender},m.prototype.addStream=function(a){var c=this;if(b>=15025)a.getTracks().forEach(function(b){c.addTrack(b,a)});else{var d=a.clone();a.getTracks().forEach(function(a,b){var c=d.getTracks()[b];a.addEventListener("enabled",function(a){c.enabled=a.enabled})}),d.getTracks().forEach(function(a){c.addTrack(a,d)})}},m.prototype.removeTrack=function(b){if(this._isClosed)throw i("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(b instanceof a.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var c=this.transceivers.find(function(a){return a.rtpSender===b});if(!c)throw i("InvalidAccessError","Sender was not created by this connection.");var d=c.stream;c.rtpSender.stop(),c.rtpSender=null,c.track=null,c.stream=null;var e=this.transceivers.map(function(a){return a.stream});e.indexOf(d)===-1&&this.localStreams.indexOf(d)>-1&&this.localStreams.splice(this.localStreams.indexOf(d),1),this._maybeFireNegotiationNeeded()},m.prototype.removeStream=function(a){var b=this;a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});c&&b.removeTrack(c)})},m.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})},m.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})},m.prototype._createIceGatherer=function(b,c){var d=this;if(c&&b>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var e=new a.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(e,"state",{value:"new",writable:!0}),this.transceivers[b].bufferedCandidateEvents=[],this.transceivers[b].bufferCandidates=function(a){var c=!a.candidate||0===Object.keys(a.candidate).length;e.state=c?"completed":"gathering",null!==d.transceivers[b].bufferedCandidateEvents&&d.transceivers[b].bufferedCandidateEvents.push(a)},e.addEventListener("localcandidate",this.transceivers[b].bufferCandidates),e},m.prototype._gather=function(b,c){var d=this,e=this.transceivers[c].iceGatherer;if(!e.onlocalcandidate){var f=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null,e.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates),e.onlocalcandidate=function(a){if(!(d.usingBundle&&c>0)){var f=new Event("icecandidate");f.candidate={sdpMid:b,sdpMLineIndex:c};var g=a.candidate,h=!g||0===Object.keys(g).length;if(h)"new"!==e.state&&"gathering"!==e.state||(e.state="completed");else{"new"===e.state&&(e.state="gathering"),g.component=1,g.ufrag=e.getLocalParameters().usernameFragment;var i=j.writeCandidate(g);f.candidate=Object.assign(f.candidate,j.parseCandidate(i)),f.candidate.candidate=i,f.candidate.toJSON=function(){return{candidate:f.candidate.candidate,sdpMid:f.candidate.sdpMid,sdpMLineIndex:f.candidate.sdpMLineIndex,usernameFragment:f.candidate.usernameFragment}}}var k=j.getMediaSections(d.localDescription.sdp);h?k[f.candidate.sdpMLineIndex]+="a=end-of-candidates\r\n":k[f.candidate.sdpMLineIndex]+="a="+f.candidate.candidate+"\r\n",d.localDescription.sdp=j.getDescription(d.localDescription.sdp)+k.join("");var l=d.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange()),h||d._dispatchEvent("icecandidate",f),l&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}},a.setTimeout(function(){f.forEach(function(a){e.onlocalcandidate(a)})},0)}},m.prototype._createIceAndDtlsTransports=function(){var b=this,c=new a.RTCIceTransport(null);c.onicestatechange=function(){b._updateIceConnectionState(),b._updateConnectionState()};var d=new a.RTCDtlsTransport(c);return d.ondtlsstatechange=function(){b._updateConnectionState()},d.onerror=function(){Object.defineProperty(d,"state",{value:"failed",writable:!0}),b._updateConnectionState()},{iceTransport:c,dtlsTransport:d}},m.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);var c=this.transceivers[a].iceTransport;c&&(delete c.onicestatechange,delete this.transceivers[a].iceTransport);var d=this.transceivers[a].dtlsTransport;d&&(delete d.ondtlsstatechange,delete d.onerror,delete this.transceivers[a].dtlsTransport)},m.prototype._transceive=function(a,c,d){var e=f(a.localCapabilities,a.remoteCapabilities);c&&a.rtpSender&&(e.encodings=a.sendEncodingParameters,e.rtcp={cname:j.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(e.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(e)),d&&a.rtpReceiver&&e.codecs.length>0&&("video"===a.kind&&a.recvEncodingParameters&&b<15019&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),a.recvEncodingParameters.length?e.encodings=a.recvEncodingParameters:e.encodings=[{}],e.rtcp={compound:a.rtcpParameters.compound},a.rtcpParameters.cname&&(e.rtcp.cname=a.rtcpParameters.cname),a.sendEncodingParameters.length&&(e.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(e))},m.prototype.setLocalDescription=function(a){var b=this;if(["offer","answer"].indexOf(a.type)===-1)return Promise.reject(i("TypeError",'Unsupported type "'+a.type+'"'));if(!g("setLocalDescription",a.type,b.signalingState)||b._isClosed)return Promise.reject(i("InvalidStateError","Can not set local "+a.type+" in state "+b.signalingState));var c,d;if("offer"===a.type)c=j.splitSections(a.sdp),d=c.shift(),c.forEach(function(a,c){var d=j.parseRtpParameters(a);b.transceivers[c].localCapabilities=d}),b.transceivers.forEach(function(a,c){b._gather(a.mid,c)});else if("answer"===a.type){c=j.splitSections(b.remoteDescription.sdp),d=c.shift();var e=j.matchPrefix(d,"a=ice-lite").length>0;c.forEach(function(a,c){var g=b.transceivers[c],h=g.iceGatherer,i=g.iceTransport,k=g.dtlsTransport,l=g.localCapabilities,m=g.remoteCapabilities,n=j.isRejected(a)&&0===j.matchPrefix(a,"a=bundle-only").length;if(!n&&!g.rejected){var o=j.getIceParameters(a,d),p=j.getDtlsParameters(a,d);e&&(p.role="server"),b.usingBundle&&0!==c||(b._gather(g.mid,c),"new"===i.state&&i.start(h,o,e?"controlling":"controlled"),"new"===k.state&&k.start(p));var q=f(l,m);b._transceive(g,q.codecs.length>0,!1)}})}return b.localDescription={type:a.type,sdp:a.sdp},"offer"===a.type?b._updateSignalingState("have-local-offer"):b._updateSignalingState("stable"),Promise.resolve()},m.prototype.setRemoteDescription=function(d){var e=this;if(["offer","answer"].indexOf(d.type)===-1)return Promise.reject(i("TypeError",'Unsupported type "'+d.type+'"'));if(!g("setRemoteDescription",d.type,e.signalingState)||e._isClosed)return Promise.reject(i("InvalidStateError","Can not set remote "+d.type+" in state "+e.signalingState));var f={};e.remoteStreams.forEach(function(a){f[a.id]=a});var m=[],n=j.splitSections(d.sdp),o=n.shift(),p=j.matchPrefix(o,"a=ice-lite").length>0,q=j.matchPrefix(o,"a=group:BUNDLE ").length>0;e.usingBundle=q;var r=j.matchPrefix(o,"a=ice-options:")[0];return r?e.canTrickleIceCandidates=r.substr(14).split(" ").indexOf("trickle")>=0:e.canTrickleIceCandidates=!1,n.forEach(function(g,i){var l=j.splitLines(g),n=j.getKind(g),r=j.isRejected(g)&&0===j.matchPrefix(g,"a=bundle-only").length,s=l[0].substr(2).split(" ")[2],t=j.getDirection(g,o),u=j.parseMsid(g),v=j.getMid(g)||j.generateIdentifier();if("application"===n&&"DTLS/SCTP"===s||r)return void(e.transceivers[i]={mid:v,kind:n,rejected:!0});!r&&e.transceivers[i]&&e.transceivers[i].rejected&&(e.transceivers[i]=e._createTransceiver(n,!0));var w,x,y,z,A,B,C,D,E,F,G,H=j.parseRtpParameters(g);r||(F=j.getIceParameters(g,o),G=j.getDtlsParameters(g,o),G.role="client"),C=j.parseRtpEncodingParameters(g);var I=j.parseRtcpParameters(g),J=j.matchPrefix(g,"a=end-of-candidates",o).length>0,K=j.matchPrefix(g,"a=candidate:").map(function(a){return j.parseCandidate(a)}).filter(function(a){return 1===a.component});if(("offer"===d.type||"answer"===d.type)&&!r&&q&&i>0&&e.transceivers[i]&&(e._disposeIceAndDtlsTransports(i),e.transceivers[i].iceGatherer=e.transceivers[0].iceGatherer,e.transceivers[i].iceTransport=e.transceivers[0].iceTransport,e.transceivers[i].dtlsTransport=e.transceivers[0].dtlsTransport,e.transceivers[i].rtpSender&&e.transceivers[i].rtpSender.setTransport(e.transceivers[0].dtlsTransport),e.transceivers[i].rtpReceiver&&e.transceivers[i].rtpReceiver.setTransport(e.transceivers[0].dtlsTransport)),"offer"!==d.type||r)"answer"!==d.type||r||(w=e.transceivers[i],x=w.iceGatherer,y=w.iceTransport,z=w.dtlsTransport,A=w.rtpReceiver,B=w.sendEncodingParameters,D=w.localCapabilities,e.transceivers[i].recvEncodingParameters=C,e.transceivers[i].remoteCapabilities=H,e.transceivers[i].rtcpParameters=I,K.length&&"new"===y.state&&(!p&&!J||q&&0!==i?K.forEach(function(a){h(w.iceTransport,a)}):y.setRemoteCandidates(K)),q&&0!==i||("new"===y.state&&y.start(x,F,"controlling"),"new"===z.state&&z.start(G)),e._transceive(w,"sendrecv"===t||"recvonly"===t,"sendrecv"===t||"sendonly"===t),!A||"sendrecv"!==t&&"sendonly"!==t?delete w.rtpReceiver:(E=A.track,u?(f[u.stream]||(f[u.stream]=new a.MediaStream),c(E,f[u.stream]),m.push([E,A,f[u.stream]])):(f["default"]||(f["default"]=new a.MediaStream),c(E,f["default"]),m.push([E,A,f["default"]]))));else{w=e.transceivers[i]||e._createTransceiver(n),w.mid=v,w.iceGatherer||(w.iceGatherer=e._createIceGatherer(i,q)),K.length&&"new"===w.iceTransport.state&&(!J||q&&0!==i?K.forEach(function(a){h(w.iceTransport,a)}):w.iceTransport.setRemoteCandidates(K)),D=a.RTCRtpReceiver.getCapabilities(n),b<15019&&(D.codecs=D.codecs.filter(function(a){return"rtx"!==a.name})),B=w.sendEncodingParameters||[{ssrc:1001*(2*i+2)}];var L=!1;if("sendrecv"===t||"sendonly"===t){if(L=!w.rtpReceiver,A=w.rtpReceiver||new a.RTCRtpReceiver(w.dtlsTransport,n),L){var M;E=A.track,u&&"-"===u.stream||(u?(f[u.stream]||(f[u.stream]=new a.MediaStream,Object.defineProperty(f[u.stream],"id",{get:function(){return u.stream}})),Object.defineProperty(E,"id",{get:function(){return u.track}}),M=f[u.stream]):(f["default"]||(f["default"]=new a.MediaStream),M=f["default"])),M&&(c(E,M),w.associatedRemoteMediaStreams.push(M)),m.push([E,A,M])}}else w.rtpReceiver&&w.rtpReceiver.track&&(w.associatedRemoteMediaStreams.forEach(function(a){var b=a.getTracks().find(function(a){return a.id===w.rtpReceiver.track.id});b&&k(b,a)}),w.associatedRemoteMediaStreams=[]);w.localCapabilities=D,w.remoteCapabilities=H,w.rtpReceiver=A,w.rtcpParameters=I,w.sendEncodingParameters=B,w.recvEncodingParameters=C,e._transceive(e.transceivers[i],!1,L)}}),void 0===e._dtlsRole&&(e._dtlsRole="offer"===d.type?"active":"passive"),e.remoteDescription={type:d.type,sdp:d.sdp},"offer"===d.type?e._updateSignalingState("have-remote-offer"):e._updateSignalingState("stable"),Object.keys(f).forEach(function(b){var c=f[b];if(c.getTracks().length){if(e.remoteStreams.indexOf(c)===-1){e.remoteStreams.push(c);var d=new Event("addstream");d.stream=c,a.setTimeout(function(){e._dispatchEvent("addstream",d)})}m.forEach(function(a){var b=a[0],d=a[1];c.id===a[2].id&&l(e,b,d,[c])})}}),m.forEach(function(a){a[2]||l(e,a[0],a[1],[])}),a.setTimeout(function(){e&&e.transceivers&&e.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&a.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},m.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop(),a.dtlsTransport&&a.dtlsTransport.stop(),a.rtpSender&&a.rtpSender.stop(),a.rtpReceiver&&a.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},m.prototype._updateSignalingState=function(a){this.signalingState=a;var b=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",b)},m.prototype._maybeFireNegotiationNeeded=function(){var b=this;"stable"===this.signalingState&&this.needNegotiation!==!0&&(this.needNegotiation=!0,a.setTimeout(function(){if(b.needNegotiation){b.needNegotiation=!1;var a=new Event("negotiationneeded");b._dispatchEvent("negotiationneeded",a)}},0))},m.prototype._updateIceConnectionState=function(){var a,b={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(a){b[a.iceTransport.state]++}),a="new",b.failed>0?a="failed":b.checking>0?a="checking":b.disconnected>0?a="disconnected":b["new"]>0?a="new":b.connected>0?a="connected":b.completed>0&&(a="completed"),a!==this.iceConnectionState){this.iceConnectionState=a;var c=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",c)}},m.prototype._updateConnectionState=function(){var a,b={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(a){b[a.iceTransport.state]++,b[a.dtlsTransport.state]++}),b.connected+=b.completed,a="new",b.failed>0?a="failed":b.connecting>0?a="connecting":b.disconnected>0?a="disconnected":b["new"]>0?a="new":b.connected>0&&(a="connected"),a!==this.connectionState){this.connectionState=a;var c=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",c)}},m.prototype.createOffer=function(){var c=this;if(c._isClosed)return Promise.reject(i("InvalidStateError","Can not call createOffer after close"));var e=c.transceivers.filter(function(a){return"audio"===a.kind}).length,f=c.transceivers.filter(function(a){return"video"===a.kind}).length,g=arguments[0];if(g){if(g.mandatory||g.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==g.offerToReceiveAudio&&(e=g.offerToReceiveAudio===!0?1:g.offerToReceiveAudio===!1?0:g.offerToReceiveAudio),void 0!==g.offerToReceiveVideo&&(f=g.offerToReceiveVideo===!0?1:g.offerToReceiveVideo===!1?0:g.offerToReceiveVideo)}for(c.transceivers.forEach(function(a){"audio"===a.kind?(e--,e<0&&(a.wantReceive=!1)):"video"===a.kind&&(f--,f<0&&(a.wantReceive=!1))});e>0||f>0;)e>0&&(c._createTransceiver("audio"),e--),f>0&&(c._createTransceiver("video"),f--);var h=j.writeSessionBoilerplate(c._sdpSessionId,c._sdpSessionVersion++);c.transceivers.forEach(function(d,e){var f=d.track,g=d.kind,h=d.mid||j.generateIdentifier();d.mid=h,d.iceGatherer||(d.iceGatherer=c._createIceGatherer(e,c.usingBundle));var i=a.RTCRtpSender.getCapabilities(g);b<15019&&(i.codecs=i.codecs.filter(function(a){return"rtx"!==a.name})),i.codecs.forEach(function(a){"H264"===a.name&&void 0===a.parameters["level-asymmetry-allowed"]&&(a.parameters["level-asymmetry-allowed"]="1"),d.remoteCapabilities&&d.remoteCapabilities.codecs&&d.remoteCapabilities.codecs.forEach(function(b){a.name.toLowerCase()===b.name.toLowerCase()&&a.clockRate===b.clockRate&&(a.preferredPayloadType=b.payloadType)})}),i.headerExtensions.forEach(function(a){var b=d.remoteCapabilities&&d.remoteCapabilities.headerExtensions||[];b.forEach(function(b){a.uri===b.uri&&(a.id=b.id)})});var k=d.sendEncodingParameters||[{ssrc:1001*(2*e+1)}];f&&b>=15019&&"video"===g&&!k[0].rtx&&(k[0].rtx={ssrc:k[0].ssrc+1}),d.wantReceive&&(d.rtpReceiver=new a.RTCRtpReceiver(d.dtlsTransport,g)),d.localCapabilities=i,d.sendEncodingParameters=k}),"max-compat"!==c._config.bundlePolicy&&(h+="a=group:BUNDLE "+c.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n"),h+="a=ice-options:trickle\r\n",c.transceivers.forEach(function(a,b){h+=d(a,a.localCapabilities,"offer",a.stream,c._dtlsRole),h+="a=rtcp-rsize\r\n",!a.iceGatherer||"new"===c.iceGatheringState||0!==b&&c.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1,h+="a="+j.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&(h+="a=end-of-candidates\r\n"))});var k=new a.RTCSessionDescription({type:"offer",sdp:h});return Promise.resolve(k)},m.prototype.createAnswer=function(){var c=this;if(c._isClosed)return Promise.reject(i("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==c.signalingState&&"have-local-pranswer"!==c.signalingState)return Promise.reject(i("InvalidStateError","Can not call createAnswer in signalingState "+c.signalingState));var e=j.writeSessionBoilerplate(c._sdpSessionId,c._sdpSessionVersion++);c.usingBundle&&(e+="a=group:BUNDLE "+c.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var g=j.getMediaSections(c.remoteDescription.sdp).length;c.transceivers.forEach(function(a,h){if(!(h+1>g)){if(a.rejected)return"application"===a.kind?e+="m=application 0 DTLS/SCTP 5000\r\n":"audio"===a.kind?e+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===a.kind&&(e+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(e+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+a.mid+"\r\n");if(a.stream){var i;"audio"===a.kind?i=a.stream.getAudioTracks()[0]:"video"===a.kind&&(i=a.stream.getVideoTracks()[0]),i&&b>=15019&&"video"===a.kind&&!a.sendEncodingParameters[0].rtx&&(a.sendEncodingParameters[0].rtx={ssrc:a.sendEncodingParameters[0].ssrc+1})}var j=f(a.localCapabilities,a.remoteCapabilities),k=j.codecs.filter(function(a){return"rtx"===a.name.toLowerCase()}).length;!k&&a.sendEncodingParameters[0].rtx&&delete a.sendEncodingParameters[0].rtx,e+=d(a,j,"answer",a.stream,c._dtlsRole),a.rtcpParameters&&a.rtcpParameters.reducedSize&&(e+="a=rtcp-rsize\r\n")}});var h=new a.RTCSessionDescription({type:"answer",sdp:e});return Promise.resolve(h)},m.prototype.addIceCandidate=function(a){var b,c=this;return a&&void 0===a.sdpMLineIndex&&!a.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(d,e){if(!c.remoteDescription)return e(i("InvalidStateError","Can not add ICE candidate without a remote description"));if(a&&""!==a.candidate){var f=a.sdpMLineIndex;if(a.sdpMid)for(var g=0;g<c.transceivers.length;g++)if(c.transceivers[g].mid===a.sdpMid){f=g;break}var k=c.transceivers[f];if(!k)return e(i("OperationError","Can not add ICE candidate"));if(k.rejected)return d();var l=Object.keys(a.candidate).length>0?j.parseCandidate(a.candidate):{};if("tcp"===l.protocol&&(0===l.port||9===l.port))return d();if(l.component&&1!==l.component)return d();if((0===f||f>0&&k.iceTransport!==c.transceivers[0].iceTransport)&&!h(k.iceTransport,l))return e(i("OperationError","Can not add ICE candidate"));var m=a.candidate.trim();0===m.indexOf("a=")&&(m=m.substr(2)),b=j.getMediaSections(c.remoteDescription.sdp),b[f]+="a="+(l.type?m:"end-of-candidates")+"\r\n",c.remoteDescription.sdp=j.getDescription(c.remoteDescription.sdp)+b.join("")}else for(var n=0;n<c.transceivers.length&&(c.transceivers[n].rejected||(c.transceivers[n].iceTransport.addRemoteCandidate({}),b=j.getMediaSections(c.remoteDescription.sdp),b[n]+="a=end-of-candidates\r\n",c.remoteDescription.sdp=j.getDescription(c.remoteDescription.sdp)+b.join(""),!c.usingBundle));n++);d()})},m.prototype.getStats=function(){var a=[];this.transceivers.forEach(function(b){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(c){b[c]&&a.push(b[c].getStats())})});var b=function(a){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};return new Promise(function(c){var d=new Map;Promise.all(a).then(function(a){a.forEach(function(a){Object.keys(a).forEach(function(c){a[c].type=b(a[c]),d.set(c,a[c])})}),c(d)})})};var n=["createOffer","createAnswer"];return n.forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"==typeof a[0]||"function"==typeof a[1]?b.apply(this,[arguments[2]]).then(function(b){"function"==typeof a[0]&&a[0].apply(null,[b])},function(b){"function"==typeof a[1]&&a[1].apply(null,[b])}):b.apply(this,arguments)}}),n=["setLocalDescription","setRemoteDescription","addIceCandidate"],n.forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"==typeof a[1]||"function"==typeof a[2]?b.apply(this,arguments).then(function(){"function"==typeof a[1]&&a[1].apply(null)},function(b){"function"==typeof a[2]&&a[2].apply(null,[b])}):b.apply(this,arguments)}}),["getStats"].forEach(function(a){var b=m.prototype[a];m.prototype[a]=function(){var a=arguments;return"function"==typeof a[1]?b.apply(this,arguments).then(function(){"function"==typeof a[1]&&a[1].apply(null)}):b.apply(this,arguments)}}),m}},{sdp:2}],2:[function(a,b,c){"use strict";var d={};d.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)},d.localCName=d.generateIdentifier(),d.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})},d.splitSections=function(a){var b=a.split("\nm=");return b.map(function(a,b){return(b>0?"m="+a:a).trim()+"\r\n"})},d.getDescription=function(a){var b=d.splitSections(a);return b&&b[0]},d.getMediaSections=function(a){var b=d.splitSections(a);return b.shift(),b},d.matchPrefix=function(a,b){return d.splitLines(a).filter(function(a){return 0===a.indexOf(b)})},d.parseCandidate=function(a){var b;b=0===a.indexOf("a=candidate:")?a.substring(12).split(" "):a.substring(10).split(" ");for(var c={foundation:b[0],component:parseInt(b[1],10),protocol:b[2].toLowerCase(),priority:parseInt(b[3],10),ip:b[4],port:parseInt(b[5],10),type:b[7]},d=8;d<b.length;d+=2)switch(b[d]){case"raddr":c.relatedAddress=b[d+1];break;case"rport":c.relatedPort=parseInt(b[d+1],10);break;case"tcptype":c.tcpType=b[d+1];break;case"ufrag":c.ufrag=b[d+1],c.usernameFragment=b[d+1];break;default:c[b[d]]=b[d+1]}return c},d.writeCandidate=function(a){var b=[];b.push(a.foundation),b.push(a.component),b.push(a.protocol.toUpperCase()),b.push(a.priority),b.push(a.ip),b.push(a.port);var c=a.type;return b.push("typ"),b.push(c),"host"!==c&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort)),a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType)),(a.usernameFragment||a.ufrag)&&(b.push("ufrag"),b.push(a.usernameFragment||a.ufrag)),"candidate:"+b.join(" ")},d.parseIceOptions=function(a){return a.substr(14).split(" ")},d.parseRtpMap=function(a){var b=a.substr(9).split(" "),c={payloadType:parseInt(b.shift(),10)};return b=b[0].split("/"),c.name=b[0],c.clockRate=parseInt(b[1],10),c.numChannels=3===b.length?parseInt(b[2],10):1,c},d.writeRtpMap=function(a){var b=a.payloadType;return void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType),"a=rtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==a.numChannels?"/"+a.numChannels:"")+"\r\n"},d.parseExtmap=function(a){var b=a.substr(9).split(" ");return{id:parseInt(b[0],10),direction:b[0].indexOf("/")>0?b[0].split("/")[1]:"sendrecv",uri:b[1]}},d.writeExtmap=function(a){return"a=extmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"},d.parseFmtp=function(a){for(var b,c={},d=a.substr(a.indexOf(" ")+1).split(";"),e=0;e<d.length;e++)b=d[e].trim().split("="),c[b[0].trim()]=b[1];return c},d.writeFmtp=function(a){var b="",c=a.payloadType;if(void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.parameters&&Object.keys(a.parameters).length){var d=[];Object.keys(a.parameters).forEach(function(b){d.push(b+"="+a.parameters[b])}),b+="a=fmtp:"+c+" "+d.join(";")+"\r\n"}return b},d.parseRtcpFb=function(a){var b=a.substr(a.indexOf(" ")+1).split(" ");return{type:b.shift(),parameter:b.join(" ")}},d.writeRtcpFb=function(a){var b="",c=a.payloadType;return void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a=rtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"}),b},d.parseSsrcMedia=function(a){var b=a.indexOf(" "),c={ssrc:parseInt(a.substr(7,b-7),10)},d=a.indexOf(":",b);return d>-1?(c.attribute=a.substr(b+1,d-b-1),c.value=a.substr(d+1)):c.attribute=a.substr(b+1),c},d.getMid=function(a){var b=d.matchPrefix(a,"a=mid:")[0];if(b)return b.substr(6)},d.parseFingerprint=function(a){var b=a.substr(14).split(" ");return{algorithm:b[0].toLowerCase(),value:b[1]}},d.getDtlsParameters=function(a,b){var c=d.matchPrefix(a+b,"a=fingerprint:");return{role:"auto",fingerprints:c.map(d.parseFingerprint)}},d.writeDtlsParameters=function(a,b){
var c="a=setup:"+b+"\r\n";return a.fingerprints.forEach(function(a){c+="a=fingerprint:"+a.algorithm+" "+a.value+"\r\n"}),c},d.getIceParameters=function(a,b){var c=d.splitLines(a);c=c.concat(d.splitLines(b));var e={usernameFragment:c.filter(function(a){return 0===a.indexOf("a=ice-ufrag:")})[0].substr(12),password:c.filter(function(a){return 0===a.indexOf("a=ice-pwd:")})[0].substr(10)};return e},d.writeIceParameters=function(a){return"a=ice-ufrag:"+a.usernameFragment+"\r\na=ice-pwd:"+a.password+"\r\n"},d.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=d.splitLines(a),e=c[0].split(" "),f=3;f<e.length;f++){var g=e[f],h=d.matchPrefix(a,"a=rtpmap:"+g+" ")[0];if(h){var i=d.parseRtpMap(h),j=d.matchPrefix(a,"a=fmtp:"+g+" ");switch(i.parameters=j.length?d.parseFmtp(j[0]):{},i.rtcpFeedback=d.matchPrefix(a,"a=rtcp-fb:"+g+" ").map(d.parseRtcpFb),b.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":b.fecMechanisms.push(i.name.toUpperCase())}}}return d.matchPrefix(a,"a=extmap:").forEach(function(a){b.headerExtensions.push(d.parseExtmap(a))}),b},d.writeRtpDescription=function(a,b){var c="";c+="m="+a+" ",c+=b.codecs.length>0?"9":"0",c+=" UDP/TLS/RTP/SAVPF ",c+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n",c+="c=IN IP4 0.0.0.0\r\n",c+="a=rtcp:9 IN IP4 0.0.0.0\r\n",b.codecs.forEach(function(a){c+=d.writeRtpMap(a),c+=d.writeFmtp(a),c+=d.writeRtcpFb(a)});var e=0;return b.codecs.forEach(function(a){a.maxptime>e&&(e=a.maxptime)}),e>0&&(c+="a=maxptime:"+e+"\r\n"),c+="a=rtcp-mux\r\n",b.headerExtensions.forEach(function(a){c+=d.writeExtmap(a)}),c},d.parseRtpEncodingParameters=function(a){var b,c=[],e=d.parseRtpParameters(a),f=e.fecMechanisms.indexOf("RED")!==-1,g=e.fecMechanisms.indexOf("ULPFEC")!==-1,h=d.matchPrefix(a,"a=ssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),i=h.length>0&&h[0].ssrc,j=d.matchPrefix(a,"a=ssrc-group:FID").map(function(a){var b=a.split(" ");return b.shift(),b.map(function(a){return parseInt(a,10)})});j.length>0&&j[0].length>1&&j[0][0]===i&&(b=j[0][1]),e.codecs.forEach(function(a){if("RTX"===a.name.toUpperCase()&&a.parameters.apt){var d={ssrc:i,codecPayloadType:parseInt(a.parameters.apt,10),rtx:{ssrc:b}};c.push(d),f&&(d=JSON.parse(JSON.stringify(d)),d.fec={ssrc:b,mechanism:g?"red+ulpfec":"red"},c.push(d))}}),0===c.length&&i&&c.push({ssrc:i});var k=d.matchPrefix(a,"b=");return k.length&&(k=0===k[0].indexOf("b=TIAS:")?parseInt(k[0].substr(7),10):0===k[0].indexOf("b=AS:")?1e3*parseInt(k[0].substr(5),10)*.95-16e3:void 0,c.forEach(function(a){a.maxBitrate=k})),c},d.parseRtcpParameters=function(a){var b={},c=d.matchPrefix(a,"a=ssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];c&&(b.cname=c.value,b.ssrc=c.ssrc);var e=d.matchPrefix(a,"a=rtcp-rsize");b.reducedSize=e.length>0,b.compound=0===e.length;var f=d.matchPrefix(a,"a=rtcp-mux");return b.mux=f.length>0,b},d.parseMsid=function(a){var b,c=d.matchPrefix(a,"a=msid:");if(1===c.length)return b=c[0].substr(7).split(" "),{stream:b[0],track:b[1]};var e=d.matchPrefix(a,"a=ssrc:").map(function(a){return d.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});return e.length>0?(b=e[0].value.split(" "),{stream:b[0],track:b[1]}):void 0},d.generateSessionId=function(){return Math.random().toString().substr(2,21)},d.writeSessionBoilerplate=function(a,b){var c,e=void 0!==b?b:2;return c=a?a:d.generateSessionId(),"v=0\r\no=thisisadapterortc "+c+" "+e+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},d.writeMediaSection=function(a,b,c,e){var f=d.writeRtpDescription(a.kind,b);if(f+=d.writeIceParameters(a.iceGatherer.getLocalParameters()),f+=d.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":"active"),f+="a=mid:"+a.mid+"\r\n",f+=a.direction?"a="+a.direction+"\r\n":a.rtpSender&&a.rtpReceiver?"a=sendrecv\r\n":a.rtpSender?"a=sendonly\r\n":a.rtpReceiver?"a=recvonly\r\n":"a=inactive\r\n",a.rtpSender){var g="msid:"+e.id+" "+a.rtpSender.track.id+"\r\n";f+="a="+g,f+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" "+g,a.sendEncodingParameters[0].rtx&&(f+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+g,f+="a=ssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return f+="a=ssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+d.localCName+"\r\n",a.rtpSender&&a.sendEncodingParameters[0].rtx&&(f+="a=ssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+d.localCName+"\r\n"),f},d.getDirection=function(a,b){for(var c=d.splitLines(a),e=0;e<c.length;e++)switch(c[e]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return c[e].substr(2)}return b?d.getDirection(b):"sendrecv"},d.getKind=function(a){var b=d.splitLines(a),c=b[0].split(" ");return c[0].substr(2)},d.isRejected=function(a){return"0"===a.split(" ",2)[1]},d.parseMLine=function(a){var b=d.splitLines(a),c=b[0].substr(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},d.parseOLine=function(a){var b=d.matchPrefix(a,"o=")[0],c=b.substr(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},"object"==typeof b&&(b.exports=d)},{}],3:[function(a,b,c){(function(c){"use strict";var d=a("./adapter_factory.js");b.exports=d({window:c.window})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":4}],4:[function(a,b,c){"use strict";var d=a("./utils");b.exports=function(b,c){var e=b&&b.window,f={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var g in c)hasOwnProperty.call(c,g)&&(f[g]=c[g]);var h=d.log,i=d.detectBrowser(e),j=a("./chrome/chrome_shim")||null,k=a("./edge/edge_shim")||null,l=a("./firefox/firefox_shim")||null,m=a("./safari/safari_shim")||null,n=a("./common_shim")||null,o={browserDetails:i,commonShim:n,extractVersion:d.extractVersion,disableLog:d.disableLog,disableWarnings:d.disableWarnings};switch(i.browser){case"chrome":if(!j||!j.shimPeerConnection||!f.shimChrome)return h("Chrome shim is not included in this adapter release."),o;h("adapter.js shimming chrome."),o.browserShim=j,n.shimCreateObjectURL(e),j.shimGetUserMedia(e),j.shimMediaStream(e),j.shimSourceObject(e),j.shimPeerConnection(e),j.shimOnTrack(e),j.shimAddTrackRemoveTrack(e),j.shimGetSendersWithDtmf(e),n.shimRTCIceCandidate(e),n.shimMaxMessageSize(e),n.shimSendThrowTypeError(e);break;case"firefox":if(!l||!l.shimPeerConnection||!f.shimFirefox)return h("Firefox shim is not included in this adapter release."),o;h("adapter.js shimming firefox."),o.browserShim=l,n.shimCreateObjectURL(e),l.shimGetUserMedia(e),l.shimSourceObject(e),l.shimPeerConnection(e),l.shimOnTrack(e),l.shimRemoveStream(e),n.shimRTCIceCandidate(e),n.shimMaxMessageSize(e),n.shimSendThrowTypeError(e);break;case"edge":if(!k||!k.shimPeerConnection||!f.shimEdge)return h("MS edge shim is not included in this adapter release."),o;h("adapter.js shimming edge."),o.browserShim=k,n.shimCreateObjectURL(e),k.shimGetUserMedia(e),k.shimPeerConnection(e),k.shimReplaceTrack(e),n.shimMaxMessageSize(e),n.shimSendThrowTypeError(e);break;case"safari":if(!m||!f.shimSafari)return h("Safari shim is not included in this adapter release."),o;h("adapter.js shimming safari."),o.browserShim=m,n.shimCreateObjectURL(e),m.shimRTCIceServerUrls(e),m.shimCallbacksAPI(e),m.shimLocalStreamsAPI(e),m.shimRemoteStreamsAPI(e),m.shimTrackEventTransceiver(e),m.shimGetUserMedia(e),m.shimCreateOfferLegacy(e),n.shimRTCIceCandidate(e),n.shimMaxMessageSize(e),n.shimSendThrowTypeError(e);break;default:h("Unsupported browser!")}return o}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":10,"./safari/safari_shim":12,"./utils":13}],5:[function(a,b,c){"use strict";var d=a("../utils.js"),e=d.log;b.exports={shimGetUserMedia:a("./getusermedia"),shimMediaStream:function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream},shimOnTrack:function(a){if("object"!=typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)"RTCRtpTransceiver"in a||d.wrapPeerConnectionEvent(a,"track",function(a){return a.transceiver||(a.transceiver={receiver:a.receiver}),a});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=a)}});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=this;return c._ontrackpoly||(c._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(d){var e;e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track};var f=new Event("track");f.track=d.track,f.receiver=e,f.transceiver={receiver:e},f.streams=[b.stream],c.dispatchEvent(f)}),b.stream.getTracks().forEach(function(d){var e;e=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):{track:d};var f=new Event("track");f.track=d,f.receiver=e,f.transceiver={receiver:e},f.streams=[b.stream],c.dispatchEvent(f)})},c.addEventListener("addstream",c._ontrackpoly)),b.apply(c,arguments)}}},shimGetSendersWithDtmf:function(a){if("object"==typeof a&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){return void 0===this._dtmf&&("audio"===b.kind?this._dtmf=a.createDTMFSender(b):this._dtmf=null),this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var e=this,f=c.apply(e,arguments);return f||(f=b(e,a),e._senders.push(f)),f};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;d.apply(b,arguments);var c=b._senders.indexOf(a);c!==-1&&b._senders.splice(c,1)}}var e=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=this;c._senders=c._senders||[],e.apply(c,[a]),a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var f=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;b._senders=b._senders||[],f.apply(b,[a]),a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"==typeof a&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var g=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=g.apply(a,[]);return b.forEach(function(b){b._pc=a}),b},Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSourceObject:function(a){var b=a&&a.URL;"object"==typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(a){var c=this;return this._srcObject=a,this.src&&b.revokeObjectURL(this.src),a?(this.src=b.createObjectURL(a),a.addEventListener("addtrack",function(){c.src&&b.revokeObjectURL(c.src),c.src=b.createObjectURL(a)}),void a.addEventListener("removetrack",function(){c.src&&b.revokeObjectURL(c.src),c.src=b.createObjectURL(a)})):void(this.src="")}}))},shimAddTrackRemoveTrackWithNative:function(a){a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(b){return a._shimmedLocalStreams[b][0]})};var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,c){if(!c)return b.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var d=b.apply(this,arguments);return this._shimmedLocalStreams[c.id]?this._shimmedLocalStreams[c.id].indexOf(d)===-1&&this._shimmedLocalStreams[c.id].push(d):this._shimmedLocalStreams[c.id]=[c,d],d};var c=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var b=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(function(a){var c=b.getSenders().find(function(b){return b.track===a});if(c)throw new DOMException("Track already exists.","InvalidAccessError")});var d=b.getSenders();c.apply(this,arguments);var e=b.getSenders().filter(function(a){return d.indexOf(a)===-1});this._shimmedLocalStreams[a.id]=[a].concat(e)};var d=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],d.apply(this,arguments)};var e=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(function(c){var d=b._shimmedLocalStreams[c].indexOf(a);d!==-1&&b._shimmedLocalStreams[c].splice(d,1),1===b._shimmedLocalStreams[c].length&&delete b._shimmedLocalStreams[c]}),e.apply(this,arguments)}},shimAddTrackRemoveTrack:function(a){function b(a,b){var c=b.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(b){var d=a._reverseStreams[b],e=a._streams[d.id];c=c.replace(new RegExp(e.id,"g"),d.id)}),new RTCSessionDescription({type:b.type,sdp:c})}function c(a,b){var c=b.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(b){var d=a._reverseStreams[b],e=a._streams[d.id];c=c.replace(new RegExp(d.id,"g"),e.id)}),new RTCSessionDescription({type:b.type,sdp:c})}var e=d.detectBrowser(a);if(a.RTCPeerConnection.prototype.addTrack&&e.version>=65)return this.shimAddTrackRemoveTrackWithNative(a);var f=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=function(){var a=this,b=f.apply(this);return a._reverseStreams=a._reverseStreams||{},b.map(function(b){return a._reverseStreams[b.id]})};var g=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(b){var c=this;if(c._streams=c._streams||{},c._reverseStreams=c._reverseStreams||{},b.getTracks().forEach(function(a){var b=c.getSenders().find(function(b){return b.track===a});if(b)throw new DOMException("Track already exists.","InvalidAccessError")}),!c._reverseStreams[b.id]){var d=new a.MediaStream(b.getTracks());c._streams[b.id]=d,c._reverseStreams[d.id]=b,b=d}g.apply(c,[b])};var h=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;b._streams=b._streams||{},b._reverseStreams=b._reverseStreams||{},h.apply(b,[b._streams[a.id]||a]),delete b._reverseStreams[b._streams[a.id]?b._streams[a.id].id:a.id],delete b._streams[a.id]},a.RTCPeerConnection.prototype.addTrack=function(b,c){var d=this;if("closed"===d.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var e=[].slice.call(arguments,1);if(1!==e.length||!e[0].getTracks().find(function(a){return a===b}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var f=d.getSenders().find(function(a){return a.track===b});if(f)throw new DOMException("Track already exists.","InvalidAccessError");d._streams=d._streams||{},d._reverseStreams=d._reverseStreams||{};var g=d._streams[c.id];if(g)g.addTrack(b),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))});else{var h=new a.MediaStream([b]);d._streams[c.id]=h,d._reverseStreams[h.id]=c,d.addStream(h)}return d.getSenders().find(function(a){return a.track===b})},["createOffer","createAnswer"].forEach(function(c){var d=a.RTCPeerConnection.prototype[c];a.RTCPeerConnection.prototype[c]=function(){var a=this,c=arguments,e=arguments.length&&"function"==typeof arguments[0];return e?d.apply(a,[function(d){var e=b(a,d);c[0].apply(null,[e])},function(a){c[1]&&c[1].apply(null,a)},arguments[2]]):d.apply(a,arguments).then(function(c){return b(a,c)})}});var i=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){var a=this;return arguments.length&&arguments[0].type?(arguments[0]=c(a,arguments[0]),i.apply(a,arguments)):i.apply(a,arguments)};var j=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=this,c=j.get.apply(this);return""===c.type?c:b(a,c)}}),a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===b.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var c=a._pc===b;if(!c)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");b._streams=b._streams||{};var d;Object.keys(b._streams).forEach(function(c){var e=b._streams[c].getTracks().find(function(b){return a.track===b});e&&(d=b._streams[c])}),d&&(1===d.getTracks().length?b.removeStream(b._reverseStreams[d.id]):d.removeTrack(a.track),b.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(a){var b=d.detectBrowser(a);if(!a.RTCPeerConnection&&a.webkitRTCPeerConnection)a.RTCPeerConnection=function(b,c){return e("PeerConnection"),b&&b.iceTransportPolicy&&(b.iceTransports=b.iceTransportPolicy),new a.webkitRTCPeerConnection(b,c)},a.RTCPeerConnection.prototype=a.webkitRTCPeerConnection.prototype,a.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return a.webkitRTCPeerConnection.generateCertificate}});else{var c=a.RTCPeerConnection;a.RTCPeerConnection=function(a,b){if(a&&a.iceServers){for(var e=[],f=0;f<a.iceServers.length;f++){var g=a.iceServers[f];!g.hasOwnProperty("urls")&&g.hasOwnProperty("url")?(d.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),g.urls=g.url,e.push(g)):e.push(a.iceServers[f])}a.iceServers=e}return new c(a,b)},a.RTCPeerConnection.prototype=c.prototype,Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return c.generateCertificate}})}var f=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,b,c){var d=this,e=arguments;if(arguments.length>0&&"function"==typeof a)return f.apply(this,arguments);if(0===f.length&&(0===arguments.length||"function"!=typeof arguments[0]))return f.apply(this,[]);var g=function(a){var b={},c=a.result();return c.forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=a.stat(b)}),b[c.id]=c}),b},h=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};if(arguments.length>=2){var i=function(a){e[1](h(g(a)))};return f.apply(this,[i,arguments[0]])}return new Promise(function(a,b){f.apply(d,[function(b){a(h(g(b)))},b])}).then(b,c)},b.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){var a=arguments,b=this,d=new Promise(function(d,e){c.apply(b,[a[0],d,e])});return a.length<2?d:d.then(function(){a[1].apply(null,[])},function(b){a.length>=3&&a[2].apply(null,[b])})}}),b.version<52&&["createOffer","createAnswer"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){var a=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var b=1===arguments.length?arguments[0]:void 0;return new Promise(function(d,e){c.apply(a,[d,e,b])})}return c.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){return arguments[0]=new("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}});var g=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?g.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}}},{"../utils.js":13,"./getusermedia":6}],6:[function(a,b,c){"use strict";var d=a("../utils.js"),e=d.log;b.exports=function(a){var b=d.detectBrowser(a),c=a&&a.navigator,f=function(a){if("object"!=typeof a||a.mandatory||a.optional)return a;var b={};return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d="object"==typeof a[c]?a[c]:{ideal:a[c]};void 0!==d.exact&&"number"==typeof d.exact&&(d.min=d.max=d.exact);var e=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){b.optional=b.optional||[];var f={};"number"==typeof d.ideal?(f[e("min",c)]=d.ideal,b.optional.push(f),f={},f[e("max",c)]=d.ideal,b.optional.push(f)):(f[e("",c)]=d.ideal,b.optional.push(f))}void 0!==d.exact&&"number"!=typeof d.exact?(b.mandatory=b.mandatory||{},b.mandatory[e("",c)]=d.exact):["min","max"].forEach(function(a){void 0!==d[a]&&(b.mandatory=b.mandatory||{},b.mandatory[e(a,c)]=d[a])})}}),a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced)),b},g=function(a,d){if(b.version>=61)return d(a);if(a=JSON.parse(JSON.stringify(a)),a&&"object"==typeof a.audio){var g=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};a=JSON.parse(JSON.stringify(a)),g(a.audio,"autoGainControl","googAutoGainControl"),g(a.audio,"noiseSuppression","googNoiseSuppression"),a.audio=f(a.audio)}if(a&&"object"==typeof a.video){var h=a.video.facingMode;h=h&&("object"==typeof h?h:{ideal:h});var i=b.version<66;if(h&&("user"===h.exact||"environment"===h.exact||"user"===h.ideal||"environment"===h.ideal)&&(!c.mediaDevices.getSupportedConstraints||!c.mediaDevices.getSupportedConstraints().facingMode||i)){delete a.video.facingMode;var j;if("environment"===h.exact||"environment"===h.ideal?j=["back","rear"]:"user"!==h.exact&&"user"!==h.ideal||(j=["front"]),j)return c.mediaDevices.enumerateDevices().then(function(b){b=b.filter(function(a){return"videoinput"===a.kind});var c=b.find(function(a){return j.some(function(b){return a.label.toLowerCase().indexOf(b)!==-1})});return!c&&b.length&&j.indexOf("back")!==-1&&(c=b[b.length-1]),c&&(a.video.deviceId=h.exact?{exact:c.deviceId}:{ideal:c.deviceId}),a.video=f(a.video),e("chrome: "+JSON.stringify(a)),d(a)})}a.video=f(a.video)}return e("chrome: "+JSON.stringify(a)),d(a)},h=function(a){return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[a.name]||a.name,message:a.message,constraint:a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}},i=function(a,b,d){g(a,function(a){c.webkitGetUserMedia(a,b,function(a){d&&d(h(a))})})};c.getUserMedia=i;var j=function(a){return new Promise(function(b,d){c.getUserMedia(a,b,d)})};if(c.mediaDevices||(c.mediaDevices={getUserMedia:j,enumerateDevices:function(){return new Promise(function(b){var c={audio:"audioinput",video:"videoinput"};return a.MediaStreamTrack.getSources(function(a){b(a.map(function(a){return{label:a.label,kind:c[a.kind],deviceId:a.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),c.mediaDevices.getUserMedia){var k=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(a){return g(a,function(a){return k(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");return b},function(a){return Promise.reject(h(a))})})}}else c.mediaDevices.getUserMedia=function(a){return j(a)};"undefined"==typeof c.mediaDevices.addEventListener&&(c.mediaDevices.addEventListener=function(){e("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof c.mediaDevices.removeEventListener&&(c.mediaDevices.removeEventListener=function(){e("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":13}],7:[function(a,b,c){"use strict";var d=a("sdp"),e=a("./utils");b.exports={shimRTCIceCandidate:function(a){if(a.RTCIceCandidate&&!(a.RTCIceCandidate&&"foundation"in a.RTCIceCandidate.prototype)){var b=a.RTCIceCandidate;a.RTCIceCandidate=function(a){if("object"==typeof a&&a.candidate&&0===a.candidate.indexOf("a=")&&(a=JSON.parse(JSON.stringify(a)),a.candidate=a.candidate.substr(2)),a.candidate&&a.candidate.length){var c=new b(a),e=d.parseCandidate(a.candidate),f=Object.assign(c,e);return f.toJSON=function(){return{candidate:f.candidate,sdpMid:f.sdpMid,sdpMLineIndex:f.sdpMLineIndex,usernameFragment:f.usernameFragment}},f}return new b(a)},a.RTCIceCandidate.prototype=b.prototype,e.wrapPeerConnectionEvent(a,"icecandidate",function(b){return b.candidate&&Object.defineProperty(b,"candidate",{value:new a.RTCIceCandidate(b.candidate),writable:"false"}),b})}},shimCreateObjectURL:function(a){var b=a&&a.URL;if("object"==typeof a&&a.HTMLMediaElement&&"srcObject"in a.HTMLMediaElement.prototype&&b.createObjectURL&&b.revokeObjectURL){var c=b.createObjectURL.bind(b),d=b.revokeObjectURL.bind(b),f=new Map,g=0;b.createObjectURL=function(a){if("getTracks"in a){var b="polyblob:"+ ++g;return f.set(b,a),e.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),b}return c(a)},b.revokeObjectURL=function(a){d(a),f["delete"](a)};var h=Object.getOwnPropertyDescriptor(a.HTMLMediaElement.prototype,"src");Object.defineProperty(a.HTMLMediaElement.prototype,"src",{get:function(){return h.get.apply(this)},set:function(a){return this.srcObject=f.get(a)||null,h.set.apply(this,[a])}});var i=a.HTMLMediaElement.prototype.setAttribute;a.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=f.get(arguments[1])||null),i.apply(this,arguments)}}},shimMaxMessageSize:function(a){if(!a.RTCSctpTransport&&a.RTCPeerConnection){var b=e.detectBrowser(a);"sctp"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"sctp",{get:function(){return"undefined"==typeof this._sctp?null:this._sctp}});var c=function(a){var b=d.splitSections(a.sdp);return b.shift(),b.some(function(a){var b=d.parseMLine(a);return b&&"application"===b.kind&&b.protocol.indexOf("SCTP")!==-1})},f=function(a){var b=a.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===b||b.length<2)return-1;var c=parseInt(b[1],10);return c!==c?-1:c},g=function(a){var c=65536;return"firefox"===b.browser&&(c=b.version<57?a===-1?16384:2147483637:57===b.version?65535:65536),c},h=function(a,c){var e=65536;"firefox"===b.browser&&57===b.version&&(e=65535);var f=d.matchPrefix(a.sdp,"a=max-message-size:");return f.length>0?e=parseInt(f[0].substr(19),10):"firefox"===b.browser&&c!==-1&&(e=2147483637),e},i=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;if(a._sctp=null,c(arguments[0])){var b,d=f(arguments[0]),e=g(d),j=h(arguments[0],d);b=0===e&&0===j?Number.POSITIVE_INFINITY:0===e||0===j?Math.max(e,j):Math.min(e,j);var k={};Object.defineProperty(k,"maxMessageSize",{get:function(){return b}}),a._sctp=k}return i.apply(a,arguments)}}},shimSendThrowTypeError:function(a){if(a.RTCPeerConnection&&"createDataChannel"in a.RTCPeerConnection.prototype){var b=a.RTCPeerConnection.prototype.createDataChannel;a.RTCPeerConnection.prototype.createDataChannel=function(){var a=this,c=b.apply(a,arguments),d=c.send;return c.send=function(){var b=this,c=arguments[0],e=c.length||c.size||c.byteLength;if(e>a.sctp.maxMessageSize)throw new DOMException("Message too large (can send a maximum of "+a.sctp.maxMessageSize+" bytes)","TypeError");return d.apply(b,arguments)},c}}}}},{"./utils":13,sdp:2}],8:[function(a,b,c){"use strict";var d=a("../utils"),e=a("rtcpeerconnection-shim");b.exports={shimGetUserMedia:a("./getusermedia"),shimPeerConnection:function(a){var b=d.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=function(a){return a}),b.version<15025)){var c=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){c.set.call(this,a);var b=new Event("enabled");b.enabled=a,this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),a.RTCDtmfSender&&!a.RTCDTMFSender&&(a.RTCDTMFSender=a.RTCDtmfSender),a.RTCPeerConnection=e(a,b.version)},shimReplaceTrack:function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)}}},{"../utils":13,"./getusermedia":9,"rtcpeerconnection-shim":1}],9:[function(a,b,c){"use strict";b.exports=function(a){var b=a&&a.navigator,c=function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}},d=b.mediaDevices.getUserMedia.bind(b.mediaDevices);b.mediaDevices.getUserMedia=function(a){return d(a)["catch"](function(a){return Promise.reject(c(a))})}}},{}],10:[function(a,b,c){"use strict";var d=a("../utils");b.exports={shimGetUserMedia:a("./getusermedia"),shimOnTrack:function(a){"object"!=typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=a),this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(b){var c=new Event("track");c.track=b,c.receiver={track:b},c.transceiver={receiver:c.receiver},c.streams=[a.stream],this.dispatchEvent(c)}.bind(this))}.bind(this))}}),"object"==typeof a&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(a){"object"==typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(a){this.mozSrcObject=a}}))},shimPeerConnection:function(a){var b=d.detectBrowser(a);if("object"==typeof a&&(a.RTCPeerConnection||a.mozRTCPeerConnection)){
a.RTCPeerConnection||(a.RTCPeerConnection=function(c,d){if(b.version<38&&c&&c.iceServers){for(var e=[],f=0;f<c.iceServers.length;f++){var g=c.iceServers[f];if(g.hasOwnProperty("urls"))for(var h=0;h<g.urls.length;h++){var i={url:g.urls[h]};0===g.urls[h].indexOf("turn")&&(i.username=g.username,i.credential=g.credential),e.push(i)}else e.push(c.iceServers[f])}c.iceServers=e}return new a.mozRTCPeerConnection(c,d)},a.RTCPeerConnection.prototype=a.mozRTCPeerConnection.prototype,a.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return a.mozRTCPeerConnection.generateCertificate}}),a.RTCSessionDescription=a.mozRTCSessionDescription,a.RTCIceCandidate=a.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){return arguments[0]=new("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}});var c=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var e=function(a){var b=new Map;return Object.keys(a).forEach(function(c){b.set(c,a[c]),b[c]=a[c]}),b},f={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},g=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,c,d){return g.apply(this,[a||null]).then(function(a){if(b.version<48&&(a=e(a)),b.version<53&&!c)try{a.forEach(function(a){a.type=f[a.type]||a.type})}catch(d){if("TypeError"!==d.name)throw d;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:f[b.type]||b.type}))})}return a}).then(c,d)}}},shimRemoveStream:function(a){!a.RTCPeerConnection||"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;d.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(c){c.track&&a.getTracks().indexOf(c.track)!==-1&&b.removeTrack(c)})})}}},{"../utils":13,"./getusermedia":11}],11:[function(a,b,c){"use strict";var d=a("../utils"),e=d.log;b.exports=function(a){var b=d.detectBrowser(a),c=a&&a.navigator,f=a&&a.MediaStreamTrack,g=function(a){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[a.name]||a.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[a.message]||a.message,constraint:a.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},h=function(a,d,f){var h=function(a){if("object"!=typeof a||a.require)return a;var b=[];return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d=a[c]="object"==typeof a[c]?a[c]:{ideal:a[c]};if(void 0===d.min&&void 0===d.max&&void 0===d.exact||b.push(c),void 0!==d.exact&&("number"==typeof d.exact?d.min=d.max=d.exact:a[c]=d.exact,delete d.exact),void 0!==d.ideal){a.advanced=a.advanced||[];var e={};"number"==typeof d.ideal?e[c]={min:d.ideal,max:d.ideal}:e[c]=d.ideal,a.advanced.push(e),delete d.ideal,Object.keys(d).length||delete a[c]}}}),b.length&&(a.require=b),a};return a=JSON.parse(JSON.stringify(a)),b.version<38&&(e("spec: "+JSON.stringify(a)),a.audio&&(a.audio=h(a.audio)),a.video&&(a.video=h(a.video)),e("ff37: "+JSON.stringify(a))),c.mozGetUserMedia(a,d,function(a){f(g(a))})},i=function(a){return new Promise(function(b,c){h(a,b,c)})};if(c.mediaDevices||(c.mediaDevices={getUserMedia:i,addEventListener:function(){},removeEventListener:function(){}}),c.mediaDevices.enumerateDevices=c.mediaDevices.enumerateDevices||function(){return new Promise(function(a){var b=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];a(b)})},b.version<41){var j=c.mediaDevices.enumerateDevices.bind(c.mediaDevices);c.mediaDevices.enumerateDevices=function(){return j().then(void 0,function(a){if("NotFoundError"===a.name)return[];throw a})}}if(b.version<49){var k=c.mediaDevices.getUserMedia.bind(c.mediaDevices);c.mediaDevices.getUserMedia=function(a){return k(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("The object can not be found here.","NotFoundError");return b},function(a){return Promise.reject(g(a))})}}if(!(b.version>55&&"autoGainControl"in c.mediaDevices.getSupportedConstraints())){var l=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},m=c.mediaDevices.getUserMedia.bind(c.mediaDevices);if(c.mediaDevices.getUserMedia=function(a){return"object"==typeof a&&"object"==typeof a.audio&&(a=JSON.parse(JSON.stringify(a)),l(a.audio,"autoGainControl","mozAutoGainControl"),l(a.audio,"noiseSuppression","mozNoiseSuppression")),m(a)},f&&f.prototype.getSettings){var n=f.prototype.getSettings;f.prototype.getSettings=function(){var a=n.apply(this,arguments);return l(a,"mozAutoGainControl","autoGainControl"),l(a,"mozNoiseSuppression","noiseSuppression"),a}}if(f&&f.prototype.applyConstraints){var o=f.prototype.applyConstraints;f.prototype.applyConstraints=function(a){return"audio"===this.kind&&"object"==typeof a&&(a=JSON.parse(JSON.stringify(a)),l(a,"autoGainControl","mozAutoGainControl"),l(a,"noiseSuppression","mozNoiseSuppression")),o.apply(this,[a])}}}c.getUserMedia=function(a,e,f){return b.version<44?h(a,e,f):(d.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),void c.mediaDevices.getUserMedia(a).then(e,f))}}},{"../utils":13}],12:[function(a,b,c){"use strict";var d=a("../utils");b.exports={shimLocalStreamsAPI:function(a){if("object"==typeof a&&a.RTCPeerConnection){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getStreamById=function(a){var b=null;return this._localStreams&&this._localStreams.forEach(function(c){c.id===a&&(b=c)}),this._remoteStreams&&this._remoteStreams.forEach(function(c){c.id===a&&(b=c)}),b}),!("addStream"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]),this._localStreams.indexOf(a)===-1&&this._localStreams.push(a);var c=this;a.getTracks().forEach(function(d){b.call(c,d,a)})},a.RTCPeerConnection.prototype.addTrack=function(a,c){return c&&(this._localStreams?this._localStreams.indexOf(c)===-1&&this._localStreams.push(c):this._localStreams=[c]),b.call(this,a,c)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);var b=this._localStreams.indexOf(a);if(b!==-1){this._localStreams.splice(b,1);var c=this,d=a.getTracks();this.getSenders().forEach(function(a){d.indexOf(a.track)!==-1&&c.removeTrack(a)})}})}},shimRemoteStreamsAPI:function(a){"object"==typeof a&&a.RTCPeerConnection&&("getRemoteStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){var b=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=a),this.addEventListener("track",this._onaddstreampoly=function(a){a.streams.forEach(function(a){if(b._remoteStreams||(b._remoteStreams=[]),!(b._remoteStreams.indexOf(a)>=0)){b._remoteStreams.push(a);var c=new Event("addstream");c.stream=a,b.dispatchEvent(c)}})})}}))},shimCallbacksAPI:function(a){if("object"==typeof a&&a.RTCPeerConnection){var b=a.RTCPeerConnection.prototype,c=b.createOffer,d=b.createAnswer,e=b.setLocalDescription,f=b.setRemoteDescription,g=b.addIceCandidate;b.createOffer=function(a,b){var d=arguments.length>=2?arguments[2]:arguments[0],e=c.apply(this,[d]);return b?(e.then(a,b),Promise.resolve()):e},b.createAnswer=function(a,b){var c=arguments.length>=2?arguments[2]:arguments[0],e=d.apply(this,[c]);return b?(e.then(a,b),Promise.resolve()):e};var h=function(a,b,c){var d=e.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d};b.setLocalDescription=h,h=function(a,b,c){var d=f.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d},b.setRemoteDescription=h,h=function(a,b,c){var d=g.apply(this,[a]);return c?(d.then(b,c),Promise.resolve()):d},b.addIceCandidate=h}},shimGetUserMedia:function(a){var b=a&&a.navigator;b.getUserMedia||(b.webkitGetUserMedia?b.getUserMedia=b.webkitGetUserMedia.bind(b):b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,c,d){b.mediaDevices.getUserMedia(a).then(c,d)}.bind(b)))},shimRTCIceServerUrls:function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,c){if(a&&a.iceServers){for(var e=[],f=0;f<a.iceServers.length;f++){var g=a.iceServers[f];!g.hasOwnProperty("urls")&&g.hasOwnProperty("url")?(d.deprecated("RTCIceServer.url","RTCIceServer.urls"),g=JSON.parse(JSON.stringify(g)),g.urls=g.url,delete g.url,e.push(g)):e.push(a.iceServers[f])}a.iceServers=e}return new b(a,c)},a.RTCPeerConnection.prototype=b.prototype,"generateCertificate"in a.RTCPeerConnection&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})},shimTrackEventTransceiver:function(a){"object"==typeof a&&a.RTCPeerConnection&&"receiver"in a.RTCTrackEvent.prototype&&!a.RTCTransceiver&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){var c=this;if(a){"undefined"!=typeof a.offerToReceiveAudio&&(a.offerToReceiveAudio=!!a.offerToReceiveAudio);var d=c.getTransceivers().find(function(a){return a.sender.track&&"audio"===a.sender.track.kind});a.offerToReceiveAudio===!1&&d?"sendrecv"===d.direction?d.setDirection?d.setDirection("sendonly"):d.direction="sendonly":"recvonly"===d.direction&&(d.setDirection?d.setDirection("inactive"):d.direction="inactive"):a.offerToReceiveAudio!==!0||d||c.addTransceiver("audio"),"undefined"!=typeof a.offerToReceiveAudio&&(a.offerToReceiveVideo=!!a.offerToReceiveVideo);var e=c.getTransceivers().find(function(a){return a.sender.track&&"video"===a.sender.track.kind});a.offerToReceiveVideo===!1&&e?"sendrecv"===e.direction?e.setDirection("sendonly"):"recvonly"===e.direction&&e.setDirection("inactive"):a.offerToReceiveVideo!==!0||e||c.addTransceiver("video")}return b.apply(c,arguments)}}}},{"../utils":13}],13:[function(a,b,c){"use strict";function d(a,b,c){var d=a.match(b);return d&&d.length>=c&&parseInt(d[c],10)}function e(a,b,c){if(a.RTCPeerConnection){var d=a.RTCPeerConnection.prototype,e=d.addEventListener;d.addEventListener=function(a,d){if(a!==b)return e.apply(this,arguments);var f=function(a){d(c(a))};return this._eventMap=this._eventMap||{},this._eventMap[d]=f,e.apply(this,[a,f])};var f=d.removeEventListener;d.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return f.apply(this,arguments);var d=this._eventMap[c];return delete this._eventMap[c],f.apply(this,[a,d])},Object.defineProperty(d,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]),a&&this.addEventListener(b,this["_on"+b]=a)}})}}var f=!0,g=!0;b.exports={extractVersion:d,wrapPeerConnectionEvent:e,disableLog:function(a){return"boolean"!=typeof a?new Error("Argument type: "+typeof a+". Please use a boolean."):(f=a,a?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(a){return"boolean"!=typeof a?new Error("Argument type: "+typeof a+". Please use a boolean."):(g=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(f)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(a,b){g&&console.warn(a+" is deprecated, please use "+b+" instead.")},detectBrowser:function(a){var b=a&&a.navigator,c={};if(c.browser=null,c.version=null,"undefined"==typeof a||!a.navigator)return c.browser="Not a browser.",c;if(b.mozGetUserMedia)c.browser="firefox",c.version=d(b.userAgent,/Firefox\/(\d+)\./,1);else if(b.webkitGetUserMedia)c.browser="chrome",c.version=d(b.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(b.mediaDevices&&b.userAgent.match(/Edge\/(\d+).(\d+)$/))c.browser="edge",c.version=d(b.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!a.RTCPeerConnection||!b.userAgent.match(/AppleWebKit\/(\d+)\./))return c.browser="Not a supported browser.",c;c.browser="safari",c.version=d(b.userAgent,/AppleWebKit\/(\d+)\./,1)}return c}}},{}]},{},[3])(3)});
define('core/tag', ["jquery","core/ajax","core/templates","core/notification","core/str","core/yui","core/pending"],function(a,b,c,d,e,f,g){return{initTagindexPage:function(){a("body").delegate(".tagarea[data-ta] a[data-quickload=1]","click",function(e){var f=new g("core/tag:initTagindexPage");e.preventDefault();var h=a(this),i=h[0].search.replace(/^\?/,""),j=h.closest(".tagarea[data-ta]"),k=i.split("&").reduce(function(a,b){var c=b.split("=");return a[c[0]]=decodeURIComponent(c[1]),a},{});b.call([{methodname:"core_tag_get_tagindex",args:{tagindex:k}}])[0].then(function(a){return c.render("core_tag/index",a)}).then(function(a,b){c.replaceNode(j,a,b)}).always(f.resolve)["catch"](d.exception)})},initManagePage:function(){a("body").on("updated","[data-inplaceeditable]",function(b){var c=new g("core/tag:initManagePage");if(e.get_strings([{key:"selecttag",component:"core_tag"},{key:"now",component:"core"}]).then(function(c){a('label[for="tagselect'+b.ajaxreturn.itemid+'"]').html(c[0]),a(b.target).closest("tr").find("td.col-timemodified").html(c[1])}).always(c.resolve)["catch"](d.exception),"tagflag"===b.ajaxreturn.itemtype){var f=a(b.target).closest("tr");"0"===b.ajaxreturn.value?f.removeClass("flagged-tag"):f.addClass("flagged-tag")}}),a(".tag-management-table").delegate("a.tagdelete","click",function(b){var c=new g("core/tag:tagdelete");b.preventDefault();var f=a(this).attr("href");e.get_strings([{key:"delete",component:"core"},{key:"confirmdeletetag",component:"tag"},{key:"yes",component:"core"},{key:"no",component:"core"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=f})}).always(c.resolve)["catch"](d.exception)}),a("#tag-management-delete").click(function(b){var c=a(this).closest("form").get(0),f=a(c).find("input[type=checkbox]:checked").length;if(f){var h=new g("core/tag:tag-management-delete"),i=a("<input type='hidden'/>").attr("name",this.name);b.preventDefault(),e.get_strings([{key:"delete",component:"core"},{key:"confirmdeletetags",component:"tag"},{key:"yes",component:"core"},{key:"no",component:"core"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){i.appendTo(c),c.submit()})}).always(h.resolve)["catch"](d.exception)}}),a("#tag-management-combine").click(function(b){var c=new g("core/tag:tag-management-combine");b.preventDefault();var h=a(this).closest("form").get(0),i=a(h).find("input[type=checkbox]:checked");if(i.length<=1)return void e.get_strings([{key:"combineselected",component:"tag"},{key:"selectmultipletags",component:"tag"},{key:"ok"}]).then(function(a){return d.alert(a[0],a[1],a[2])}).always(c.resolve)["catch"](d.exception);var j=a("<input type='hidden'/>").attr("name",this.name);e.get_strings([{key:"combineselected",component:"tag"},{key:"selectmaintag",component:"tag"},{key:"continue"},{key:"cancel"}]).then(function(b){var c=a('<div><form id="combinetags_form"><div class="description"></div><div class="form-group options"></div><div class="form-group">   <input type="submit" class="btn btn-primary" id="combinetags_submit"/>   <input type="button" class="btn btn-secondary" id="combinetags_cancel"/></div></form></div>');c.find(".description").html(b[1]),c.find("#combinetags_submit").attr("value",b[2]),c.find("#combinetags_cancel").attr("value",b[3]);var d=c.find(".options");i.each(function(){var b=a(this).val(),c=a(".inplaceeditable[data-itemtype=tagname][data-itemid="+b+"]").attr("data-value"),e='<div class="form-check">   <input type="radio" class="form-check-input" name="maintag"        id="combinetags_maintag_'+b+'" value="'+b+'"/>   <label class="form-check-label" for="combinetags_maintag_'+b+'">'+c+"</label></div>";d.append(a(e))}),f.use("moodle-core-notification-dialogue",function(){var d=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:c.html()});d.show(),a("#combinetags_form input[type=radio]").first().focus().prop("checked",!0),a("#combinetags_form #combinetags_cancel").on("click",function(){d.destroy()}),a("#combinetags_form").on("submit",function(){j.appendTo(h);var b=a("input[name=maintag]:checked","#combinetags_form").val();return a("<input type='hidden'/>").attr("name","maintag").attr("value",b).appendTo(h),h.submit(),!1})})}).always(c.resolve)["catch"](d.exception)}),a("body").on("updatefailed","[data-inplaceeditable][data-itemtype=tagname]",function(b){var c=b.exception,f=b.newvalue,h=a(b.target).attr("data-itemid");if("namesalreadybeeingused"===c.errorcode){var i=new g("core/tag:tag-management-combine-exists");b.preventDefault(),e.get_strings([{key:"confirm",component:"core"},{key:"nameuseddocombine",component:"tag"},{key:"yes",component:"core"},{key:"cancel",component:"core"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=window.location.href+"&newname="+encodeURIComponent(f)+"&tagid="+encodeURIComponent(h)+"&action=renamecombine&sesskey="+M.cfg.sesskey})}).always(i.resolve)["catch"](d.exception)}}),a("body").on("click","a[data-action=addstandardtag]",function(b){var c=new g("core/tag:addstandardtag");b.preventDefault(),e.get_strings([{key:"addotags",component:"tag"},{key:"inputstandardtags",component:"tag"},{key:"continue",component:"core"},{key:"cancel",component:"core"}]).then(function(b){var d=a('<div><form id="addtags_form" method="POST"><input type="hidden" name="action" value="addstandardtag"/><input type="hidden" name="sesskey" value="'+M.cfg.sesskey+'"/><div class="form-group">   <label for="id_tagslist">'+b[1]+'</label>   <input type="text" id="id_tagslist" class="form-control" name="tagslist"/></div><div class="form-group">   <input type="submit" class="btn btn-primary" id="addtags_submit"/>   <input type="button" class="btn btn-secondary" id="addtags_cancel"/></div></form></div>');d.find("#addtags_form").attr("action",window.location.href),d.find("#addtags_submit").attr("value",b[2]),d.find("#addtags_cancel").attr("value",b[3]),f.use("moodle-core-notification-dialogue",function(){var e=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:d.html()});e.show(),a("#addtags_form input[type=text]").focus(),a("#addtags_form #addtags_cancel").on("click",function(){e.destroy()}),c.resolve()})})["catch"](d.exception)})},initManageCollectionsPage:function(){a("body").on("updated","[data-inplaceeditable]",function(b){var c,d,e,f=new g("core/tag:initManageCollectionsPage-updated"),h=b.ajaxreturn;"core_tag"===h.component&&"tagareaenable"===h.itemtype&&(c=a(this).attr("data-itemid"),a(".tag-collections-table ul[data-collectionid] li[data-areaid="+c+"]").hide(),e=h.value,"1"===e?(a(this).closest("tr").removeClass("dimmed_text"),d=a(this).closest("tr").find('[data-itemtype="tagareacollection"]').attr("data-value"),a(".tag-collections-table ul[data-collectionid="+d+"] li[data-areaid="+c+"]").show()):a(this).closest("tr").addClass("dimmed_text")),"core_tag"===h.component&&"tagareacollection"===h.itemtype&&(c=a(this).attr("data-itemid"),a(".tag-collections-table ul[data-collectionid] li[data-areaid="+c+"]").hide(),d=a(this).attr("data-value"),e=a(this).closest("tr").find('[data-itemtype="tagareaenable"]').attr("data-value"),"1"===e&&a(".tag-collections-table ul[data-collectionid="+d+"] li[data-areaid="+c+"]").show()),f.resolve()}),a("body").on("click",".addtagcoll > a",function(b){var c=new g("core/tag:initManageCollectionsPage-addtagcoll");b.preventDefault();var h=a(this).attr("data-url")+"&sesskey="+M.cfg.sesskey;e.get_strings([{key:"addtagcoll",component:"tag"},{key:"name"},{key:"searchable",component:"tag"},{key:"create"},{key:"cancel"}]).then(function(b){var d=a('<div><form id="addtagcoll_form"><div class="form-group">   <label for="addtagcoll_name"></label>    <input id="addtagcoll_name" type="text" class="form-control"/>  </div><div class="form-group form-check">   <input id="addtagcoll_searchable" type="checkbox" value="1" checked class="form-check-input"/>   <label for="addtagcoll_searchable" class="form-check-label"></label></div><div class="form-group">   <input type="submit" class="btn btn-primary" id="addtagcoll_submit"/>   <input type="button" class="btn btn-secondary" id="addtagcoll_cancel"/></div></form></div>');d.find('label[for="addtagcoll_name"]').html(b[1]),d.find('label[for="addtagcoll_searchable"]').html(b[2]),d.find("#addtagcoll_submit").attr("value",b[3]),d.find("#addtagcoll_cancel").attr("value",b[4]),f.use("moodle-core-notification-dialogue",function(){var e=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,headerContent:b[0],bodyContent:d.html()});e.show(),a("#addtagcoll_form #addtagcoll_name").focus(),a("#addtagcoll_form #addtagcoll_cancel").on("click",function(){e.destroy()}),a("#addtagcoll_form").on("submit",function(){var b=a("#addtagcoll_form #addtagcoll_name").val(),c=a("#addtagcoll_form #addtagcoll_searchable").prop("checked")?1:0;return String(b).length>0&&(window.location.href=h+"&name="+encodeURIComponent(b)+"&searchable="+c),!1}),c.resolve()})})["catch"](d.exception)}),a("body").on("click",".tag-collections-table .action_delete",function(b){var c=new g("core/tag:initManageCollectionsPage-action_delete");b.preventDefault();var f=a(this).attr("data-url")+"&sesskey="+M.cfg.sesskey;e.get_strings([{key:"delete"},{key:"suredeletecoll",component:"tag",param:a(this).attr("data-collname")},{key:"yes"},{key:"no"}]).then(function(a){return d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=f})}).always(c.resolve)["catch"](d.exception)})}}});
define('core/modal_backdrop', ["jquery","core/templates","core/notification"],function(a,b,c){var d={ROOT:'[data-region="modal-backdrop"]'},e=function(b){this.root=a(b),this.isAttached=!1,this.root.is(d.ROOT)||c.exception({message:"Element is not a modal backdrop"})};return e.prototype.getRoot=function(){return this.root},e.prototype.attachToDOM=function(){this.isAttached||(a("body").append(this.root),this.isAttached=!0)},e.prototype.setZIndex=function(a){this.root.css("z-index",a)},e.prototype.isVisible=function(){return this.root.hasClass("show")},e.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")},e.prototype.show=function(){this.isVisible()||(this.isAttached||this.attachToDOM(),this.root.removeClass("hide").addClass("show"))},e.prototype.hide=function(){this.isVisible()&&(this.hasTransitions()?this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this)):this.getRoot().removeClass("show").addClass("hide"))},e.prototype.destroy=function(){this.root.remove()},e});
define('core/log', ["core/loglevel"],function(a){var b=a.methodFactory;return a.methodFactory=function(a,c){var d=b(a,c);return function(a,b){d(b?b+": "+a:a)}},a.setConfig=function(b){"undefined"!=typeof b.level&&a.setLevel(b.level)},a});
define('core/form-cohort-selector', ["core/ajax","jquery"],function(a,b){return{processResults:function(a,c){var d=[],e=0,f=String(b(a).data("exclude")).split(",");for(e=0;e<c.cohorts.length;e++)f.indexOf(String(c.cohorts[e].id))===-1&&d.push({value:c.cohorts[e].id,label:c.cohorts[e].name});return d},transport:function(c,d,e,f){var g=b(c),h=null;"undefined"==typeof d&&(d="");var i=g.data("contextid"),j={query:d,includes:"parents",limitfrom:0,limitnum:100,context:{contextid:i}},k=[{methodname:"core_cohort_search_cohorts",args:j}];h=a.call(k),b.when.apply(b.when,h).done(function(a){e(a)}).fail(f)}}});
define('core/form-course-selector', ["core/ajax","jquery"],function(a,b){return{processResults:function(a,c){var d=[],e=0,f=String(b(a).data("exclude")).split(",");for(e=0;e<c.courses.length;e++)f.indexOf(String(c.courses[e].id))===-1&&d.push({value:c.courses[e].id,label:c.courses[e].displayname});return d},transport:function(c,d,e,f){var g=b(c),h=g.data("requiredcapabilities");h=""!==h.trim()?h.split(","):[];var i=g.data("limittoenrolled"),j=g.data("includefrontpage"),k=null;"undefined"==typeof d&&(d="");var l={criterianame:"search",criteriavalue:d,page:0,perpage:100,requiredcapabilities:h,limittoenrolled:i},m=[{methodname:"core_course_search_courses",args:l}];j&&m.push({methodname:"core_course_get_courses",args:{options:{ids:[j]}}}),k=a.call(m),b.when.apply(b.when,k).done(function(a,b){if(b&&1==b.length){var c=b.pop(),f=""===d||c.fullname.toUpperCase().indexOf(d.toUpperCase())>-1||c.shortname.toUpperCase().indexOf(d.toUpperCase())>-1;f&&a.courses.splice(0,0,c)}e(a)}).fail(f)}}});
define('core/sessionstorage', ["core/config","core/storagewrapper"],function(a,b){var c=new b(window.sessionStorage);return{get:function(a){return c.get(a)},set:function(a,b){return c.set(a,b)}}});
define('core/paged_content_factory', ["jquery","core/templates","core/notification","core/paged_content_pages"],function(a,b,c,d){var e={PAGED_CONTENT:"core/paged_content"},f=function(a,b){for(var c={itemsperpage:b,previous:{},next:{},pages:[]},d=1;d<=a;d++){var e={number:d,page:""+d};1===d&&(e.active=!0),c.pages.push(e)}return c},g=function(a,b,c){var d={options:[]},e=0,f=0,g=a;c.hasOwnProperty("maxPages")&&(g=c.maxPages);for(var h=1;h<=g;h++){var i=0;h<=2?(i=b,f=b):(f=2*f,i=f),e+=i;var j={itemcount:i,content:e};1===h&&(j.active=!0),d.options.push(j)}return d},h=function(a,b,c){var d={pagingbar:!1,pagingdropdown:!1,skipjs:!0};return c.hasOwnProperty("dropdown")&&c.dropdown?d.pagingdropdown=g(a,b,c):d.pagingbar=f(a,b),d},i=function(a,b){var c=1;if(a>0){var d=a%b;d?(a-=d,c=a/b+1):c=a/b}return c},j=function(f,g,j,k){"undefined"==typeof k&&(k={});var l=a.Deferred(),m=i(f,g),n=h(m,g,k);return b.render(e.PAGED_CONTENT,n).then(function(b,c){b=a(b);var e=b,f=b.find(d.rootSelector);d.init(f,e,j),l.resolve(b,c)}).fail(function(a){l.reject(a)}).fail(c.exception),l},k=function(a,b,c,d){"undefined"==typeof d&&(d={});var e=a.length;return j(e,b,function(b){var d=[];return b.forEach(function(b){var c=b.offset,f=b.limit?c+b.limit:e,g=a.slice(c,f);d.push(g)}),c(d)},d)};return{createFromAjax:j,createFromStaticList:k}});
define('core/config', function(){return M.cfg});
define('core/storagewrapper', ["core/config"],function(a){var b=function(b){this.storage=b,this.supported=this.detectSupport(),this.hashSource=a.wwwroot+"/"+a.jsrev,this.hash=this.hashString(this.hashSource),this.prefix=this.hash+"/",this.jsrevPrefix=this.hashString(a.wwwroot)+"/jsrev",this.validateCache()};return b.prototype.detectSupport=function(){if(a.jsrev==-1)return!1;if("undefined"==typeof this.storage)return!1;var b="test";try{return null!==this.storage&&(this.storage.setItem(b,"1"),this.storage.removeItem(b),!0)}catch(c){return!1}},b.prototype.prefixKey=function(a){return this.prefix+a},b.prototype.validateCache=function(){var b=this.storage.getItem(this.jsrevPrefix);if(null===b)return void this.storage.setItem(this.jsrevPrefix,a.jsrev);var c=a.jsrev;c!=b&&(this.storage.clear(),this.storage.setItem(this.jsrevPrefix,a.jsrev))},b.prototype.hashString=function(a){var b,c,d,e=0;if(0===a.length)return e;for(b=0,d=a.length;b<d;b++)c=a.charCodeAt(b),e=(e<<5)-e+c,e|=0;return e},b.prototype.get=function(a){return!!this.supported&&(a=this.prefixKey(a),this.storage.getItem(a))},b.prototype.set=function(a,b){if(!this.supported)return!1;a=this.prefixKey(a);try{this.storage.setItem(a,b)}catch(c){return!1}return!0},b});
define('core/paged_content_paging_dropdown', ["jquery","core/custom_interaction_events","core/paged_content_events"],function(a,b,c){var d={ROOT:'[data-region="paging-dropdown-container"]',DROPDOWN_ITEM:'[data-region="dropdown-item"]',DROPDOWN_TOGGLE:'[data-region="dropdown-toggle"]',ACTIVE_DROPDOWN_ITEM:'[data-region="dropdown-item"].active',CARET:'[data-region="caret"]'},e=function(a){return parseInt(a.attr("data-page-number"),10)},f=function(a){return a.find(d.DROPDOWN_ITEM)},g=function(b,c){var d=e(c);return f(b).filter(function(b,c){return e(a(c))<d})},h=function(a){return parseInt(a.attr("data-item-count"),10)},i=function(b,c){if(void 0!=c.attr("data-offset"))return parseInt(c.attr("data-offset"),10);var d=0;return g(b,c).each(function(b,c){c=a(c),d+=h(c)}),c.attr("data-offset",d),d},j=function(a){return a.find(d.ACTIVE_DROPDOWN_ITEM)},k=function(b,c){return c.map(function(c,d){return d=a(d),{pageNumber:e(d),limit:h(d),offset:i(b,d)}}).get()},l=function(b){b.each(function(b,c){c=a(c),c.attr("data-page-number",b+1)})},m=function(a,b){var e=g(a,b),f=e.add(b),h=k(a,f),i=a.find(d.DROPDOWN_TOGGLE),l=i.find(d.CARET);j(a).removeClass("active"),b.addClass("active"),i.html(b.text()),i.append(l),a.trigger(c.SHOW_PAGES,[h])},n=function(c){c=a(c);var e=f(c);l(e);var g=j(c);g.length&&m(c,g),b.define(c,[b.events.activate]),c.on(b.events.activate,d.DROPDOWN_ITEM,function(b,e){var f=a(b.target).closest(d.DROPDOWN_ITEM);m(c,f),e.originalEvent.preventDefault()})};return{init:n,rootSelector:d.ROOT}});
define('core/icon_system_fontawesome', ["core/icon_system","jquery","core/ajax","core/mustache","core/localstorage","core/url"],function(a,b,c,d,e,f){var g=null,h=null,i=function(){a.apply(this,arguments)};return i.prototype=Object.create(a.prototype),i.prototype.init=function(){if(g)return b.when(this);var a=e.get("core/iconmap-fontawesome");return a&&(a=JSON.parse(a)),a?(g=a,b.when(this)):(null===h&&(h=c.call([{methodname:"core_output_load_fontawesome_icon_map",args:[]}],!0,!1)[0]),h.then(function(a){return g={},b.each(a,function(a,b){g[b.component+"/"+b.pix]=b.to}),e.set("core/iconmap-fontawesome",JSON.stringify(g)),this}.bind(this)))},i.prototype.renderIcon=function(a,b,c,e){var h=g[b+"/"+a],i=!1;if("undefined"==typeof h){var j=f.imageUrl(a,b);i={attributes:[{name:"src",value:j},{name:"alt",value:c},{name:"title",value:c}]}}var k={key:h,title:c,alt:c,unmappedIcon:i};"undefined"!=typeof c&&""!==c||(k["aria-hidden"]=!0);var l=d.render(e,k);return l.trim()},i.prototype.getTemplateName=function(){return"core/pix_icon_fontawesome"},i});
define('core/key_codes', function(){return{tab:9,enter:13,escape:27,space:32,end:35,home:36,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,8:56,asterix:106,pageUp:33,pageDown:34}});
define('core/inplace_editable', ["jquery","core/ajax","core/templates","core/notification","core/str","core/config","core/url","core/form-autocomplete","core/pending"],function(a,b,c,d,e,f,g,h,i){return a("body").on("click keypress","[data-inplaceeditable] [data-inplaceeditablelink]",function(j){if("keypress"!==j.type||13===j.keyCode){var k=new i("autocomplete-start-editing");j.stopImmediatePropagation(),j.preventDefault();var l=a(this),m=l.closest("[data-inplaceeditable]"),n=function(b){b.addClass("updating");var c=b.find("img.spinner");c.length?c.show():(c=a("<img/>").attr("src",g.imageUrl("i/loading_small")).addClass("spinner").addClass("smallicon"),b.append(c))},o=function(a){a.removeClass("updating"),a.find("img.spinner").hide()},p=function(e,f){var g=[e.attr("data-itemid"),e.attr("data-component"),e.attr("data-itemtype")].join("-"),h=new i(g);n(e),b.call([{methodname:"core_update_inplace_editable",args:{itemid:e.attr("data-itemid"),component:e.attr("data-component"),itemtype:e.attr("data-itemtype"),value:f}}])[0].then(function(b){return c.render("core/inplace_editable",b).then(function(d,f){var g=e.attr("data-value"),h=a(d);c.replaceNode(e,h,f),h.find("[data-inplaceeditablelink]").focus(),h.trigger({type:"updated",ajaxreturn:b,oldvalue:g})})}).then(function(){return h.resolve()}).fail(function(b){var c=a.Event("updatefailed",{exception:b,newvalue:f});o(e),M.util.js_complete(g),e.trigger(c),c.isDefaultPrevented()||d.exception(b)})},q=function(a){a.find("input").off(),a.find("select").off(),a.html(a.attr("data-oldcontent")),a.removeAttr("data-oldcontent"),a.removeClass("inplaceeditingon"),a.find("[data-inplaceeditablelink]").focus()},r=function(){a("span.inplaceeditable.inplaceeditingon").each(function(){q(a(this))})},s=function(b,c){var d,e=b;for(d=0;d<c;d++)e+=String(Math.floor(10*Math.random()));return 0===a("#"+e).length?e:s(b,c)},t=function(b){e.get_string("edittitleinstructions").done(function(c){var d=a('<span class="editinstructions">'+c+"</span>").attr("id",s("id_editinstructions_",20)),e=a('<input type="text"/>').attr("id",s("id_inplacevalue_",20)).attr("value",b.attr("data-value")).attr("aria-describedby",d.attr("id")).addClass("ignoredirty").addClass("form-control"),g=a('<label class="accesshide">'+m.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));b.html("").append(d).append(g).append(e),e.focus(),e.select(),e.on("keyup keypress focusout",function(a){if(!f.behatsiterunning||"focusout"!==a.type){if("keypress"===a.type&&13===a.keyCode){var c=e.val();q(b),p(b,c)}("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&q(b)}})})},u=function(a,b){q(a),p(a,b)},v=function(b,c){var d,e=a("<select></select>").attr("id",s("id_inplacevalue_",20)).addClass("custom-select"),g=a('<label class="accesshide">'+m.attr("data-editlabel")+"</label>").attr("for",e.attr("id"));for(d in c)e.append(a("<option>").attr("value",c[d].key).html(c[d].value));e.val(b.attr("data-value")),b.html("").append(g).append(e),e.focus(),e.select(),e.on("keyup change focusout",function(a){if(!f.behatsiterunning||"focusout"!==a.type){if("change"===a.type){var c=e.val();q(b),p(b,c)}("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&q(b)}})},w=function(b,f){var g,i=a("<select></select>").attr("id",s("id_inplacevalue_",20)).addClass("form-autocomplete-original-select").addClass("custom-select"),j=a('<label class="accesshide">'+m.attr("data-editlabel")+"</label>").attr("for",i.attr("id")),k=f.options,l=f.attributes,n=a('<a href="#"></a>'),o=a('<a href="#"></a>');for(g in k)i.append(a("<option>").attr("value",k[g].key).html(k[g].value));l.multiple&&i.attr("multiple","true"),i.val(JSON.parse(b.attr("data-value"))),e.get_string("savechanges","core").then(function(a){return c.renderPix("e/save","core",a)}).then(function(a){n.append(a)}).fail(d.exception),e.get_string("cancel","core").then(function(a){return c.renderPix("e/cancel","core",a)}).then(function(a){o.append(a)}).fail(d.exception),b.html("").append(j).append(i).append(n).append(o),i.focus(),i.select(),h.enhance(i,l.tags,l.ajax,l.placeholder,l.caseSensitive,l.showSuggestions,l.noSelectionString).then(function(){b.find("[role=combobox]").focus()}).fail(d.exception),i.on("keyup",function(a){("keyup"===a.type&&27===a.keyCode||"focusout"===a.type)&&q(b)}),n.on("click",function(a){var c=JSON.stringify(i.val());i.empty(),q(b),p(b,c),a.preventDefault()}),o.on("click",function(a){i.empty(),q(b),a.preventDefault()})},x=function(b){b.addClass("inplaceeditingon"),b.attr("data-oldcontent",b.html());var c=b.attr("data-type"),d=b.attr("data-options");"toggle"===c?u(b,d):"select"===c?v(b,a.parseJSON(d)):"autocomplete"===c?w(b,a.parseJSON(d)):t(b)};r(),x(m),k.resolve()}}),{}});
define('core/localstorage', ["core/config","core/storagewrapper"],function(a,b){var c=new b(window.localStorage);return{get:function(a){return c.get(a)},set:function(a,b){return c.set(a,b)}}});
define('core/permissionmanager', ["jquery","core/config","core/notification","core/templates","core/yui"],function(a,b,c,d,e){var f,g,h,i,j={ADDROLE:"a.allowlink, a.prohibitlink",REMOVEROLE:"a.preventlink, a.unprohibitlink",UNPROHIBIT:"a.unprohibitlink"},k=a.Event("rolesloaded"),l=null,m=function(){var d={contextid:f,getroles:1,sesskey:b.sesskey};a.post(h+"roles/ajax.php",d,null,"json").done(function(b){try{i=b,m=function(){a("body").trigger(k)},m()}catch(d){c.exception(d)}}).fail(function(a,b,d){c.exception(d)})},n=function(b,e,g){var j={contextid:f,roleid:e,sesskey:M.cfg.sesskey,action:g,capability:b.data("name")};a.post(h+"roles/ajax.php",j,null,"json").done(function(f){var g=f;try{var j={rolename:i[e],roleid:e,adminurl:h,imageurl:M.util.image_url("t/delete","moodle")};switch(g){case"allow":j.spanclass="allowed",j.linkclass="preventlink",j.action="prevent",j.icon="t/delete";break;case"prohibit":j.spanclass="forbidden",j.linkclass="unprohibitlink",j.action="unprohibit",j.icon="t/delete";break;case"prevent":return void b.find('a[data-role-id="'+e+'"]').first().closest(".allowed").remove();case"unprohibit":return void b.find('a[data-role-id="'+e+'"]').first().closest(".forbidden").remove();default:return}d.render("core/permissionmanager_role",j).done(function(c){if("allow"==g)a(c).insertBefore(b.find(".allowmore").first());else if("prohibit"==g){a(c).insertBefore(b.find(".prohibitmore").first());var d=b.find(".allowedroles").first().find('a[data-role-id="'+e+'"]');d&&d.first().closest(".allowed").remove()}l.hide()}).fail(c.exception)}catch(k){c.exception(k)}}).fail(function(a,b,d){c.exception(d)})},o=function(b){b.preventDefault(),e.use("moodle-core-notification-dialogue",function(){a("body").one("rolesloaded",function(){var e=a(b.currentTarget),f=e.data("action"),h=e.closest("tr.rolecap"),k={cap:h.data("humanname"),context:g},m=M.util.get_string("role"+f+"info","core_role",k);null===l&&(l=new M.core.dialogue({draggable:!0,modal:!0,closeButton:!0,width:"450px"})),l.set("headerContent",M.util.get_string("role"+f+"header","core_role"));var o,p,q=[];switch(f){case"allow":p=h.find(j.REMOVEROLE);break;case"prohibit":p=h.find(j.UNPROHIBIT)}for(o in i){var r="",s=p.filter("[data-role-id='"+o+"']").length;s&&(r="disabled");var t={roleid:o,rolename:i[o],disabled:r};q.push(t)}d.render("core/permissionmanager_panelcontent",{message:m,roles:q}).done(function(b){l.set("bodyContent",b),l.show(),a("div.role_buttons").delegate("input","click",function(b){var c=a(b.currentTarget).data("role-id");n(h,c,f)})}).fail(c.exception)})}),m()},p=function(b){b.preventDefault(),a("body").one("rolesloaded",function(){var d=a(b.currentTarget),e=d.data("action"),f=d.data("role-id"),h=d.closest("tr.rolecap"),j={role:i[f],cap:h.data("humanname"),context:g};c.confirm(M.util.get_string("confirmunassigntitle","core_role"),M.util.get_string("confirmrole"+e,"core_role",j),M.util.get_string("confirmunassignyes","core_role"),M.util.get_string("confirmunassignno","core_role"),function(){n(h,f,e)})}),m()};return{initialize:function(b){f=b.contextid,g=b.contextname,h=b.adminurl;var c=a("body");c.delegate(j.ADDROLE,"click",o),c.delegate(j.REMOVEROLE,"click",p)}}});
define('core/paged_content_paging_bar', ["jquery","core/custom_interaction_events","core/paged_content_events"],function(a,b,c){var d={ROOT:'[data-region="paging-bar"]',PAGE:"[data-page]",PAGE_ITEM:'[data-region="page-item"]',ACTIVE_PAGE_ITEM:'[data-region="page-item"].active'},e=function(a,b){return a.find(d.PAGE_ITEM+'[data-page-number="'+b+'"]')},f=function(a){var b=a.find(d.PAGE).last();return b?parseInt(b.attr("data-page-number"),10):null},g=function(a){var b=a.find(d.ACTIVE_PAGE_ITEM);return b.length?h(a,b):null},h=function(a,b){if(void 0!=b.attr("data-page"))return parseInt(b.attr("data-page-number"),10);var c=1,d=null;switch(b.attr("data-control")){case"first":c=1;break;case"last":c=f(a);break;case"next":d=g(a);var e=f(a);c=d&&d<e?d+1:e;break;case"previous":d=g(a),c=d&&d>1?d-1:1;break;default:c=1}return parseInt(c,10)},i=function(a){return parseInt(a.attr("data-items-per-page"),10)},j=function(b){b.each(function(b,c){c=a(c),c.attr("data-page-number",b+1)})},k=function(a,b){var f=b==g(a),h=i(a),j=(b-1)*h;if(!f){a.find(d.PAGE_ITEM).removeClass("active");var k=e(a,b);k.addClass("active")}a.trigger(c.SHOW_PAGES,[[{pageNumber:b,limit:h,offset:j}]])},l=function(c){c=a(c);var e=c.find(d.PAGE);j(e);var f=g(c);f&&k(c,f),b.define(c,[b.events.activate]),c.on(b.events.activate,d.PAGE_ITEM,function(b,e){var f=a(b.target).closest(d.PAGE_ITEM),g=h(c,f);k(c,g),e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()})};return{init:l,rootSelector:d.ROOT}});
define('core/ajax', ["jquery","core/config","core/log","core/url"],function(a,b,c,d){var e=!1,f=function(a){var b,c,e=this,f=null,g=0;if(a.error)for(;g<e.length;g++)b=e[g],b.deferred.reject(a);else{for(g=0;g<e.length;g++){if(b=e[g],c=a[g],"undefined"==typeof c){f=new Error("missing response");break}if(c.error!==!1){f=c.exception;break}b.deferred.resolve(c.data)}null!==f&&("servicerequireslogin"===f.errorcode?window.location=d.relativeUrl("/login/index.php"):e.forEach(function(a){a.deferred.reject(f)}))}},g=function(a,b,d){var f=this,g=0;for(g=0;g<f.length;g++){var h=f[g];e?(c.error("Page unloaded."),c.error(d)):h.deferred.reject(d)}};return{call:function(c,d,h){a(window).bind("beforeunload",function(){e=!0});var i,j=[],k=[],l=[],m="";for("undefined"==typeof h&&(h=!0),"undefined"==typeof d&&(d=!0),i=0;i<c.length;i++){var n=c[i];j.push({index:i,methodname:n.methodname,args:n.args}),n.deferred=a.Deferred(),k.push(n.deferred.promise()),"undefined"!=typeof n.done&&n.deferred.done(n.done),"undefined"!=typeof n.fail&&n.deferred.fail(n.fail),n.index=i,l.push(n.methodname)}m=l.length<=5?l.sort().join():l.length+"-method-calls",j=JSON.stringify(j);var o={type:"POST",data:j,context:c,dataType:"json",processData:!1,async:d,contentType:"application/json"},p="service.php";h||(p="service-nologin.php");var q=b.wwwroot+"/lib/ajax/"+p+"?sesskey="+b.sesskey+"&info="+m;return d?a.ajax(q,o).done(f).fail(g):(o.success=f,o.error=g,a.ajax(q,o)),k}}});
define('core/notification', ["core/yui","jquery","core/log","core/pending"],function(a,b,c,d){var e={types:{success:"core/notification_success",info:"core/notification_info",warning:"core/notification_warning",error:"core/notification_error"},fieldName:"user-notifications",fetchNotifications:function(){var a=new d("core/notification:fetchNotifications");require(["core/ajax"],function(b){var c=b.call([{methodname:"core_fetch_notifications",args:{contextid:e.contextid}}]);c[0].then(e.addNotifications).always(a.resolve)})},addNotifications:function(a){var c=new d("core/notification:addNotifications");a||(a=[]),b.each(a,function(a,b){e.renderNotification(b.template,b.variables)}),c.resolve()},setupTargetRegion:function(){var a=b("#"+e.fieldName);if(a.length)return!1;var c=b("<span>").attr("id",e.fieldName);return a=b("#region-main"),a.length?a.prepend(c):(a=b('[role="main"]'),a.length?a.prepend(c):(a=b("body"),a.prepend(c)))},addNotification:function(a){var c=new d("core/notification:addNotifications"),f=e.types.error;return a=b.extend({closebutton:!0,announce:!0,type:"error"},a),a.template?(f=a.template,delete a.template):a.type&&("undefined"!=typeof e.types[a.type]&&(f=e.types[a.type]),delete a.type),c.resolve(),e.renderNotification(f,a)},renderNotification:function(a,f){if("undefined"==typeof f.message||!f.message)return void c.debug("Notification received without content. Skipping.");var g=new d("core/notification:renderNotification");require(["core/templates"],function(c){c.render(a,f).then(function(a,d){b("#"+e.fieldName).prepend(a),c.runTemplateJS(d)}).then(g.resolve)["catch"](e.exception)})},alert:function(b,c,e){var f=new d("core/notification:alert");a.use("moodle-core-notification-alert",function(){var a=new M.core.alert({title:b,message:c,yesLabel:e});a.show(),f.resolve()})},confirm:function(b,c,e,f,g,h){var i=new d("core/notification:confirm");a.use("moodle-core-notification-confirm",function(){var a=new M.core.confirm({title:b,question:c,yesLabel:e,noLabel:f});a.on("complete-yes",function(){g()}),h&&a.on("complete-no",function(){h()}),a.show(),i.resolve()})},exception:function(b){var c=new d("core/notification:addNotifications");if("undefined"==typeof b.stack&&(b.stack=""),b.debuginfo&&(b.stack+=b.debuginfo+"\n"),!b.backtrace&&b.stacktrace&&(b.backtrace=b.stacktrace),b.backtrace){b.stack+=b.backtrace;var e=b.backtrace.match(/line ([^ ]*) of/),f=b.backtrace.match(/ of ([^:]*): /);e&&e[1]&&(b.lineNumber=e[1]),f&&f[1]&&(b.fileName=f[1],b.fileName.length>30&&(b.fileName="..."+b.fileName.substr(b.fileName.length-27)))}"undefined"==typeof b.name&&b.errorcode&&(b.name=b.errorcode),a.use("moodle-core-notification-exception",function(){var a=new M.core.exception(b);a.show(),c.resolve()})}};return{init:function(a,b){e.contextid=a,e.setupTargetRegion(),e.addNotifications(b),e.fetchNotifications()},fetchNotifications:e.fetchNotifications,addNotification:e.addNotification,alert:e.alert,confirm:e.confirm,exception:e.exception}});
define('core/pending', ["jquery"],function(a){var b=function(b){var c=a.Deferred();return b=b||{},M.util.js_pending(b),c.then(function(){return M.util.js_complete(b)})["catch"](),c};return b.prototype.constructor=b,b});
define('core/backoff_timer', function(){var a=function(a,b){this.callback=a,this.backOffFunction=b};return a.prototype.callback=null,a.prototype.backOffFunction=null,a.prototype.time=null,a.prototype.timeout=null,a.prototype.generateNextTime=function(){var a=this.backOffFunction(this.time);return this.time=a,a},a.prototype.reset=function(){return this.time=null,this.stop(),this},a.prototype.stop=function(){return this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null),this},a.prototype.start=function(){if(!this.timeout){var a=this.generateNextTime();this.timeout=window.setTimeout(function(){this.callback(),this.stop(),this.start()}.bind(this),a)}return this},a.prototype.restart=function(){return this.reset().start()},a.getIncrementalCallback=function(a,b,c,d){return function(e){return e?e+b>c?d:e+b:a}},a});
define('core/str', ["jquery","core/ajax","core/localstorage"],function(a,b,c){var d=[];return{get_string:function(a,b,c,d){var e=this.get_strings([{key:a,component:b,param:c,lang:d}]);return e.then(function(a){return a[0]})},get_strings:function(e){var f,g=a.Deferred(),h=[],i=0,j=!1;for(i=0;i<e.length;i++)if(f=e[i],"undefined"==typeof f.lang&&(f.lang=a("html").attr("lang").replace(/-/g,"_")),f.cacheKey="core_str/"+f.key+"/"+f.component+"/"+f.lang,"undefined"==typeof M.str[f.component]||"undefined"==typeof M.str[f.component][f.key]){var k=c.get(f.cacheKey);k?("undefined"==typeof M.str[f.component]&&(M.str[f.component]=[]),M.str[f.component][f.key]=k):j=!0}if(j){var l=[],m=[],n=function(a){this.resolve(a)},o=function(a){this.reject(a)};for(i=0;i<e.length;i++)if(f=e[i],"undefined"!=typeof d[f.cacheKey])m.push(d[f.cacheKey]);else{var p=a.Deferred();l.push({methodname:"core_get_string",args:{stringid:f.key,component:f.component,lang:f.lang,stringparams:[]},done:n.bind(p),fail:o.bind(p)}),d[f.cacheKey]=p.promise(),m.push(d[f.cacheKey])}l.length>0&&b.call(l,!0,!1),a.when.apply(null,m).done(function(){var a=0;for(a=0;a<arguments.length;a++)f=e[a],"undefined"==typeof M.str[f.component]&&(M.str[f.component]=[]),M.str[f.component][f.key]=arguments[a],c.set("core_str/"+f.key+"/"+f.component+"/"+f.lang,arguments[a]),h[a]=M.util.get_string(f.key,f.component,f.param).trim();g.resolve(h)}).fail(function(a){g.reject(a)})}else{for(i=0;i<e.length;i++)f=e[i],h[i]=M.util.get_string(f.key,f.component,f.param);g.resolve(h)}return g.promise()}}});
define('core/form-autocomplete', ["jquery","core/log","core/str","core/templates","core/notification"],function(a,b,c,d,e){var f={DOWN:40,ENTER:13,SPACE:32,ESCAPE:27,COMMA:44,UP:38},g=Date.now(),h=function(b,c){var d=a(document.getElementById(c.selectionId)),e=d.children("[aria-selected=true]").length;for(b%=e;b<0;)b+=e;var f=a(d.children("[aria-selected=true]").get(b)),g=c.selectionId+"-"+b;return d.children().attr("data-active-selection",!1).attr("id",""),f.attr("data-active-selection",!0).attr("id",g),d.attr("aria-activedescendant",g),a.Deferred().resolve()},i=function(b,c,f){var g="form-autocomplete-updateSelectionList-"+c.inputId;M.util.js_pending(g);var i=[],j=a(document.getElementById(c.selectionId)),k=j.attr("aria-activedescendant"),l=!1;k&&(l=a(document.getElementById(k)).attr("data-value")),f.children("option").each(function(b,c){if(a(c).prop("selected")){var d;d=a(c).data("html")?a(c).data("html"):a(c).html(),i.push({label:d,value:a(c).attr("value")})}});var m=a.extend({items:i},b,c);return d.render("core/form_autocomplete_selection",m).then(function(b,e){return d.replaceNodeContents(j,b,e),l!==!1&&j.children("[aria-selected=true]").each(function(b,d){a(d).attr("data-value")===l&&h(b,c)}),l}).then(function(){return M.util.js_complete(g)})["catch"](e.exception)},j=function(a){"undefined"!=typeof M.core_formchangechecker&&M.core_formchangechecker.set_form_changed(),a.change()},k=function(b,c,d,e){var f=a(d).attr("data-value");return b.multiple&&e.children("option").each(function(b,c){a(c).attr("value")==f&&(a(c).prop("selected",!1),a(c).attr("data-iscustom")&&a(c).remove())}),i(b,c,e).then(function(){j(e)})},l=function(b,c){var d=a(document.getElementById(c.inputId)),e=a(document.getElementById(c.suggestionsId)),f=e.children("[aria-hidden=false]").length;for(b%=f;b<0;)b+=f;var g=a(e.children("[aria-hidden=false]").get(b)),h=a(e.children("[role=option]")).index(g),i=c.suggestionsId+"-"+h;e.children().attr("aria-selected",!1).attr("id",""),g.attr("aria-selected",!0).attr("id",i),d.attr("aria-activedescendant",i);var j=g.offset().top-e.offset().top+e.scrollTop()-e.height()/2;return e.animate({scrollTop:j},100).promise()},m=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);return l(e+1,b)},n=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection=true]");if(!d)return h(0,b);var e=c.children("[aria-selected=true]").index(d);return h(e-1,b)},o=function(b){var c=a(document.getElementById(b.selectionId)),d=c.children("[data-active-selection=true]"),e=0;return d?(e=c.children("[aria-selected=true]").index(d),e+=1):e=0,h(e,b)},p=function(b){var c=a(document.getElementById(b.suggestionsId)),d=c.children("[aria-selected=true]"),e=c.children("[aria-hidden=false]").index(d);return l(e-1,b)},q=function(b){var c=a(document.getElementById(b.inputId)),d=a(document.getElementById(b.suggestionsId));return c.attr("aria-expanded",!1).attr("aria-activedescendant",b.selectionId),d.hide().attr("aria-hidden",!0),a.Deferred().resolve()},r=function(b,f,g,h){var i="form-autocomplete-updateSuggestions-"+f.inputId;M.util.js_pending(i);var j=a(document.getElementById(f.inputId)),k=a(document.getElementById(f.suggestionsId)),m=!1,n=[];h.children("option").each(function(b,c){a(c).prop("selected")!==!0&&(n[n.length]={label:c.innerHTML,value:a(c).attr("value")})});var o=f.caseSensitive?g:g.toLocaleLowerCase(),p=a.extend({options:n},b,f),q=d.render("core/form_autocomplete_suggestions",p).then(function(e,g){return d.replaceNode(k,e,g),k=a(document.getElementById(f.suggestionsId)),k.show().attr("aria-hidden",!1),k.children().each(function(c,d){d=a(d),b.caseSensitive&&d.text().indexOf(o)>-1||!b.caseSensitive&&d.text().toLocaleLowerCase().indexOf(o)>-1?(d.show().attr("aria-hidden",!1),m=!0):d.hide().attr("aria-hidden",!0)}),j.attr("aria-expanded",!0),h.attr("data-notice")?k.html(h.attr("data-notice")):m?b.tags||l(0,f):c.get_string("nosuggestions","form").done(function(a){k.html(a)}),k}).then(function(){return M.util.js_complete(i)})["catch"](e.exception);return q},s=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=e.val(),g=f.split(","),h=!1;return a.each(g,function(c,e){if(e=e.trim(),""!==e&&(b.multiple||d.children("option").prop("selected",!1),d.children("option").each(function(b,c){a(c).attr("value")==e&&(h=!0,a(c).prop("selected",!0))}),!h)){var f=a("<option>");f.append(document.createTextNode(e)),f.attr("value",e),d.append(f),f.prop("selected",!0),f.attr("data-iscustom",!0)}}),i(b,c,d).then(function(){j(d)}).then(function(){e.val("")}).then(function(){return q(c)})},t=function(b,c,d){var e=a(document.getElementById(c.inputId)),f=a(document.getElementById(c.suggestionsId)),g=f.children("[aria-selected=true]").attr("data-value");return b.multiple||d.children("option").prop("selected",!1),d.children("option").each(function(b,c){a(c).attr("value")==g&&a(c).prop("selected",!0)}),i(b,c,d).then(function(){j(d)}).then(function(){return b.closeSuggestionsOnSelect?(e.val(""),q(c)):(e.focus(),r(b,c,e.val(),d))})},u=function(b,c,d,e,f){var g=w("updateAjax"),h=a(b.currentTarget).val();return f.transport(c.selector,h,function(b){var h=f.processResults(c.selector,b),i=[];if(e.children("option").each(function(b,c){c=a(c),c.prop("selected")?i.push(String(c.attr("value"))):c.remove()}),!c.multiple&&0===e.children("option").length){var j=a("<option>");e.append(j)}a.isArray(h)?(a.each(h,function(b,c){if(i.indexOf(String(c.value))===-1){var d=a("<option>");d.append(c.label),d.attr("value",c.value),e.append(d)}}),e.attr("data-notice","")):e.attr("data-notice",h),g.resolve(r(c,d,"",e))},function(a){g.reject(a)}),g},v=function(b,c,d){var g=a(document.getElementById(c.inputId));if(g.on("keydown",function(e){var h=w("addNavigation-"+c.inputId+"-"+e.keyCode);switch(e.keyCode){case f.DOWN:return b.showSuggestions?("true"===g.attr("aria-expanded")?h.resolve(m(c)):!g.val()&&b.ajax?require([b.ajax],function(a){h.resolve(u(e,b,c,d,a))}):h.resolve(r(b,c,g.val(),d)),e.preventDefault(),!1):(h.resolve(),!0);case f.UP:return h.resolve(p(c)),e.preventDefault(),!1;case f.ENTER:var i=a(document.getElementById(c.suggestionsId));return"true"===g.attr("aria-expanded")&&i.children("[aria-selected=true]").length>0?h.resolve(t(b,c,d)):b.tags?h.resolve(s(b,c,d)):h.resolve(),e.preventDefault(),!1;case f.ESCAPE:return"true"===g.attr("aria-expanded")?h.resolve(q(c)):h.resolve(),e.preventDefault(),!1}return h.resolve(),!0}),g.on("keypress",function(a){return a.keyCode!==f.COMMA||(b.tags&&w("keypress-"+a.keyCode).resolve(s(b,c,d)),a.preventDefault(),!1)}),g.closest("form").on("submit",function(){return b.tags&&w("form-autocomplete-submit").resolve(s(b,c,d)),!0}),g.on("blur",function(){var e=w("form-autocomplete-blur");window.setTimeout(function(){var f=a(document.activeElement),h=a.Deferred();f.attr("id")!=g.attr("id")&&a("#"+c.inputId).length&&(b.tags&&h.then(function(){return s(b,c,d)})["catch"](),h.then(function(){return q(c)})["catch"]()),h.then(function(){return e.resolve()})["catch"](),h.resolve()},500)}),b.showSuggestions){var h=a(document.getElementById(c.downArrowId));h.on("click",function(a){var e=w("form-autocomplete-show-suggestions");g.focus(),!g.val()&&b.ajax?require([b.ajax],function(f){e.resolve(u(a,b,c,d,f))}):e.resolve(r(b,c,g.val(),d))})}var i=a(document.getElementById(c.suggestionsId));i.parent().prop("onclick",null).off("click"),i.parent().on("click","[role=option]",function(e){var f=w("form-autocomplete-parent"),g=a(e.currentTarget).closest("[role=option]"),h=a(document.getElementById(c.suggestionsId)),i=h.children("[aria-hidden=false]").index(g);l(i,c).then(function(){return t(b,c,d)}).then(function(){return f.resolve()})["catch"]()});var j=a(document.getElementById(c.selectionId));j.on("click","[role=listitem]",function(e){var f=w("form-autocomplete-clicks");f.resolve(k(b,c,a(e.currentTarget),d))}),j.on("keydown",function(e){var g=w("form-autocomplete-keydown-"+e.keyCode);switch(e.keyCode){case f.DOWN:return e.preventDefault(),g.resolve(o(c)),!1;case f.UP:return e.preventDefault(),g.resolve(n(c)),!1;case f.SPACE:case f.ENTER:var h=a(document.getElementById(c.selectionId)).children("[data-active-selection=true]");return h&&(e.preventDefault(),g.resolve(k(b,c,h,d))),!1}return g.resolve(),!0}),b.showSuggestions&&(b.ajax?require([b.ajax],function(a){var f=null,h=!1,i="autocomplete-throttledhandler",j=function(g){f=null,h=!0,u(g,b,c,d,a).then(function(){return null===f&&M.util.js_complete(i),h=!1,arguments[0]})["catch"](e.exception)},k=function(a){return window.clearTimeout(f),h?void(f=window.setTimeout(k.bind(this,a),100)):(null===f&&M.util.js_pending(i),void(f=window.setTimeout(j.bind(this,a),300)))};g.on("input",k)}):g.on("input",function(e){var f=a(e.currentTarget).val(),g=a(e.currentTarget).data("last-value");g!==f&&r(b,c,f,d),a(e.currentTarget).data("last-value",f)}))},w=function(b){var c="form-autocomplete:"+b;M.util.js_pending(c);var d=a.Deferred();return d.then(function(){return M.util.js_complete(c),arguments[0]})["catch"](e.exception),d};return{enhance:function(f,h,j,k,l,m,n,o){var p={selector:f,tags:!1,ajax:!1,placeholder:k,caseSensitive:!1,showSuggestions:!0,noSelectionString:n},q="autocomplete-setup-"+f;M.util.js_pending(q),"undefined"!=typeof h&&(p.tags=h),"undefined"!=typeof j&&(p.ajax=j),"undefined"!=typeof l&&(p.caseSensitive=l),"undefined"!=typeof m&&(p.showSuggestions=m),"undefined"==typeof n&&c.get_string("noselection","form").done(function(a){p.noSelectionString=a}).fail(e.exception);var r=a(f);if(!r)return b.debug("Selector not found: "+f),M.util.js_complete(q),!1;r.css("visibility","hidden").attr("aria-hidden",!0);var s={selectId:r.attr("id"),inputId:"form_autocomplete_input-"+g,suggestionsId:"form_autocomplete_suggestions-"+g,selectionId:"form_autocomplete_selection-"+g,downArrowId:"form_autocomplete_downarrow-"+g};g++,p.multiple=!!r.attr("multiple"),"undefined"!=typeof o?p.closeSuggestionsOnSelect=o:p.closeSuggestionsOnSelect=!p.multiple;var t=a("[for="+s.selectId+"]"),u=[];r.children("option").each(function(b,c){u[b]={label:c.innerHTML,value:a(c).attr("value")}});var w=a.extend({},p,s);w.options=u,w.items=[];var x="",y=d.render("core/form_autocomplete_input",w).then(function(a,b){return x+=b,a}),z=d.render("core/form_autocomplete_suggestions",w).then(function(a,b){return x+=b,a}),A=d.render("core/form_autocomplete_selection",w).then(function(a,b){return x+=b,a});return a.when(y,z,A).then(function(b,c,e){r.hide(),a(b).find("input").attr("data-fieldtype","autocomplete"),r.after(c),r.after(b),r.after(e),d.runTemplateJS(x),t.attr("for",s.inputId),v(p,s,r);var f=a(document.getElementById(s.suggestionsId));f.hide().attr("aria-hidden",!0)}).then(function(){return i(p,s,r)}).then(function(){return M.util.js_complete(q)})["catch"](function(a){M.util.js_complete(q),e.exception(a)})}}});
define('core/paged_content_events', [],function(){return{SHOW_PAGES:"core-paged-content-show-pages"}});
define('core/modal_factory', ["jquery","core/modal_events","core/modal_registry","core/modal","core/modal_save_cancel","core/modal_confirm","core/modal_cancel","core/templates","core/notification","core/custom_interaction_events","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k){var l={DEFAULT:"core/modal",SAVE_CANCEL:"core/modal_save_cancel",CONFIRM:"core/modal_save_cancel",CANCEL:"core/modal_cancel"},m={DEFAULT:"DEFAULT",SAVE_CANCEL:"SAVE_CANCEL",CONFIRM:"CONFIRM",CANCEL:"CANCEL"};c.register(m.DEFAULT,d,l.DEFAULT),c.register(m.SAVE_CANCEL,e,l.SAVE_CANCEL),c.register(m.CONFIRM,f,l.CONFIRM),c.register(m.CANCEL,g,l.CANCEL);var n=function(c,d,e){var f=null,g="function"==typeof e.preShowCallback,h=function(b,d){var h=new k("core/modal_factory:setUpTrigger:triggeredCallback");f=a(b.currentTarget),c.then(function(a){return g&&e.preShowCallback(f,a),a.show(),a}).then(h.resolve),d.originalEvent.preventDefault()};if(Array.isArray(d)){var i=d[1];d=d[0],j.define(d,[j.events.activate]),d.on(j.events.activate,i,h)}else j.define(d,[j.events.activate]),d.on(j.events.activate,h);c.then(function(a){return a.getRoot().on(b.hidden,function(){null!==f&&f.focus()}),a})},o=function(b,c){c=a(c);var d=b.module,e=new d(c);return e},p=function(b,c){var d=b.template,e=h.render(d,c).then(function(c){var d=a(c);return o(b,d)}).fail(i.exception);return e},q=function(a,b){var d=a.type||m.DEFAULT,e=!!a.large,f=null,g={};f=c.get(d),f||i.exception({message:"Unable to find modal of type: "+d}),"undefined"!=typeof a.templateContext&&(g=a.templateContext);var h=p(f,g).then(function(b){return"undefined"!=typeof a.title&&b.setTitle(a.title),"undefined"!=typeof a.body&&b.setBody(a.body),"undefined"!=typeof a.footer&&b.setFooter(a.footer),e&&b.setLarge(),b});return"undefined"!=typeof b&&n(h,b,a),h};return{create:q,types:m}});
define('core/chart_builder', ["jquery"],function(a){var b={make:function(b){var c=a.Deferred();return require(["core/chart_"+b.type],function(a){var d=a.prototype.create(a,b);c.resolve(d)}),c.promise()}};return b});
define('core/modal_confirm', ["jquery","core/custom_interaction_events","core/modal_events","core/modal_save_cancel","core/log"],function(a,b,c,d,e){var f=function(a){e.warn("The CONFIRM modal type has been deprecated and should not be used anymore. Please use the SAVE_CANCEL modal type instead."),d.call(this,a)};return f.prototype=Object.create(d.prototype),f.prototype.constructor=f,f});
define('core/addblockmodal', ["jquery","core/modal_factory","core/templates","core/str","core/notification"],function(a,b,c,d,e){return{init:function(f){var g=a("[data-key=addblock]"),h=f.blocks.map(function(a){return{key:"pluginname",component:"block_"+a}}),i=d.get_strings(h).then(function(a){return a.map(function(a,b){return{name:f.blocks[b],title:a}})}).then(function(a){return f.blocks=a,c.render("core/add_block_body",f)}).fail(e.exception),j=d.get_string("addblock").fail(e.exception);b.create({title:j,body:i,type:"CANCEL"},g)}}});
define('core/event', ["jquery","core/yui"],function(a,b){return{Events:{FORM_FIELD_VALIDATION:"core_form-field-validation"},getLegacyEvents:function(){var c=a.Deferred();return b.use("event","moodle-core-event",function(){c.resolve(window.M.core.event)}),c.promise()},notifyFilterContentUpdated:function(c){c=a(c),b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.FILTER_CONTENT_UPDATED,[c]);var d=new b.NodeList(c.get());b.fire(M.core.event.FILTER_CONTENT_UPDATED,{nodes:d})})},notifyEditorContentRestored:function(){b.use("event","moodle-core-event",function(b){a(document).trigger(M.core.event.EDITOR_CONTENT_RESTORED),b.fire(M.core.event.EDITOR_CONTENT_RESTORED)})}}});
define('core/fragment', ["jquery","core/ajax"],function(a,b){var c=function(a,c,d,e){var f=[];for(var g in e)f.push({name:g,value:e[g]});return b.call([{methodname:"core_get_fragment",args:{component:a,callback:c,contextid:d,args:f}}])[0]};return{loadFragment:function(b,d,e,f){var g=a.Deferred();return c(b,d,e,f).then(function(b){var c=a(b.javascript),d="";c.each(function(b,c){c=a(c);var e=c.prop("tagName");if(e&&"script"==e.toLowerCase())if(c.attr("src")){var f=!1;a("script").each(function(b,d){return a(d).attr("src")==c.attr("src")&&(f=!0),!f}),f||(d+=" { ",d+=' node = document.createElement("script"); ',d+=' node.type = "text/javascript"; ',d+=' node.src = decodeURI("'+encodeURI(c.attr("src"))+'"); ',d+=' document.getElementsByTagName("head")[0].appendChild(node); ',d+=" } ")}else d+=" "+c.text()}),g.resolve(b.html,d)}).fail(function(a){g.reject(a)}),g.promise()}}});
define('core/modal', ["jquery","core/templates","core/notification","core/key_codes","core/custom_interaction_events","core/modal_backdrop","core/event","core/modal_events","core/pending"],function(a,b,c,d,e,f,g,h,i){var j,k={CONTAINER:'[data-region="modal-container"]',MODAL:'[data-region="modal"]',HEADER:'[data-region="header"]',TITLE:'[data-region="title"]',BODY:'[data-region="body"]',FOOTER:'[data-region="footer"]',HIDE:'[data-action="hide"]',DIALOG:"[role=dialog]",MENU_BAR:"[role=menubar]",HAS_Z_INDEX:".moodle-has-zindex",CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},l={LOADING:"core/loading",BACKDROP:"core/modal_backdrop"},m=0,n=function(b){this.root=a(b),this.modal=this.root.find(k.MODAL),this.header=this.modal.find(k.HEADER),this.title=this.header.find(k.TITLE),this.body=this.modal.find(k.BODY),this.footer=this.modal.find(k.FOOTER),this.hiddenSiblings=[],this.isAttached=!1,this.bodyJS=null,this.footerJS=null,this.modalCount=m++,this.root.is(k.CONTAINER)||c.exception({message:"Element is not a modal container"}),this.modal.length||c.exception({message:"Container does not contain a modal"}),this.header.length||c.exception({message:"Modal is missing a header region"}),this.title.length||c.exception({message:"Modal header is missing a title region"}),this.body.length||c.exception({message:"Modal is missing a body region"}),this.footer.length||c.exception({message:"Modal is missing a footer region"}),this.registerEventListeners()};return n.prototype.attachToDOM=function(){this.isAttached||(a("body").append(this.root),this.bodyJS&&(b.runTemplateJS(this.bodyJS),this.bodyJS=null),this.footerJS&&(b.runTemplateJS(this.footerJS),this.footerJS=null),this.isAttached=!0)},n.prototype.countOtherVisibleModals=function(){var b=0;return a("body").find(k.CONTAINER).each(function(c,d){d=a(d),!this.root.is(d)&&d.hasClass("show")&&b++}.bind(this)),b},n.prototype.getBackdrop=function(){return j||(j=b.render(l.BACKDROP,{}).then(function(b){var c=a(b);return new f(c)}).fail(c.exception)),j},n.prototype.getRoot=function(){return this.root},n.prototype.getModal=function(){return this.modal},n.prototype.getTitle=function(){return this.title},n.prototype.getBody=function(){return this.body},n.prototype.getFooter=function(){return this.footer},n.prototype.getModalCount=function(){return this.modalCount},n.prototype.setTitle=function(a){var b=this.getTitle();this.asyncSet(a,b.html.bind(b))},n.prototype.setBody=function(d){var e=this.getBody();if("string"==typeof d)e.html(d),g.notifyFilterContentUpdated(e),this.getRoot().trigger(h.bodyRendered,this);else{var f="amd-modal-js-pending-id-"+this.getModalCount();M.util.js_pending(f);var i=null;if(e.css("overflow","hidden"),"pending"==d.state()){var j=e.innerHeight();j<100&&(j=100),e.animate({height:j+"px"},150),e.html(""),i=b.render(l.LOADING,{}).then(function(b){var c=a(b).hide();return e.html(c),c.fadeIn(150),a.when(c.promise(),d)}).then(function(a){return a.fadeOut(100).promise()}).then(function(){return d})}else i=d;i.then(function(a,c){var d=null;if(this.isVisible()){e.css("opacity",0);var f=e.innerHeight();e.html(a),e.css("height","");var i=e.innerHeight();e.css("height",f+"px"),d=e.animate({height:i+"px",opacity:1},{duration:150,queue:!1}).promise()}else e.html(a);return c&&(this.isAttached?b.runTemplateJS(c):this.bodyJS=c),g.notifyFilterContentUpdated(e),this.getRoot().trigger(h.bodyRendered,this),d}.bind(this)).fail(c.exception).always(function(){e.css("height",""),e.css("overflow",""),e.css("opacity",""),M.util.js_complete(f)}).fail(c.exception)}},n.prototype.setFooter=function(a){this.showFooter();var c=this.getFooter();"string"==typeof a?c.html(a):b.render(l.LOADING,{}).done(function(d){c.html(d),a.done(function(a,d){c.html(a),d&&(this.isAttached?b.runTemplateJS(d):this.footerJS=d)}.bind(this))}.bind(this))},n.prototype.hasFooterContent=function(){return!!this.getFooter().children().length},n.prototype.hideFooter=function(){this.getFooter().addClass("hidden")},n.prototype.showFooter=function(){this.getFooter().removeClass("hidden")},n.prototype.setLarge=function(){this.isLarge()||this.getModal().addClass("modal-lg")},n.prototype.isLarge=function(){return this.getModal().hasClass("modal-lg")},n.prototype.setSmall=function(){this.isSmall()||this.getModal().removeClass("modal-lg")},n.prototype.isSmall=function(){return!this.getModal().hasClass("modal-lg")},n.prototype.calculateZIndex=function(){var b=a(k.DIALOG+", "+k.MENU_BAR+", "+k.HAS_Z_INDEX),c=parseInt(this.root.css("z-index"));return b.each(function(b,d){d=a(d);var e=d.css("z-index")?parseInt(d.css("z-index")):0;e>c&&(c=e)}),c},n.prototype.isVisible=function(){return this.root.hasClass("show")},n.prototype.hasFocus=function(){var b=a(document.activeElement);return this.root.is(b)||this.root.has(b).length},n.prototype.hasTransitions=function(){return this.getRoot().hasClass("fade")},n.prototype.show=function(){if(!this.isVisible()){var b=new i("core/modal:show");this.hasFooterContent()?this.showFooter():this.hideFooter(),this.isAttached||this.attachToDOM(),this.getBackdrop().then(function(b){var c=this.calculateZIndex(),d=c+2,e=d-1;this.root.css("z-index",d),b.setZIndex(e),b.show(),this.root.removeClass("hide").addClass("show"),this.accessibilityShow(),this.getModal().focus(),a("body").addClass("modal-open"),this.root.trigger(h.shown,this)}.bind(this)).then(b.resolve)}},n.prototype.hide=function(){this.getBackdrop().done(function(b){this.countOtherVisibleModals()||(b.hide(),a("body").removeClass("modal-open"));var c=parseInt(this.root.css("z-index"));this.root.css("z-index",""),b.setZIndex(c-3),this.accessibilityHide(),this.hasTransitions()?this.getRoot().one("transitionend webkitTransitionEnd oTransitionEnd",function(){this.getRoot().removeClass("show").addClass("hide")}.bind(this)):this.getRoot().removeClass("show").addClass("hide"),this.root.trigger(h.hidden,this)}.bind(this))},n.prototype.destroy=function(){this.root.remove(),this.root.trigger(h.destroyed,this)},n.prototype.accessibilityShow=function(){a("body").children().each(function(b,c){if(!this.root.is(c)){c=a(c);var d=c.attr("aria-hidden");"true"!==d&&(c.data("previous-aria-hidden",d),this.hiddenSiblings.push(c),c.attr("aria-hidden","true"))}}.bind(this)),this.root.attr("aria-hidden","false")},n.prototype.accessibilityHide=function(){this.root.attr("aria-hidden","true"),a.each(this.hiddenSiblings,function(b,c){c=a(c);var d=c.data("previous-aria-hidden");"undefined"==typeof d?c.removeAttr("aria-hidden"):c.attr("aria-hidden",d)}),this.hiddenSiblings=[]},n.prototype.handleTabLock=function(b){if(this.hasFocus()){var c=a(document.activeElement),d=this.modal.find(k.CAN_RECEIVE_FOCUS),e=d.first(),f=d.last();c.is(e)&&b.shiftKey?(f.focus(),b.preventDefault()):c.is(f)&&!b.shiftKey&&(e.focus(),b.preventDefault())}},n.prototype.registerEventListeners=function(){this.getRoot().on("keydown",function(a){this.isVisible()&&(a.keyCode==d.tab?this.handleTabLock(a):a.keyCode==d.escape&&this.hide())}.bind(this)),e.define(this.getModal(),[e.events.activate]),this.getModal().on(e.events.activate,k.HIDE,function(a,b){this.hide(),b.originalEvent.preventDefault()}.bind(this))},n.prototype.asyncSet=function(b,d){var e=b;return"object"==typeof b&&b.hasOwnProperty("then")||(e=a.Deferred(),e.resolve(b)),e.then(function(a){d(a)}).fail(c.exception),e},n});
define('core/modal_save_cancel', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={SAVE_BUTTON:'[data-action="save"]',CANCEL_BUTTON:'[data-action="cancel"]'},g=function(a){d.call(this,a),this.getFooter().find(f.SAVE_BUTTON).length||b.exception({message:"No save button found"}),this.getFooter().find(f.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a save cancel modal"})},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.SAVE_BUTTON,function(b,c){var d=a.Event(e.save);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,f.CANCEL_BUTTON,function(b,c){var d=a.Event(e.cancel);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g.prototype.setSaveButtonText=function(a){var b=this.getFooter().find(f.SAVE_BUTTON);this.asyncSet(a,b.text.bind(b))},g});
define('core/chart_pie', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype.TYPE="pie",b.prototype._doughnut=null,b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setDoughnut(c.doughnut),d},b.prototype.addSeries=function(b){if(null===b.getColor()){for(var c=[],d=this.getConfigColorSet()||a.prototype.COLORSET,e=0;e<b.getCount();e++)c.push(d[e%d.length]);b.setColors(c)}return a.prototype.addSeries.apply(this,arguments)},b.prototype.getDoughnut=function(){return this._doughnut},b.prototype.setDoughnut=function(a){this._doughnut=Boolean(a)},b.prototype._validateSeries=function(){if(this._series.length>=1)throw new Error("Pie charts only support one serie.");return a.prototype._validateSeries.apply(this,arguments)},b});
define('core/user_date', ["jquery","core/ajax","core/sessionstorage","core/config"],function(a,b,c,d){var e={},f=function(b){var c=a("html").attr("lang").replace(/-/g,"_");return"core_user_date/"+c+"/"+d.usertimezone+"/"+b.timestamp+"/"+b.format},g=function(a){return c.get(a)},h=function(a,b){c.set(a,b)},i=function(a){return"undefined"!=typeof e[a]},j=function(a){return e[a]},k=function(a,b){e[a]=b},l=function(a){var c=a.map(function(a){return{timestamp:a.timestamp,format:a.format}}),e={methodname:"core_get_user_dates",args:{contextid:d.contextid,timestamps:c}};return b.call([e],!0,!0)[0].then(function(b){b.dates.forEach(function(b,c){var d=a[c],e=f(d);h(e,b),d.deferred.resolve(b)})})["catch"](function(b){a.forEach(function(a){a.deferred.reject(b)})})},m=function(b){var c=[],d=[];return b.forEach(function(b){var e=f(b);if(i(e))d.push(j(e));else{var h=a.Deferred(),l=g(e);l?h.resolve(l):(b.deferred=h,c.push(b)),k(e,h.promise()),d.push(h.promise())}}),c.length&&l(c),a.when.apply(a,d).then(function(){return 1===arguments.length?[arguments[0]]:Array.apply(null,arguments)})};return{get:m}});
define('core/chart_output_chartjs', ["jquery","core/chartjs","core/chart_axis","core/chart_bar","core/chart_output_base","core/chart_line","core/chart_pie","core/chart_series"],function(a,b,c,d,e,f,g,h){function i(){e.prototype.constructor.apply(this,arguments),this._canvas=this._node,"CANVAS"!=this._canvas.prop("tagName")&&(this._canvas=a("<canvas>"),this._node.append(this._canvas)),this._build()}var j=function(a,b){return"axis-"+a+"-"+b};return i.prototype=Object.create(e.prototype),i.prototype._config=null,i.prototype._chartjs=null,i.prototype._canvas=null,i.prototype._build=function(){this._config=this._makeConfig(),this._chartjs=new b(this._canvas[0],this._config)},i.prototype._cleanData=function(b){return b instanceof Array?b.map(function(b){return a("<span>").html(b).text()}):a("<span>").html(b).text()},i.prototype._getChartType=function(){var a=this._chart.getType();return this._chart.getType()===d.prototype.TYPE&&this._chart.getHorizontal()===!0?a="horizontalBar":this._chart.getType()===g.prototype.TYPE&&this._chart.getDoughnut()===!0&&(a="doughnut"),a},i.prototype._makeAxisConfig=function(a,b,d){var e={id:j(b,d)};return a.getPosition()!==c.prototype.POS_DEFAULT&&(e.position=a.getPosition()),null!==a.getLabel()&&(e.scaleLabel={display:!0,labelString:this._cleanData(a.getLabel())}),null!==a.getStepSize()&&(e.ticks=e.ticks||{},e.ticks.stepSize=a.getStepSize()),null!==a.getMax()&&(e.ticks=e.ticks||{},e.ticks.max=a.getMax()),null!==a.getMin()&&(e.ticks=e.ticks||{},e.ticks.min=a.getMin()),e},i.prototype._makeConfig=function(){var a={type:this._getChartType(),data:{labels:this._cleanData(this._chart.getLabels()),datasets:this._makeDatasetsConfig()},options:{title:{display:null!==this._chart.getTitle(),text:this._cleanData(this._chart.getTitle())}}};return this._chart.getXAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{},a.options.scales.xAxes=a.options.scales.xAxes||[],a.options.scales.xAxes[c]=this._makeAxisConfig(b,"x",c),null!==d&&(a.options.scales.xAxes[c].ticks.callback=function(a,b){return d[b]||""}),a.options.scales.xAxes[c].stacked=this._isStacked()}.bind(this)),this._chart.getYAxes().forEach(function(b,c){var d=b.getLabels();a.options.scales=a.options.scales||{},a.options.scales.yAxes=a.options.scales.yAxes||[],a.options.scales.yAxes[c]=this._makeAxisConfig(b,"y",c),null!==d&&(a.options.scales.yAxes[c].ticks.callback=function(a){return d[parseInt(a,10)]||""}),a.options.scales.yAxes[c].stacked=this._isStacked()}.bind(this)),a.options.tooltips={callbacks:{label:this._makeTooltip.bind(this)}},a},i.prototype._makeDatasetsConfig=function(){var a=this._chart.getSeries().map(function(a){var b=a.hasColoredValues()?a.getColors():a.getColor(),c={label:this._cleanData(a.getLabel()),data:a.getValues(),type:a.getType(),fill:!1,backgroundColor:b,borderColor:this._chart.getType()==g.prototype.TYPE?"#fff":b,lineTension:this._isSmooth(a)?.3:0};return null!==a.getXAxis()&&(c.xAxisID=j("x",a.getXAxis())),null!==a.getYAxis()&&(c.yAxisID=j("y",a.getYAxis())),c}.bind(this));return a},i.prototype._makeTooltip=function(a,b){var c=this._chart.getSeries()[a.datasetIndex],d=c.getLabel(),e=c.getLabels(),f=b.datasets[a.datasetIndex].data,g=f[a.index],h=[];if(""==a.xLabel&&""==a.yLabel){var i=this._cleanData(this._chart.getLabels());h.push(i[a.index])}return null!==e?h.push(this._cleanData(e[a.index])):h.push(this._cleanData(d)+": "+g),h},i.prototype._isSmooth=function(a){var b=!1;return this._chart.getType()===f.prototype.TYPE?(b=a.getSmooth(),null===b&&(b=this._chart.getSmooth())):a.getType()===h.prototype.TYPE_LINE&&(b=a.getSmooth()),b},i.prototype._isStacked=function(){var a=!1;return this._chart.getType()===d.prototype.TYPE&&(a=this._chart.getStacked()),a},i.prototype.update=function(){a.extend(!0,this._config,this._makeConfig()),this._chartjs.update()},i});
define('core/modal_cancel', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events"],function(a,b,c,d,e){var f={CANCEL_BUTTON:'[data-action="cancel"]'},g=function(a){d.call(this,a),this.getFooter().find(f.CANCEL_BUTTON).length||b.exception({message:"No cancel button found"})};return g.prototype=Object.create(d.prototype),g.prototype.constructor=g,g.prototype.setFooter=function(){b.exception({message:"Can not change the footer of a cancel modal"})},g.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,f.CANCEL_BUTTON,function(b,c){var d=a.Event(e.cancel);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g});
define('core/first', ["jquery"],function(a){a(document).bind("ajaxStart",function(){M.util.js_pending("jq")}).bind("ajaxStop",function(){M.util.js_complete("jq")})});
define('core/chart_axis', [],function(){function a(){}return a.prototype.POS_DEFAULT=null,a.prototype.POS_BOTTOM="bottom",a.prototype.POS_LEFT="left",a.prototype.POS_RIGHT="right",a.prototype.POS_TOP="top",a.prototype._label=null,a.prototype._labels=null,a.prototype._max=null,a.prototype._min=null,a.prototype._position=null,a.prototype._stepSize=null,a.prototype.create=function(b){var c=new a;return c.setPosition(b.position),c.setLabel(b.label),c.setStepSize(b.stepSize),c.setMax(b.max),c.setMin(b.min),c.setLabels(b.labels),c},a.prototype.getLabel=function(){return this._label},a.prototype.getLabels=function(){return this._labels},a.prototype.getMax=function(){return this._max},a.prototype.getMin=function(){return this._min},a.prototype.getPosition=function(){return this._position},a.prototype.getStepSize=function(){return this._stepSize},a.prototype.setLabel=function(a){this._label=a||null},a.prototype.setLabels=function(a){this._labels=a||null,null===this._labels||null!==this._stepSize||null!==this._min&&0!==this._min||null!==this._max||(this.setStepSize(1),this.setMin(0),this.setMax(a.length-1))},a.prototype.setMax=function(a){this._max="undefined"!=typeof a?a:null},a.prototype.setMin=function(a){this._min="undefined"!=typeof a?a:null},a.prototype.setPosition=function(a){if(a!=this.POS_DEFAULT&&a!=this.POS_BOTTOM&&a!=this.POS_LEFT&&a!=this.POS_RIGHT&&a!=this.POS_TOP)throw new Error("Invalid axis position.");this._position=a},a.prototype.setStepSize=function(a){if("undefined"==typeof a||null===a)a=null;else{if(isNaN(Number(a)))throw new Error("Value for stepSize is not a number.");a=Number(a)}this._stepSize=a},a});
define('core/modal_registry', ["core/notification"],function(a){var b={},c=function(a){return b[a]},d=function(d,e,f){c(d)&&a.exception({message:"Modal of  type '"+d+"' is already registered"}),e&&"function"==typeof e||a.exception({message:"You must provide a modal module"}),f||a.exception({message:"You must provide a modal template"}),b[d]={module:e,template:f}};return{register:d,get:c}});
define('core/modal_events', [],function(){return{shown:"modal:shown",hidden:"modal:hidden",destroyed:"modal:destroyed",bodyRendered:"modal:bodyRendered",save:"modal-save-cancel:save",cancel:"modal-save-cancel:cancel",yes:"modal-save-cancel:save",no:"modal-save-cancel:cancel"}});
define('core/paged_content_pages', ["jquery","core/templates","core/notification","core/paged_content_events"],function(a,b,c,d){var e={ROOT:'[data-region="page-container"]',PAGE_REGION:'[data-region="paged-content-page"]',ACTIVE_PAGE_REGION:'[data-region="paged-content-page"].active'},f={PAGING_CONTENT_ITEM:"core/paged_content_page",LOADING:"core/overlay_loading"},g=function(a,b){return a.find('[data-page="'+b+'"]')},h=function(d){var e=a.Deferred();return b.render(f.LOADING,{visible:!0}).then(function(b){var c=a(b),f=setTimeout(function(){d.css("position","relative"),c.appendTo(d)},100);e.always(function(){clearTimeout(f),c.remove(),d.css("position","")})}).fail(c.exception),e},i=function(d,e,h){var i=a.Deferred();return e.then(function(a,e){b.render(f.PAGING_CONTENT_ITEM,{page:h,content:a}).then(function(a){b.appendNodeContents(d,a,e);var c=g(d,h);i.resolve(c)}).fail(function(a){i.reject(a)}).fail(c.exception)}).fail(function(a){i.reject(a)}).fail(c.exception),i},j=function(b,d,f){var j=[],k=[],l=a.Deferred();if(d.forEach(function(a){var c=a.pageNumber,d=g(b,c);d.length?j.push(d):k.push(a)}),k.length&&"function"==typeof f){var m=f(k),n=m.map(function(a,c){return i(b,a,k[c].pageNumber)});a.when.apply(a,n).then(function(){var a=Array.prototype.slice.call(arguments);l.resolve(a)}).fail(function(a){l.reject(a)}).fail(c.exception)}else l.resolve([]);var o=h(b);l.then(function(a){var c=j.concat(a);b.find(e.PAGE_REGION).addClass("hidden"),c.forEach(function(a){a.removeClass("hidden")})}).fail(c.exception).always(function(){o.resolve()})},k=function(b,c,e){b=a(b),c=a(c),c.on(d.SHOW_PAGES,function(a,c){j(b,c,e)})};return{init:k,rootSelector:e.ROOT}});
!function(a,b){"object"==typeof exports&&exports&&"string"!=typeof exports.nodeName?b(exports):"function"==typeof define&&define.amd?define('core/mustache', ["exports"],b):(a.Mustache={},b(a.Mustache))}(this,function(a){function b(a){return"function"==typeof a}function c(a){return p(a)?"array":typeof a}function d(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function e(a,b){return null!=a&&"object"==typeof a&&b in a}function f(a,b){return q.call(a,b)}function g(a){return!f(r,a)}function h(a){return String(a).replace(/[&<>"'`=\/]/g,function(a){return s[a]})}function i(b,c){function e(){if(r&&!s)for(;q.length;)delete o[q.pop()];else q=[];r=!1,s=!1}function f(a){if("string"==typeof a&&(a=a.split(u,2)),!p(a)||2!==a.length)throw new Error("Invalid tags: "+a);h=new RegExp(d(a[0])+"\\s*"),i=new RegExp("\\s*"+d(a[1])),m=new RegExp("\\s*"+d("}"+a[1]))}if(!b)return[];var h,i,m,n=[],o=[],q=[],r=!1,s=!1;f(c||a.tags);for(var y,z,A,B,C,D,E=new l(b);!E.eos();){if(y=E.pos,A=E.scanUntil(h))for(var F=0,G=A.length;F<G;++F)B=A.charAt(F),g(B)?q.push(o.length):s=!0,o.push(["text",B,y,y+1]),y+=1,"\n"===B&&e();if(!E.scan(h))break;if(r=!0,z=E.scan(x)||"name",E.scan(t),"="===z?(A=E.scanUntil(v),E.scan(v),E.scanUntil(i)):"{"===z?(A=E.scanUntil(m),E.scan(w),E.scanUntil(i),z="&"):A=E.scanUntil(i),!E.scan(i))throw new Error("Unclosed tag at "+E.pos);if(C=[z,A,y,E.pos],o.push(C),"#"===z||"^"===z||"$"===z||"<"===z)n.push(C);else if("/"===z){if(D=n.pop(),!D)throw new Error('Unopened section "'+A+'" at '+y);if(D[1]!==A)throw new Error('Unclosed section "'+D[1]+'" at '+y)}else"name"===z||"{"===z||"&"===z?s=!0:"="===z&&f(A)}if(D=n.pop())throw new Error('Unclosed section "'+D[1]+'" at '+E.pos);return k(j(o))}function j(a){for(var b,c,d=[],e=0,f=a.length;e<f;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function k(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;g<h;++g)switch(b=a[g],b[0]){case"$":case"<":case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function l(a){this.string=a,this.tail=a,this.pos=0}function m(a,b){this.view=a,this.blocks={},this.cache={".":this.view},this.parent=b}function n(){this.cache={}}var o=Object.prototype.toString,p=Array.isArray||function(a){return"[object Array]"===o.call(a)},q=RegExp.prototype.test,r=/\S/,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},t=/\s*/,u=/\s+/,v=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!|\$|</;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c},l.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},m.prototype.push=function(a){return new m(a,this)},m.prototype.setBlockVar=function(a,b){var c=this.blocks;return c[a]=b,b},m.prototype.clearBlockVars=function(){this.blocks={}},m.prototype.getBlockVar=function(a){var b,c=this.blocks;return c.hasOwnProperty(a)?b=c[a]:this.parent&&(b=this.parent.getBlockVar(a)),b},m.prototype.lookup=function(a){var c,d=this.cache;if(d.hasOwnProperty(a))c=d[a];else{for(var f,g,h=this,i=!1;h;){if(a.indexOf(".")>0)for(c=h.view,f=a.split("."),g=0;null!=c&&g<f.length;)g===f.length-1&&(i=e(c,f[g])),c=c[f[g++]];else c=h.view[a],i=e(h.view,a);if(i)break;h=h.parent}d[a]=c}return b(c)&&(c=c.call(this.view)),c},n.prototype.clearCache=function(){this.cache={}},n.prototype.parse=function(b,c){var d=this.cache,e=d[b];return null==e&&(e=d[b+":"+(c||a.tags).join(":")]=i(b,c)),e},n.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof m?b:new m(b);return this.renderTokens(d,e,c,a)},n.prototype.renderTokens=function(a,b,c,d){for(var e,f,g,h="",i=0,j=a.length;i<j;++i)g=void 0,e=a[i],f=e[0],"#"===f?g=this.renderSection(e,b,c,d):"^"===f?g=this.renderInverted(e,b,c,d):">"===f?g=this.renderPartial(e,b,c,d):"<"===f?g=this.renderBlock(e,b,c,d):"$"===f?g=this.renderBlockVariable(e,b,c,d):"&"===f?g=this.unescapedValue(e,b):"name"===f?g=this.escapedValue(e,b):"text"===f&&(g=this.rawValue(e)),void 0!==g&&(h+=g);return h},n.prototype.renderSection=function(a,c,d,e){function f(a){return g.render(a,c,d)}var g=this,h="",i=c.lookup(a[1]);if(i){if(p(i))for(var j=0,k=i.length;j<k;++j)h+=this.renderTokens(a[4],c.push(i[j]),d,e);else if("object"==typeof i||"string"==typeof i||"number"==typeof i)h+=this.renderTokens(a[4],c.push(i),d,e);else if(b(i)){if("string"!=typeof e)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,e.slice(a[3],a[5]),f),null!=i&&(h+=i)}else h+=this.renderTokens(a[4],c,d,e);return h}},n.prototype.renderInverted=function(a,b,c,d){var e=b.lookup(a[1]);if(!e||p(e)&&0===e.length)return this.renderTokens(a[4],b,c,d)},n.prototype.renderPartial=function(a,c,d){if(d){var e=b(d)?d(a[1]):d[a[1]];return null!=e?this.renderTokens(this.parse(e),c,d,e):void 0}},n.prototype.renderBlock=function(a,c,d,e){if(d){var f=b(d)?d(a[1]):d[a[1]];null!=f&&c.clearBlockVars(),this.renderTokens(a[4],c,d,e);var g=this.renderTokens(this.parse(f),c,d,f);return c.clearBlockVars(),g}},n.prototype.renderBlockVariable=function(a,b,c,d){var e=a[1],f=b.getBlockVar(e);return f?this.renderTokens(this.parse(f),b,c,f):(b.setBlockVar(e,d.slice(a[3],a[5])),this.renderTokens(a[4],b,c,d))},n.prototype.unescapedValue=function(a,b){var c=b.lookup(a[1]);if(null!=c)return c},n.prototype.escapedValue=function(b,c){var d=c.lookup(b[1]);if(null!=d)return a.escape(d)},n.prototype.rawValue=function(a){return a[1]},a.name="mustache.js",a.version="2.3.0",a.tags=["{{","}}"];var y=new n;return a.clearCache=function(){return y.clearCache()},a.parse=function(a,b){return y.parse(a,b)},a.render=function(a,b,d){if("string"!=typeof a)throw new TypeError('Invalid template! Template should be a "string" but "'+c(a)+'" was given as the first argument for mustache#render(template, view, partials)');return y.render(a,b,d)},a.to_html=function(c,d,e,f){var g=a.render(c,d,e);return b(f)?void f(g):g},a.escape=h,a.Scanner=l,a.Context=m,a.Writer=n,a});
define('core/chart_base', ["core/chart_series","core/chart_axis"],function(a,b){function c(){this._series=[],this._labels=[],this._xaxes=[],this._yaxes=[],this._setDefaults()}return c.prototype._series=null,c.prototype._labels=null,c.prototype._title=null,c.prototype._xaxes=null,c.prototype._yaxes=null,c.prototype.COLORSET=["#f3c300","#875692","#f38400","#a1caf1","#be0032","#c2b280","#7f180d","#008856","#e68fac","#0067a5"],c.prototype._configColorSet=null,c.prototype.TYPE=null,c.prototype.addSeries=function(a){if(this._validateSeries(a),this._series.push(a),null===a.getColor()){var b=this.getConfigColorSet()||c.prototype.COLORSET;a.setColor(b[this._series.length%b.length])}},c.prototype.create=function(c,d){var e=new c;return e.setConfigColorSet(d.config_colorset),e.setLabels(d.labels),e.setTitle(d.title),d.series.forEach(function(b){e.addSeries(a.prototype.create(b))}),d.axes.x.forEach(function(a,c){e.setXAxis(b.prototype.create(a),c)}),d.axes.y.forEach(function(a,c){e.setYAxis(b.prototype.create(a),c)}),e},c.prototype.__getAxis=function(a,c,d){var e,f="x"===a?this._xaxes:this._yaxes,g=("x"===a?this.setXAxis:this.setYAxis).bind(this);if(c="undefined"==typeof c?0:c,d="undefined"!=typeof d&&d,e=f[c],"undefined"==typeof e){if(!d)throw new Error("Unknown axis.");e=new b,g(e,c)}return e},c.prototype.getConfigColorSet=function(){return this._configColorSet},c.prototype.getLabels=function(){return this._labels},c.prototype.getSeries=function(){return this._series},c.prototype.getTitle=function(){return this._title},c.prototype.getType=function(){if(!this.TYPE)throw new Error("The TYPE property has not been set.");return this.TYPE},c.prototype.getXAxes=function(){return this._xaxes},c.prototype.getXAxis=function(a,b){return this.__getAxis("x",a,b)},c.prototype.getYAxes=function(){return this._yaxes},c.prototype.getYAxis=function(a,b){return this.__getAxis("y",a,b)},c.prototype.setConfigColorSet=function(a){this._configColorSet=a},c.prototype._setDefaults=function(){},c.prototype.setLabels=function(a){if(a.length&&this._series.length&&this._series[0].length!=a.length)throw new Error("Series must match label values.");this._labels=a},c.prototype.setTitle=function(a){this._title=a},c.prototype.setXAxis=function(a,b){b="undefined"==typeof b?0:b,this._validateAxis("x",a,b),this._xaxes[b]=a},c.prototype.setYAxis=function(a,b){b="undefined"==typeof b?0:b,this._validateAxis("y",a,b),this._yaxes[b]=a},c.prototype._validateAxis=function(a,b,c){if(c="undefined"==typeof c?0:c,c>0){var d="x"==a?this._xaxes:this._yaxes;if("undefined"==typeof d[c-1])throw new Error("Missing "+a+" axis at index lower than "+c)}},c.prototype._validateSeries=function(a){if(this._series.length&&this._series[0].getCount()!=a.getCount())throw new Error("Series do not have an equal number of values.");if(this._labels.length&&this._labels.length!=a.getCount())throw new Error("Series must match label values.")},c});
define('core/search-input', ["jquery"],function(a){var b=null,c=function(a){b.hasClass("expanded")?e():d(a)},d=function(c){var d=a(document).width();if("keydown"!==c.type||13===c.keyCode||32===c.keyCode)return d<=767&&("click"===c.type||"keydown"===c.type)?void f():void(d<=767||("keydown"===c.type&&c.preventDefault(),b.addClass("expanded"),b.find("form").addClass("expanded"),b.find("input").focus()))},e=function(){b.removeClass("expanded"),b.find("form").removeClass("expanded")},f=function(){b.find("form").submit()};return{init:function(d){b=a("#"+d),b.on("click mouseover keydown","div",c)}}});
define('core/chart_line', ["core/chart_base"],function(a){function b(){a.prototype.constructor.apply(this,arguments)}return b.prototype=Object.create(a.prototype),b.prototype.TYPE="line",b.prototype._smooth=!1,b.prototype.create=function(b,c){var d=a.prototype.create.apply(this,arguments);return d.setSmooth(c.smooth),d},b.prototype.getSmooth=function(){return this._smooth},b.prototype.setSmooth=function(a){this._smooth=Boolean(a)},b});
define('core/tooltip', ["jquery"],function(a){var b=function(b){this._regionSelector=b,a(this._regionSelector).each(function(b,c){var d=a(c).attr("aria-describedby");if(d){var e=document.getElementById(d);if(e){var f="tooltip"==a(e).attr("role");f&&(a(e).hide(),a(c).attr("tabindex","0")),a(c).on("focus",this._handleFocus.bind(this)),a(c).on("mouseover",this._handleMouseOver.bind(this)),a(c).on("mouseout",this._handleMouseOut.bind(this)),a(c).on("blur",this._handleBlur.bind(this)),a(c).on("keydown",this._handleKeyDown.bind(this))}}}.bind(this))};return b.prototype._regionSelector=null,b.prototype._showTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=a(document.getElementById(d));if(e.show(),e.attr("aria-hidden","false"),!e.is(".tooltip")){var f=a('<div class="tooltip-inner"></div>');f.append(e.contents()),e.append(f),e.addClass("tooltip"),e.addClass("bottom"),e.append('<div class="tooltip-arrow"></div>')}var g=c.offset();g.top+=c.height()+10,a(e).offset(g)}},b.prototype._hideTooltip=function(b){var c=a(b.target),d=c.attr("aria-describedby");if(d){var e=document.getElementById(d);a(e).hide(),a(e).attr("aria-hidden","true")}},b.prototype._handleFocus=function(a){this._showTooltip(a)},b.prototype._handleKeyDown=function(a){27==a.which&&this._hideTooltip(a)},b.prototype._handleMouseOver=function(a){this._showTooltip(a)},b.prototype._handleMouseOut=function(b){var c=a(b.target);c.is(":focus")||this._hideTooltip(b)},b.prototype._handleBlur=function(a){this._hideTooltip(a)},b});
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define('core/popper', b):a.Popper=b()}(this,function(){"use strict";function a(a){var b=!1;return function(){b||(b=!0,Promise.resolve().then(function(){b=!1,a()}))}}function b(a){var b=!1;return function(){b||(b=!0,setTimeout(function(){b=!1,a()},ha))}}function c(a){var b={};return a&&"[object Function]"===b.toString.call(a)}function d(a,b){if(1!==a.nodeType)return[];var c=window.getComputedStyle(a,null);return b?c[b]:c}function e(a){return"HTML"===a.nodeName?a:a.parentNode||a.host}function f(a){if(!a)return window.document.body;switch(a.nodeName){case"HTML":case"BODY":return a.ownerDocument.body;case"#document":return a.body}var b=d(a),c=b.overflow,g=b.overflowX,h=b.overflowY;return/(auto|scroll)/.test(c+h+g)?a:f(e(a))}function g(a){var b=a&&a.offsetParent,c=b&&b.nodeName;return c&&"BODY"!==c&&"HTML"!==c?["TD","TABLE"].indexOf(b.nodeName)!==-1&&"static"===d(b,"position")?g(b):b:a?a.ownerDocument.documentElement:window.document.documentElement}function h(a){var b=a.nodeName;return"BODY"!==b&&("HTML"===b||g(a.firstElementChild)===a)}function i(a){return null!==a.parentNode?i(a.parentNode):a}function j(a,b){if(!(a&&a.nodeType&&b&&b.nodeType))return window.document.documentElement;var c=a.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_FOLLOWING,d=c?a:b,e=c?b:a,f=document.createRange();f.setStart(d,0),f.setEnd(e,0);var k=f.commonAncestorContainer;if(a!==k&&b!==k||d.contains(e))return h(k)?k:g(k);var l=i(a);return l.host?j(l.host,b):j(a,i(b).host)}function k(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",c="top"===b?"scrollTop":"scrollLeft",d=a.nodeName;if("BODY"===d||"HTML"===d){var e=a.ownerDocument.documentElement,f=a.ownerDocument.scrollingElement||e;return f[c]}return a[c]}function l(a,b){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=k(b,"top"),e=k(b,"left"),f=c?-1:1;return a.top+=d*f,a.bottom+=d*f,a.left+=e*f,a.right+=e*f,a}function m(a,b){var c="x"===b?"Left":"Top",d="Left"===c?"Right":"Bottom";return+a["border"+c+"Width"].split("px")[0]+ +a["border"+d+"Width"].split("px")[0]}function n(a,b,c,d){return Math.max(b["offset"+a],b["scroll"+a],c["client"+a],c["offset"+a],c["scroll"+a],ma()?c["offset"+a]+d["margin"+("Height"===a?"Top":"Left")]+d["margin"+("Height"===a?"Bottom":"Right")]:0)}function o(){var a=window.document.body,b=window.document.documentElement,c=ma()&&window.getComputedStyle(b);return{height:n("Height",a,b,c),width:n("Width",a,b,c)}}function p(a){return qa({},a,{right:a.left+a.width,bottom:a.top+a.height})}function q(a){var b={};if(ma())try{b=a.getBoundingClientRect();var c=k(a,"top"),e=k(a,"left");b.top+=c,b.left+=e,b.bottom+=c,b.right+=e}catch(f){}else b=a.getBoundingClientRect();var g={left:b.left,top:b.top,width:b.right-b.left,height:b.bottom-b.top},h="HTML"===a.nodeName?o():{},i=h.width||a.clientWidth||g.right-g.left,j=h.height||a.clientHeight||g.bottom-g.top,l=a.offsetWidth-i,n=a.offsetHeight-j;if(l||n){var q=d(a);l-=m(q,"x"),n-=m(q,"y"),g.width-=l,g.height-=n}return p(g)}function r(a,b){var c=ma(),e="HTML"===b.nodeName,g=q(a),h=q(b),i=f(a),j=d(b),k=+j.borderTopWidth.split("px")[0],m=+j.borderLeftWidth.split("px")[0],n=p({top:g.top-h.top-k,left:g.left-h.left-m,width:g.width,height:g.height});if(n.marginTop=0,n.marginLeft=0,!c&&e){var o=+j.marginTop.split("px")[0],r=+j.marginLeft.split("px")[0];n.top-=k-o,n.bottom-=k-o,n.left-=m-r,n.right-=m-r,n.marginTop=o,n.marginLeft=r}return(c?b.contains(i):b===i&&"BODY"!==i.nodeName)&&(n=l(n,b)),n}function s(a){var b=a.ownerDocument.documentElement,c=r(a,b),d=Math.max(b.clientWidth,window.innerWidth||0),e=Math.max(b.clientHeight,window.innerHeight||0),f=k(b),g=k(b,"left"),h={top:f-c.top+c.marginTop,left:g-c.left+c.marginLeft,width:d,height:e};return p(h)}function t(a){var b=a.nodeName;return"BODY"!==b&&"HTML"!==b&&("fixed"===d(a,"position")||t(e(a)))}function u(a,b,c,d){var g={top:0,left:0},h=j(a,b);if("viewport"===d)g=s(h);else{var i=void 0;"scrollParent"===d?(i=f(e(a)),"BODY"===i.nodeName&&(i=a.ownerDocument.documentElement)):i="window"===d?a.ownerDocument.documentElement:d;var k=r(i,h);if("HTML"!==i.nodeName||t(h))g=k;else{var l=o(),m=l.height,n=l.width;g.top+=k.top-k.marginTop,g.bottom=m+k.top,g.left+=k.left-k.marginLeft,g.right=n+k.left}}return g.left+=c,g.top+=c,g.right-=c,g.bottom-=c,g}function v(a){var b=a.width,c=a.height;return b*c}function w(a,b,c,d,e){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(a.indexOf("auto")===-1)return a;var g=u(c,d,f,e),h={top:{width:g.width,height:b.top-g.top},right:{width:g.right-b.right,height:g.height},bottom:{width:g.width,height:g.bottom-b.bottom},left:{width:b.left-g.left,height:g.height}},i=Object.keys(h).map(function(a){return qa({key:a},h[a],{area:v(h[a])})}).sort(function(a,b){return b.area-a.area}),j=i.filter(function(a){var b=a.width,d=a.height;return b>=c.clientWidth&&d>=c.clientHeight}),k=j.length>0?j[0].key:i[0].key,l=a.split("-")[1];return k+(l?"-"+l:"")}function x(a,b,c){var d=j(b,c);return r(c,d)}function y(a){var b=window.getComputedStyle(a),c=parseFloat(b.marginTop)+parseFloat(b.marginBottom),d=parseFloat(b.marginLeft)+parseFloat(b.marginRight),e={width:a.offsetWidth+d,height:a.offsetHeight+c};return e}function z(a){var b={left:"right",right:"left",bottom:"top",top:"bottom"};return a.replace(/left|right|bottom|top/g,function(a){return b[a]})}function A(a,b,c){c=c.split("-")[0];var d=y(a),e={width:d.width,height:d.height},f=["right","left"].indexOf(c)!==-1,g=f?"top":"left",h=f?"left":"top",i=f?"height":"width",j=f?"width":"height";return e[g]=b[g]+b[i]/2-d[i]/2,c===h?e[h]=b[h]-d[j]:e[h]=b[z(h)],e}function B(a,b){return Array.prototype.find?a.find(b):a.filter(b)[0]}function C(a,b,c){if(Array.prototype.findIndex)return a.findIndex(function(a){return a[b]===c});var d=B(a,function(a){return a[b]===c});return a.indexOf(d)}function D(a,b,d){var e=void 0===d?a:a.slice(0,C(a,"name",d));return e.forEach(function(a){a["function"]&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var d=a["function"]||a.fn;a.enabled&&c(d)&&(b.offsets.popper=p(b.offsets.popper),b.offsets.reference=p(b.offsets.reference),b=d(b,a))}),b}function E(){if(!this.state.isDestroyed){var a={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};a.offsets.reference=x(this.state,this.popper,this.reference),a.placement=w(this.options.placement,a.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),a.originalPlacement=a.placement,a.offsets.popper=A(this.popper,a.offsets.reference,a.placement),a.offsets.popper.position="absolute",a=D(this.modifiers,a),this.state.isCreated?this.options.onUpdate(a):(this.state.isCreated=!0,this.options.onCreate(a))}}function F(a,b){return a.some(function(a){var c=a.name,d=a.enabled;return d&&c===b})}function G(a){for(var b=[!1,"ms","Webkit","Moz","O"],c=a.charAt(0).toUpperCase()+a.slice(1),d=0;d<b.length-1;d++){var e=b[d],f=e?""+e+c:a;if("undefined"!=typeof window.document.body.style[f])return f}return null}function H(){return this.state.isDestroyed=!0,F(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[G("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function I(a){var b=a.ownerDocument;return b?b.defaultView:window}function J(a,b,c,d){var e="BODY"===a.nodeName,g=e?a.ownerDocument.defaultView:a;g.addEventListener(b,c,{passive:!0}),e||J(f(g.parentNode),b,c,d),d.push(g)}function K(a,b,c,d){c.updateBound=d,I(a).addEventListener("resize",c.updateBound,{passive:!0});var e=f(a);return J(e,"scroll",c.updateBound,c.scrollParents),c.scrollElement=e,c.eventsEnabled=!0,c}function L(){this.state.eventsEnabled||(this.state=K(this.reference,this.options,this.state,this.scheduleUpdate))}function M(a,b){return I(a).removeEventListener("resize",b.updateBound),b.scrollParents.forEach(function(a){a.removeEventListener("scroll",b.updateBound)}),b.updateBound=null,b.scrollParents=[],b.scrollElement=null,b.eventsEnabled=!1,b}function N(){this.state.eventsEnabled&&(window.cancelAnimationFrame(this.scheduleUpdate),this.state=M(this.reference,this.state))}function O(a){return""!==a&&!isNaN(parseFloat(a))&&isFinite(a)}function P(a,b){Object.keys(b).forEach(function(c){var d="";["width","height","top","right","bottom","left"].indexOf(c)!==-1&&O(b[c])&&(d="px"),a.style[c]=b[c]+d})}function Q(a,b){Object.keys(b).forEach(function(c){var d=b[c];d!==!1?a.setAttribute(c,b[c]):a.removeAttribute(c)})}function R(a){return P(a.instance.popper,a.styles),Q(a.instance.popper,a.attributes),a.arrowElement&&Object.keys(a.arrowStyles).length&&P(a.arrowElement,a.arrowStyles),a}function S(a,b,c,d,e){var f=x(e,b,a),g=w(c.placement,f,b,a,c.modifiers.flip.boundariesElement,c.modifiers.flip.padding);return b.setAttribute("x-placement",g),P(b,{position:"absolute"}),c}function T(a,b){var c=b.x,d=b.y,e=a.offsets.popper,f=B(a.instance.modifiers,function(a){return"applyStyle"===a.name}).gpuAcceleration;void 0!==f&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var h=void 0!==f?f:b.gpuAcceleration,i=g(a.instance.popper),j=q(i),k={position:e.position},l={left:Math.floor(e.left),top:Math.floor(e.top),bottom:Math.floor(e.bottom),right:Math.floor(e.right)},m="bottom"===c?"top":"bottom",n="right"===d?"left":"right",o=G("transform"),p=void 0,r=void 0;if(r="bottom"===m?-j.height+l.bottom:l.top,p="right"===n?-j.width+l.right:l.left,h&&o)k[o]="translate3d("+p+"px, "+r+"px, 0)",k[m]=0,k[n]=0,k.willChange="transform";else{var s="bottom"===m?-1:1,t="right"===n?-1:1;k[m]=r*s,k[n]=p*t,k.willChange=m+", "+n}var u={"x-placement":a.placement};return a.attributes=qa({},u,a.attributes),a.styles=qa({},k,a.styles),a.arrowStyles=qa({},a.offsets.arrow,a.arrowStyles),a}function U(a,b,c){var d=B(a,function(a){var c=a.name;return c===b}),e=!!d&&a.some(function(a){return a.name===c&&a.enabled&&a.order<d.order});if(!e){var f="`"+b+"`",g="`"+c+"`";console.warn(g+" modifier is required by "+f+" modifier in order to work, be sure to include it before "+f+"!")}return e}function V(a,b){if(!U(a.instance.modifiers,"arrow","keepTogether"))return a;var c=b.element;if("string"==typeof c){if(c=a.instance.popper.querySelector(c),!c)return a}else if(!a.instance.popper.contains(c))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),a;var e=a.placement.split("-")[0],f=a.offsets,g=f.popper,h=f.reference,i=["left","right"].indexOf(e)!==-1,j=i?"height":"width",k=i?"Top":"Left",l=k.toLowerCase(),m=i?"left":"top",n=i?"bottom":"right",o=y(c)[j];h[n]-o<g[l]&&(a.offsets.popper[l]-=g[l]-(h[n]-o)),h[l]+o>g[n]&&(a.offsets.popper[l]+=h[l]+o-g[n]);var q=h[l]+h[j]/2-o/2,r=d(a.instance.popper,"margin"+k).replace("px",""),s=q-p(a.offsets.popper)[l]-r;return s=Math.max(Math.min(g[j]-o,s),0),a.arrowElement=c,a.offsets.arrow={},a.offsets.arrow[l]=Math.round(s),a.offsets.arrow[m]="",a}function W(a){return"end"===a?"start":"start"===a?"end":a}function X(a){var b=arguments.length>1&&void 0!==arguments[1]&&arguments[1],c=sa.indexOf(a),d=sa.slice(c+1).concat(sa.slice(0,c));return b?d.reverse():d}function Y(a,b){if(F(a.instance.modifiers,"inner"))return a;if(a.flipped&&a.placement===a.originalPlacement)return a;var c=u(a.instance.popper,a.instance.reference,b.padding,b.boundariesElement),d=a.placement.split("-")[0],e=z(d),f=a.placement.split("-")[1]||"",g=[];switch(b.behavior){case ta.FLIP:g=[d,e];break;case ta.CLOCKWISE:g=X(d);break;case ta.COUNTERCLOCKWISE:g=X(d,!0);break;default:g=b.behavior}return g.forEach(function(h,i){if(d!==h||g.length===i+1)return a;d=a.placement.split("-")[0],e=z(d);var j=a.offsets.popper,k=a.offsets.reference,l=Math.floor,m="left"===d&&l(j.right)>l(k.left)||"right"===d&&l(j.left)<l(k.right)||"top"===d&&l(j.bottom)>l(k.top)||"bottom"===d&&l(j.top)<l(k.bottom),n=l(j.left)<l(c.left),o=l(j.right)>l(c.right),p=l(j.top)<l(c.top),q=l(j.bottom)>l(c.bottom),r="left"===d&&n||"right"===d&&o||"top"===d&&p||"bottom"===d&&q,s=["top","bottom"].indexOf(d)!==-1,t=!!b.flipVariations&&(s&&"start"===f&&n||s&&"end"===f&&o||!s&&"start"===f&&p||!s&&"end"===f&&q);(m||r||t)&&(a.flipped=!0,(m||r)&&(d=g[i+1]),t&&(f=W(f)),a.placement=d+(f?"-"+f:""),a.offsets.popper=qa({},a.offsets.popper,A(a.instance.popper,a.offsets.reference,a.placement)),a=D(a.instance.modifiers,a,"flip"))}),a}function Z(a){var b=a.offsets,c=b.popper,d=b.reference,e=a.placement.split("-")[0],f=Math.floor,g=["top","bottom"].indexOf(e)!==-1,h=g?"right":"bottom",i=g?"left":"top",j=g?"width":"height";return c[h]<f(d[i])&&(a.offsets.popper[i]=f(d[i])-c[j]),c[i]>f(d[h])&&(a.offsets.popper[i]=f(d[h])),a}function $(a,b,c,d){var e=a.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),f=+e[1],g=e[2];if(!f)return a;if(0===g.indexOf("%")){var h=void 0;switch(g){case"%p":h=c;break;case"%":case"%r":default:h=d}var i=p(h);return i[b]/100*f}if("vh"===g||"vw"===g){var j=void 0;return j="vh"===g?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),j/100*f}return f}function _(a,b,c,d){var e=[0,0],f=["right","left"].indexOf(d)!==-1,g=a.split(/(\+|\-)/).map(function(a){return a.trim()}),h=g.indexOf(B(g,function(a){return a.search(/,|\s/)!==-1}));g[h]&&g[h].indexOf(",")===-1&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var i=/\s*,\s*|\s+/,j=h!==-1?[g.slice(0,h).concat([g[h].split(i)[0]]),[g[h].split(i)[1]].concat(g.slice(h+1))]:[g];return j=j.map(function(a,d){var e=(1===d?!f:f)?"height":"width",g=!1;return a.reduce(function(a,b){return""===a[a.length-1]&&["+","-"].indexOf(b)!==-1?(a[a.length-1]=b,g=!0,a):g?(a[a.length-1]+=b,g=!1,a):a.concat(b)},[]).map(function(a){return $(a,e,b,c)})}),j.forEach(function(a,b){a.forEach(function(c,d){O(c)&&(e[b]+=c*("-"===a[d-1]?-1:1))})}),e}function aa(a,b){var c=b.offset,d=a.placement,e=a.offsets,f=e.popper,g=e.reference,h=d.split("-")[0],i=void 0;return i=O(+c)?[+c,0]:_(c,f,g,h),"left"===h?(f.top+=i[0],f.left-=i[1]):"right"===h?(f.top+=i[0],f.left+=i[1]):"top"===h?(f.left+=i[0],f.top-=i[1]):"bottom"===h&&(f.left+=i[0],f.top+=i[1]),a.popper=f,a}function ba(a,b){var c=b.boundariesElement||g(a.instance.popper);a.instance.reference===c&&(c=g(c));var d=u(a.instance.popper,a.instance.reference,b.padding,c);b.boundaries=d;var e=b.priority,f=a.offsets.popper,h={primary:function(a){var c=f[a];return f[a]<d[a]&&!b.escapeWithReference&&(c=Math.max(f[a],d[a])),pa({},a,c)},secondary:function(a){var c="right"===a?"left":"top",e=f[c];return f[a]>d[a]&&!b.escapeWithReference&&(e=Math.min(f[c],d[a]-("right"===a?f.width:f.height))),pa({},c,e)}};return e.forEach(function(a){var b=["left","top"].indexOf(a)!==-1?"primary":"secondary";f=qa({},f,h[b](a))}),a.offsets.popper=f,a}function ca(a){var b=a.placement,c=b.split("-")[0],d=b.split("-")[1];if(d){var e=a.offsets,f=e.reference,g=e.popper,h=["bottom","top"].indexOf(c)!==-1,i=h?"left":"top",j=h?"width":"height",k={start:pa({},i,f[i]),end:pa({},i,f[i]+f[j]-g[j])};a.offsets.popper=qa({},g,k[d])}return a}function da(a){if(!U(a.instance.modifiers,"hide","preventOverflow"))return a;var b=a.offsets.reference,c=B(a.instance.modifiers,function(a){return"preventOverflow"===a.name}).boundaries;if(b.bottom<c.top||b.left>c.right||b.top>c.bottom||b.right<c.left){if(a.hide===!0)return a;a.hide=!0,a.attributes["x-out-of-boundaries"]=""}else{if(a.hide===!1)return a;a.hide=!1,a.attributes["x-out-of-boundaries"]=!1}return a}function ea(a){var b=a.placement,c=b.split("-")[0],d=a.offsets,e=d.popper,f=d.reference,g=["left","right"].indexOf(c)!==-1,h=["top","left"].indexOf(c)===-1;return e[g?"left":"top"]=f[c]-(h?e[g?"width":"height"]:0),a.placement=z(b),a.offsets.popper=p(e),a}for(var fa="undefined"!=typeof window&&"undefined"!=typeof window.document,ga=["Edge","Trident","Firefox"],ha=0,ia=0;ia<ga.length;ia+=1)if(fa&&navigator.userAgent.indexOf(ga[ia])>=0){ha=1;break}var ja=fa&&window.Promise,ka=ja?a:b,la=void 0,ma=function(){return void 0===la&&(la=navigator.appVersion.indexOf("MSIE 10")!==-1),la},na=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},oa=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),pa=function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a},qa=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},ra=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],sa=ra.slice(3),ta={FLIP:"flip",CLOCKWISE:"clockwise",COUNTERCLOCKWISE:"counterclockwise"},ua={shift:{order:100,enabled:!0,fn:ca},offset:{order:200,enabled:!0,fn:aa,offset:0},preventOverflow:{order:300,enabled:!0,fn:ba,priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:Z},arrow:{order:500,enabled:!0,fn:V,element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:Y,behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:ea},hide:{order:800,enabled:!0,fn:da},computeStyle:{order:850,enabled:!0,fn:T,gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:R,onLoad:S,gpuAcceleration:void 0}},va={placement:"bottom",eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:ua},wa=function(){function a(b,d){var e=this,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};na(this,a),this.scheduleUpdate=function(){return requestAnimationFrame(e.update)},this.update=ka(this.update.bind(this)),this.options=qa({},a.Defaults,f),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=b&&b.jquery?b[0]:b,this.popper=d&&d.jquery?d[0]:d,this.options.modifiers={},Object.keys(qa({},a.Defaults.modifiers,f.modifiers)).forEach(function(b){e.options.modifiers[b]=qa({},a.Defaults.modifiers[b]||{},f.modifiers?f.modifiers[b]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(a){return qa({name:a},e.options.modifiers[a])}).sort(function(a,b){return a.order-b.order}),this.modifiers.forEach(function(a){a.enabled&&c(a.onLoad)&&a.onLoad(e.reference,e.popper,e.options,a,e.state)}),this.update();var g=this.options.eventsEnabled;g&&this.enableEventListeners(),this.state.eventsEnabled=g}return oa(a,[{key:"update",value:function(){return E.call(this)}},{key:"destroy",value:function(){return H.call(this)}},{key:"enableEventListeners",value:function(){return L.call(this)}},{key:"disableEventListeners",value:function(){return N.call(this)}}]),a}();return wa.Utils=("undefined"!=typeof window?window:global).PopperUtils,wa.placements=ra,wa.Defaults=va,wa});
define('core/custom_interaction_events', ["jquery","core/key_codes"],function(a,b){var c={activate:"cie:activate",keyboardActivate:"cie:keyboardactivate",escape:"cie:escape",down:"cie:down",up:"cie:up",home:"cie:home",end:"cie:end",next:"cie:next",previous:"cie:previous",asterix:"cie:asterix",scrollLock:"cie:scrollLock",scrollTop:"cie:scrollTop",scrollBottom:"cie:scrollBottom",ctrlPageUp:"cie:ctrlPageUp",ctrlPageDown:"cie:ctrlPageDown",enter:"cie:enter"},d={},e=function(a,b){return b=b||[],!(!b.length||b.indexOf(a)===-1)},f=function(a){return a.shiftKey||a.metaKey||a.altKey||a.ctrlKey},g=function(b,c){var e="";return c.hasOwnProperty("originalEvent")?(e="triggeredCustom_"+b,c.originalEvent.hasOwnProperty(e)?void 0:(c.originalEvent[e]=!0,void a(c.target).trigger(b,[{originalEvent:c}]))):(e=""+b+c.type+c.timeStamp,void(d.hasOwnProperty(e)||(d[e]=!0,a(c.target).trigger(b,[{originalEvent:c}]))))},h=function(a,b,c){a.off("keydown."+b).on("keydown."+b,function(a){f(a)||a.keyCode==c&&g(b,a)})},i=function(a){a.off("click.cie.activate").on("click.cie.activate",function(a){g(c.activate,a)}),a.off("keydown.cie.activate").on("keydown.cie.activate",function(a){f(a)||a.keyCode!=b.enter&&a.keyCode!=b.space||g(c.activate,a)})},j=function(a){a.off("keydown.cie.keyboardactivate").on("keydown.cie.keyboardactivate",function(a){f(a)||a.keyCode!=b.enter&&a.keyCode!=b.space||g(c.keyboardActivate,a)})},k=function(a){h(a,c.escape,b.escape)},l=function(a){h(a,c.down,b.arrowDown)},m=function(a){h(a,c.up,b.arrowUp)},n=function(a){h(a,c.home,b.home)},o=function(a){h(a,c.end,b.end)},p=function(d){var e="rtl"==a("html").attr("dir")?b.arrowLeft:b.arrowRight;h(d,c.next,e)},q=function(d){var e="rtl"==a("html").attr("dir")?b.arrowRight:b.arrowLeft;h(d,c.previous,e)},r=function(a){h(a,c.asterix,b.asterix)},s=function(a){a.off("scroll.cie.scrollTop").on("scroll.cie.scrollTop",function(b){var d=a.scrollTop();0===d&&g(c.scrollTop,b)})},t=function(a){a.off("scroll.cie.scrollBottom").on("scroll.cie.scrollBottom",function(b){var d=a.scrollTop(),e=a.innerHeight(),f=a[0].scrollHeight;d+e>=f&&g(c.scrollBottom,b)})},u=function(a){a.off("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock").on("DOMMouseScroll.cie.DOMMouseScrollLock mousewheel.cie.mousewheelLock",function(b){var d=a.scrollTop(),e=a[0].scrollHeight,f=a.height(),h="DOMMouseScroll"==b.type?b.originalEvent.detail*-40:b.originalEvent.wheelDelta,i=h>0;return!i&&-h>e-f-d?(a.scrollTop(e),b.stopPropagation(),b.preventDefault(),b.returnValue=!1,g(c.scrollLock,b),!1):!(i&&h>d)||(a.scrollTop(0),b.stopPropagation(),b.preventDefault(),b.returnValue=!1,g(c.scrollLock,b),!1)})},v=function(a){a.off("keydown.cie.ctrlpageup").on("keydown.cie.ctrlpageup",function(a){a.ctrlKey&&a.keyCode==b.pageUp&&g(c.ctrlPageUp,a)})},w=function(a){a.off("keydown.cie.ctrlpagedown").on("keydown.cie.ctrlpagedown",function(a){a.ctrlKey&&a.keyCode==b.pageDown&&g(c.ctrlPageDown,a)})},x=function(a){h(a,c.enter,b.enter)},y=function(){var a={};return a[c.activate]=i,a[c.keyboardActivate]=j,a[c.escape]=k,a[c.down]=l,a[c.up]=m,a[c.home]=n,a[c.end]=o,a[c.next]=p,a[c.previous]=q,a[c.asterix]=r,a[c.scrollLock]=u,a[c.scrollTop]=s,a[c.scrollBottom]=t,a[c.ctrlPageUp]=v,a[c.ctrlPageDown]=w,a[c.enter]=x,a},z=function(b,c){b=a(b),c=c||[],b.length&&c.length&&a.each(y(),function(a,d){e(a,c)&&d(b)})};return{define:z,events:c}});
define('core/yui', function(){return Y});
define('core/icon_system', ["jquery"],function(a){var b=function(){};return b.prototype.init=function(){return a.when(this)},b.prototype.renderIcon=function(a,b,c,d){throw new Error("Abstract function not implemented.")},b.prototype.getTemplateName=function(){throw new Error("Abstract function not implemented.")},b});
define('core/chart_series', [],function(){function a(a,b){if("string"!=typeof a)throw new Error("Invalid label for series.");if("object"!=typeof b)throw new Error("Values for a series must be an array.");if(b.length<1)throw new Error("Invalid values received for series.");this._colors=[],this._label=a,this._values=b}return a.prototype.TYPE_DEFAULT=null,a.prototype.TYPE_LINE="line",a.prototype._colors=null,a.prototype._label=null,a.prototype._labels=null,a.prototype._smooth=!1,a.prototype._type=a.prototype.TYPE_DEFAULT,a.prototype._values=null,a.prototype._xaxis=null,a.prototype._yaxis=null,a.prototype.create=function(b){var c=new a(b.label,b.values);return c.setType(b.type),c.setXAxis(b.axes.x),c.setYAxis(b.axes.y),c.setLabels(b.labels),b.colors&&b.colors.length>1?c.setColors(b.colors):c.setColor(b.colors[0]),c.setSmooth(b.smooth),c},a.prototype.getColor=function(){return this._colors[0]||null},a.prototype.getColors=function(){return this._colors},a.prototype.getCount=function(){return this._values.length},a.prototype.getLabel=function(){return this._label},a.prototype.getLabels=function(){return this._labels},a.prototype.getSmooth=function(){return this._smooth},a.prototype.getType=function(){return this._type},a.prototype.getValues=function(){return this._values},a.prototype.getXAxis=function(){return this._xaxis},a.prototype.getYAxis=function(){return this._yaxis},a.prototype.hasColoredValues=function(){return this._colors.length==this.getCount()},a.prototype.setColor=function(a){this._colors=[a]},a.prototype.setColors=function(a){if(a&&a.length!=this.getCount())throw new Error("When setting multiple colors there must be one per value.");this._colors=a||[]},a.prototype.setLabels=function(a){this._validateLabels(a),a="undefined"==typeof a?null:a,this._labels=a},a.prototype.setSmooth=function(a){a="undefined"==typeof a?null:a,this._smooth=a},a.prototype.setType=function(a){if(a!=this.TYPE_DEFAULT&&a!=this.TYPE_LINE)throw new Error("Invalid serie type.");this._type=a||null},a.prototype.setXAxis=function(a){this._xaxis=a||null},a.prototype.setYAxis=function(a){this._yaxis=a||null},a.prototype._validateLabels=function(a){if(a&&a.length>0&&a.length!=this.getCount())throw new Error("Series labels must match series values.")},a});
define('core/templates', ["core/mustache","jquery","core/ajax","core/str","core/notification","core/url","core/config","core/localstorage","core/icon_system","core/event","core/yui","core/log","core/truncate","core/user_date","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=0,q={},r={},s={},t={},u=["js"],v=function(){this.requiredStrings=[],this.requiredJS=[],this.requiredDates=[],this.currentThemeName=""};v.prototype.requiredStrings=null,v.prototype.requiredDates=[],v.prototype.requiredJS=null,v.prototype.currentThemeName="",v.prototype.getTemplate=function(a){var d=a.split("/"),e=d.shift(),f=d.shift(),g=this.currentThemeName+"/"+a;if(g in r)return r[g];var i=h.get("core_template/"+g);if(i)return q[g]=i,r[g]=b.Deferred().resolve(i).promise(),r[g];var j=c.call([{methodname:"core_output_load_template",args:{component:e,template:f,themename:this.currentThemeName}}],!0,!1);return r[g]=j[0].then(function(a){return q[g]=a,h.set("core_template/"+g,a),a}),r[g]},v.prototype.partialHelper=function(a){var b=this.currentThemeName+"/"+a;return b in q||e.exception(new Error("Failed to pre-fetch the template: "+a)),q[b]},v.prototype.renderIcon=function(a,c,d){var f=g.iconsystemmodule,h=b.Deferred();return require([f],function(a){var b=new a;b instanceof i?(t=b,b.init().then(h.resolve)["catch"](e.exception)):h.reject("Invalid icon system specified"+g.iconsystemmodule)}),h.then(function(a){return this.getTemplate(a.getTemplateName())}.bind(this)).then(function(b){return t.renderIcon(a,c,d,b)})},v.prototype.pixHelper=function(a,b,c){var d=b.split(","),e="",f="",g="";d.length>0&&(e=c(d.shift().trim(),a)),d.length>0&&(f=c(d.shift().trim(),a)),d.length>0&&(g=c(d.join(",").trim(),a));var h=t.getTemplateName(),i=this.currentThemeName+"/"+h,j=q[i];return e=e.replace(/&#x2F;/gi,"/"),t.renderIcon(e,f,g,j)},v.prototype.jsHelper=function(a,b,c){return this.requiredJS.push(c(b,a)),""},v.prototype.stringHelper=function(a,b,c){var d=b.split(","),e="",f="",g="";d.length>0&&(e=d.shift().trim()),d.length>0&&(f=d.shift().trim()),d.length>0&&(g=d.join(",").trim()),""!==g&&(g=c(g,a)),0===g.indexOf("{")&&0!==g.indexOf("{{")&&(g=JSON.parse(g));var h=this.requiredStrings.length;return this.requiredStrings.push({key:e,component:f,param:g}),"[[_s"+h+"]]"},v.prototype.quoteHelper=function(a,b,c){var d=c(b.trim(),a);return d=d.replace('"','\\"').replace(/([\{\}]{2,3})/g,"{{=<% %>=}}$1<%={{ }}=%>"),'"'+d+'"'},v.prototype.shortenTextHelper=function(a,b,c){var d=/(.*?),(.*)/,e=b.match(d),f=e[1].trim(),g=e[2].trim(),h=c(g,a);return m.truncate(h,{length:f,words:!0,ellipsis:"..."})},v.prototype.userDateHelper=function(a,b,c){var d=/(.*?),(.*)/,e=b.match(d),f=c(e[1].trim(),a),g=c(e[2].trim(),a),h=this.requiredDates.length;return this.requiredDates.push({timestamp:f,format:g}),"[[_t_"+h+"]]"},v.prototype.addHelperFunction=function(a,b){return function(){return function(c,d){var e=u.reduce(function(a,c){return b.hasOwnProperty(c)&&(a[c]=b[c]),a},{});u.forEach(function(a){b[a]=function(){return""}});var f=a.apply(this,[b,c,d]);for(var g in e)b[g]=e[g];return f}.bind(this)}.bind(this)},v.prototype.addHelpers=function(a,b){this.currentThemeName=b,this.requiredStrings=[],this.requiredJS=[],a.uniqid=p++,a.str=this.addHelperFunction(this.stringHelper,a),a.pix=this.addHelperFunction(this.pixHelper,a),a.js=this.addHelperFunction(this.jsHelper,a),a.quote=this.addHelperFunction(this.quoteHelper,a),a.shortentext=this.addHelperFunction(this.shortenTextHelper,a),a.userdate=this.addHelperFunction(this.userDateHelper,a),a.globals={config:g},a.currentTheme=b},v.prototype.getJS=function(){var a="";return this.requiredJS.length>0&&(a=this.requiredJS.join(";\n")),a},v.prototype.treatStringsInContent=function(a,b){var c,d,e,f,g,h,i=/\[\[_s\d+\]\]/;do{for(c="",d=a.search(i);d>-1;){c+=a.substring(0,d),a=a.substr(d),e="",f=4,g=a.substr(f,1);do e+=g,f++,g=a.substr(f,1);while("]"!=g);h=b[parseInt(e,10)],"undefined"==typeof h&&(l.debug("Could not find string for pattern [[_s"+e+"]]."),h=""),c+=h,a=a.substr(6+e.length),d=a.search(i)}a=c+a,d=a.search(i)}while(d>-1);return a},v.prototype.treatDatesInContent=function(a,b){return b.forEach(function(b,c){var d="\\[\\[_t_"+c+"\\]\\]",e=new RegExp(d,"g");a=a.replace(e,b)}),a},v.prototype.doRender=function(c,e,f){this.currentThemeName=f;var g=t.getTemplateName(),h=new o("core/templates:doRender");return this.getTemplate(g).then(function(){this.addHelpers(e,f);var d=a.render(c,e,this.partialHelper.bind(this));return b.Deferred().resolve(d.trim(),this.getJS()).promise()}.bind(this)).then(function(a,c){return this.requiredStrings.length>0?d.get_strings(this.requiredStrings).then(function(d){return this.requiredDates=this.requiredDates.map(function(a){return{timestamp:this.treatStringsInContent(a.timestamp,d),format:this.treatStringsInContent(a.format,d)}}.bind(this)),a=this.treatStringsInContent(a,d),c=this.treatStringsInContent(c,d),b.Deferred().resolve(a,c).promise()}.bind(this)):b.Deferred().resolve(a,c).promise()}.bind(this)).then(function(a,c){return this.requiredDates.length>0?n.get(this.requiredDates).then(function(d){return a=this.treatDatesInContent(a,d),c=this.treatDatesInContent(c,d),b.Deferred().resolve(a,c).promise()}.bind(this)):b.Deferred().resolve(a,c).promise()}.bind(this)).then(function(a,c){return h.resolve(),b.Deferred().resolve(a,c).promise()})};var w=function(a){if(""!==a.trim()){var c=b("<script>").attr("type","text/javascript").html(a);b("head").append(c)}},x=function(a,c,d,e){var f=b(a);if(f.length){var g=b(c),h=null;e?(h=new k.NodeList(f.children().get()),h.destroy(!0),f.empty(),f.append(g)):(h=new k.NodeList(f.get()),h.destroy(!0),f.replaceWith(g)),w(d),j.notifyFilterContentUpdated(g)}};v.prototype.scanForPartials=function(b){var c=a.parse(b),d=[],e=function(a,b){var c,d;for(c=0;c<a.length;c++)d=a[c],">"!=d[0]&&"<"!=d[0]||b.push(d[1]),d.length>4&&e(d[4],b)};return e(c,d),d},v.prototype.cachePartials=function(a,c){var d=this.currentThemeName+"/"+a;return d in s?s[d]:(c=c||[d],s[d]=b.Deferred(),this.getTemplate(a).then(function(e){var f=this.scanForPartials(e),g=f.filter(function(b){return!(c.indexOf(this.currentThemeName+"/"+b)>=0)&&b!=a}.bind(this)),h=g.map(function(a){return c.push(this.currentThemeName+"/"+a),this.cachePartials(a,c)}.bind(this));return b.when.apply(b,h).then(function(){return s[d].resolve(e)})}.bind(this))["catch"](s[d].reject),s[d])},v.prototype.render=function(a,c,d){"undefined"==typeof d&&(d=g.theme),this.currentThemeName=d;var f=g.iconsystemmodule,h=b.Deferred();return require([f],function(a){var b=new a;b instanceof i?(t=b,b.init().then(h.resolve)["catch"](e.exception)):h.reject("Invalid icon system specified"+g.iconsystem)}),h.then(function(){return this.cachePartials(a)}.bind(this)).then(function(a){return this.doRender(a,c,d)}.bind(this))};var y=function(a,c,d){var e=b(a);e.length&&(e.prepend(c),w(d),j.notifyFilterContentUpdated(e))},z=function(a,c,d){var e=b(a);e.length&&(e.append(c),w(d),j.notifyFilterContentUpdated(e))};return{render:function(a,b,c){var d=new v;return d.render(a,b,c)},renderPix:function(a,b,c){var d=new v;return d.renderIcon(a,b,c)},runTemplateJS:w,replaceNodeContents:function(a,b,c){x(a,b,c,!0)},replaceNode:function(a,b,c){x(a,b,c,!1)},prependNodeContents:function(a,b,c){y(a,b,c)},appendNodeContents:function(a,b,c){z(a,b,c)}}});
define('core/chart_output_htmltable', ["jquery","core/chart_output_base"],function(a,b){function c(){b.prototype.constructor.apply(this,arguments),this._build()}return c.prototype=Object.create(b.prototype),c.prototype._build=function(){this._node.empty(),this._node.append(this._makeTable())},c.prototype._makeTable=function(){var b,c,d,e=a("<table>"),f=this._chart,g=f.getLabels(),h=g.length>0,i=f.getSeries(),j=i[0].getCount();e.addClass("chart-output-htmltable generaltable"),null!==f.getTitle()&&e.append(a("<caption>").text(f.getTitle())),b=a("<tr>"),h&&b.append(a("<td>")),i.forEach(function(c){b.append(a("<th>").text(c.getLabel()).attr("scope","col"))}),e.append(b);for(var k=0;k<j;k++){b=a("<tr>"),g.length>0&&b.append(a("<th>").text(g[k]).attr("scope","row"));for(var l=0;l<i.length;l++)c=i[l].getValues()[k],d=i[l].getLabels(),null!==d&&(c=i[l].getLabels()[k]),b.append(a("<td>").text(c));e.append(b)}return e},c.prototype.update=function(){this._build()},c});
define('core_calendar/calendar_mini', ["jquery","core_calendar/selectors","core_calendar/events","core_calendar/view_manager"],function(a,b,c,d){var e=function(b){var d=a("body"),e="."+b.attr("id");d.on(c.created+e,b,f),d.on(c.deleted+e,b,f),d.on(c.updated+e,b,f),d.on(c.eventMoved+e,b,f)},f=function(b){var e=b.data,f=a("body"),g="."+e.attr("id");e.is(":visible")?d.reloadCurrentMonth(e):(f.off(c.created+g),f.off(c.deleted+g),f.off(c.updated+g),f.off(c.eventMoved+g))},g=function(e){a("body").on(c.filterChanged,function(a,c){var d=e.find(b.eventType[c.type]);d.toggleClass("calendar_event_"+c.type,!c.hidden)});var f="."+e.attr("id");a("body").on("change"+f,b.elements.courseSelector,function(){if(e.is(":visible")){var b=a(this),c=b.val(),g=null;d.reloadCurrentMonth(e,c,g)}else a("body").off("change"+f)})};return{init:function(b,c){b=a(b),d.init(b),g(b),e(b),c&&d.reloadCurrentMonth(b)}}});
define('core_calendar/modal_delete', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_events","core/modal_registry","core_calendar/events"],function(a,b,c,d,e,f,g){var h=!1,i={DELETE_ONE_BUTTON:'[data-action="deleteone"]',DELETE_ALL_BUTTON:'[data-action="deleteall"]',CANCEL_BUTTON:'[data-action="cancel"]'},j=function(a){d.call(this,a)};return j.TYPE="core_calendar-modal_delete",j.prototype=Object.create(d.prototype),j.prototype.constructor=j,j.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,i.DELETE_ONE_BUTTON,function(b,c){var d=a.Event(e.save);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,i.DELETE_ALL_BUTTON,function(b,c){var d=a.Event(g.deleteAll);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,i.CANCEL_BUTTON,function(b,c){var d=a.Event(e.cancel);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},h||(f.register(j.TYPE,j,"calendar/event_delete_modal"),h=!0),j});
define('core_calendar/summary_modal', ["jquery","core/str","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/modal_factory","core/modal_events","core_calendar/repository","core_calendar/events","core_calendar/crud"],function(a,b,c,d,e,f,g,h,i,j,k){var l=!1,m={ROOT:"[data-region='summary-modal-container']",EDIT_BUTTON:'[data-action="edit"]',DELETE_BUTTON:'[data-action="delete"]'},n=function(a){e.call(this,a)};return n.TYPE="core_calendar-event_summary",n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.prototype.getEditButton=function(){return"undefined"==typeof this.editButton&&(this.editButton=this.getFooter().find(m.EDIT_BUTTON)),this.editButton},n.prototype.getDeleteButton=function(){return"undefined"==typeof this.deleteButton&&(this.deleteButton=this.getFooter().find(m.DELETE_BUTTON)),this.deleteButton},n.prototype.getEventId=function(){return this.getBody().find(m.ROOT).attr("data-event-id")},n.prototype.getEventTitle=function(){return this.getBody().find(m.ROOT).attr("data-event-title")},n.prototype.getEventCount=function(){return this.getBody().find(m.ROOT).attr("data-event-count")},n.prototype.getEditUrl=function(){return this.getBody().find(m.ROOT).attr("data-edit-url")},n.prototype.isActionEvent=function(){return"true"==this.getBody().find(m.ROOT).attr("data-action-event")},n.prototype.registerEventListeners=function(){e.prototype.registerEventListeners.call(this),M.util.js_pending("core_calendar/summary_modal:registerEventListeners:bodyRendered"),this.getRoot().on(h.bodyRendered,function(){this.getModal().data({eventTitle:this.getEventTitle(),eventId:this.getEventId(),eventCount:this.getEventCount()}).attr("data-type","event"),k.registerRemove(this.getModal()),M.util.js_complete("core_calendar/summary_modal:registerEventListeners:bodyRendered")}.bind(this)),a("body").on(j.deleted,function(){this.hide()}.bind(this)),d.define(this.getEditButton(),[d.events.activate]),this.getEditButton().on(d.events.activate,function(b,c){this.isActionEvent()?a("body").trigger(j.editActionEvent,[this.getEditUrl()]):a("body").trigger(j.editEvent,[this.getEventId()]),this.hide(),b.preventDefault(),b.stopPropagation(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()}.bind(this))},l||(f.register(n.TYPE,n,"core_calendar/event_summary_modal"),l=!0),n});
define('core_calendar/month_view_drag_drop', ["jquery","core/notification","core/str","core_calendar/events","core_calendar/drag_drop_data_store"],function(a,b,c,d,e){var f={ROOT:"[data-region='calendar']",DRAGGABLE:'[draggable="true"][data-region="event-item"]',DROP_ZONE:'[data-drop-zone="month-view-day"]',WEEK:'[data-region="month-view-week"]'},g="bg-faded",h="bg-danger text-white",i="bg-primary text-white",j=g+" "+h+" "+i,k=!1,l=function(b){var c=a(b.target).closest(f.DROP_ZONE);return c.length?c:null},m=function(a){var b=a.attr("data-day-timestamp"),c=e.getMinTimestart(),d=e.getMaxTimestart();return!(c&&c>b)&&!(d&&d<b)},n=function(a){var b=a.attr("data-day-timestamp"),c=e.getMinTimestart(),d=e.getMaxTimestart();return c&&c>b?e.getMinError():d&&d<b?e.getMaxError():null},o=function(){a(f.ROOT).find(f.DROP_ZONE).each(function(b,c){c=a(c),c.removeClass(j)})},p=function(a,b,c){"undefined"==typeof c&&(c=e.getDurationDays());var d=m(a);if(a.removeClass(j),b?d?a.addClass(i):a.addClass(h):(a.removeClass(i+" "+h),d||a.addClass(g)),c--,c>0){var k=a.next();if(!k.length){var l=a.closest(f.WEEK).next();l.length&&(k=l.children(f.DROP_ZONE).first())}k.length&&p(k,b,c)}},q=function(){a(f.ROOT).find(f.DROP_ZONE).each(function(b,c){c=a(c),m(c)||p(c,!1)})},r=function(b){var c=a(b.target),d=c.closest(f.DRAGGABLE);if(d.length){var g=d.find("[data-event-id]"),h=g.attr("data-event-id"),i=d.attr("data-min-day-timestamp"),j=d.attr("data-max-day-timestamp"),k=d.attr("data-min-day-error"),l=d.attr("data-max-day-error"),m=f.ROOT+' [data-event-id="'+h+'"]',n=a(m).length;e.setEventId(h),e.setDurationDays(n),i&&e.setMinTimestart(i),j&&e.setMaxTimestart(j),k&&e.setMinError(k),l&&e.setMaxError(l),b.dataTransfer.effectAllowed="move",b.dataTransfer.dropEffect="move",b.dataTransfer.setData("text/plain",h),b.dropEffect="move",q()}},s=function(a){if(e.hasEventId()){a.preventDefault();var b=l(a);b&&p(b,!0)}},t=function(a){if(e.hasEventId()){var b=l(a);b&&(p(b,!1),a.preventDefault())}},u=function(g){if(e.hasEventId()){var h=l(g);if(!h)return e.clearAll(),void o();if(m(h)){var i=e.getEventId(),j=f.ROOT+' [data-event-id="'+i+'"]',k=a(j),p=null;k.length&&(p=k.closest(f.DROP_ZONE)),a("body").trigger(d.moveEvent,[i,p,h])}else{var q=n(h);c.get_string("errorinvaliddate","calendar").then(function(a){b.exception({name:a,message:q||a})})}e.clearAll(),o(),g.preventDefault()}},v=function(){e.clearAll(),o()},w=function(){q()};return{init:function(){k||(document.addEventListener("dragstart",r,!1),document.addEventListener("dragover",s,!1),document.addEventListener("dragleave",t,!1),document.addEventListener("drop",u,!1),document.addEventListener("dragend",v,!1),a("body").on(d.monthChanged,w),k=!0)}}});
define('core_calendar/calendar_filter', ["jquery","core_calendar/selectors","core_calendar/events","core/str","core/templates"],function(a,b,c,d,e){var f=function(d){d.on("click",b.eventFilterItem,function(b){var c=a(b.currentTarget);g(c),b.preventDefault()}),a("body").on(c.viewUpdated,function(){var c=d.find(b.eventFilterItem);c.each(function(b,c){if(c=a(c),c.data("eventtype-hidden")){var d=i(c);h(d)}})})},g=function(a){var b=i(a);return b.hidden=!b.hidden,M.util.js_pending("core_calendar/calendar_filter:toggleFilter"),d.get_string("eventtype"+b.eventtype,"calendar").then(function(a){return b.name=a,b}).then(function(a){return e.render("core_calendar/event_filter_key",a)}).then(function(b,c){return e.replaceNode(a,b,c)}).then(function(){h(b),M.util.js_complete("core_calendar/calendar_filter:toggleFilter")})},h=function(b){M.util.js_pending("month-mini-filterChanged"),a("body").trigger(c.filterChanged,{type:b.eventtype,hidden:b.hidden}),M.util.js_complete("month-mini-filterChanged")},i=function(a){return{eventtype:a.data("eventtype"),hidden:a.data("eventtype-hidden")}};return{init:function(b){b=a(b),f(b)}}});
define('core_calendar/events', [],function(){return{created:"calendar-events:created",deleted:"calendar-events:deleted",deleteAll:"calendar-events:delete_all",updated:"calendar-events:updated",editEvent:"calendar-events:edit_event",editActionEvent:"calendar-events:edit_action_event",eventMoved:"calendar-events:event_moved",dayChanged:"calendar-events:day_changed",monthChanged:"calendar-events:month_changed",moveEvent:"calendar-events:move_event",filterChanged:"calendar-events:filter_changed",viewUpdated:"calendar-events:view_updated"}});
define('core_calendar/calendar_view', ["jquery","core/str","core/notification","core_calendar/selectors","core_calendar/events","core_calendar/view_manager","core_calendar/repository","core/modal_factory","core_calendar/modal_event_form","core/modal_events","core_calendar/crud"],function(a,b,c,d,e,f,g,h,i,j,k){var l=function(b,g){var h=a("body");k.registerRemove(b);var i="reloadCurrent"+g.charAt(0).toUpperCase()+g.slice(1);h.on(e.created,function(){f[i](b)}),h.on(e.deleted,function(){f[i](b)}),h.on(e.updated,function(){f[i](b)}),b.on("change",d.courseSelector,function(){var e=a(this),g=e.val();f[i](b,g,null).then(function(){return b.find(d.courseSelector).val(g)}).then(function(){window.history.pushState({},"","?view=upcoming&course="+g)}).fail(c.exception)}),h.on(e.filterChanged,function(a,c){var e=b.find(d.eventType[c.type]);1==c.hidden?e.addClass("hidden"):e.removeClass("hidden")});var j=k.registerEventFormModal(b);k.registerEditListeners(b,j)};return{init:function(b,c){b=a(b),f.init(b,c),l(b,c)}}});
define('core_calendar/calendar', ["jquery","core/ajax","core/str","core/templates","core/notification","core/custom_interaction_events","core/modal_events","core/modal_factory","core_calendar/modal_event_form","core_calendar/summary_modal","core_calendar/repository","core_calendar/events","core_calendar/view_manager","core_calendar/crud","core_calendar/selectors"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={ROOT:"[data-region='calendar']",DAY:"[data-region='day']",NEW_EVENT_BUTTON:"[data-action='new-event-button']",DAY_CONTENT:"[data-region='day-content']",LOADING_ICON:".loading-icon",VIEW_DAY_LINK:"[data-action='view-day-link']",CALENDAR_MONTH_WRAPPER:".calendarwrapper",TODAY:".today"},q=function(b,c,f,g){var h=null,i=g.attr("data-day-timestamp");f&&(h=f.attr("data-day-timestamp")),f&&h==i||d.render("core/loading",{}).then(function(a,b){g.find(p.DAY_CONTENT).addClass("hidden"),d.appendNodeContents(g,a,b),f&&(f.find(p.DAY_CONTENT).addClass("hidden"),d.appendNodeContents(f,a,b))}).then(function(){return k.updateEventStartDay(c,i)}).then(function(){a("body").trigger(l.eventMoved,[c,f,g])}).always(function(){var a=g.find(p.LOADING_ICON);if(g.find(p.DAY_CONTENT).removeClass("hidden"),d.replaceNode(a,"",""),f){var b=f.find(p.LOADING_ICON);f.find(p.DAY_CONTENT).removeClass("hidden"),d.replaceNode(b,"","")}}).fail(e.exception)},r=function(b,c){var d=a("body");d.on(l.created,function(){m.reloadCurrentMonth(b)}),d.on(l.deleted,function(){m.reloadCurrentMonth(b)}),d.on(l.updated,function(){m.reloadCurrentMonth(b)}),d.on(l.editActionEvent,function(a,b){window.location.assign(b)}),d.on(l.moveEvent,q),d.on(l.eventMoved,function(){m.reloadCurrentMonth(b)}),n.registerEditListeners(b,c)},s=function(b){b.on("change",o.elements.courseSelector,function(){var c=a(this),d=c.val();m.reloadCurrentMonth(b,d,null).then(function(){return b.find(o.elements.courseSelector).val(d)}).fail(e.exception)});var c=n.registerEventFormModal(b),d=a(p.CALENDAR_MONTH_WRAPPER).data("context-id");r(b,c),d&&b.on("click",p.DAY,function(b){var d=a(b.target);if(!d.is(p.VIEW_DAY_LINK)){var f=a(this).attr("data-new-event-timestamp");c.then(function(a){var b=d.closest(o.wrapper);a.setCourseId(b.data("courseid"));var c=b.data("categoryid");"undefined"!=typeof c&&a.setCategoryId(c),a.setContextId(b.data("contextId")),a.setStartTime(f),a.show()}).fail(e.exception),b.preventDefault()}})};return{init:function(b){b=a(b),m.init(b),s(b)}}});
define('core_calendar/month_navigation_drag_drop', ["jquery","core_calendar/drag_drop_data_store"],function(a,b){var c={DRAGGABLE:'[draggable="true"][data-region="event-item"]',DROP_ZONE:'[data-drop-zone="nav-link"]'},d="bg-primary text-white",e="drop-target",f=1e3,g=!1,h=null,i=null,j=function(a,b){b?a.addClass(d):a.removeClass(d)},k=function(){i.find(c.DROP_ZONE).addClass(e)},l=function(){i.find(c.DROP_ZONE).removeClass(e)},m=function(b){var d=a(b.target).closest(c.DROP_ZONE);return d.length?d:null},n=function(b){var d=a(b.target).closest(c.DRAGGABLE);d.length&&k()},o=function(a){if(b.hasEventId()){a.preventDefault();var c=m(a);c&&b.hasEventId()&&(h||(h=setTimeout(function(){c.click(),h=null},f)),j(c,!0),l())}},p=function(a){if(b.hasEventId()){var c=m(a);c&&(h&&(clearTimeout(h),h=null),j(c,!1),k(),a.preventDefault())}},q=function(a){if(b.hasEventId()){l();var c=m(a);c&&(j(c,!1),a.preventDefault())}};return{init:function(c){g||(document.addEventListener("dragstart",n,!1),document.addEventListener("dragover",o,!1),document.addEventListener("dragleave",p,!1),document.addEventListener("drop",q,!1),document.addEventListener("dragend",l,!1),g=!0),i=a(c),b.hasEventId()&&k()}}});
define('core_calendar/modal_event_form', ["jquery","core/event","core/str","core/notification","core/templates","core/custom_interaction_events","core/modal","core/modal_registry","core/fragment","core_calendar/events","core_calendar/repository"],function(a,b,c,d,e,f,g,h,i,j,k){var l=!1,m={SAVE_BUTTON:'[data-action="save"]',LOADING_ICON_CONTAINER:'[data-region="loading-icon-container"]'},n=function(a){g.call(this,a),this.eventId=null,this.startTime=null,this.courseId=null,this.categoryId=null,this.contextId=null,this.reloadingBody=!1,this.reloadingTitle=!1,this.saveButton=this.getFooter().find(m.SAVE_BUTTON)};return n.TYPE="core_calendar-modal_event_form",n.prototype=Object.create(g.prototype),n.prototype.constructor=n,n.prototype.setContextId=function(a){this.contextId=a},n.prototype.getContextId=function(){return this.contextId},n.prototype.setCourseId=function(a){this.courseId=a},n.prototype.getCourseId=function(){return this.courseId},n.prototype.setCategoryId=function(a){this.categoryId=a},n.prototype.getCategoryId=function(){return this.categoryId},n.prototype.hasCourseId=function(){return null!==this.courseId},n.prototype.hasCategoryId=function(){return null!==this.categoryId},n.prototype.setEventId=function(a){this.eventId=a},n.prototype.getEventId=function(){return this.eventId},n.prototype.hasEventId=function(){return null!==this.eventId},n.prototype.setStartTime=function(a){this.startTime=a},n.prototype.getStartTime=function(){return this.startTime},n.prototype.hasStartTime=function(){return null!==this.startTime},n.prototype.getForm=function(){return this.getBody().find("form")},n.prototype.disableButtons=function(){this.saveButton.prop("disabled",!0)},n.prototype.enableButtons=function(){this.saveButton.prop("disabled",!1)},n.prototype.reloadTitleContent=function(){return this.reloadingTitle?this.titlePromise:(this.reloadingTitle=!0,this.hasEventId()?this.titlePromise=c.get_string("editevent","calendar"):this.titlePromise=c.get_string("newevent","calendar"),this.titlePromise.then(function(a){return this.setTitle(a),a}.bind(this)).always(function(){this.reloadingTitle=!1}.bind(this)).fail(d.exception),this.titlePromise)},n.prototype.reloadBodyContent=function(a){if(this.reloadingBody)return this.bodyPromise;this.reloadingBody=!0,this.disableButtons();var b={};return this.hasEventId()&&(b.eventid=this.getEventId()),this.hasStartTime()&&(b.starttime=this.getStartTime()),this.hasCourseId()&&(b.courseid=this.getCourseId()),this.hasCategoryId()&&(b.categoryid=this.getCategoryId()),"undefined"!=typeof a&&(b.formdata=a),this.bodyPromise=i.loadFragment("calendar","event_form",this.getContextId(),b),this.setBody(this.bodyPromise),this.bodyPromise.then(function(){this.enableButtons()}.bind(this)).fail(d.exception).always(function(){this.reloadingBody=!1}.bind(this)).fail(d.exception),this.bodyPromise},n.prototype.reloadAllContent=function(){return a.when(this.reloadTitleContent(),this.reloadBodyContent())},n.prototype.show=function(){this.reloadAllContent(),g.prototype.show.call(this)},n.prototype.hide=function(){g.prototype.hide.call(this),this.setEventId(null),this.setStartTime(null),this.setCourseId(null),this.setCategoryId(null)},n.prototype.getFormData=function(){return this.getForm().serialize()},n.prototype.save=function(){var b=this.saveButton.find(m.LOADING_ICON_CONTAINER);b.removeClass("hidden"),this.disableButtons();var c=this.getFormData();return k.submitCreateUpdateForm(c).then(function(b){if(b.validationerror)return void this.reloadBodyContent(c);var d=this.hasEventId();this.hide(),d?a("body").trigger(j.updated,[b.event]):a("body").trigger(j.created,[b.event])}.bind(this)).always(function(){b.addClass("hidden"),this.enableButtons()}.bind(this)).fail(d.exception)},n.prototype.registerEventListeners=function(){g.prototype.registerEventListeners.call(this),this.getModal().on(f.events.activate,m.SAVE_BUTTON,function(a,b){this.getForm().submit(),b.originalEvent.preventDefault(),a.stopPropagation()}.bind(this)),this.getModal().on("submit",function(a){this.save(),a.preventDefault(),a.stopPropagation()}.bind(this))},l||(h.register(n.TYPE,n,"calendar/modal_event_form"),l=!0),n});
define('core_calendar/view_manager', ["jquery","core/templates","core/str","core/notification","core_calendar/repository","core_calendar/events","core_calendar/selectors","core/modal_factory","core/modal_events","core_calendar/summary_modal","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k){var l=function(b){b=a(b),b.on("click",g.links.eventLink,function(b){var c,d=new k("core_calendar/view_manager:eventLink:click"),e=a(b.target),f=null;c=e.is(g.actions.viewEvent)?e:e.closest(g.actions.viewEvent),f=c.length?c.data("eventId"):e.find(g.actions.viewEvent).data("eventId"),f?(b.preventDefault(),b.stopPropagation(),x(f).then(d.resolve())["catch"]()):d.resolve()}),b.on("click",g.links.navLink,function(c){var d=b.find(g.wrapper),e=d.data("view"),f=d.data("courseid"),h=d.data("categoryid"),i=a(c.currentTarget);"month"===e?(n(b,i.attr("href"),i.data("year"),i.data("month"),f,h),c.preventDefault()):"day"===e&&(r(b,i.attr("href"),i.data("year"),i.data("month"),i.data("day"),f,h),c.preventDefault())})},m=function(c,h,i,j,k,l){s(c),l=l||c.find(g.wrapper),M.util.js_pending([c.get("id"),h,i,j].join("-"));var m=c.data("includenavigation"),n=c.data("mini");return e.getCalendarMonthData(h,i,j,k,m,n).then(function(a){return b.render(c.attr("data-template"),a)}).then(function(a,c){return b.replaceNode(l,a,c)}).then(function(){a("body").trigger(f.viewUpdated)}).always(function(){return M.util.js_complete([c.get("id"),h,i,j].join("-")),t(c)}).fail(d.exception)},n=function(b,c,d,e,g,h){return m(b,d,e,g,h).then(function(){return c.length&&"#"!==c&&window.history.pushState({},"",c),arguments}).then(function(){return a("body").trigger(f.monthChanged,[d,e,g,h]),arguments})},o=function(a,b,c){var d=a.find(g.wrapper).data("year"),e=a.find(g.wrapper).data("month");return"undefined"==typeof b&&(b=a.find(g.wrapper).data("courseid")),"undefined"==typeof c&&(c=a.find(g.wrapper).data("categoryid")),m(a,d,e,b,c)},p=function(c,h,i,j,k,l,m){s(c),m=m||c.find(g.wrapper),M.util.js_pending([c.get("id"),h,i,j,k,l].join("-"));var n=c.data("includenavigation");return e.getCalendarDayData(h,i,j,k,l,n).then(function(a){return b.render(c.attr("data-template"),a)}).then(function(a,c){return b.replaceNode(m,a,c)}).then(function(){a("body").trigger(f.viewUpdated)}).always(function(){return M.util.js_complete([c.get("id"),h,i,j,k,l].join("-")),t(c)}).fail(d.exception)},q=function(a,b,c){var d=a.find(g.wrapper),e=d.data("year"),f=d.data("month"),h=d.data("day");return b||(b=a.find(g.wrapper).data("courseid")),"undefined"==typeof c&&(c=a.find(g.wrapper).data("categoryid")),p(a,e,f,h,b,c)},r=function(b,c,d,e,g,h,i){return p(b,d,e,g,h,i).then(function(){return c.length&&"#"!==c&&window.history.pushState({},"",c),arguments}).then(function(){return a("body").trigger(f.dayChanged,[d,e,g,h,i]),arguments})},s=function(a){var b=a.find(g.containers.loadingIcon);b.removeClass("hidden")},t=function(a){var b=a.find(g.containers.loadingIcon);b.addClass("hidden")},u=function(c,h,i){s(c);var j=c.find(g.wrapper);return"undefined"==typeof h&&(h=c.find(g.wrapper).data("courseid")),"undefined"==typeof i&&(i=c.find(g.wrapper).data("categoryid")),e.getCalendarUpcomingData(h,i).then(function(a){return b.render(c.attr("data-template"),a)}).then(function(a,c){return b.replaceNode(j,a,c)}).then(function(){a("body").trigger(f.viewUpdated)}).always(function(){return t(c)}).fail(d.exception)},v=function(a){switch(a){case"user":return"user";case"site":return"site";case"group":return"group";case"category":return"category";default:return"course"}},w=function(a){return"calendar_event_"+v(a)},x=function(a){var c=new k("core_calendar/view_manager:renderEventSummaryModal"),f="";return e.getEventById(a).then(function(b){if(!b.event)throw new Error("Error encountered while trying to fetch calendar event with ID: "+a);var c=b.event;return f=w(c.eventtype),y(c.eventtype).then(function(a){return c.eventtype=a,c})}).then(function(a){var c={title:a.name,type:j.TYPE,body:b.render("core_calendar/event_summary_body",a),templateContext:{canedit:a.canedit,candelete:a.candelete,headerclasses:f,isactionevent:a.isactionevent,url:a.url}};return h.create(c)}).then(function(a){return a.getRoot().on(i.hidden,function(){a.destroy()}),a.show(),a}).then(function(a){return c.resolve(),a})["catch"](d.exception)},y=function(a){var b="type"+v(a);return c.get_string(b,"core_calendar").then(function(a){return a})};return{init:function(a){l(a)},reloadCurrentMonth:o,changeMonth:n,refreshMonthContent:m,reloadCurrentDay:q,changeDay:r,refreshDayContent:p,reloadCurrentUpcoming:u}});
define('core_calendar/drag_drop_data_store', [],function(){var a=null,b=null,c=null,d=null,e=null,f=null,g=function(b){a=b},h=function(){return a},i=function(){return null!==a},j=function(a){b=a},k=function(){return b},l=function(a){c=a},m=function(){return c},n=function(){return null!==c},o=function(a){d=a},p=function(){return d},q=function(){return null!==d},r=function(a){e=a},s=function(){return e},t=function(a){f=a},u=function(){return f},v=function(){g(null),j(null),l(null),o(null),r(null),t(null)};return{setEventId:g,getEventId:h,hasEventId:i,setDurationDays:j,getDurationDays:k,setMinTimestart:l,getMinTimestart:m,hasMinTimestart:n,setMaxTimestart:o,getMaxTimestart:p,hasMaxTimestart:q,setMinError:r,getMinError:s,setMaxError:t,getMaxError:u,clearAll:v}});
define('core_calendar/event_form', ["jquery","core_calendar/repository"],function(a,b){var c={EVENT_GROUP_COURSE_ID:'[name="groupcourseid"]',EVENT_GROUP_ID:'[name="groupid"]',SELECT_OPTION:"option"},d=function(d){var e=d.find(c.EVENT_GROUP_COURSE_ID),f=function(b){var e=d.find(c.EVENT_GROUP_ID),f=e.find(c.SELECT_OPTION),g=a(b);f.remove(),e.prop("disabled",!1),g.each(function(b,c){a(e).append(a("<option></option>").attr("value",c.id).text(c.name))})};e.on("change",function(){var a=d.find(c.EVENT_GROUP_COURSE_ID).val();b.getCourseGroupsData(a).then(function(a){return f(a)})["catch"](Notification.exception)})},e=function(b){var c=a("#"+b);d(c)};return{init:e}});
define('core_calendar/repository', ["jquery","core/ajax"],function(a,b){var c=function(a,c){"undefined"==typeof c&&(c=!1);var d={methodname:"core_calendar_delete_calendar_events",args:{events:[{eventid:a,repeat:c}]}};return b.call([d])[0]},d=function(a){var c={methodname:"core_calendar_get_calendar_event_by_id",args:{eventid:a}};return b.call([c])[0]},e=function(a){var c={methodname:"core_calendar_submit_create_update_form",args:{formdata:a}};return b.call([c])[0]},f=function(a,c,d,e,f,g){var h={methodname:"core_calendar_get_calendar_monthly_view",args:{year:a,month:c,courseid:d,categoryid:e,includenavigation:f,mini:g}};return b.call([h])[0]},g=function(a,c,d,e,f){var g={methodname:"core_calendar_get_calendar_day_view",args:{year:a,month:c,day:d,courseid:e,categoryid:f}};return b.call([g])[0]},h=function(a,c){var d={methodname:"core_calendar_update_event_start_day",args:{eventid:a,daytimestamp:c}};return b.call([d])[0]},i=function(a,c){var d={methodname:"core_calendar_get_calendar_upcoming_view",args:{courseid:a,categoryid:c}};return b.call([d])[0]},j=function(a){var c={methodname:"core_group_get_course_groups",args:{courseid:a}};return b.call([c])[0]};return{getEventById:d,deleteEvent:c,updateEventStartDay:h,submitCreateUpdateForm:e,getCalendarMonthData:f,getCalendarDayData:g,getCalendarUpcomingData:i,getCourseGroupsData:j}});
define('core_calendar/calendar_threemonth', ["jquery","core/notification","core_calendar/selectors","core_calendar/events","core/templates","core_calendar/view_manager"],function(a,b,c,d,e,f){var g=function(e){var g=a("body");g.on(d.monthChanged,function(a,c,d,f,g){e.queue(function(e){return h(a,c,d,f,g).then(function(){return e()}).fail(b.exception)})});var h=function(b,d,g,h,i){var j=e.find('[data-year="'+d+'"][data-month="'+g+'"]'),k=j.closest(c.calendarPeriods.month),l=e.find(c.calendarPeriods.month),m=a(l[0]),n=a(l[2]),o=a("<span>");o.attr("data-template","core_calendar/threemonth_month"),o.attr("data-includenavigation",!1),o.attr("data-mini",!0);var p=a("<div>");p.hide(),p.append(o);var q,r,s;return k.is(m)?(p.insertBefore(m),q=m.data("previousYear"),r=m.data("previousMonth"),s=n):k.is(n)&&(p.insertAfter(n),q=n.data("nextYear"),r=n.data("nextMonth"),s=m),f.refreshMonthContent(o,q,r,h,i,o).then(function(){var b=a.Deferred(),c=a.Deferred();return s.slideUp("fast",function(){a(this).remove(),b.resolve()}),p.slideDown("fast",function(){c.resolve()}),a.when(b,c)})}};return{init:function(b){b=a(b),g(b)}}});
define('core_calendar/crud', ["jquery","core/str","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","core/modal_factory","core/modal_events","core_calendar/modal_event_form","core_calendar/repository","core_calendar/events","core_calendar/modal_delete","core_calendar/selectors","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(d,e,f){var i=[{key:"deleteevent",component:"calendar"}];f=parseInt(f,10);var m,o=f>1;o?(i.push({key:"confirmeventseriesdelete",component:"calendar",param:{name:e,count:f}}),m=g.create({type:l.TYPE})):(i.push({key:"confirmeventdelete",component:"calendar",param:e}),m=g.create({type:g.types.SAVE_CANCEL}));var p=b.get_strings(i),q=a.when(p,m).then(function(b,e){return e.setTitle(b[0]),e.setBody(b[1]),o||e.setSaveButtonText(b[0]),e.show(),e.getRoot().on(h.save,function(){var b=new n("calendar/crud:initModal:deletedevent");j.deleteEvent(d,!1).then(function(){a("body").trigger(k.deleted,[d,!1])}).then(b.resolve)["catch"](c.exception)}),e.getRoot().on(k.deleteAll,function(){var b=new n("calendar/crud:initModal:deletedallevent");j.deleteEvent(d,!0).then(function(){a("body").trigger(k.deleted,[d,!0])}).then(b.resolve)["catch"](c.exception)}),e})["catch"](c.exception);return q}function p(b){b.on("click",m.actions.remove,function(b){var c=a(this).closest(m.eventItem),d=c.data("eventId"),e=c.data("eventTitle"),f=c.data("eventCount");o(d,e,f),b.preventDefault()})}function q(b,d){var e=new n("core_calendar/crud:registerEditListeners");return d.then(function(c){return a("body").on(k.editEvent,function(a,d){var e=b.find(m.wrapper);c.setEventId(d),c.setContextId(e.data("contextId")),c.show(),a.stopImmediatePropagation()}),c}).then(function(a){return e.resolve(),a})["catch"](c.exception)}var r=function(b){var d=g.create({type:i.TYPE,large:!0});return b.on("click",m.actions.create,function(a){d.then(function(a){var c=b.find(m.wrapper),d=c.data("categoryid");"undefined"!=typeof d&&a.setCategoryId(d);var e=b.find(m.today),f=b.find(m.day);!e.length&&f.length&&a.setStartTime(f.data("newEventTimestamp")),a.setContextId(c.data("contextId")),a.setCourseId(c.data("courseid")),a.show()}).fail(c.exception),a.preventDefault()}),b.on("click",m.actions.edit,function(b){b.preventDefault();var e=a(b.currentTarget),f=e.closest(m.wrapper),g=e.closest(m.eventItem);d.then(function(a){a.setEventId(g.data("eventId")),a.setContextId(f.data("contextId")),a.show(),b.stopImmediatePropagation()}).fail(c.exception)}),d};return{registerRemove:p,registerEditListeners:q,registerEventFormModal:r}});
define('core_calendar/selectors', [],function(){return{eventFilterItem:"[data-action='filter-event-type']",eventType:{site:"[data-eventtype-site]",category:"[data-eventtype-category]",course:"[data-eventtype-course]",group:"[data-eventtype-group]",user:"[data-eventtype-user]"},popoverType:{site:"[data-popover-eventtype-site]",category:"[data-popover-eventtype-category]",course:"[data-popover-eventtype-course]",group:"[data-popover-eventtype-group]",user:"[data-popover-eventtype-user]"},calendarPeriods:{month:"[data-period='month']"},courseSelector:'select[name="course"]',actions:{create:'[data-action="new-event-button"]',edit:'[data-action="edit"]',remove:'[data-action="delete"]',viewEvent:'[data-action="view-event"]'},elements:{courseSelector:'select[name="course"]'},today:".today",day:'[data-region="day"]',wrapper:".calendarwrapper",eventItem:'[data-type="event"]',links:{navLink:".calendarwrapper .arrow_link",eventLink:"[data-region='event-item']"},containers:{loadingIcon:'[data-region="overlay-icon-container"]'}}});
define('core_course/actions', ["jquery","core/ajax","core/templates","core/notification","core/str","core/url","core/yui","core/modal_factory","core/modal_events","core/key_codes"],function(a,b,c,d,e,f,g,h,i,j){var k={EDITINPROGRESS:"editinprogress",SECTIONDRAGGABLE:"sectiondraggable",EDITINGMOVE:"editing_move"},l={ACTIVITYLI:"li.activity",ACTIONAREA:".actions",ACTIVITYACTION:"a.cm-edit-action",MENU:".moodle-actionmenu[data-enhance=moodle-core-actionmenu]",TOGGLE:".toggle-display,.dropdown-toggle",SECTIONLI:"li.section",SECTIONACTIONMENU:".section_action_menu",ADDSECTIONS:"#changenumsections [data-add-sections]"};g.use("moodle-course-coursebase",function(){var a=M.course.format.get_section_selector();a&&(l.SECTIONLI=a)});var m=function(a){var b;return g.use("moodle-course-util",function(c){b=c.Moodle.core_course.util.cm.getId(c.Node(a.get(0)))}),b},n=function(a){var b;return g.use("moodle-course-util",function(c){b=c.Moodle.core_course.util.cm.getName(c.Node(a.get(0)))}),b},o=function(a){a.addClass(k.EDITINPROGRESS);var b=a.find(l.ACTIONAREA).get(0);if(b){var c=M.util.add_spinner(g,g.Node(b));return c.show(),c}return null},p=function(a){a.addClass(k.EDITINPROGRESS);var b=a.find(l.SECTIONACTIONMENU).get(0);if(b){var c=M.util.add_spinner(g,g.Node(b));return c.show(),c}return null},q=function(a){var b=M.util.add_lightbox(g,g.Node(a.get(0)));return b.show(),b},r=function(a,b,c){window.setTimeout(function(){a.removeClass(k.EDITINPROGRESS),b&&b.hide()},c)},s=function(a,b){a&&window.setTimeout(function(){a.hide()},b)},t=function(a,b){if(g.use("moodle-course-coursebase",function(){M.course.coursebase.invoke_function("setup_for_resource","#"+a)}),M.core.actionmenu&&M.core.actionmenu.newDOMNode&&M.core.actionmenu.newDOMNode(g.one("#"+a)),b){var c=g.one("#"+a+" "+l.MENU).one(l.TOGGLE);c&&c.simulate&&c.simulate("click")}},u=function(b,c){var d=a("#"+b),e="[data-action="+c+"]";"groupsseparate"!==c&&"groupsvisible"!==c&&"groupsnone"!==c||(e="[data-action=groupsseparate],[data-action=groupsvisible],[data-action=groupsnone]"),d.find(e).is(":visible")?d.find(e).focus():d.find(l.MENU).find(l.TOGGLE).focus()},v=function(b){var c=a("a:visible"),d=!1,e=null;return c.each(function(){if(a.contains(b[0],this))d=!0;else if(d)return e=this,!1}),e},w=function(c,e,f){var g,h=f.attr("data-keepopen"),i=f.attr("data-action"),j=o(c),k=b.call([{methodname:"core_course_edit_module",args:{id:e,action:i,sectionreturn:f.attr("data-sectionreturn")?f.attr("data-sectionreturn"):0}}],!0);"duplicate"===i&&(g=q(f.closest(l.SECTIONLI))),a.when.apply(a,k).done(function(b){var d=v(c);c.replaceWith(b),a("<div>"+b+"</div>").find(l.ACTIVITYLI).each(function(b){t(a(this).attr("id"),h),0===b&&(u(a(this).attr("id"),i),d=null)}),d&&d.focus(),r(c,j,400),s(g,400),c.trigger(a.Event("coursemoduleedited",{ajaxreturn:b,action:i}))}).fail(function(b){r(c,j),s(g);var e=a.Event("coursemoduleeditfailed",{exception:b,action:i});c.trigger(e),e.isDefaultPrevented()||d.exception(b)})},x=function(c,d,e){var f=o(c),g=b.call([{methodname:"core_course_get_module",args:{id:d,sectionreturn:e}}],!0);a.when.apply(a,g).done(function(a){r(c,f,400),C(a)}).fail(function(){r(c,f)})},y=function(a,b){var c=a.attr("class").match(/modtype_([^\s]*)/)[1],f=n(a);e.get_string("pluginname",c).done(function(a){var c={type:a,name:f};e.get_strings([{key:"confirm"},{key:null===f?"deletechecktype":"deletechecktypename",param:c},{key:"yes"},{key:"no"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],b)})})},z=function(a,b){e.get_strings([{key:"confirm"},{key:"yes"},{key:"no"}]).done(function(c){d.confirm(c[0],a,c[1],c[2],b)})},A=function(a,b,f,g,h,i,j){var k=[{key:f,component:g}];return e.get_strings(k).then(function(d){return a.find("span.menu-action-text").html(d[0]),c.renderPix(b,"core")}).then(function(b){a.find(".icon").replaceWith(b),a.attr("data-action",j)})["catch"](d.exception)},B=function(b,c,d,e){var f=c.attr("data-action");if("hide"===f||"show"===f){if("hide"===f?(b.addClass("hidden"),A(c,"i/show","showfromothers","format_"+e,null,null,"show")):(b.removeClass("hidden"),A(c,"i/hide","hidefromothers","format_"+e,null,null,"hide")),void 0!==d.modules)for(var g in d.modules)C(d.modules[g]);void 0!==d.section_availability&&b.find(".section_availability").first().replaceWith(d.section_availability)}else if("setmarker"===f){var h=a(l.SECTIONLI+".current"),i=h.find(l.SECTIONACTIONMENU+" a[data-action=removemarker]");h.removeClass("current"),A(i,"i/marker","highlight","core","markthistopic","core","setmarker"),b.addClass("current"),A(c,"i/marked","highlightoff","core","markedthistopic","core","removemarker")}else"removemarker"===f&&(b.removeClass("current"),A(c,"i/marker","highlight","core","markthistopic","core","setmarker"))},C=function(b){a("<div>"+b+"</div>").find(l.ACTIVITYLI).each(function(){var c=a(this).attr("id");a(l.ACTIVITYLI+"#"+c).replaceWith(b),t(c,!1)})},D=function(c,e,f,g){var h=f.attr("data-action"),i=f.attr("data-sectionreturn")?f.attr("data-sectionreturn"):0,j=p(c),k=b.call([{methodname:"core_course_edit_section",args:{id:e,action:h,sectionreturn:i}}],!0),m=q(c);a.when.apply(a,k).done(function(b){var d=a.parseJSON(b);r(c,j),s(m),c.find(l.SECTIONACTIONMENU).find(l.TOGGLE).focus();var e=a.Event("coursesectionedited",{ajaxreturn:d,action:h});c.trigger(e),e.isDefaultPrevented()||B(c,f,d,g)}).fail(function(b){r(c,j),s(m);var e=a.Event("coursesectioneditfailed",{exception:b,action:h});c.trigger(e),e.isDefaultPrevented()||d.exception(b)})};return g.use("moodle-course-coursebase",function(){M.course.coursebase.register_module({set_visibility_resource_ui:function(b){var c=a(b.element.getDOMNode()),d=m(c);if(d){var e=c.find("."+k.EDITINGMOVE).attr("data-sectionreturn");x(c,d,e)}}})}),{initCoursePage:function(b){a("body").on("click keypress",l.ACTIVITYLI+" "+l.ACTIVITYACTION+"[data-action]",function(b){if("keypress"!==b.type||13===b.keyCode){var c=a(this),d=c.closest(l.ACTIVITYLI),e=c.attr("data-action"),f=m(d);switch(e){case"moveleft":case"moveright":case"delete":case"duplicate":case"hide":case"stealth":case"show":case"groupsseparate":case"groupsvisible":case"groupsnone":break;default:return}f&&(b.preventDefault(),"delete"===e?y(d,function(){w(d,f,c)}):w(d,f,c))}}),a("body").on("click keypress",l.SECTIONLI+" "+l.SECTIONACTIONMENU+"[data-sectionid] a[data-action]",function(c){if("keypress"!==c.type||13===c.keyCode){var d=a(this),e=d.closest(l.SECTIONLI),f=d.closest(l.SECTIONACTIONMENU).attr("data-sectionid");c.preventDefault(),d.attr("data-confirm")?z(d.attr("data-confirm"),function(){D(e,f,d,b)}):D(e,f,d,b)}}),e.get_string("numberweeks").done(function(b){var c=a(l.ADDSECTIONS),d=c.attr("data-add-sections"),e=c.attr("new-sections"),f=a('<div><label for="add_section_numsections"></label> <input id="add_section_numsections" type="number" min="1" max="'+e+'" value="1"></div>');f.find("label").html(b),h.create({title:d,type:h.types.SAVE_CANCEL,body:f.html()},c).done(function(b){var e=a(b.getBody()).find("#add_section_numsections"),f=function(){""+parseInt(e.val())===e.val()&&parseInt(e.val())>=1&&(document.location=c.attr("href")+"&numsections="+parseInt(e.val()))};b.setSaveButtonText(d),b.getRoot().on(i.shown,function(){e.focus().select().on("keydown",function(a){a.keyCode===j.enter&&f()})}),b.getRoot().on(i.save,function(a){a.preventDefault(),f()})})})},replaceSectionActionItem:function(a,b,c,d,e,f,g,h){var i=a.find(l.SECTIONACTIONMENU+" "+b);A(i,c,d,e,f,g,h)}}});
define('core_form/defaultcustom', ["jquery"],function(a){var b=function(b){var c=a(b.target),d=JSON.parse(c.attr("data-defaultvalue")),e=JSON.parse(c.attr("data-customvalue")),f=c.attr("data-type"),g=c.closest("form"),h=c.attr("name").replace(/\[customize\]$/,"[value]"),i=c.prop("checked")?e:d;"text"===f?g.find('[name="'+h+'"]').val(i):"date_selector"===f?(g.find('[name="'+h+'[day]"]').val(i.day),g.find('[name="'+h+'[month]"]').val(i.month),g.find('[name="'+h+'[year]"]').val(i.year)):"date_time_selector"===f&&(g.find('[name="'+h+'[day]"]').val(i.day),g.find('[name="'+h+'[month]"]').val(i.month),g.find('[name="'+h+'[year]"]').val(i.year),g.find('[name="'+h+'[hour]"]').val(i.hour),g.find('[name="'+h+'[minute]"]').val(i.minute))},c="input[data-defaultcustom=true]";a("body").on("change",c,b)});
define('core_form/filetypes', ["jquery","core/log","core/str","core/modal_factory","core/modal_events","core/ajax","core/templates","core/tree"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(c,d,e,f){if(this.elementId=c,this.elementLabel=d,this.onlyTypes=e,this.allowAll=f,this.inputField=a("#"+c),this.wrapperBrowserTrigger=a('[data-filetypesbrowser="'+c+'"]'),this.wrapperDescriptions=a('[data-filetypesdescriptions="'+c+'"]'),this.wrapperBrowserTrigger.length)return this.inputField.length&&this.wrapperDescriptions.length?void this.prepareBrowserTrigger().then(function(){return this.prepareBrowserModal()}.bind(this)).then(function(){return this.prepareBrowserTree()}.bind(this)):void b.error("core_form/filetypes: Unexpected DOM structure, unable to enhance filetypes field "+c)};return i.prototype.prepareBrowserTrigger=function(){return g.render("core_form/filetypes-trigger",{}).then(function(a){this.wrapperBrowserTrigger.html(a),this.browserTrigger=this.wrapperBrowserTrigger.find('[data-filetypeswidget="browsertrigger"]')}.bind(this))},i.prototype.prepareBrowserModal=function(){return d.create({type:d.types.SAVE_CANCEL,title:this.elementLabel}).then(function(a){this.browserModal=a}.bind(this)).then(function(){this.browserModal.getRoot().on(e.hidden,function(){this.browserTrigger.focus()}.bind(this)),this.browserModal.getRoot().on(e.save,function(){this.saveBrowserModal()}.bind(this))}.bind(this))},i.prototype.prepareBrowserTree=function(){return this.browserTrigger.on("click",function(b){if(b.preventDefault(),!this.inputField.is("[disabled]")){var c=this.loadBrowserModalBody();c.then(function(){this.browserTree=new h(this.browserModal.getBody()),this.browserTree.handleKeyDown=function(a,b){b.keyCode==this.browserTree.keys.enter||b.keyCode==this.browserTree.keys.space?(b.preventDefault(),b.stopPropagation(),this.toggleCheckbox(a.attr("data-filetypesbrowserkey"))):h.prototype.handleKeyDown.call(this.browserTree,a,b)}.bind(this),this.allowAll&&(this.hideOrShowItemsDependingOnAllowAll(this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="*"]').first()),this.browserModal.getRoot().on("change",'input[type="checkbox"][data-filetypesbrowserkey="*"]',function(b){this.hideOrShowItemsDependingOnAllowAll(a(b.currentTarget))}.bind(this))),this.browserModal.getRoot().on("change",'input[type="checkbox"][data-filetypesbrowserkey]',function(b){var c=a(b.currentTarget),d=c.attr("data-filetypesbrowserkey");this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="'+d+'"]').prop("checked",c.prop("checked"))}.bind(this))}.bind(this)).then(function(){this.browserModal.show()}.bind(this)),this.browserModal.setBody(c)}}.bind(this)),a.when()},i.prototype.loadBrowserModalBody=function(){var a={onlytypes:this.onlyTypes.join(),allowall:this.allowAll,current:this.inputField.val()};return f.call([{methodname:"core_form_get_filetypes_browser_data",args:a}])[0].then(function(a){return g.render("core_form/filetypes-browser",{elementid:this.elementId,groups:a.groups})}.bind(this))},i.prototype.toggleCheckbox=function(a){var b=this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="'+a+'"]').first();b.prop("checked",!b.prop("checked"))},i.prototype.saveBrowserModal=function(){if(this.allowAll){var b=this.browserModal.getRoot().find('input[type="checkbox"][data-filetypesbrowserkey="*"]');if(b.length&&b.prop("checked"))return this.inputField.val("*"),void this.updateDescriptions(["*"])}var c=[];this.browserModal.getRoot().find('input[type="checkbox"]').each(function(){var b=a(this),d=b.attr("data-filetypesbrowserkey");b.prop("checked")&&c.push(d)}),c=c.filter(function(a,b,c){return c.indexOf(a)==b}),this.inputField.val(c.join(" ")),this.updateDescriptions(c)},i.prototype.updateDescriptions=function(a){var b=[];a.forEach(function(a){b.push({description:this.browserModal.getRoot().find('[data-filetypesname="'+a+'"]').first().text().trim(),extensions:this.browserModal.getRoot().find('[data-filetypesextensions="'+a+'"]').first().text().trim()})}.bind(this));var c={hasdescriptions:b.length>0,descriptions:b};return g.render("core_form/filetypes-descriptions",c).then(function(a){this.wrapperDescriptions.html(a)}.bind(this))},i.prototype.hideOrShowItemsDependingOnAllowAll=function(a){var b=this.browserModal.getRoot().find('[role="treeitem"][data-filetypesbrowserkey!="*"]');a.prop("checked")?b.hide():b.show()},{init:function(a,b,c,d){new i(a,b,c,d)}}});
define('core_form/passwordunmask', ["jquery","core/templates"],function(a,b){var c=function(b){this.wrapperSelector='[data-passwordunmask="wrapper"][data-passwordunmaskid="'+b+'"]',this.wrapper=a(this.wrapperSelector),this.editorSpace=this.wrapper.find('[data-passwordunmask="editor"]'),this.editLink=this.wrapper.find('a[data-passwordunmask="edit"]'),this.editInstructions=this.wrapper.find('[data-passwordunmask="instructions"]'),this.displayValue=this.wrapper.find('[data-passwordunmask="displayvalue"]'),this.inputFieldLabel=a('label[for="'+b+'"]'),this.inputField=this.editorSpace.find(document.getElementById(b)),this.inputField.attr("type","hidden"),this.inputField.removeClass("hiddenifjs"),this.editInstructions.attr("id")||this.editInstructions.attr("id",b+"_instructions"),this.editInstructions.hide(),this.setDisplayValue(),this.addListeners()};return c.prototype.addListeners=function(){return this.wrapper.on("click keypress",'[data-passwordunmask="edit"]',a.proxy(function(b){"keypress"===b.type&&13!==b.keyCode||(b.stopImmediatePropagation(),b.preventDefault(),"hidden"!==this.inputField.attr("type")?"click"===b.type||a(b.relatedTarget).is(":input")?this.turnEditingOff(!1):this.turnEditingOff(!0):this.turnEditingOn())},this)),this.wrapper.on("click keypress",'[data-passwordunmask="unmask"]',a.proxy(function(a){"keypress"===a.type&&13!==a.keyCode||(a.stopImmediatePropagation(),a.preventDefault(),this.wrapper.data("unmasked",!this.wrapper.data("unmasked")),this.setDisplayValue())},this)),this.wrapper.on("keydown","input",a.proxy(function(a){"keydown"===a.type&&13!==a.keyCode||(a.stopImmediatePropagation(),a.preventDefault(),this.turnEditingOff(!0))},this)),this.inputFieldLabel.on("click",a.proxy(function(a){a.preventDefault(),this.turnEditingOn()},this)),this},c.prototype.checkFocusOut=function(b){this.isEditing()&&window.setTimeout(a.proxy(function(){var c=b.relatedTarget||document.activeElement;this.wrapper.has(a(c)).length||this.turnEditingOff(!a(c).is(":input,a"))},this),100)},c.prototype.passwordVisible=function(){return!!this.wrapper.data("unmasked")},c.prototype.isEditing=function(){return"hidden"!==this.inputField.attr("type")},c.prototype.turnEditingOn=function(){var b=this.getDisplayValue();return this.passwordVisible()?this.inputField.attr("type","text"):this.inputField.attr("type","password"),this.inputField.val(b),this.inputField.attr("size",this.inputField.attr("data-size")),this.editInstructions.length&&(this.inputField.attr("aria-describedby",this.editInstructions.attr("id")),this.editInstructions.show()),this.wrapper.attr("data-passwordunmask-visible",1),this.editLink.hide(),this.inputField.focus().select(),a("body").on("focusout",this.wrapperSelector,a.proxy(this.checkFocusOut,this)),this},c.prototype.turnEditingOff=function(b){a("body").off("focusout",this.wrapperSelector,this.checkFocusOut);var c=this.getDisplayValue();return this.inputField.attr("type","hidden").attr("aria-describedby",null),this.inputField.val(c),this.editInstructions.hide(),this.wrapper.removeAttr("data-passwordunmask-visible"),this.inputField.removeAttr("size"),this.editLink.show(),this.setDisplayValue(),b&&this.editLink.focus(),this},c.prototype.getDisplayValue=function(){return this.inputField.val()},c.prototype.setDisplayValue=function(){var c=this.getDisplayValue();return this.isEditing()&&(this.wrapper.data("unmasked")?this.inputField.attr("type","text"):this.inputField.attr("type","password"),this.inputField.val(c)),c&&this.wrapper.data("unmasked")?this.displayValue.text(c):(c||(c=""),b.render("core_form/element-passwordunmask-fill",{element:{frozen:this.inputField.is("[readonly]"),value:c,valuechars:c.split("")}}).done(a.proxy(function(a,c){this.displayValue.html(a),b.runTemplateJS(c)},this))),this},c});
define('core_grades/edittree_index', ["jquery"],function(a){var b=function(){a("body").on("change",".itemselect.ignoredirty",b.checkMoveMenuState),a("body").on("click",'[data-action="grade_edittree-index-bulkselect"]',b.toggleAllSelectItems),a("body").on("change",".weightoverride",b.toggleWeightInput),a("#menumoveafter").on("change",function(){var b=a(this).closest("form"),c=b.find("#bulkmoveinput");c.val(1),b.submit()}),b.checkMoveMenuState()};return b.toggleWeightInput=function(b){b.preventDefault();var c=a(this),d=c.closest("tr");a('input[name="weight_'+d.data("itemid")+'"]').prop("disabled",!c.prop("checked"))},b.toggleAllSelectItems=function(c){c.preventDefault();var d=a(this),e=d.closest("tr");a("."+e.data("category")+" .itemselect").prop("checked",d.data("checked")),b.checkMoveMenuState()},b.getMoveMenu=function(){return a("#menumoveafter")},b.checkMoveMenuState=function(){var c=b.getMoveMenu();if(!c.length)return!1;var d;return a(".itemselect").each(function(){return d=a(this).prop("checked"),!d}),c.prop("disabled",!d),d},{enhance:b}});
define('core_message/message_area_messages', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events","core/auto_rows","core_message/message_area_actions","core/modal_factory","core/modal_events","core/str","core_message/message_area_events","core/backoff_timer"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){this.messageArea=a,this._init()}var n=500,o=50,p={BLOCKTIME:"[data-region='blocktime']",CANCELDELETEMESSAGES:"[data-action='cancel-delete-messages']",CONTACT:"[data-region='contact']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",DELETEALLMESSAGES:"[data-action='delete-all-messages']",DELETEMESSAGES:"[data-action='delete-messages']",LOADINGICON:".loading-icon",MESSAGE:"[data-region='message']",MESSAGERESPONSE:"[data-region='response']",MESSAGES:"[data-region='messages']",MESSAGESAREA:"[data-region='messages-area']",MESSAGINGAREA:"[data-region='messaging-area']",SENDMESSAGE:"[data-action='send-message']",SENDMESSAGETEXT:"[data-region='send-message-txt']",SHOWCONTACTS:"[data-action='show-contacts']",STARTDELETEMESSAGES:"[data-action='start-delete-messages']"},q=1e3;return m.prototype._isSendingMessage=!1,m.prototype._isLoadingMessages=!1,m.prototype._numMessagesDisplayed=0,m.prototype._messageQueue=[],m.prototype._numMessagesToRetrieve=20,m.prototype._confirmationModal=null,m.prototype._latestMessageTimestamp=0,m.prototype._backoffTimer=null,m.prototype.messageArea=null,m.prototype._init=function(){e.define(this.messageArea.node,[e.events.activate,e.events.up,e.events.down,e.events.enter]),a(window).height()<=670&&(n=400),f.init(this.messageArea.node),this.messageArea.onCustomEvent(k.CONVERSATIONSELECTED,this._viewMessages.bind(this)),this.messageArea.onCustomEvent(k.SENDMESSAGE,this._viewMessages.bind(this)),this.messageArea.onCustomEvent(k.CHOOSEMESSAGESTODELETE,this._chooseMessagesToDelete.bind(this)),this.messageArea.onCustomEvent(k.CANCELDELETEMESSAGES,this._hideDeleteAction.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.SENDMESSAGE,this._sendMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.STARTDELETEMESSAGES,this._startDeleting.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.DELETEMESSAGES,this._deleteMessages.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.DELETEALLMESSAGES,this._deleteAllMessages.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.CANCELDELETEMESSAGES,this._triggerCancelMessagesToDelete.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.MESSAGE,this._toggleMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,p.SHOWCONTACTS,this._hideMessagingArea.bind(this)),this.messageArea.onDelegateEvent(e.events.up,p.MESSAGE,this._selectPreviousMessage.bind(this)),this.messageArea.onDelegateEvent(e.events.down,p.MESSAGE,this._selectNextMessage.bind(this)),this.messageArea.onDelegateEvent("focus",p.SENDMESSAGETEXT,this._setMessaging.bind(this)),this.messageArea.onDelegateEvent("blur",p.SENDMESSAGETEXT,this._clearMessaging.bind(this)),a(document).on(f.events.ROW_CHANGE,this._adjustMessagesAreaHeight.bind(this));var b=this.messageArea.find(p.MESSAGES);b.length&&(this._addScrollEventListener(b.find(p.MESSAGE).length),this._latestMessageTimestamp=b.find(p.MESSAGE+":last").data("timecreated")),this._backoffTimer=new l(this._loadNewMessages.bind(this),l.getIncrementalCallback(this.messageArea.pollmin*q,q,this.messageArea.pollmax*q,this.messageArea.polltimeout*q)),this._backoffTimer.start()},m.prototype._viewMessages=function(e,f){this._numMessagesDisplayed=0,this._backoffTimer.stop(),this._latestMessageTimestamp=0;var g=b.call([{methodname:"core_message_mark_all_messages_as_read",args:{useridto:this.messageArea.getCurrentUserId(),useridfrom:f}}]),h=0;return c.render("core/loading",{}).then(function(a,b){return c.replaceNodeContents(this.messageArea.find(p.MESSAGESAREA),a,b),g[0]}.bind(this)).then(function(){var b=this.messageArea.find(p.CONVERSATIONS+" "+p.CONTACT+"[data-userid='"+f+"']");return b.hasClass("unread")&&(b.removeClass("unread"),a(document).trigger("messagearea:conversationselected",f)),this._getMessages(f)}.bind(this)).then(function(a){return h=a.messages.length,c.render("core_message/message_area_messages_area",a)}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(p.MESSAGESAREA),a,b),this._addScrollEventListener(h),this._backoffTimer.restart(),this.messageArea.find(p.SENDMESSAGETEXT).focus()}.bind(this)).fail(d.exception)},m.prototype._loadMessages=function(){if(this._isLoadingMessages)return!1;this._isLoadingMessages=!0;var b=0;return c.render("core/loading",{}).then(function(a,b){return c.prependNodeContents(this.messageArea.find(p.MESSAGES),"<div style='text-align:center'>"+a+"</div>",b),this._getMessages(this._getUserId())}.bind(this)).then(function(a){return b=a.messages.length,c.render("core_message/message_area_messages",a)}).then(function(d,e){if(this.messageArea.find(p.MESSAGES+" "+p.LOADINGICON).remove(),b>0){var f=a("<div>"+d+"</div>");this._hasMatchingBlockTime(this.messageArea.node,f,!0)&&this.messageArea.node.find(p.BLOCKTIME+":first").remove();var g=this.messageArea.find(p.MESSAGES)[0].scrollHeight;c.prependNodeContents(this.messageArea.find(p.MESSAGES),d,e);var h=this.messageArea.find(p.MESSAGES)[0].scrollHeight;this.messageArea.find(p.MESSAGES).scrollTop(h-g),this._numMessagesDisplayed+=b}this._isLoadingMessages=!1}.bind(this)).fail(d.exception)},m.prototype._loadNewMessages=function(){if(this._isLoadingMessages)return!1;if(!this._getUserId())return!1;this._isLoadingMessages=!0;var a=!1,b=this.messageArea.find(p.MESSAGES);if(0!==b.length){var c=b.scrollTop(),e=b.innerHeight(),f=b[0].scrollHeight;c+e>=f&&(a=!0)}return this._getMessages(this._getUserId(),!0).then(function(b){return this._addMessagesToDom(b.messages,a)}.bind(this)).always(function(){this._isLoadingMessages=!1}.bind(this)).fail(d.exception)},m.prototype._getMessages=function(a,c){var e={currentuserid:this.messageArea.getCurrentUserId(),otheruserid:a,limitfrom:this._numMessagesDisplayed,limitnum:this._numMessagesToRetrieve,newest:!0};c&&(e.timefrom=this._latestMessageTimestamp,e.limitfrom=0,e.limitnum=0);var f=b.call([{methodname:"core_message_data_for_messagearea_messages",args:e}]);return f[0].then(function(a){var b=a.messages;if(b&&b.length){var c=b[b.length-1];c.timecreated>this._latestMessageTimestamp&&(this._latestMessageTimestamp=c.timecreated+1)}return a}.bind(this)).fail(function(a){this._backoffTimer.stop(),d.exception(a)}.bind(this))},m.prototype._sendMessage=function(){var a=this.messageArea.find(p.SENDMESSAGETEXT),c=a.val().trim();if(""===c)return!1;if(this._isSendingMessage)return!1;this._isSendingMessage=!0;var e=b.call([{methodname:"core_message_send_instant_messages",args:{messages:[{touserid:this._getUserId(),text:c}]}}]);return a.prop("disabled",!0),e[0].then(function(a){if(a.length<0)throw new Error("Invalid response");if(a[0].errormessage)throw new Error(a[0].errormessage);return this.messageArea.trigger(k.MESSAGESENT,[this._getUserId(),c]),this._addLastMessageToDom()}.bind(this)).then(function(){this._isSendingMessage=!1}.bind(this)).always(function(){a.prop("disabled",!1),a.focus()}).fail(d.exception)},m.prototype._chooseMessagesToDelete=function(){this.messageArea.find(p.MESSAGESAREA).addClass("editing"),this.messageArea.find(p.MESSAGE).attr("role","checkbox").attr("aria-checked","false")},m.prototype._deleteMessages=function(){var c=this.messageArea.getCurrentUserId(),e=this.messageArea.find(p.MESSAGE+"[aria-checked='true']"),f=[],g=[];e.each(function(b,d){var e=a(d),h=e.data("messageid"),i=e.data("messageread")?1:0;g.push(e),f.push({methodname:"core_message_delete_message",args:{messageid:h,userid:c,read:i}})}),f.length>0?a.when(b.call(f)).then(function(){var b=null,c=this.messageArea.find(p.MESSAGE),d=c.last(),e=g[g.length-1];a.each(g,function(a,b){b.remove()}),d.data("id")===e.data("id")&&(b=this.messageArea.find(p.MESSAGE).last()),a.each(g,function(a,b){var c=b.data("blocktime");0===this.messageArea.find(p.MESSAGE+"[data-blocktime='"+c+"']").length&&this.messageArea.find(p.BLOCKTIME+"[data-blocktime='"+c+"']").remove()}.bind(this)),0===this.messageArea.find(p.MESSAGE).length&&this.messageArea.find(p.CONVERSATIONS+" "+p.CONTACT+"[data-userid='"+this._getUserId()+"']").remove(),this.messageArea.trigger(k.MESSAGESDELETED,[this._getUserId(),b])}.bind(this))["catch"](d.exception):this.messageArea.trigger(k.MESSAGESDELETED,this._getUserId()),this._hideDeleteAction()},m.prototype._addScrollEventListener=function(a){this._scrollBottom(),this._numMessagesDisplayed=a,e.define(this.messageArea.find(p.MESSAGES),[e.events.scrollTop]),this.messageArea.onCustomEvent(e.events.scrollTop,this._loadMessages.bind(this))},m.prototype._deleteAllMessages=function(){if(this._confirmationModal)return void this._confirmationModal.show();var c=j.get_strings([{key:"confirm"},{key:"deleteallconfirm",component:"message"},{key:"delete"}]),e=h.create({type:h.types.SAVE_CANCEL},this.messageArea.find(p.DELETEALLMESSAGES));a.when(c,e).then(function(a,c){c.setTitle(a[0]),c.setBody(a[1]),c.setSaveButtonText(a[2]),this._confirmationModal=c,c.getRoot().on(i.save,function(){var a=this._getUserId(),c={methodname:"core_message_delete_conversation",args:{userid:this.messageArea.getCurrentUserId(),otheruserid:a}};b.call([c])[0].then(function(){this.messageArea.find(p.MESSAGESAREA).empty(),this.messageArea.trigger(k.CONVERSATIONDELETED,a),this._hideDeleteAction()}.bind(this))["catch"](d.exception)}.bind(this)),c.show()}.bind(this))["catch"](d.exception)},m.prototype._hideDeleteAction=function(){this.messageArea.find(p.MESSAGE).removeAttr("role").removeAttr("aria-checked"),this.messageArea.find(p.MESSAGESAREA).removeClass("editing")},m.prototype._triggerCancelMessagesToDelete=function(){this.messageArea.trigger(k.CANCELDELETEMESSAGES)},m.prototype._addMessagesToDom=function(b,d){var e=0,f=this.messageArea.find(p.MESSAGES);return b=b.filter(function(a){var b=""+a.id+a.isread;if(this._messageQueue[b])return!1;var c=f.find(p.MESSAGE+'[data-id="'+b+'"]');return c.length||(this._messageQueue[b]=!0),!c.length}.bind(this)),e=b.length,c.render("core_message/message_area_messages",{messages:b}).then(function(b,f){if(e>0){var g=a("<div>"+b+"</div>");this._hasMatchingBlockTime(this.messageArea.node,g,!1)&&g.find(p.BLOCKTIME+":first").remove(),c.appendNodeContents(this.messageArea.find(p.MESSAGES),g,f),d&&this._scrollBottom(),this._numMessagesDisplayed+=e,this._backoffTimer.restart()}}.bind(this))},m.prototype._addLastMessageToDom=function(){var a=b.call([{methodname:"core_message_data_for_messagearea_get_most_recent_message",args:{currentuserid:this.messageArea.getCurrentUserId(),otheruserid:this._getUserId()}}]);return a[0].then(function(a){return this._addMessagesToDom([a],!0)}.bind(this)).always(function(){this.messageArea.find(p.SENDMESSAGETEXT).val("").trigger("input")}.bind(this)).fail(d.exception)},m.prototype._getUserId=function(){return this.messageArea.find(p.MESSAGES).data("userid")},m.prototype._scrollBottom=function(){var a=this.messageArea.find(p.MESSAGES);0!==a.length&&a.scrollTop(a[0].scrollHeight)},m.prototype._selectPreviousMessage=function(b,c){var d=a(b.target).closest(p.MESSAGE);do d=d.prev();while(d.length&&!d.is(p.MESSAGE));d.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},m.prototype._selectNextMessage=function(b,c){var d=a(b.target).closest(p.MESSAGE);do d=d.next();while(d.length&&!d.is(p.MESSAGE));d.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},m.prototype._setMessaging=function(b){a(b.target).closest(p.MESSAGERESPONSE).addClass("messaging")},m.prototype._clearMessaging=function(b){a(b.target).closest(p.MESSAGERESPONSE).removeClass("messaging")},m.prototype._startDeleting=function(a){var b=new g(this.messageArea);b.chooseMessagesToDelete(),a.preventDefault()},m.prototype._isEditing=function(){return this.messageArea.find(p.MESSAGESAREA).hasClass("editing")},m.prototype._toggleMessage=function(b){if(this._isEditing()){var c=a(b.target).closest(p.MESSAGE);"true"===c.attr("aria-checked")?c.attr("aria-checked","false"):c.attr("aria-checked","true")}},m.prototype._adjustMessagesAreaHeight=function(){var a=this.messageArea.find(p.MESSAGES),b=this.messageArea.find(p.MESSAGERESPONSE),c=b.outerHeight(),d=c-o,e=n-d;a.outerHeight(e)},m.prototype._sendMessageHandler=function(a,b){b.originalEvent.preventDefault(),this._sendMessage()},m.prototype._hideMessagingArea=function(){this.messageArea.find(p.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},m.prototype._hasMatchingBlockTime=function(a,b,c){var d,e,f,g;return c?(e=":first",g=":last"):(e=":last",g=":first"),d=a.find(p.BLOCKTIME+e),f=b.find(p.BLOCKTIME+g),!(!d.length||!f.length)&&d.data("blocktime")==f.data("blocktime")},m});
define('core_message/message_notification_preference', ["jquery","core_message/notification_preference"],function(a,b){var c={PREFERENCE_KEY:"[data-preference-key]"},d=function(a,c){b.call(this,a,c)};return d.prototype=Object.create(b.prototype),d.prototype.constructor=d,d.prototype.getPreferenceKey=function(){return this.root.find(c.PREFERENCE_KEY).attr("data-preference-key")},d});
define('core_message/message_area_profile', ["jquery","core/ajax","core/templates","core/notification","core/str","core/config","core/custom_interaction_events","core_message/message_area_events"],function(a,b,c,d,e,f,g,h){function i(a){this.messageArea=a,this._init()}var j={PROFILE:"[data-region='profile']",PROFILEADDCONTACT:"[data-action='profile-add-contact']",PROFILEBLOCKCONTACT:"[data-action='profile-block-contact']",PROFILEREMOVECONTACT:"[data-action='profile-remove-contact']",PROFILESENDMESSAGE:"[data-action='profile-send-message']",PROFILEUNBLOCKCONTACT:"[data-action='profile-unblock-contact']",PROFILEVIEW:"[data-action='profile-view']",SHOWCONTACTS:"[data-action='show-contacts']",MESSAGESAREA:"[data-region='messages-area']",MESSAGINGAREA:"[data-region='messaging-area']"};return i.prototype.messageArea=null,i.prototype._init=function(){g.define(this.messageArea.node,[g.events.activate]),this.messageArea.onCustomEvent(h.CONTACTSELECTED,this._viewProfile.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEVIEW,function(a,b){this._viewFullProfile(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILESENDMESSAGE,function(a,b){this._sendMessage(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEUNBLOCKCONTACT,function(a,b){this._unblockContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEBLOCKCONTACT,function(a,b){this._blockContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEADDCONTACT,function(a,b){this._addContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.PROFILEREMOVECONTACT,function(a,b){this._removeContact(),b.originalEvent.preventDefault()}.bind(this)),this.messageArea.onDelegateEvent(g.events.activate,j.SHOWCONTACTS,this._hideMessagingArea.bind(this))},i.prototype._viewProfile=function(a,e){c.render("core/loading",{}).done(function(a,b){c.replaceNodeContents(this.messageArea.find(j.MESSAGESAREA),a,b)}.bind(this));var f=b.call([{methodname:"core_message_data_for_messagearea_get_profile",args:{currentuserid:this.messageArea.getCurrentUserId(),otheruserid:e}}]);return f[0].then(function(a){return c.render("core_message/message_area_profile",a)}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(j.MESSAGESAREA),a,b)}.bind(this)).fail(d.exception)},i.prototype._viewFullProfile=function(){window.location.href=f.wwwroot+"/user/profile.php?id="+this._getUserId()},i.prototype._sendMessage=function(){this.messageArea.trigger(h.SENDMESSAGE,this._getUserId())},i.prototype._blockContact=function(){var a=this._performAction("core_message_block_contacts","unblockcontact","profile-block-contact","profile-unblock-contact","");return a.then(function(){this.messageArea.trigger(h.CONTACTBLOCKED,this._getUserId())}.bind(this))},i.prototype._unblockContact=function(){var a=this._performAction("core_message_unblock_contacts","blockcontact","profile-unblock-contact","profile-block-contact","danger");return a.then(function(){this.messageArea.trigger(h.CONTACTUNBLOCKED,this._getUserId())}.bind(this))},i.prototype._addContact=function(){var a=this._performAction("core_message_create_contacts","removecontact","profile-add-contact","profile-remove-contact","danger");return a.then(function(){this.messageArea.trigger(h.CONTACTADDED,this._getUserId())}.bind(this))},i.prototype._removeContact=function(){var a=this._performAction("core_message_delete_contacts","addcontact","profile-remove-contact","profile-add-contact","");return a.then(function(){this.messageArea.trigger(h.CONTACTREMOVED,this._getUserId())}.bind(this))},i.prototype._performAction=function(a,c,f,g,h){var i=b.call([{methodname:a,args:{userid:this.messageArea.getCurrentUserId(),userids:[this._getUserId()]}}]);return i[0].then(function(){return e.get_string(c,"message")}).then(function(a){this._changeText(a,f,g,h)}.bind(this)).fail(d.exception)},i.prototype._changeText=function(a,b,c,d){var e=this.messageArea.find("[data-action='"+b+"']");e.text(a),e.removeClass(),d&&e.addClass(d),e.attr("data-action",c)},i.prototype._getUserId=function(){return this.messageArea.find(j.PROFILE).data("userid")},i.prototype._hideMessagingArea=function(){this.messageArea.find(j.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},i});
define('core_message/message_area_actions', ["core_message/message_area_events"],function(a){function b(a){this.messageArea=a}var c={MESSAGES:"[data-region='messages']"};return b.prototype.messageArea=null,b.prototype.chooseMessagesToDelete=function(){0!==this.messageArea.find(c.MESSAGES).length&&this.messageArea.trigger(a.CHOOSEMESSAGESTODELETE)},b});
define('core_message/preferences_notifications_list_controller', ["jquery","core/ajax","core/notification","core/custom_interaction_events","core_message/notification_preference","core_message/notification_processor_settings"],function(a,b,c,d,e,f){var g={DISABLE_NOTIFICATIONS:'[data-region="disable-notification-container"] [data-disable-notifications]',DISABLE_NOTIFICATIONS_CONTAINER:'[data-region="disable-notification-container"]',PREFERENCE:"[data-state]",PREFERENCE_ROW:'[data-region="preference-row"]',PREFERENCE_INPUT:"[data-state] input",PROCESSOR_SETTING:"[data-processor-setting]"},h=function(b){this.root=a(b),this.userId=this.root.attr("data-user-id"),this.registerEventListeners()};return h.prototype.isDisabled=function(){return this.root.hasClass("disabled")},h.prototype.setDisabled=function(){this.root.addClass("disabled"),this.root.find(g.PREFERENCE_INPUT).prop("disabled",!0)},h.prototype.setEnabled=function(){this.root.removeClass("disabled"),this.root.find(g.PREFERENCE_INPUT).prop("disabled",!1)},h.prototype.toggleDisableAllStatus=function(){var d=a(g.DISABLE_NOTIFICATIONS),e=a(g.DISABLE_NOTIFICATIONS_CONTAINER),f=d.prop("checked");if(e.hasClass("loading"))return a.Deferred().resolve();e.addClass("loading");var h={methodname:"core_user_update_user_preferences",args:{userid:this.userId,emailstop:f?1:0}};return b.call([h])[0].done(function(){f?this.setDisabled():this.setEnabled()}.bind(this)).always(function(){e.removeClass("loading")}).fail(c.exception)},h.prototype.registerEventListeners=function(){var b=a(g.DISABLE_NOTIFICATIONS);d.define(this.root,[d.events.activate]),this.root.on("change",function(b){if(!this.isDisabled()){var c=a(b.target).closest(g.PREFERENCE),d=a(b.target).closest(g.PREFERENCE_ROW),f=new e(d,this.userId);c.addClass("loading"),f.save().always(function(){c.removeClass("loading")})}}.bind(this)),this.root.on(d.events.activate,g.PROCESSOR_SETTING,function(b,c){var d=a(b.target).closest(g.PROCESSOR_SETTING),e=new f(d);e.show(),c.originalEvent.preventDefault()}),d.define(b,[d.events.activate]),b.on(d.events.activate,function(){this.toggleDisableAllStatus()}.bind(this))},h});
define('core_message/message_area_events', [],function(){return{CANCELDELETEMESSAGES:"cancel-delete-messages",CHOOSEMESSAGESTODELETE:"choose-messages-to-delete",CONTACTADDED:"contact-added",CONTACTBLOCKED:"contact-blocked",CONTACTREMOVED:"contact-removed",CONTACTSELECTED:"contact-selected",CONTACTSSELECTED:"contacts-selected",CONTACTUNBLOCKED:"contact-unblocked",CONVERSATIONDELETED:"conversation-deleted",CONVERSATIONSELECTED:"conversation-selected",CONVERSATIONSSELECTED:"conversations-selected",MESSAGESDELETED:"messages-deleted",MESSAGESEARCHCANCELED:"message-search-canceled",MESSAGESENT:"message-sent",SENDMESSAGE:"message-send",USERSSEARCHCANCELED:"users-search-canceled"}});
define('core_message/message_area', ["jquery","core_message/message_area_contacts","core_message/message_area_messages","core_message/message_area_profile","core_message/message_area_tabs","core_message/message_area_search"],function(a,b,c,d,e,f){function g(b,c,d,e){this.node=a(b),this.pollmin=c,this.pollmax=d,this.polltimeout=e,this._init()}return g.prototype.node=null,g.prototype.pollmin=null,g.prototype.pollmax=null,g.prototype.polltimeout=null,g.prototype._init=function(){new b(this),new c(this),new d(this),new e(this),new f(this)},g.prototype.onDelegateEvent=function(a,b,c){this.node.on(a,b,c)},g.prototype.onCustomEvent=function(a,b){this.node.on(a,b)},g.prototype.trigger=function(a,b){"undefined"==typeof b&&(b=""),this.node.trigger(a,b)},g.prototype.find=function(a){return this.node.find(a)},g.prototype.getCurrentUserId=function(){return this.node.data("userid")},g.prototype.showContactsFirst=function(){return!!this.node.data("displaycontacts")},g});
define('core_message/message_area_contacts', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events","core/str","core_message/message_area_events"],function(a,b,c,d,e,f,g){function h(a){this.messageArea=a,this._init()}var i={CONTACT:"[data-region='contact']",CONTACTICONBLOCKED:"[data-region='contact-icon-blocked']",CONTACTS:"[data-region='contacts'][data-region-content='contacts']",CONTACTSAREA:"[data-region='contacts-area']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",COURSE:"[data-region='course']",LASTMESSAGETEXT:"[data-region='last-message-text']",LASTMESSAGEUSER:"[data-region='last-message-user']",LOADINGICON:".loading-icon",MESSAGETEXT:"[data-region='message-text']",MESSAGINGAREA:"[data-region='messaging-area']",NOCONTACTS:"[data-region=no-contacts]",SEARCHBOX:"[data-region='search-box']",SEARCHRESULTSAREA:"[data-region='search-results-area']",SEARCHTEXTAREA:"[data-region='search-text-area']",SELECTEDVIEWCONVERSATION:"[data-action='view-contact-msg'].selected",SELECTEDVIEWPROFILE:"[data-action='view-contact-profile'].selected",SHOWMESSAGES:"[data-action='show-messages']",VIEWCONVERSATION:"[data-action='view-contact-msg']",VIEWPROFILE:"[data-action='view-contact-profile']"};return h.prototype._isLoadingConversations=!1,h.prototype._isLoadingContacts=!1,h.prototype._numContactsDisplayed=0,h.prototype._numContactsToRetrieve=20,h.prototype._numConversationsDisplayed=0,h.prototype._numConversationsToRetrieve=20,h.prototype._messageLength=60,h.prototype.messageArea=null,h.prototype._init=function(){e.define(this.messageArea.node,[e.events.activate,e.events.down,e.events.up]),this.messageArea.onCustomEvent(g.MESSAGESEARCHCANCELED,this._viewConversations.bind(this)),this.messageArea.onCustomEvent(g.USERSSEARCHCANCELED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONDELETED,this._deleteConversation.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONSSELECTED,this._viewConversations.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,this._viewContacts.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESDELETED,this._updateLastMessage.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESENT,this._handleMessageSent.bind(this)),this.messageArea.onCustomEvent(g.CONTACTREMOVED,function(a,b){this._removeContact(i.CONTACTS,b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTADDED,function(a,b){this._addContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTBLOCKED,function(a,b){this._blockContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTUNBLOCKED,function(a,b){this._unblockContact(b)}.bind(this)),this.messageArea.onCustomEvent(g.CHOOSEMESSAGESTODELETE,this._startDeleting.bind(this)),this.messageArea.onCustomEvent(g.CANCELDELETEMESSAGES,this._stopDeleting.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.VIEWCONVERSATION,this._viewConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.VIEWPROFILE,this._viewContact.bind(this)),this.messageArea.onDelegateEvent(e.events.activate,i.SHOWMESSAGES,this._showMessagingArea.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.CONTACT,this._selectPreviousContact.bind(this)),this.messageArea.onDelegateEvent(e.events.down,i.CONTACT,this._selectNextContact.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.VIEWCONVERSATION,this._selectPreviousConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.down,i.VIEWCONVERSATION,this._selectNextConversation.bind(this)),this.messageArea.onDelegateEvent(e.events.up,i.COURSE,this._selectPreviousCourse.bind()),this.messageArea.onDelegateEvent(e.events.down,i.COURSE,this._selectNextCourse.bind()),this.messageArea.onDelegateEvent("focus",i.SEARCHBOX,this._setSearching.bind(this)),this.messageArea.onDelegateEvent("blur",i.SEARCHBOX,this._clearSearching.bind(this)),e.define(this.messageArea.find(i.CONVERSATIONS),[e.events.scrollBottom]),e.define(this.messageArea.find(i.CONTACTS),[e.events.scrollBottom]),this.messageArea.onDelegateEvent(e.events.scrollBottom,i.CONVERSATIONS,this._loadConversations.bind(this)),this.messageArea.onDelegateEvent(e.events.scrollBottom,i.CONTACTS,this._loadContacts.bind(this)),this.messageArea.showContactsFirst()||(this._numConversationsDisplayed=20)},h.prototype._startDeleting=function(){this.messageArea.find(i.CONTACTSAREA).addClass("editing")},h.prototype._stopDeleting=function(){this.messageArea.find(i.CONTACTSAREA).removeClass("editing")},h.prototype._viewConversations=function(){0===this._numConversationsDisplayed&&this._loadConversations(),this.messageArea.find(i.CONTACTS).hide(),this.messageArea.find(i.CONVERSATIONS).show()},h.prototype._viewContacts=function(){0===this._numContactsDisplayed&&this._loadContacts(),this.messageArea.find(i.CONVERSATIONS).hide(),this.messageArea.find(i.CONTACTS).show()},h.prototype._handleMessageSent=function(a,b,c){this._viewConversations();var d=this._getUserNode(i.CONVERSATIONS,b);if(0===d.length){var e=this._getUserNode(i.CONTACTS,b);if(0===e.length&&(e=this._getUserNode(i.SEARCHRESULTSAREA,b)),0==e.length)return;d=e.clone(),d.attr("data-action","view-contact-msg"),this.messageArea.find(i.CONVERSATIONS+" "+i.NOCONTACTS).remove(),this._numConversationsDisplayed++}d.prependTo(this.messageArea.find(i.CONVERSATIONS)),this.messageArea.find(i.CONVERSATIONS).scrollTop(0),this._updateContactText(d,c,!0),this._setSelectedUser("[data-userid='"+b+"']")},h.prototype._loadConversations=function(){if(this._isLoadingConversations)return!1;this._isLoadingConversations=!0;var a=0;return c.render("core/loading",{}).then(function(a,b){return this._numConversationsDisplayed?c.appendNodeContents(this.messageArea.find(i.CONVERSATIONS),"<div style='text-align:center'>"+a+"</div>",b):c.replaceNodeContents(this.messageArea.find(i.CONVERSATIONS),"<div style='text-align:center'>"+a+"</div>",b),this._getItems("core_message_data_for_messagearea_conversations",this._numConversationsDisplayed,this._numConversationsToRetrieve)}.bind(this)).then(function(b){return a=b.contacts.length,b.isconversation=!0,c.render("core_message/message_area_contacts",b)}).then(function(b,d){this.messageArea.find(i.CONVERSATIONS+" "+i.LOADINGICON).remove(),a>0?(c.appendNodeContents(this.messageArea.find(i.CONVERSATIONS),b,d),this._numConversationsDisplayed+=this._numConversationsToRetrieve):this._numConversationsDisplayed||c.replaceNodeContents(this.messageArea.find(i.CONVERSATIONS),b,d),this._isLoadingConversations=!1}.bind(this)).fail(d.exception)},h.prototype._loadContacts=function(){if(this._isLoadingContacts)return!1;this._isLoadingContacts=!0;var a=0;return c.render("core/loading",{}).then(function(a,b){return this._numContactsDisplayed?c.appendNodeContents(this.messageArea.find(i.CONTACTS),"<div style='text-align:center'>"+a+"</div>",b):c.replaceNodeContents(this.messageArea.find(i.CONTACTS),"<div style='text-align:center'>"+a+"</div>",b),this._getItems("core_message_data_for_messagearea_contacts",this._numContactsDisplayed,this._numContactsToRetrieve)}.bind(this)).then(function(b){return a=b.contacts.length,b.isconversation=!1,c.render("core_message/message_area_contacts",b)}).then(function(b,d){this.messageArea.find(i.CONTACTS+" "+i.LOADINGICON).remove(),a>0?(c.appendNodeContents(this.messageArea.find(i.CONTACTS),b,d),this._numContactsDisplayed+=a):this._numContactsDisplayed||c.replaceNodeContents(this.messageArea.find(i.CONTACTS),b,d),this._isLoadingContacts=!1}.bind(this)).fail(d.exception)},h.prototype._viewConversation=function(b){this.messageArea.trigger(g.CANCELDELETEMESSAGES);var c=a(b.currentTarget).data("userid"),d=a(b.currentTarget).data("messageid"),e="[data-userid='"+c+"']";d&&(e="[data-messageid='"+d+"']"),this._setSelectedUser(e),this.messageArea.trigger(g.CONVERSATIONSELECTED,c),this.messageArea.find(i.SELECTEDVIEWPROFILE).removeClass("selected"),this._showMessagingArea()},h.prototype._viewContact=function(b){this.messageArea.trigger(g.CANCELDELETEMESSAGES);var c=a(b.currentTarget).data("userid");this._setSelectedUser("[data-userid='"+c+"']"),this.messageArea.trigger(g.CONTACTSELECTED,c),this.messageArea.find(i.SELECTEDVIEWCONVERSATION).removeClass("selected"),this._showMessagingArea()},h.prototype._getItems=function(a,c,d){var e=b.call([{methodname:a,args:{userid:this.messageArea.getCurrentUserId(),limitfrom:c,limitnum:d}}]);return e[0]},h.prototype._deleteConversation=function(a,b){this._removeContact(i.CONVERSATIONS,b),this._numConversationsDisplayed--,this._hideMessagingArea(),this._stopDeleting()},h.prototype._updateLastMessage=function(a,b,c){if(c){var d=this._getUserNode(i.CONVERSATIONS,b),e=c.find(i.MESSAGETEXT).text().trim(),f=!1;c.data("useridto")==b&&(f=!0),this._updateContactText(d,e,f)}this._stopDeleting()},h.prototype._addContact=function(){this.messageArea.find(i.CONTACTS).empty(),this._numContactsDisplayed=0,this._loadContacts()},h.prototype._removeContact=function(a,b){this._getUserNode(a,b).remove(),this._numContactsDisplayed--},h.prototype._blockContact=function(a){var b=this._getUserNode(i.CONTACTS,a);b.find(i.CONTACTICONBLOCKED).removeClass("hidden"),b=this._getUserNode(i.CONVERSATIONS,a),b.find(i.CONTACTICONBLOCKED).removeClass("hidden"),b=this._getUserNode(i.SEARCHRESULTSAREA,a),b.find(i.CONTACTICONBLOCKED).removeClass("hidden")},h.prototype._unblockContact=function(a){var b=this._getUserNode(i.CONTACTS,a);b.find(i.CONTACTICONBLOCKED).addClass("hidden"),b=this._getUserNode(i.CONVERSATIONS,a),b.find(i.CONTACTICONBLOCKED).addClass("hidden"),b=this._getUserNode(i.SEARCHRESULTSAREA,a),b.find(i.CONTACTICONBLOCKED).addClass("hidden")},h.prototype._getUserNode=function(a,b){return this.messageArea.find(a+" "+i.CONTACT+"[data-userid='"+b+"']")},h.prototype._setSelectedUser=function(a){this.messageArea.find(i.CONTACT).removeClass("selected"),this.messageArea.find(i.CONTACT).attr("aria-pressed",!1),this.messageArea.find(i.CONTACT+a).addClass("selected"),this.messageArea.find(i.CONTACT+a).attr("aria-pressed",!0)},h.prototype._getContactText=function(a){return a.length>this._messageLength&&(a=a.substr(0,this._messageLength-3),a+="..."),document.createTextNode(a)},h.prototype._updateContactText=function(a,b,c){b=this._getContactText(b),c?f.get_string("you","message").done(function(b){a.find(i.LASTMESSAGEUSER).empty().append(b)}).always(function(){a.find(i.LASTMESSAGETEXT).empty().append(b)}):(a.find(i.LASTMESSAGEUSER).empty(),a.find(i.LASTMESSAGETEXT).empty().append(b))},h.prototype._selectNextContact=function(b,c){var d=a(b.target).closest(i.CONTACT),e=d.next();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousContact=function(b,c){var d=a(b.target).closest(i.CONTACT),e=d.prev();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectNextCourse=function(b,c){var d=a(b.target).closest(i.COURSE);d.next().focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousCourse=function(b,c){var d=a(b.target).closest(i.COURSE);d.prev().focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectNextConversation=function(b,c){var d=a(b.target).closest(i.VIEWCONVERSATION),e=d.next();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._selectPreviousConversation=function(b,c){var d=a(b.target).closest(i.VIEWCONVERSATION),e=d.prev();e.focus(),c.originalEvent.preventDefault(),c.originalEvent.stopPropagation()},h.prototype._setSearching=function(){a(i.SEARCHTEXTAREA).addClass("searching")},h.prototype._clearSearching=function(){a(i.SEARCHTEXTAREA).removeClass("searching")},h.prototype._showMessagingArea=function(){this.messageArea.find(i.MESSAGINGAREA).removeClass("hide-messages").addClass("show-messages")},h.prototype._hideMessagingArea=function(){this.messageArea.find(i.MESSAGINGAREA).removeClass("show-messages").addClass("hide-messages")},h});
define('core_message/message_area_tabs', ["core/custom_interaction_events","core_message/message_area_events"],function(a,b){function c(a){this.messageArea=a,this._init()}var d={ACTIVECONTACTSTAB:"[data-region='contacts-area'] [role='tab'][aria-selected='true']",CONTACTSPANELS:"[data-region='contacts']",VIEWCONTACTS:"[data-action='contacts-view']",VIEWCONVERSATIONS:"[data-action='conversations-view']"};return c.prototype.messageArea=null,c.prototype._init=function(){a.define(this.messageArea.node,[a.events.activate,a.events.up,a.events.down,a.events.next,a.events.previous,a.events.ctrlPageUp,a.events.ctrlPageDown]),this.messageArea.onDelegateEvent(a.events.activate,d.VIEWCONVERSATIONS,this._viewConversations.bind(this)),this.messageArea.onDelegateEvent(a.events.activate,d.VIEWCONTACTS,this._viewContacts.bind(this)),this.messageArea.onDelegateEvent(a.events.up,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.down,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.next,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.previous,d.VIEWCONVERSATIONS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.up,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.down,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.next,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.previous,d.VIEWCONTACTS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.ctrlPageUp,d.CONTACTSPANELS,this._toggleTabs.bind(this)),this.messageArea.onDelegateEvent(a.events.ctrlPageDown,d.CONTACTSPANELS,this._toggleTabs.bind(this)),this.messageArea.onCustomEvent(b.MESSAGESENT,function(){this._selectTab(d.VIEWCONVERSATIONS,d.VIEWCONTACTS)}.bind(this))},c.prototype._viewConversations=function(){this.messageArea.trigger(b.CONVERSATIONSSELECTED),this._selectTab(d.VIEWCONVERSATIONS,d.VIEWCONTACTS)},c.prototype._viewContacts=function(){this.messageArea.trigger(b.CONTACTSSELECTED),this._selectTab(d.VIEWCONTACTS,d.VIEWCONVERSATIONS)},c.prototype._selectTab=function(a,b){b=this.messageArea.find(b),b.removeClass("selected"),b.attr("aria-selected","false"),b.attr("tabindex","-1"),a=this.messageArea.find(a),a.addClass("selected"),a.attr("aria-selected","true"),a.attr("tabindex","0")},c.prototype._toggleTabs=function(a,b){var c=this.messageArea.find(d.ACTIVECONTACTSTAB);c.is(d.VIEWCONVERSATIONS)?this._viewContacts():this._viewConversations(),this.messageArea.find(d.ACTIVECONTACTSTAB).focus(),a.preventDefault(),a.stopPropagation(),b.originalEvent.preventDefault(),b.originalEvent.stopPropagation()},c});
define('core_message/notification_processor_settings', ["jquery","core/ajax","core/notification","core/fragment","core/templates","core/str","tool_lp/dialogue"],function(a,b,c,d,e,f,g){var h={PROCESSOR:"[data-processor-name]",PREFERENCE_ROW:'[data-region="preference-row"]'},i=function(b){this.root=a(b),this.name=this.root.attr("data-name"),this.userId=this.root.attr("data-user-id"),this.contextId=this.root.attr("data-context-id")};return i.prototype.show=function(){d.loadFragment("message","processor_settings",this.contextId,{userid:this.userId,type:this.name}).done(function(b,c){f.get_string("processorsettings","message").done(function(d){var f=new g(d,b,function(){e.runTemplateJS(c)},function(){f.close()});a(document).on("mpp:formsubmitted",function(){f.close(),this.updateConfiguredStatus()}.bind(this)),a(document).on("mpp:formcancelled",function(){f.close()})}.bind(this))}.bind(this))},i.prototype.updateConfiguredStatus=function(){var d=this.root.closest(h.PROCESSOR);if(!d.hasClass("unconfigured"))return!1;var e=d.attr("data-processor-name"),f={methodname:"core_message_get_message_processor",args:{name:e,userid:this.userId}};return b.call([f])[0].fail(c.exception).done(function(b){if(b.userconfigured){var c=a(h.PREFERENCE_ROW+' [data-processor-name="'+e+'"]');d.removeClass("unconfigured"),c.removeClass("disabled")}})},i});
define('core_message/message_area_search', ["jquery","core/ajax","core/templates","core/notification","core/str","core/custom_interaction_events","core_message/message_area_events"],function(a,b,c,d,e,f,g){function h(a){this.messageArea=a,this._init()}var i={CONTACTS:"[data-region='contacts'][data-region-content='contacts']",CONTACTSAREA:"[data-region='contacts-area']",CONVERSATIONS:"[data-region='contacts'][data-region-content='conversations']",DELETESEARCHFILTER:"[data-region='search-filter-area']",LOADINGICON:".loading-icon",SEARCHBOX:"[data-region='search-box']",SEARCHFILTER:"[data-region='search-filter']",SEARCHFILTERAREA:"[data-region='search-filter-area']",SEARCHRESULTSAREA:"[data-region='search-results-area']",SEARCHTEXTAREA:"[data-region='search-text-area']",SEARCHUSERSINCOURSE:"[data-action='search-users-in-course']"};return h.prototype.messageArea=null,h.prototype._searchArea=null,h.prototype._courseid=null,h.prototype._isLoading=!1,h.prototype._numMessagesDisplayed=0,h.prototype._numMessagesToRetrieve=20,h.prototype._numUsersDisplayed=0,h.prototype._numUsersToRetrieve=20,h.prototype._searchAreas={MESSAGES:"messages",USERS:"users",USERSINCOURSE:"usersincourse"},h.prototype._requestTimeout=null,h.prototype._init=function(){this.messageArea.find(i.SEARCHTEXTAREA).on("input",this._searchRequest.bind(this)),this.messageArea.onDelegateEvent(f.events.activate,i.SEARCHUSERSINCOURSE,function(b){this._setFilter(a(b.currentTarget).html()),this._setPlaceholderText("searchforuser"),this._clearSearchArea(),this._searchArea=this._searchAreas.USERSINCOURSE,this._courseid=a(b.currentTarget).data("courseid"),this._searchUsersInCourse(),this.messageArea.find(i.SEARCHBOX).focus()}.bind(this)),this.messageArea.onDelegateEvent(f.events.activate,i.DELETESEARCHFILTER,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.USERS,this._setPlaceholderText("searchforuserorcourse"),this.messageArea.trigger(g.USERSSEARCHCANCELED),this.messageArea.find(i.SEARCHBOX).focus()}.bind(this)),this.messageArea.onCustomEvent(g.CONVERSATIONSSELECTED,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.MESSAGES,this._setPlaceholderText("searchmessages")}.bind(this)),this.messageArea.onCustomEvent(g.CONTACTSSELECTED,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.USERS,this._setPlaceholderText("searchforuserorcourse")}.bind(this)),this.messageArea.onCustomEvent(g.MESSAGESENT,function(){this._hideSearchResults(),this._searchArea=this._searchAreas.MESSAGES,this._setPlaceholderText("searchmessages")}.bind(this)),f.define(this.messageArea.find(i.SEARCHRESULTSAREA),[f.events.scrollBottom]),this.messageArea.onDelegateEvent(f.events.scrollBottom,i.SEARCHRESULTSAREA,function(){this._searchArea==this._searchAreas.MESSAGES?this._searchMessages():this._searchArea==this._searchAreas.USERSINCOURSE&&this._searchUsersInCourse()}.bind(this)),this._searchArea=this.messageArea.showContactsFirst()?this._searchAreas.USERS:this._searchAreas.MESSAGES},h.prototype._searchRequest=function(){var a=this.messageArea.find(i.SEARCHTEXTAREA+" input").val();return this._requestTimeout&&clearTimeout(this._requestTimeout),""===a.trim()?void(this._searchArea==this._searchAreas.MESSAGES?(this._hideSearchResults(),this.messageArea.trigger(g.MESSAGESEARCHCANCELED)):this._searchArea==this._searchAreas.USERS?(this._hideSearchResults(),this.messageArea.trigger(g.USERSSEARCHCANCELED)):this._searchArea==this._searchAreas.USERSINCOURSE&&(this._clearSearchArea(),this._searchUsersInCourse())):(this.messageArea.find(i.CONVERSATIONS).hide(),this.messageArea.find(i.CONTACTS).hide(),this.messageArea.find(i.SEARCHRESULTSAREA).show(),void(this._searchArea==this._searchAreas.MESSAGES?this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numMessagesDisplayed=0,this._searchMessages()}.bind(this),300):this._searchArea==this._searchAreas.USERSINCOURSE?this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numUsersDisplayed=0,this._searchUsersInCourse()}.bind(this),300):this._requestTimeout=setTimeout(function(){this._clearSearchArea(),this._numUsersDisplayed=0,this._searchUsers()}.bind(this),300)))},h.prototype._searchMessages=function(){if(this._isLoading)return!1;var a=this.messageArea.find(i.SEARCHBOX).val();this._isLoading=!0;var e=b.call([{methodname:"core_message_data_for_messagearea_search_messages",args:{userid:this.messageArea.getCurrentUserId(),search:a,limitfrom:this._numMessagesDisplayed,limitnum:this._numMessagesToRetrieve}}]),f=0;return c.render("core/loading",{}).then(function(a,b){return c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return f=a.contacts.length,c.render("core_message/message_area_message_search_results",a)}).then(function(a,b){this.messageArea.find(i.SEARCHRESULTSAREA+" "+i.LOADINGICON).remove(),f>0?(c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._numMessagesDisplayed+=f):0==this._numMessagesDisplayed&&c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._isLoading=!1}.bind(this)).fail(d.exception)},h.prototype._searchUsers=function(){var a=this.messageArea.find(i.SEARCHBOX).val(),e=b.call([{methodname:"core_message_data_for_messagearea_search_users",args:{userid:this.messageArea.getCurrentUserId(),search:a,limitnum:this._numUsersToRetrieve}}]);return c.render("core/loading",{}).then(function(a,b){return c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return a.contacts.length>0&&(a.hascontacts=!0),a.courses.length>0&&(a.hascourses=!0),a.noncontacts.length>0&&(a.hasnoncontacts=!0),c.render("core_message/message_area_user_search_results",a)}).then(function(a,b){c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b)}.bind(this)).fail(d.exception)},h.prototype._searchUsersInCourse=function(){if(this._isLoading)return!1;var a=this.messageArea.find(i.SEARCHBOX).val();this._isLoading=!0;var e=b.call([{methodname:"core_message_data_for_messagearea_search_users_in_course",args:{userid:this.messageArea.getCurrentUserId(),courseid:this._courseid,search:a,limitfrom:this._numUsersDisplayed,limitnum:this._numUsersToRetrieve}}]),f=0;return c.render("core/loading",{}).then(function(a,b){return c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),"<div style='text-align:center'>"+a+"</div>",b),e[0]}.bind(this)).then(function(a){return f=a.contacts.length,f>0&&(a.hascontacts=!0),c.render("core_message/message_area_user_search_results",a)}).then(function(a,b){this.messageArea.find(i.SEARCHRESULTSAREA+" "+i.LOADINGICON).remove(),f>0?(c.appendNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._numUsersDisplayed+=f):0==this._numUsersDisplayed&&c.replaceNodeContents(this.messageArea.find(i.SEARCHRESULTSAREA),a,b),this._isLoading=!1}.bind(this)).fail(d.exception)},h.prototype._setPlaceholderText=function(a){return e.get_string(a,"message").then(function(a){this.messageArea.find(i.SEARCHTEXTAREA+" input").attr("placeholder",a)}.bind(this))},h.prototype._setFilter=function(a){this.messageArea.find(i.SEARCHBOX).val(""),this.messageArea.find(i.CONTACTSAREA).addClass("searchfilter"),this.messageArea.find(i.SEARCHFILTERAREA).show(),this.messageArea.find(i.SEARCHFILTER).html(a),e.get_string("removecoursefilter","message",a).then(function(a){this.messageArea.find(i.SEARCHFILTERAREA).attr("aria-label",a)}.bind(this))["catch"](d.exception)},h.prototype._clearFilters=function(){this.messageArea.find(i.CONTACTSAREA).removeClass("searchfilter"),this.messageArea.find(i.SEARCHFILTER).empty(),this.messageArea.find(i.SEARCHFILTERAREA).hide(),this.messageArea.find(i.SEARCHFILTERAREA).removeAttr("aria-label")},h.prototype._clearSearchArea=function(){this.messageArea.find(i.SEARCHRESULTSAREA).empty()},h.prototype._hideSearchResults=function(){this._clearFilters(),this.messageArea.find(i.SEARCHTEXTAREA+" input").val(""),this._clearSearchArea(),this.messageArea.find(i.SEARCHRESULTSAREA).hide()},h});
define('core_message/message_preferences', ["jquery","core/ajax","core/notification","core_message/message_notification_preference","core/custom_interaction_events"],function(a,b,c,d,e){var f={PREFERENCE:"[data-state]",PREFERENCES_CONTAINER:'[data-region="preferences-container"]',BLOCK_NON_CONTACTS:'[data-region="block-non-contacts-container"] [data-block-non-contacts]',BLOCK_NON_CONTACTS_CONTAINER:'[data-region="block-non-contacts-container"]'},g=function(b){this.root=a(b),this.userId=this.root.find(f.PREFERENCES_CONTAINER).attr("data-user-id"),this.registerEventListeners()};return g.prototype.preferencesDisabled=function(){return this.root.find(f.PREFERENCES_CONTAINER).hasClass("disabled")},g.prototype.saveBlockNonContactsStatus=function(){var d=this.root.find(f.BLOCK_NON_CONTACTS),e=this.root.find(f.BLOCK_NON_CONTACTS_CONTAINER),g=d.prop("checked");if(e.hasClass("loading"))return a.Deferred().resolve();e.addClass("loading");var h={methodname:"core_user_update_user_preferences",args:{userid:this.userId,preferences:[{type:d.attr("data-preference-key"),value:g?1:0}]}};return b.call([h])[0].fail(c.exception).always(function(){e.removeClass("loading")})},g.prototype.registerEventListeners=function(){e.define(this.root,[e.events.activate]),this.root.on(e.events.activate,f.BLOCK_NON_CONTACTS,function(){this.saveBlockNonContactsStatus()}.bind(this)),this.root.on("change",function(b){if(!this.preferencesDisabled()){var c=a(b.target).closest(f.PREFERENCES_CONTAINER),e=a(b.target).closest(f.PREFERENCE),g=new d(c,this.userId);e.addClass("loading"),g.save().always(function(){e.removeClass("loading")})}}.bind(this))},g});
define('core_message/message_repository', ["jquery","core/ajax","core/notification"],function(a,b,c){var d=function(a){"undefined"==typeof a.limit&&(a.limit=0),"undefined"==typeof a.offset&&(a.offset=0),a.limitfrom=a.offset,a.limitnum=a.limit,delete a.limit,delete a.offset;var d={methodname:"core_message_data_for_messagearea_conversations",args:a},e=b.call([d])[0];return e.fail(c.exception),e},e=function(a){var d={methodname:"core_message_get_unread_conversations_count",args:a},e=b.call([d])[0];return e.fail(c.exception),e},f=function(a){var d={methodname:"core_message_mark_all_messages_as_read",args:a},e=b.call([d])[0];return e.fail(c.exception),e};return{query:d,countUnreadConversations:e,markAllAsRead:f}});
define('core_message/preferences_processor_form', ["jquery","core/ajax","core/notification","core/custom_interaction_events"],function(a,b,c,d){var e=function(b){this.root=a(b),this.userId=this.root.attr("data-user-id"),this.name=this.root.attr("data-processor-name"),this.root.find("form").on("submit",function(b){b.preventDefault(),this.save().done(function(){a(document).trigger("mpp:formsubmitted")})}.bind(this));var c=this.root.find("[data-cancel-button]");d.define(c,[d.events.activate]),c.on(d.events.activate,function(){a(document).trigger("mpp:formcancelled")})};return e.prototype.startLoading=function(){this.root.addClass("loading")},e.prototype.stopLoading=function(){this.root.removeClass("loading")},e.prototype.isLoading=function(){return this.root.hasClass("loading")},e.prototype.save=function(){if(this.isLoading())return a.Deferred();this.startLoading();var d=this.root.find("form").serializeArray(),e={methodname:"core_message_message_processor_config_form",args:{userid:this.userId,name:this.name,formvalues:d}};return b.call([e])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))},e});
define('core_message/toggle_contact_button', ["jquery","core/ajax","core/templates","core/notification","core/custom_interaction_events"],function(a,b,c,d,e){var f=function(a){return"1"==a.attr("data-is-contact")},g=function(a){a.attr("data-is-contact","1")},h=function(a){a.attr("data-is-contact","0")},i=function(a){return a.attr("data-userid")},j=function(a){return a.hasClass("loading")||a.attr("disabled")},k=function(c,e){return j(c)?a.Deferred():(c.addClass("loading"),c.attr("disabled","disabled"),b.call([e])[0].fail(d.exception).always(function(){c.removeClass("loading"),c.removeAttr("disabled")}))},l=function(a){if(!j(a)){var b={methodname:"core_message_create_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){g(a),c.render("message/remove_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})}},m=function(a){if(!j(a)){var b={methodname:"core_message_delete_contacts",args:{userids:[i(a)]}};k(a,b).done(function(){h(a),c.render("message/add_contact_button",{}).done(function(b,d){c.replaceNodeContents(a,b,d)})})}},n=function(b){b=a(b),b.children(".loading-icon").length||c.render("core/loading",{}).done(function(a,c){b.append(a,c)}),e.define(b,[e.events.activate]),b.on(e.events.activate,function(a,c){f(b)?m(b):l(b),a.preventDefault(),c.originalEvent.preventDefault()})};return{enhance:n}});
define('core_message/notification_processor', ["jquery"],function(a){var b={STATE_NONE:'[data-state="none"]',STATE_BOTH:'[data-state="both"]',STATE_LOGGED_IN:'[data-state="loggedin"]',STATE_LOGGED_OFF:'[data-state="loggedoff"]'},c=function(b){this.root=a(b)};return c.prototype.getName=function(){return this.root.attr("data-processor-name")},c.prototype.isLoggedInEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked"))return!1;var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_IN).find("input");return d.prop("checked")||c.prop("checked")},c.prototype.isLoggedOffEnabled=function(){var a=this.root.find(b.STATE_NONE).find("input");if(a.prop("checked"))return!1;var c=this.root.find(b.STATE_BOTH).find("input"),d=this.root.find(b.STATE_LOGGED_OFF).find("input");return d.prop("checked")||c.prop("checked")},c});
define('core_message/notification_preference', ["jquery","core/ajax","core/notification","core_message/notification_processor"],function(a,b,c,d){var e={PROCESSOR:"[data-processor-name]",STATE_INPUTS:"[data-state] input"},f=function(b,c){this.root=a(b),this.userId=c};return f.prototype.getPreferenceKey=function(){return this.root.attr("data-preference-key")},f.prototype.getLoggedInPreferenceKey=function(){return this.getPreferenceKey()+"_loggedin"},f.prototype.getLoggedOffPreferenceKey=function(){return this.getPreferenceKey()+"_loggedoff"},f.prototype.getProcessors=function(){return this.root.find(e.PROCESSOR).map(function(b,c){return new d(a(c))})},f.prototype.startLoading=function(){this.root.addClass("loading"),this.root.find(e.STATE_INPUTS).prop("disabled",!0)},f.prototype.stopLoading=function(){this.root.removeClass("loading"),this.root.find(e.STATE_INPUTS).prop("disabled",!1)},f.prototype.isLoading=function(){return this.root.hasClass("loading")},f.prototype.save=function(){if(this.isLoading())return a.Deferred().resolve();this.startLoading();var d="",e="";this.getProcessors().each(function(a,b){b.isLoggedInEnabled()&&(""===d?d=b.getName():d+=","+b.getName()),b.isLoggedOffEnabled()&&(""===e?e=b.getName():e+=","+b.getName())}),""===d&&(d="none"),""===e&&(e="none");var f={userid:this.userId,preferences:[{type:this.getLoggedInPreferenceKey(),value:d},{type:this.getLoggedOffPreferenceKey(),value:e}]},g={methodname:"core_user_update_user_preferences",args:f};return b.call([g])[0].fail(c.exception).always(function(){this.stopLoading()}.bind(this))},f});
define('core_question/repository', ["jquery","core/ajax"],function(a,b){var c=function(a,c,d){var e={methodname:"core_question_submit_tags_form",args:{questionid:a,contextid:c,formdata:d}};return b.call([e])[0]};return{submitTagCreateUpdateForm:c}});
define('core_question/edit_tags', ["jquery","core/fragment","core/str","core/modal_events","core/modal_factory","core/notification","core/custom_interaction_events","core_question/repository","core_question/selectors"],function(a,b,c,d,e,f,g,h,i){var j=function(a){a.find(i.actions.save).prop("disabled",!1)},k=function(a){a.find(i.actions.save).prop("disabled",!0)},l=function(a){return a.getBody().find("form").serialize()},m=function(a){var b=a.find(i.containers.loadingIcon);b.removeClass("hidden")},n=function(a){var b=a.find(i.containers.loadingIcon);b.addClass("hidden")},o=function(a,b){a.getBody().attr("data-contextid",b)},p=function(a){return a.getBody().data("contextid")},q=function(a,b){a.getBody().attr("data-questionid",b)},r=function(a){return a.getBody().data("questionid")},s=function(h){var l=e.create({type:e.types.SAVE_CANCEL,large:!1},[h,i.actions.edittags]).then(function(a){return c.get_string("questiontags","question").then(function(b){return a.setTitle(b),b}).fail(f.exception),a.getRoot().on(d.save,function(b){var c=a.getBody().find("form");c.submit(),b.preventDefault()}),a.getRoot().on("submit","form",function(b){t(a,h).then(function(){a.hide(),location.reload()}).fail(f.exception),b.preventDefault(),b.stopPropagation()}),a});h.on(g.events.activate,i.actions.edittags,function(c){var d=a(c.currentTarget),e=d.data("questionid"),g=!!d.data("cantag"),p=d.data("contextid");l.then(function(a){k(h),m(h);var c={id:e},d=b.loadFragment("question","tags_form",p,c);return a.setBody(d),d.then(function(){j(h)}).always(function(){n(h)}).fail(f.exception),g?a.getRoot().find(i.actions.save).show():a.getRoot().find(i.actions.save).hide(),q(a,e),o(a,p),a}).fail(f.exception),c.preventDefault()})},t=function(a,b){k(b),m(b);var c=l(a),d=r(a),e=p(a);return h.submitTagCreateUpdateForm(d,e,c).always(function(){n(b),j(b)}).fail(f.exception)};return{init:function(b){b=a(b),s(b)}}});
define('core_question/selectors', [],function(){return{actions:{save:'[data-action="save"]',edittags:'[data-action="edittags"]'},containers:{loadingIcon:'[data-region="overlay-icon-container"]'}}});
define('core_search/form-search-user-selector', ["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.id,label:b._label})}),d},transport:function(d,e,f,g){var h,i={query:e},j=a(d).attr("withincourseid");"undefined"!=typeof j&&""!==a("#id_searchwithin").val()?i.courseid=j:i.courseid=0,h=b.call([{methodname:"core_search_get_relevant_users",args:i}]),h[0].then(function(b){var d=[];return a.each(b,function(a,b){d.push(c.render("core_search/form-user-selector-suggestion",b))}),a.when.apply(a.when,d).then(function(){var c=arguments,d=0;a.each(b,function(a,b){b._label=c[d++]}),f(b)})}).fail(g)}}});
define('core_user/unified_filter_datasource', ["jquery","core/ajax","core/notification"],function(a,b,c){return{list:function(b,c){var d=[],e=a(b),f=a(b).data("originaloptionsjson"),g=e.val();a.each(f,function(b,e){return""!==c.trim()&&e.label.toLocaleLowerCase().indexOf(c.toLocaleLowerCase())===-1||(a.inArray(e.value,g)>-1||(d.push(e),!0))});var h=new a.Deferred;return h.resolve(d),h.promise()},processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.value,label:b.label})}),d},transport:function(a,b,d){this.list(a,b).then(d)["catch"](c.exception)}}});
define('core_user/status_field', ["core/templates","jquery","core/str","core/config","core/notification","core/modal_factory","core/modal_events","core/fragment","core/ajax"],function(a,b,c,d,e,f,g,h,i){var j={EDIT_ENROLMENT:'[data-action="editenrolment"]',SHOW_DETAILS:'[data-action="showdetails"]',UNENROL:'[data-action="unenrol"]'},k=function(a){this.contextid=a.contextid,this.courseid=a.courseid,this.bindEditEnrol(),this.bindUnenrol(),this.bindStatusDetails()};return k.prototype.courseid=0,k.prototype.bindEditEnrol=function(){var a=this;b(j.EDIT_ENROLMENT).click(function(d){d.preventDefault();var h=b(this),i=h.parent(),j=i.data("fullname"),k=h.attr("rel");b.when(c.get_string("edituserenrolment","enrol",j)).then(function(a){return f.create({large:!0,title:a,type:f.types.SAVE_CANCEL})}).done(function(b){b.getRoot().on(g.save,function(c){c.preventDefault(),a.submitEditFormAjax(b)}),b.getRoot().on(g.hidden,function(){b.destroy()}),b.setBody(a.getBody(k)),b.show()}).fail(e.exception)})},k.prototype.bindUnenrol=function(){var a=this;b(j.UNENROL).click(function(d){d.preventDefault();var h=b(this),i=h.parent(),j=[{key:"unenrol",component:"enrol"},{key:"unenrolconfirm",component:"enrol",param:{user:i.data("fullname"),course:i.data("coursename"),enrolinstancename:i.data("enrolinstancename")}}],k=f.create({type:f.types.SAVE_CANCEL});b.when(c.get_strings(j),k).done(function(c,e){var f=c[0],i=c[1];e.setTitle(f),e.setBody(i),e.setSaveButtonText(f),e.getRoot().on(g.save,function(){var c={ueid:b(h).attr("rel")};d.preventDefault(),a.submitUnenrolFormAjax(e,c)}),e.getRoot().on(g.hidden,function(){e.destroy()}),e.show()}).fail(e.exception)})},k.prototype.bindStatusDetails=function(){b(j.SHOW_DETAILS).click(function(d){d.preventDefault();var h=b(this),i=h.parent(),k={fullname:i.data("fullname"),coursename:i.data("coursename"),enrolinstancename:i.data("enrolinstancename"),status:i.data("status"),statusclass:i.find("span").attr("class"),timestart:i.data("timestart"),timeend:i.data("timeend")},l=[{key:"enroldetails",component:"enrol"}],m=h.next(j.EDIT_ENROLMENT);m.length&&(k.editenrollink=b("<div>").append(m.clone()).html());var n=c.get_strings(l),o=f.create({large:!0,type:f.types.CANCEL});b.when(n,o).done(function(c,d){var e=a.render("core_user/status_details",k);d.setTitle(c[0]),d.setBody(e),m.length&&d.getRoot().on("click",j.EDIT_ENROLMENT,function(a){a.preventDefault(),d.hide(),b(m).trigger("click")}),d.show(),d.getRoot().on(g.hidden,function(){d.destroy()})}).fail(e.exception)})},k.prototype.submitEditFormAjax=function(a){var c=this,d=a.getRoot().find("form"),f=b(d).find('[name="ue"]').val(),g=b(d).find('[name="status"]').val(),h={courseid:this.courseid,ueid:f,status:g},j=b(d).find('[name="timestart[enabled]"]');if(j.is(":checked")){var k=b(d).find('[name="timestart[year]"]').val(),l=b(d).find('[name="timestart[month]"]').val()-1,m=b(d).find('[name="timestart[day]"]').val(),n=b(d).find('[name="timestart[hour]"]').val(),o=b(d).find('[name="timestart[minute]"]').val(),p=new Date(k,l,m,n,o);h.timestart=p.getTime()/1e3}var q=b(d).find('[name="timeend[enabled]"]');if(q.is(":checked")){var r=b(d).find('[name="timeend[year]"]').val(),s=b(d).find('[name="timeend[month]"]').val()-1,t=b(d).find('[name="timeend[day]"]').val(),u=b(d).find('[name="timeend[hour]"]').val(),v=b(d).find('[name="timeend[minute]"]').val(),w=new Date(r,s,t,u,v);h.timeend=w.getTime()/1e3}var x={methodname:"core_enrol_edit_user_enrolment",args:h};i.call([x])[0].done(function(b){if(b.result)a.hide(),"undefined"!=typeof window.M.core_formchangechecker&&window.M.core_formchangechecker.reset_form_dirty_state(),window.location.reload();else{var e=JSON.stringify(d.serialize());a.setBody(c.getBody(f,e))}}).fail(e.exception)},k.prototype.submitUnenrolFormAjax=function(a,b){var c={methodname:"core_enrol_unenrol_user_enrolment",args:b};i.call([c])[0].done(function(b){b.result?(a.hide(),"undefined"!=typeof window.M.core_formchangechecker&&window.M.core_formchangechecker.reset_form_dirty_state(),window.location.reload()):e.alert(b.errors[0].key,b.errors[0].message)}).fail(e.exception)},k.prototype.getBody=function(a,b){var c={ueid:a};return"undefined"!=typeof b&&(c.formdata=b),h.loadFragment("enrol","user_enrolment_form",this.contextid,c).fail(e.exception)},{init:function(a){new k(a)}}});
define('core_user/unified_filter', ["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={UNIFIED_FILTERS:"#unified-filters"},f=function(){var f=[{key:"userfilterplaceholder",component:"moodle"},{key:"nofiltersapplied",component:"moodle"}];M.util.js_pending("unified_filter_datasource"),c.get_strings(f).done(function(a){var c=a[0],f=a[1];b.enhance(e.UNIFIED_FILTERS,!0,"core_user/unified_filter_datasource",c,!1,!0,f,!0).then(function(){M.util.js_complete("unified_filter_datasource")}).fail(d.exception)}).fail(d.exception);var g=a(e.UNIFIED_FILTERS).val();a(e.UNIFIED_FILTERS).on("change",function(){var b=a(this).val(),c=[],d=[],e=!1;if(a.each(b,function(a,b){var f=b.split(":",2);if(2!==f.length)return d.push(b),!0;var g=f[0],h=f[1];return"undefined"!=typeof c[g]&&(e=!0),c[g]=h,!0}),e){var f=[];for(var h in c)f.push(h+":"+c[h]);f=f.concat(d),a(this).val(f)}g.join(",")!=b.join(",")&&this.form.submit()})},g=function(){return a(e.UNIFIED_FILTERS).closest("form")};return{init:function(){f()},getForm:function(){return g()}}});
define('core_user/participants', ["jquery","core/str","core/modal_factory","core/modal_events","core/templates","core/notification","core/ajax"],function(a,b,c,d,e,f,g){var h={BULKACTIONSELECT:"#formactionid",BULKUSERCHECKBOXES:"input.usercheckbox",BULKUSERNOSCHECKBOXES:"input.usercheckbox[value='0']",BULKUSERSELECTEDCHECKBOXES:"input.usercheckbox:checked",BULKACTIONFORM:"#participantsform",CHECKALLBUTTON:"#checkall",CHECKALLNOSBUTTON:"#checkallnos",CHECKALLONPAGEBUTTON:"#checkallonpage",CHECKNONEBUTTON:"#checknone"},i=function(a){this.courseId=a.courseid,this.noteStateNames=a.noteStateNames,this.stateHelpIcon=a.stateHelpIcon,this.attachEventListeners()};return i.prototype.modal=null,i.prototype.courseId=-1,i.prototype.noteStateNames={},i.prototype.stateHelpIcon="",i.prototype.attachEventListeners=function(){a(h.BULKACTIONSELECT).on("change",function(b){var c=a(b.target).val();if(c.indexOf("#")!==-1){b.preventDefault();var d=[];a(h.BULKUSERSELECTEDCHECKBOXES).each(function(b,c){var e=a(c).attr("name"),f=e.replace("user","");d.push(f)}),"#messageselect"==c?this.showSendMessage(d).fail(f.exception):"#addgroupnote"==c&&this.showAddNote(d).fail(f.exception),a(h.BULKACTIONSELECT+' option[value=""]').prop("selected","selected")}else""!==c&&(a(h.BULKUSERSELECTEDCHECKBOXES).length>0?a(h.BULKACTIONFORM).submit():a(h.BULKACTIONSELECT+' option[value=""]').prop("selected","selected"))}.bind(this)),a(h.CHECKALLBUTTON).on("click",function(){var b=a(this).data("showallink");b&&(window.location=b)}),a(h.CHECKALLNOSBUTTON).on("click",function(){a(h.BULKUSERNOSCHECKBOXES).prop("checked",!0)}),a(h.CHECKALLONPAGEBUTTON).on("click",function(){a(h.BULKUSERCHECKBOXES).prop("checked",!0)}),a(h.CHECKNONEBUTTON).on("click",function(){a(h.BULKUSERCHECKBOXES).prop("checked",!1)})},i.prototype.showAddNote=function(f){if(0==f.length)return a.Deferred().resolve().promise();var g=[];for(var i in this.noteStateNames)switch(i){case"draft":g.push({value:"personal",label:this.noteStateNames[i]});break;case"public":g.push({value:"course",label:this.noteStateNames[i],selected:1});break;case"site":g.push({value:i,label:this.noteStateNames[i]})}var j={stateNames:g,stateHelpIcon:this.stateHelpIcon},k=null;return k=1==f.length?b.get_string("addbulknotesingle","core_notes"):b.get_string("addbulknote","core_notes",f.length),a.when(c.create({type:c.types.SAVE_CANCEL,body:e.render("core_user/add_bulk_note",j)}),k).then(function(b,c){return this.modal=b,this.modal.setTitle(c),this.modal.setSaveButtonText(c),this.modal.getRoot().on(d.hidden,function(){var b=a("#user-notifications [role=alert]");b.length?b.focus():a(h.BULKACTIONSELECT).focus(),this.modal.getRoot().remove()}.bind(this)),this.modal.getRoot().on(d.save,this.submitAddNote.bind(this,f)),this.modal.show(),this.modal}.bind(this))},i.prototype.submitAddNote=function(a){var c=this.modal.getRoot().find("form textarea").val(),d=this.modal.getRoot().find("form select").val(),e=[],h=0;for(h=0;h<a.length;h++)e.push({userid:a[h],text:c,courseid:this.courseId,publishstate:d});return g.call([{methodname:"core_notes_create_notes",args:{notes:e}}])[0].then(function(a){return 1==a.length?b.get_string("addbulknotedonesingle","core_notes"):b.get_string("addbulknotedone","core_notes",a.length)}).then(function(a){return f.addNotification({message:a,type:"success"}),!0})["catch"](f.exception)},i.prototype.showSendMessage=function(f){if(0==f.length)return a.Deferred().resolve().promise();var g=null;return g=1==f.length?b.get_string("sendbulkmessagesingle","core_message"):b.get_string("sendbulkmessage","core_message",f.length),a.when(c.create({type:c.types.SAVE_CANCEL,body:e.render("core_user/send_bulk_message",{})}),g).then(function(b,c){return this.modal=b,this.modal.setTitle(c),this.modal.setSaveButtonText(c),this.modal.getRoot().on(d.hidden,function(){a(h.BULKACTIONSELECT).focus(),this.modal.getRoot().remove()}.bind(this)),this.modal.getRoot().on(d.save,this.submitSendMessage.bind(this,f)),this.modal.show(),this.modal}.bind(this))},i.prototype.submitSendMessage=function(a){var c=this.modal.getRoot().find("form textarea").val(),d=[],e=0;for(e=0;e<a.length;e++)d.push({touserid:a[e],text:c});return g.call([{methodname:"core_message_send_instant_messages",args:{messages:d}}])[0].then(function(a){return 1==a.length?b.get_string("sendbulkmessagesentsingle","core_message"):b.get_string("sendbulkmessagesent","core_message",a.length)}).then(function(a){return f.addNotification({message:a,type:"success"}),!0})["catch"](f.exception)},{init:function(a){return new i(a)}}});
define ("qtype_coderunner/textareas",["jquery"],function(a){function b(){a(this).data("clickInProgress",!1);a(this).data("capturingTab",!0);a(this).on("mousedown",function(){a(this).data("clickInProgress",!0)});a(this).on("focusin",function(){a(this).data("capturingTab",a(this).data("clickInProgress"))});a(this).on("click",function(){a(this).data("clickInProgress",!1)});a(this).on("keydown",function(b){if(window.hasOwnProperty("behattesting")&&window.behattesting){return}if(b.which===void 0||0!==b.which){if(b.keyCode==9&&a(this).data("capturingTab")){if(b.shiftKey||c(this,"    ")){b.preventDefault()}}else if(b.keyCode===13&&this.selectionStart!==void 0){for(var d=this.value.substring(0,this.selectionStart),e=d.lastIndexOf("\n"),f=d.substring(e+1),g="",h=0;h<f.length&&" "===f.charAt(h);h++){g=g+" "}if(c(this,"\n"+g)){b.preventDefault()}a(this).data("capturingTab",!0)}else if(b.keyCode===77&&b.ctrlKey&&!b.altKey){a(this).data("capturingTab",!a(this).data("capturingTab"));b.preventDefault()}else if(b.keyCode===27){a(this).data("capturingTab",!1)}else if(!(b.ctrlKey||b.altKey)){a(this).data("capturingTab",!0)}}})}function c(a,b){if(a.selectionStart!==void 0){var c=a.value.substring(0,a.selectionStart),d=a.selectionEnd,e=a.value.substring(a.selectionEnd,a.value.length),f=a.scrollTop;a.value=c+b+e;var g=d+b.length;a.selectionStart=g;a.selectionEnd=g;a.scrollTop=f;return!0}else if(document.selection&&document.selection.createRange){var h=document.selection.createRange(),i=h.duplicate();i.moveToElementText(a);i.setEndPoint("EndToEnd",h);h.text=b;return!0}else{return!1}}return{setupAllTAs:function(){a("textarea.edit_code").each(b)},initQuestionTA:function(c){a(document.getElementById(c)).each(b)}}});
//# sourceMappingURL=textareas.min.js.map

define ("qtype_coderunner/graphutil",function(){function a(){this.greekLetterNames=["Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega"]}a.prototype.convertLatexShortcuts=function(a){for(var b=0,c;b<this.greekLetterNames.length;b++){c=this.greekLetterNames[b];a=a.replace(new RegExp("\\\\"+c,"g"),String.fromCharCode(913+b+(16<b)));a=a.replace(new RegExp("\\\\"+c.toLowerCase(),"g"),String.fromCharCode(945+b+(16<b)))}for(var b=0;10>b;b++){a=a.replace(new RegExp("_"+b,"g"),String.fromCharCode(8320+b))}a=a.replace(/_a/g,String.fromCharCode(8336));return a};a.prototype.drawArrow=function(a,b,c,d){var e=Math.cos(d),f=Math.sin(d);a.beginPath();a.moveTo(b,c);a.lineTo(b-8*e+5*f,c-8*f-5*e);a.lineTo(b-8*e-5*f,c-8*f+5*e);a.fill()};a.prototype.det=function(j,a,b,c,d,e,f,g,h){return j*d*h+a*e*f+b*c*g-j*e*g-a*c*h-b*d*f};a.prototype.vectorMagnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};a.prototype.scalarProjection=function(c,a){return(c.x*a.x+c.y*a.y)/this.vectorMagnitude(a)};a.prototype.isCCW=function(c,a){return 0<c.x*a.y-a.x*c.y};a.prototype.circleFromThreePoints=function(b,d,e,f,g,h){var i=this.det(b,d,1,e,f,1,g,h,1),a=-this.det(b*b+d*d,d,1,e*e+f*f,f,1,g*g+h*h,h,1),j=this.det(b*b+d*d,b,1,e*e+f*f,e,1,g*g+h*h,g,1),k=-this.det(b*b+d*d,b,d,e*e+f*f,e,f,g*g+h*h,g,h);return{x:-a/(2*i),y:-j/(2*i),radius:Math.sqrt(a*a+j*j-4*i*k)/(2*Math.abs(i))}};a.prototype.isInside=function(a,b){return a.x>b.x&&a.x<b.x+b.width&&a.y<b.y+b.height&&a.y>b.y};a.prototype.crossBrowserKey=function(a){a=a||window.event;return a.which||a.keyCode};a.prototype.crossBrowserElementPos=function(a){a=a||window.event;var b=a.target||a.srcElement,c=0,d=0;while(b.offsetParent){c+=b.offsetLeft;d+=b.offsetTop;b=b.offsetParent}return{x:c,y:d}};a.prototype.crossBrowserMousePos=function(a){a=a||window.event;return{x:a.pageX||a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:a.pageY||a.clientY+document.body.scrollTop+document.documentElement.scrollTop}};a.prototype.crossBrowserRelativeMousePos=function(a){var b=this.crossBrowserElementPos(a),c=this.crossBrowserMousePos(a);return{x:c.x-b.x,y:c.y-b.y}};return new a});
//# sourceMappingURL=graphutil.min.js.map

define ("qtype_coderunner/multilanguagequestion",["jquery"],function(a){function b(b){var c=a(document.getElementById(b)),d=a(".coderunner-lang-select");d.on("change",function(){var a=d.val(),b=c.data("current-ui-wrapper");if(b&&b.uiInstance&&"function"==typeof b.uiInstance.setLanguage){b.uiInstance.setLanguage(a)}})}return{initLangSelector:function(c){a().ready(function(){b(c)})}}});
//# sourceMappingURL=multilanguagequestion.min.js.map

define ("qtype_coderunner/ui_graph",["jquery","qtype_coderunner/graphutil","qtype_coderunner/graphelements"],function(a,b,c){function d(b,c,d,e){this.HANDLE_SIZE=10;this.parent=b;this.canvas=a(document.createElement("canvas"));this.canvas.attr({id:c,class:"coderunner_graphcanvas",tabindex:1});this.canvas.css({"background-color":"white"});this.canvas.on("mousedown",function(a){return b.mousedown(a)});this.canvas.on("mouseup",function(a){return b.mouseup(a)});this.canvas.on("dblclick",function(a){return b.dblclick(a)});this.canvas.on("keydown",function(a){return b.keydown(a)});this.canvas.on("mousemove",function(a){return b.mousemove(a)});this.canvas.on("keypress",function(a){return b.keypress(a)});this.resize=function(a,b){this.canvas.attr("width",a);this.canvas.attr("height",b)};this.resize(d,e)}function e(b,e,f,g){var h=this;this.SNAP_TO_PADDING=6;this.DUPLICATE_LINK_OFFSET=16;this.HIT_TARGET_PADDING=6;this.DEFAULT_NODE_RADIUS=26;this.DEFAULT_FONT_SIZE=20;this.DEFAULT_TEXT_OFFSET=5;this.DEFAULT_LINK_LABEL_REL_DIST=.5;this.MAX_VERSIONS=30;this.canvasId="graphcanvas_"+b;this.textArea=a(document.getElementById(b));this.helpText="";this.readOnly=this.textArea.prop("readonly");this.templateParams=g;this.graphCanvas=new d(this,this.canvasId,e,f);this.caretVisible=!0;this.caretTimer=0;this.originalClick=null;this.nodes=[];this.links=[];this.selectedObject=null;this.currentLink=null;this.movingObject=!1;this.fail=!1;this.failString=null;this.versions=[];this.versionIndex=-1;this.helpBox=new c.HelpBox(this,0,0);this.clearButton=new c.Button(this,60,0,"Clear");this.clearButton.onClick=function(){if(confirm("Are you sure you want to clear the diagram?")){this.parent.clear()}};this.buttons=[this.helpBox,this.clearButton];if("locknodes"in g){g.locknodepositions=g.locknodes}if("lockedges"in g){g.lockedgepositions=g.lockedges}if("helpmenutext"in g){this.helpText=g.helpmenutext}else{require(["core/str"],function(b){var c=b.get_string("graphhelp","qtype_coderunner");a.when(c).done(function(a){h.helpText=a})})}this.reload();if(!this.fail){this.draw()}}e.prototype.failed=function(){return this.fail};e.prototype.failMessage=function(){return this.failString};e.prototype.getElement=function(){return this.getCanvas()};e.prototype.hasFocus=function(){return document.activeElement==this.getCanvas()};e.prototype.getCanvas=function(){var a=this.graphCanvas.canvas[0];return a};e.prototype.nodeRadius=function(){return this.templateParams.noderadius?this.templateParams.noderadius:this.DEFAULT_NODE_RADIUS};e.prototype.fontSize=function(){return this.templateParams.fontsize?this.templateParams.fontsize:this.DEFAULT_FONT_SIZE};e.prototype.isFsm=function(){return this.templateParams.isfsm!==void 0?this.templateParams.isfsm:!0};e.prototype.textOffset=function(){return this.templateParams.textoffset?this.templateParams.textoffset:this.DEFAULT_TEXT_OFFSET};e.prototype.arrowIfReqd=function(a,c,d,e){if(this.templateParams.isdirected===void 0||this.templateParams.isdirected){b.drawArrow(a,c,d,e)}};e.prototype.sync=function(){};e.prototype.keypress=function(a){var c=b.crossBrowserKey(a);if(this.readOnly){return}if(32<=c&&126>=c&&!a.metaKey&&!a.altKey&&!a.ctrlKey&&37!==c&&39!==c&&null!==this.selectedObject&&this.canEditText()){if(this.selectedObject.justMoved){this.saveVersion()}this.selectedObject.justMoved=!1;this.selectedObject.textBox.insertChar(String.fromCharCode(c));this.resetCaret();this.draw();return!1}else if(8===c||32===c||9===c){return!1}};e.prototype.mousedown=function(a){var d=b.crossBrowserRelativeMousePos(a);if(this.readOnly){return}this.selectedObject=this.selectObject(d.x,d.y);this.movingObject=!1;this.movingGraph=!1;this.movingText=!1;this.originalClick=d;this.saveVersion();if(this.selectedObject!==this.helpBox){this.helpBox.helpOpen=!1}if(null!==this.selectedObject){if(this.selectedObject instanceof c.Button){this.selectedObject.onClick()}else if(a.shiftKey&&this.selectedObject instanceof c.Node){if(!this.templateParams.lockedgeset){this.currentLink=new c.SelfLink(this,this.selectedObject,d)}}else if(a.altKey&&this.selectedObject instanceof c.Node){if(!this.templateParams.locknodepositions){this.movingGraph=!0;this.movingNodes=this.selectedObject.traverseGraph(this.links,[]);for(var e=0;e<this.movingNodes.length;e++){this.movingNodes[e].setMouseStart(d.x,d.y)}}}else if(this.selectedObject instanceof c.TextBox){if(!this.templateParams.lockedgelabels){this.movingText=!0;this.selectedObject.setMouseStart(d.x,d.y);this.selectedObject=this.selectedObject.parent}}else if(!(this.templateParams.locknodepositions&&this.selectedObject instanceof c.Node)&&!(this.templateParams.lockedgepositions&&this.selectedObject instanceof c.Link)){this.movingObject=!0;if(this.selectedObject.setMouseStart){this.selectedObject.setMouseStart(d.x,d.y)}}this.selectedObject.justMoved=!0;this.resetCaret()}else if(a.shiftKey&&this.isFsm()){this.currentLink=new c.TemporaryLink(this,d,d)}this.draw();if(this.hasFocus()){return!1}else{this.resetCaret();return!0}};e.prototype.canEditText=function(){var a=this.selectedObject instanceof c.Node,b=this.selectedObject instanceof c.Link||this.selectedObject instanceof c.SelfLink;return"textBox"in this.selectedObject&&(a&&!this.templateParams.locknodelabels||b&&!this.templateParams.lockedgelabels)};e.prototype.keydown=function(a){var c=b.crossBrowserKey(a),d,e=!1;if(this.readOnly){return}if(8===c){if(null!==this.selectedObject&&this.canEditText()){this.selectedObject.textBox.deleteChar();this.resetCaret();this.draw()}return!1}else if(46===c&&null!==this.selectedObject){this.saveVersion();for(d=0;d<this.nodes.length;d++){if(this.nodes[d]===this.selectedObject&&!this.templateParams.locknodeset){this.nodes.splice(d--,1);e=!0}}for(d=0;d<this.links.length;d++){if(this.links[d]===this.selectedObject&&!this.templateParams.lockedgeset||e&&(this.links[d].node===this.selectedObject||this.links[d].nodeA===this.selectedObject||this.links[d].nodeB===this.selectedObject)){this.links.splice(d--,1)}}this.selectedObject=null;this.draw()}else if(13===c){if(null!==this.selectedObject){this.selectedObject=null;this.draw()}}else if(37===c){if(null!==this.selectedObject&&this.canEditText()){this.selectedObject.textBox.caretLeft();this.resetCaret();this.draw()}}else if(39===c){if(null!==this.selectedObject&&this.canEditText()){this.selectedObject.textBox.caretRight();this.resetCaret();this.draw()}}else if(90==a.keyCode&&a.ctrlKey&&a.shiftKey||89==a.keyCode&&a.ctrlKey){this.redo()}else if(90==a.keyCode&&a.ctrlKey){this.undo()}};e.prototype.dblclick=function(a){var d=b.crossBrowserRelativeMousePos(a);if(this.readOnly||this.templateParams.locknodeset){return}this.selectedObject=this.selectObject(d.x,d.y);this.saveVersion();if(null===this.selectedObject){this.selectedObject=new c.Node(this,d.x,d.y);this.nodes.push(this.selectedObject);this.selectedObject.justMoved=!0;this.resetCaret();this.draw()}else{if(this.selectedObject instanceof c.Node&&this.isFsm()){this.selectedObject.isAcceptState=!this.selectedObject.isAcceptState;this.draw()}}};e.prototype.resize=function(a,b){this.graphCanvas.resize(a,b);this.draw()};e.prototype.mousemove=function(a){var d=b.crossBrowserRelativeMousePos(a),e;if(this.readOnly){return}for(h=0;h<this.buttons.length;h++){if(this.buttons[h].containsPoint(d.x,d.y)){this.buttons[h].highLighted=!0}else{this.buttons[h].highLighted=!1}this.draw()}if(null!==this.currentLink){var f=this.selectObject(d.x,d.y);if(!(f instanceof c.Node)){f=null}if(null===this.selectedObject){if(null!==f){this.currentLink=new c.StartLink(this,f,this.originalClick)}else{this.currentLink=new c.TemporaryLink(this,this.originalClick,d)}}else{if(f===this.selectedObject){this.currentLink=new c.SelfLink(this,this.selectedObject,d)}else if(null!==f){this.currentLink=new c.Link(this,this.selectedObject,f)}else{e=this.selectedObject.closestPointOnCircle(d.x,d.y);this.currentLink=new c.TemporaryLink(this,e,d)}}this.draw()}if(this.movingGraph){for(var g=this.movingNodes,h=0;h<g.length;h++){g[h].trackMouse(d.x,d.y);this.snapNode(g[h])}this.draw()}else if(this.movingText){this.selectedObject.textBox.setAnchorPoint(d.x,d.y);this.draw()}else if(this.movingObject){this.selectedObject.setAnchorPoint(d.x,d.y);if(this.selectedObject instanceof c.Node){this.snapNode(this.selectedObject)}this.draw()}};e.prototype.mouseup=function(){if(this.readOnly){return}this.movingObject=!1;this.movingGraph=!1;this.movingText=!1;if(null!==this.currentLink){if(!(this.currentLink instanceof c.TemporaryLink)){this.selectedObject=this.currentLink;this.addLink(this.currentLink);this.resetCaret()}this.currentLink=null;this.draw()}};e.prototype.selectObject=function(a,b){for(c=0;c<this.buttons.length;c++){if(this.buttons[c].containsPoint(a,b)){return this.buttons[c]}}var c;for(c=0;c<this.nodes.length;c++){if(this.nodes[c].containsPoint(a,b)){return this.nodes[c]}}for(c=0;c<this.links.length;c++){if(this.links[c].containsPoint(a,b)){return this.links[c]}else if("textBox"in this.links[c]&&this.links[c].textBox.containsPoint(a,b)){return this.links[c].textBox}}return null};e.prototype.snapNode=function(a){for(var b=0;b<this.nodes.length;b++){if(this.nodes[b]===a){continue}if(Math.abs(a.x-this.nodes[b].x)<this.SNAP_TO_PADDING){a.x=this.nodes[b].x}if(Math.abs(a.y-this.nodes[b].y)<this.SNAP_TO_PADDING){a.y=this.nodes[b].y}}};e.prototype.addLink=function(a){for(var b=null,c=0,d;c<this.links.length;c++){d=this.links[c];if(d.nodeA===a.nodeA&&d.nodeB===a.nodeB){if(null===b||d.perpendicularPart>b){b=d.perpendicularPart}}if(d.nodeA===a.nodeB&&d.nodeB===a.nodeA){if(null===b||-d.perpendicularPart>b){b=-d.perpendicularPart}}}if(null!==b){a.perpendicularPart=b+this.DUPLICATE_LINK_OFFSET}this.links.push(a)};e.prototype.reload=function(){var b=a(this.textArea).val();if(b){try{var d=JSON.parse(b),e;for(e=0;e<d.nodes.length;e++){var f=d.nodes[e],g=d.nodeGeometry[e],h=new c.Node(this,g[0],g[1]);h.isAcceptState=f[1];h.textBox=new c.TextBox(f[0].toString(),h);this.nodes.push(h)}for(e=0;e<d.edges.length;e++){var j=d.edges[e],k=d.edgeGeometry[e],l=null;if(j[0]===j[1]){l=new c.SelfLink(this,this.nodes[j[0]]);l.anchorAngle=k.anchorAngle;l.textBox=new c.TextBox(j[2].toString(),l);if(3<j.length){l.textBox.setAnchorPoint(j[3].x,j[3].y)}}else if(-1===j[0]){l=new c.StartLink(this,this.nodes[j[1]]);l.deltaX=k.deltaX;l.deltaY=k.deltaY}else{l=new c.Link(this,this.nodes[j[0]],this.nodes[j[1]]);l.parallelPart=k.parallelPart;l.perpendicularPart=k.perpendicularPart;l.lineAngleAdjust=k.lineAngleAdjust;l.textBox=new c.TextBox(j[2].toString(),l);if(3<j.length){l.textBox.setAnchorPoint(j[3].x,j[3].y)}}if(null!==l){this.links.push(l)}}}catch(a){this.fail=!0;this.failString="graph_ui_invalidserialisation"}}};e.prototype.save=function(){var a={edgeGeometry:[],nodeGeometry:[],nodes:[],edges:[]},b;if(!JSON||""===this.textArea.val().trim()&&0===this.nodes.length){return}for(b=0;b<this.nodes.length;b++){var d=this.nodes[b],e=[d.textBox.text,d.isAcceptState],f=[d.x,d.y];a.nodeGeometry.push(f);a.nodes.push(e)}for(b=0;b<this.links.length;b++){var g=this.links[b],h=null,j=null;if(g instanceof c.SelfLink){j={anchorAngle:g.anchorAngle};h=[this.nodes.indexOf(g.node),this.nodes.indexOf(g.node),g.textBox.text];if(g.textBox.dragged){h.push(g.textBox.position)}}else if(g instanceof c.StartLink){j={deltaX:g.deltaX,deltaY:g.deltaY};h=[-1,this.nodes.indexOf(g.node),""]}else if(g instanceof c.Link){j={lineAngleAdjust:g.lineAngleAdjust,parallelPart:g.parallelPart,perpendicularPart:g.perpendicularPart};h=[this.nodes.indexOf(g.nodeA),this.nodes.indexOf(g.nodeB),g.textBox.text];if(g.textBox.dragged){h.push(g.textBox.position)}}if(null!==h&&null!==j){a.edges.push(h);a.edgeGeometry.push(j)}}this.textArea.val(JSON.stringify(a))};e.prototype.saveVersion=function(){var a=this.textArea.val();if(0==this.versions.length||0!=a.localeCompare(this.versions[this.versionIndex])){this.versionIndex++;while(this.versionIndex<this.versions.length){this.versions.pop()}this.versions.push(a);if(this.versions.length>this.MAX_VERSIONS){this.versions.shift();this.versionIndex--}}};e.prototype.undo=function(){this.saveVersion();if(0<this.versionIndex){this.versionIndex--;this.textArea.val(this.versions[this.versionIndex]);this.nodes=[];this.links=[];this.reload();this.draw()}};e.prototype.redo=function(){if(this.versionIndex<this.versions.length-1){this.versionIndex++;this.textArea.val(this.versions[this.versionIndex]);this.nodes=[];this.links=[];this.reload();this.draw()}};e.prototype.clear=function(){this.saveVersion();this.nodes=[];this.links=[];this.save();this.draw()};e.prototype.destroy=function(){clearInterval(this.caretTimer);this.graphCanvas.canvas.off();this.graphCanvas.canvas.remove()};e.prototype.resetCaret=function(){var a=this;clearInterval(this.caretTimer);this.caretTimer=setInterval(function(){a.caretVisible=!a.caretVisible;a.draw()},500);this.caretVisible=!0};e.prototype.draw=function(){var a=this.getCanvas(),b=a.getContext("2d"),c;b.clearRect(0,0,this.getCanvas().width,this.getCanvas().height);b.save();b.translate(.5,.5);for(c=0;c<this.buttons.length;c++){this.buttons[c].draw(b)}if(!this.helpBox.helpOpen){for(c=0;c<this.nodes.length;c++){b.lineWidth=1;b.fillStyle=b.strokeStyle=this.nodes[c]===this.selectedObject?"blue":"black";this.nodes[c].draw(b)}for(c=0;c<this.links.length;c++){b.lineWidth=1;b.fillStyle=b.strokeStyle=this.links[c]===this.selectedObject||this.links[c].textBox===this.selectedObject?"blue":"black";this.links[c].draw(b)}if(null!==this.currentLink){b.lineWidth=1;b.fillStyle=b.strokeStyle="black";this.currentLink.draw(b)}}b.restore();this.save()};return{Constructor:e}});
//# sourceMappingURL=ui_graph.min.js.map

define ("qtype_coderunner/ui_html",["jquery"],function(a){function b(b,c,d,e){this.textArea=a(document.getElementById(b));this.html=this.textArea.attr("data-globalextra");this.readOnly=this.textArea.prop("readonly");this.templateParams=e;this.fail=!1;this.htmlDiv=null;this.reload()}b.prototype.failed=function(){return this.fail};b.prototype.sync=function(){var b={},c,d=!0;this.getFields().each(function(){var e,f;f=a(this).attr("type");c=a(this).attr("name");if(("checkbox"===f||"radio"===f)&&!a(this).is(":checked")){e=""}else{e=a(this).val()}if(b.hasOwnProperty(c)){b[c].push(e)}else{b[c]=[e]}if(""!==e){d=!1}});if(d){this.textArea.val("")}else{this.textArea.val(JSON.stringify(b))}};b.prototype.getElement=function(){return this.htmlDiv};b.prototype.getFields=function(){return a(this.htmlDiv).find(".coderunner-ui-element")};b.prototype.setField=function(a,b){if("checkbox"===a.attr("type")||"radio"===a.attr("type")){a.prop("checked",a.val()===b)}else{a.val(b)}};b.prototype.reload=function(){var b=a(this.textArea).val(),c,d,e,f,g;this.htmlDiv=a("<div style='height:fit-content' class='qtype-coderunner-html-outer-div'>"+this.html+"</div>");this.htmlDiv.data("templateparams",this.templateParams);if(b){try{c=JSON.parse(b);g={};for(var h in c){d=c[h];f=this.getFields().filter("[name='"+h+"']");g[h]=[];for(e=0;e<d.length;e++){if(e<f.length){this.setField(a(f[e]),d[e])}else{g[h].push(d[e])}}if(0===g[h].length){delete g[h]}}if(!a.isEmptyObject(g)){this.htmlDiv.data("leftovers",g)}}catch(a){alert("Failed to initialise HTML UI");this.fail=!0}}};b.prototype.resize=function(){};b.prototype.hasFocus=function(){var a=!1;this.getFields().each(function(){if(this===document.activeElement){a=!0}});return a};b.prototype.destroy=function(){this.sync();a(this.htmlDiv).remove();this.htmlDiv=null};return{Constructor:b}});
//# sourceMappingURL=ui_html.min.js.map

define ("qtype_coderunner/ui_table",["jquery"],function(a){function b(b,c,d,e){this.textArea=a(document.getElementById(b));this.readOnly=this.textArea.prop("readonly");this.tableDiv=null;this.templateParams=e;if(!e.table_num_columns||!e.table_num_rows){this.fail=!0;this.failString="table_ui_missingparams";return}this.fail=!1;this.lockedCells=e.table_locked_cells||[];this.hasHeader=e.hasOwnProperty("table_column_headers");this.hasRowLabels=e.hasOwnProperty("table_row_labels");this.numDataColumns=e.table_num_columns;this.totNumColumns=this.numDataColumns+(this.hasRowLabels?1:0);this.columnWidths=this.computeColumnWidths();this.reload()}b.prototype.computeColumnWidths=function(){var a=Math.trunc(100/this.totNumColumns),b=[];if(this.templateParams.table_column_width_percents){return this.templateParams.table_column_width_percents}else if(Array.prototype.fill){return Array(this.totNumColumns).fill(a)}else{for(var c=0;c<this.totNumColumns;c++){b.push(a)}return b}};b.prototype.isLockedCell=function(a,b){for(var c=0;c<this.lockedCells.length;c++){if(this.lockedCells[c][0]==a&&this.lockedCells[c][1]==b){return!0}}return!1};b.prototype.getElement=function(){return this.tableDiv};b.prototype.failed=function(){return this.fail};b.prototype.failMessage=function(){return this.failString};b.prototype.sync=function(){var b=[],c=!0,d=a(this.tableDiv).find("table tbody tr");d.each(function(){var d=[];a(this).find("textarea").each(function(){var b=a(this).val();d.push(b);if(b){c=!1}});b.push(d)});if(c){this.textArea.val("")}else{this.textArea.val(JSON.stringify(b))}};b.prototype.tableRow=function(a,b){var c="<tr>",d=0,e;if(this.hasRowLabels){e=this.columnWidths[0];d=1;c+="<th style='padding-top:8px;text-align:center;width:"+e+"%' scope='row'>";if(a<this.templateParams.table_row_labels.length){c+=this.templateParams.table_row_labels[a]}c+="</th>"}for(var f=0;f<this.numDataColumns;f++){e=this.columnWidths[d++];c+="<td style='padding:2px;margin:0,width:"+e+"'%>";c+="<textarea rows=\"2\" style=\"width:100%;padding:0;resize:vertical;font-family: monospace\"";if(this.isLockedCell(a,f)){c+=" disabled>"}else{c+=">"}if(a<b.length){c+=b[a][f]}c+="</textarea>";c+="</td>"}c+="</tr>";return c};b.prototype.tableHeadSection=function(){var a="<thead>\n",b=0;if(this.hasHeader){a+="<tr>";if(this.hasRowLabels){a+="<th style='width:"+this.columnWidths[0]+"%'></th>";b+=1}for(var c=0;c<this.numDataColumns;c++){a+="<th style='width:"+this.columnWidths[b]+"%'>";if(c<this.templateParams.table_column_headers.length){a+=this.templateParams.table_column_headers[c]}b++;a+="</th>"}a+="</tr>\n"}a+="</thead>\n";return a};b.prototype.reload=function(){var b=a(this.textArea).val(),c=[],d="<div style='height:fit-content' class='qtype-coderunner-table-outer-div'>\n<table class='table table-bordered qtype-coderunner_table'>\n";if(b){try{c=JSON.parse(b)}catch(a){this.fail=!0;this.failString="table_ui_invalidjson";return}}try{d+=this.tableHeadSection();d+="<tbody>\n";for(var e=Math.max(this.templateParams.table_num_rows,c.length),f=0;f<e;f++){d+=this.tableRow(f,c)}d+="</tbody>\n</table>\n</div>";this.tableDiv=a(d);if(this.templateParams.table_dynamic_rows){this.addButtons()}}catch(a){this.fail=!0;this.failString="table_ui_invalidserialisation"}};b.prototype.addButtons=function(){var b=a("<button type=\"button\"style=\"float:right;margin-right:6px\" disabled>Delete row</button>"),c=this;this.tableDiv.append(b);b.click(function(){var b=c.tableDiv.find("table tbody tr").length,d=c.tableDiv.find("tr:last");if(b>c.templateParams.table_num_rows){d.remove()}d=c.tableDiv.find("tr:last");if(b==c.templateParams.table_num_rows+1){a(this).prop("disabled",!0)}});var d=a("<button type=\"button\"style=\"float:right;margin-right:6px\">Add row</button>");c.tableDiv.append(d);d.click(function(){var b,d;b=c.tableDiv.find("table tbody tr:last");d=b.clone();d.find("textarea").each(function(){a(this).val("")});b.after(d);a(this).prev().prop("disabled",!1)})};b.prototype.resize=function(){};b.prototype.hasFocus=function(){var b=!1;a(this.tableDiv).find("textarea").each(function(){if(this===document.activeElement){b=!0}});return b};b.prototype.destroy=function(){this.sync();a(this.tableDiv).remove();this.tableDiv=null};return{Constructor:b}});
//# sourceMappingURL=ui_table.min.js.map

define ("qtype_coderunner/ui_ace",["jquery"],function(a){function b(b,c,d,e){var f=a(document.getElementById(b)),g=f[0]===document.activeElement,h=e.lang,i;try{window.ace.require("ace/ext/language_tools");this.modelist=window.ace.require("ace/ext/modelist");this.textarea=f;this.enabled=!1;this.contents_changed=!1;this.capturingTab=!1;this.clickInProgress=!1;this.editNode=a("<div></div>");this.editNode.css({resize:"none",height:d,width:"100%"});this.editor=window.ace.edit(this.editNode.get(0));if(f.prop("readonly")){this.editor.setReadOnly(!0)}this.editor.setOptions({enableBasicAutocompletion:!0,newLineMode:"unix"});this.editor.$blockScrolling=1/0;i=this.editor.getSession();i.setValue(this.textarea.val());this.setLanguage(h);this.setEventHandlers(f);this.captureTab();a(".ace_gutter").addClass("moodle-has-zindex");f.hide();if(g){this.editor.focus();this.editor.navigateFileEnd()}this.aceLabel=a(".answerprompt");this.aceLabel.attr("for","ace_"+b);this.aceTextarea=a(".ace_text-input");this.aceTextarea.attr("id","ace_"+b);this.fail=!1}catch(a){this.fail=!0}}b.prototype.failed=function(){return this.fail};b.prototype.failMessage=function(){return"ace_ui_notready"};b.prototype.sync=function(){};b.prototype.setLanguage=function(a){var b=this.editor.getSession(),c=this.findMode(a);if(c){b.setMode(c.mode)}};b.prototype.getElement=function(){return this.editNode};b.prototype.captureTab=function(){this.capturingTab=!0;this.editor.commands.bindKeys({Tab:"indent","Shift-Tab":"outdent"})};b.prototype.releaseTab=function(){this.capturingTab=!1;this.editor.commands.bindKeys({Tab:null,"Shift-Tab":null})};b.prototype.setEventHandlers=function(){var a=this;this.editor.getSession().on("change",function(){a.textarea.val(a.editor.getSession().getValue());a.contents_changed=!0});this.editor.on("blur",function(){if(a.contents_changed){a.textarea.trigger("change")}});this.editor.on("mousedown",function(){a.clickInProgress=!0});this.editor.on("focus",function(){if(a.clickInProgress){a.captureTab()}else{a.releaseTab()}});this.editor.on("click",function(){a.clickInProgress=!1});this.editor.container.addEventListener("keydown",function(b){if(b.which===void 0||0!==b.which){if(b.keyCode===77&&b.ctrlKey&&!b.altKey){if(a.capturingTab){a.releaseTab()}else{a.captureTab()}b.preventDefault()}else if(b.keyCode===27){a.releaseTab()}else if(!(b.shiftKey||b.ctrlKey||b.altKey||b.keyCode==9)){a.captureTab()}}},!0)};b.prototype.destroy=function(){var b;if(!this.fail){b=this.editor.isFocused();this.textarea.val(this.editor.getSession().getValue());this.editor.destroy();a(this.editNode).remove();if(b){this.textarea.focus();this.textarea[0].selectionStart=this.textarea[0].value.length}}};b.prototype.hasFocus=function(){return this.editor.isFocused()};b.prototype.findMode=function(a){var b,c,d,e=[],f={octave:"matlab",nodejs:"javascript","c#":"cs"};if("string"!=typeof a){return}if(a.toLowerCase()in f){a=f[a.toLowerCase()]}e=[a,a.replace(/\d+$/,"")];for(var g=0;g<e.length;g++){b=e[g];c="input."+b;d=this.modelist.modesByName[b]||this.modelist.modesByName[b.toLowerCase()]||this.modelist.getModeForPath(c)||this.modelist.getModeForPath(c.toLowerCase());if(d&&"text"!==d.name){return d}}};b.prototype.resize=function(a,b){this.editNode.outerHeight(b);this.editNode.outerWidth(a);this.editor.resize()};return{Constructor:b}});
//# sourceMappingURL=ui_ace.min.js.map

define ("qtype_coderunner/resetbutton",["jquery"],function(a){return{initResetButton:function(b,c,d){var e=a("[id=\""+b+"\"]"),f=a("[id=\""+c+"\"]"),g;e.on("click",function(){if(window.behattesting||window.confirm(d)){var a=e.attr("data-reload-text");g=f.data("current-ui-wrapper");if(g&&g.uiInstance){g.stop();f.val(a);g.restart()}else{f.val(a)}}})}}});
//# sourceMappingURL=resetbutton.min.js.map

define ("qtype_coderunner/showdiff",["jquery"],function(a){function b(a,b){var c=a.length,d=b.length,e,f,g,h="function"==typeof[1].fill;e=[];for(f=0;f<=c;f+=1){e[f]=Array(d+1);if(h){e[f].fill(0)}else{for(g=0;g<d+1;g++){e[f][g]=0}}}for(f=0;f<c;f+=1){for(g=0;g<d;g+=1){if(a[f]==b[g]){e[f+1][g+1]=1+e[f][g]}else{e[f+1][g+1]=Math.max(e[f][g+1],e[f+1][g])}}}return e}function c(a,c){var d,e,f,g,h,k;d=b(a,c);k=d[a.length][c.length];h=[];e=a.length;f=c.length;g=k-1;while(0<=g){if(a[e-1]==c[f-1]){h[g]=a[e-1];g-=1;e-=1;f-=1}else if(d[e-1][f]==d[e][f]){e-=1}else{f-=1}}return h}function d(a,b,c,d){var e="",f=!1,g,h=0;if(c===void 0){c="<del>"}if(d===void 0){d="</del>"}for(g=0;g<a.length;g+=1){if(h<b.length&&a[g]==b[h]){if(f){e+=d;f=!1}h+=1}else{if(!f){e+=c;f=!0}}e+=a[g]}if(f){e+=d}return e}function e(a){return a.tagName.toLowerCase()}function f(a){var c="pre"===e(a),d=a.innerHTML,f,g=0;function b(){var a,b;if("&"!=d[g]){a=d[g];g=g+1}else{b=d.substring(g,d.length).match(/(^&[a-zA-Z]+;)|(^&#[0-9]+;)|(^&#[xX][0-9a-fA-F]+;)/);if(null===b){a=d[g];g=g+1}else{a=b[0];g=g+a.length}}return a}if(c){d=d.replace(/\n/g,"\u21A9\n")}d=d.replace(/(<br ?.*?>)/g,"\u21A9$1");f=[];g=0;while(g<d.length){f.push(b())}return f}function g(a,b){var e,g,h;e=f(a);g=f(b);h=c(e,g);a.innerHTML=d(e,h,"<del>","</del>");b.innerHTML=d(g,h,"<del>","</del>")}function h(a,b){var c=/(<\/?del[^>]*>)|(â†©)/g;a.innerHTML=a.innerHTML.replace(c,"");b.innerHTML=b.innerHTML.replace(c,"")}function i(a,b,c,d){for(var e,f,g,h,j=0;j<a.length;j++){e=a[j];f=e.getElementsByTagName("td");g=f[c].children[0];h=f[b].children[0];d(g,h)}}return{initDiffButton:function(b,c,d,e,f){var j=a("[id=\""+b+"\"]"),k,l,m,n=0,o=-1,p=-1;k=j.closest("div.coderunner-test-results");m=k.find("thead tr").children();l=k.find("tbody tr");m.each(function(){if(a(this).html()===f){o=n}else if(a(this).html()===e){p=n}n+=1});if(-1!==o&&-1!==p){j.on("click",function(){if(j.prop("value")===c){i(l.toArray(),o,p,g);j.prop("value",d)}else{i(l.toArray(),o,p,h);j.prop("value",c)}})}else{j.enabled=!1;j.hide()}}}});
//# sourceMappingURL=showdiff.min.js.map

define ("qtype_coderunner/graphelements",["qtype_coderunner/graphutil"],function(a){function b(a,b,c){this.parent=a;this.x=b;this.y=c;this.mouseOffsetX=0;this.mouseOffsetY=0;this.isAcceptState=!1;this.textBox=new i("",this);this.caretPosition=0}b.prototype.setMouseStart=function(a,b){this.mouseOffsetX=this.x-a;this.mouseOffsetY=this.y-b};b.prototype.setAnchorPoint=function(a,b){this.x=a+this.mouseOffsetX;this.y=b+this.mouseOffsetY};b.prototype.trackMouse=function(a,b){this.x=this.mouseOffsetX+a;this.y=this.mouseOffsetY+b};b.prototype.draw=function(a){a.beginPath();a.arc(this.x,this.y,this.parent.nodeRadius(),0,2*Math.PI,!1);a.stroke();this.textBox.draw(this.x,this.y,null,this);if(this.isAcceptState){a.beginPath();a.arc(this.x,this.y,this.parent.nodeRadius()-6,0,2*Math.PI,!1);a.stroke()}};b.prototype.closestPointOnCircle=function(a,b){var c=a-this.x,d=b-this.y,e=Math.sqrt(c*c+d*d);return{x:this.x+c*this.parent.nodeRadius()/e,y:this.y+d*this.parent.nodeRadius()/e}};b.prototype.containsPoint=function(a,b){return(a-this.x)*(a-this.x)+(b-this.y)*(b-this.y)<this.parent.nodeRadius()*this.parent.nodeRadius()};b.prototype.neighbours=function(a){for(var b=[],d,e=0;e<a.length;e++){d=a[e];if(d instanceof c){if(d.nodeA===this&&!b.includes(d.nodeB)){b.push(d.nodeB)}else if(d.nodeB===this&&!b.includes(d.nodeA)){b.push(d.nodeA)}}}return b};b.prototype.traverseGraph=function(a,b){var c,d;if(!b.includes(this)){b.push(this);c=this.neighbours(a);for(var e=0;e<c.length;e++){d=c[e];if(!b.includes(d)){d.traverseGraph(a,b)}}}return b};function c(c,d,a){this.parent=c;this.nodeA=d;this.nodeB=a;this.textBox=new i("",this);this.lineAngleAdjust=0;this.caretPosition=0;this.parallelPart=.5;this.perpendicularPart=0}c.prototype.getAnchorPoint=function(){var a=this.nodeB.x-this.nodeA.x,b=this.nodeB.y-this.nodeA.y,c=Math.sqrt(a*a+b*b);return{x:this.nodeA.x+a*this.parallelPart-b*this.perpendicularPart/c,y:this.nodeA.y+b*this.parallelPart+a*this.perpendicularPart/c}};c.prototype.setAnchorPoint=function(a,b){var c=this.nodeB.x-this.nodeA.x,d=this.nodeB.y-this.nodeA.y,e=Math.sqrt(c*c+d*d);this.parallelPart=(c*(a-this.nodeA.x)+d*(b-this.nodeA.y))/(e*e);this.perpendicularPart=(c*(b-this.nodeA.y)-d*(a-this.nodeA.x))/e;if(0<this.parallelPart&&1>this.parallelPart&&Math.abs(this.perpendicularPart)<this.parent.SNAP_TO_PADDING){this.lineAngleAdjust=(0>this.perpendicularPart)*Math.PI;this.perpendicularPart=0}};c.prototype.getEndPointsAndCircle=function(){if(0===this.perpendicularPart){var b=(this.nodeA.x+this.nodeB.x)/2,c=(this.nodeA.y+this.nodeB.y)/2,d=this.nodeA.closestPointOnCircle(b,c),e=this.nodeB.closestPointOnCircle(b,c);return{hasCircle:!1,startX:d.x,startY:d.y,endX:e.x,endY:e.y}}var f=this.getAnchorPoint(),g=a.circleFromThreePoints(this.nodeA.x,this.nodeA.y,this.nodeB.x,this.nodeB.y,f.x,f.y),h=0<this.perpendicularPart,i=h?1:-1,j=i*this.parent.nodeRadius()/g.radius,k=Math.atan2(this.nodeA.y-g.y,this.nodeA.x-g.x)-j,l=Math.atan2(this.nodeB.y-g.y,this.nodeB.x-g.x)+j,m=g.x+g.radius*Math.cos(k),n=g.y+g.radius*Math.sin(k),o=g.x+g.radius*Math.cos(l),p=g.y+g.radius*Math.sin(l);return{hasCircle:!0,startX:m,startY:n,endX:o,endY:p,startAngle:k,endAngle:l,circleX:g.x,circleY:g.y,circleRadius:g.radius,reverseScale:i,isReversed:h}};c.prototype.draw=function(a){var b=this.getEndPointsAndCircle(),c,d,e,f;a.beginPath();if(b.hasCircle){a.arc(b.circleX,b.circleY,b.circleRadius,b.startAngle,b.endAngle,b.isReversed)}else{a.moveTo(b.startX,b.startY);a.lineTo(b.endX,b.endY)}a.stroke();if(b.hasCircle){this.parent.arrowIfReqd(a,b.endX,b.endY,b.endAngle-b.reverseScale*(Math.PI/2))}else{this.parent.arrowIfReqd(a,b.endX,b.endY,Math.atan2(b.endY-b.startY,b.endX-b.startX))}f=this.textBox.relDist;if(b.hasCircle){var g=b.startAngle,h=b.endAngle;if(h<g){h+=2*Math.PI}e=(1-f)*g+f*h;if(b.isReversed){e+=(1-f)*(2*Math.PI)}c=b.circleX+b.circleRadius*Math.cos(e);d=b.circleY+b.circleRadius*Math.sin(e);this.textBox.draw(c,d,e,this)}else{c=(1-f)*b.startX+f*b.endX;d=(1-f)*b.startY+f*b.endY;e=Math.atan2(b.endX-b.startX,b.startY-b.endY);this.textBox.draw(c,d,e+this.lineAngleAdjust,this)}};c.prototype.containsPoint=function(a,b){var c=this.getEndPointsAndCircle(),d,e,f;if(c.hasCircle){d=a-c.circleX;e=b-c.circleY;f=Math.sqrt(d*d+e*e)-c.circleRadius;if(Math.abs(f)<this.parent.HIT_TARGET_PADDING){var g=Math.atan2(e,d),h=c.startAngle,i=c.endAngle;if(c.isReversed){var j=h;h=i;i=j}if(i<h){i+=2*Math.PI}if(g<h){g+=2*Math.PI}else if(g>i){g-=2*Math.PI}return g>h&&g<i}}else{d=c.endX-c.startX;e=c.endY-c.startY;var k=Math.sqrt(d*d+e*e),l=(d*(a-c.startX)+e*(b-c.startY))/(k*k);f=(d*(b-c.startY)-e*(a-c.startX))/k;return 0<l&&1>l&&Math.abs(f)<this.parent.HIT_TARGET_PADDING}return!1};function d(a,b,c){this.parent=a;this.node=b;this.anchorAngle=0;this.mouseOffsetAngle=0;this.textBox=new i("",this);if(c){this.setAnchorPoint(c.x,c.y)}}d.prototype.setMouseStart=function(a,b){this.mouseStartX=a;this.mouseStartY=b};d.prototype.setAnchorPoint=function(a,b){this.anchorAngle=Math.atan2(b-this.node.y,a-this.node.x)+this.mouseOffsetAngle;var c=Math.round(this.anchorAngle/(Math.PI/2))*(Math.PI/2);if(.1>Math.abs(this.anchorAngle-c)){this.anchorAngle=c}if(this.anchorAngle<-Math.PI){this.anchorAngle+=2*Math.PI}if(this.anchorAngle>Math.PI){this.anchorAngle-=2*Math.PI}};d.prototype.getEndPointsAndCircle=function(){var a=this.node.x+1.5*this.parent.nodeRadius()*Math.cos(this.anchorAngle),b=this.node.y+1.5*this.parent.nodeRadius()*Math.sin(this.anchorAngle),c=.75*this.parent.nodeRadius(),d=this.anchorAngle-.8*Math.PI,e=this.anchorAngle+.8*Math.PI,f=a+c*Math.cos(d),g=b+c*Math.sin(d),h=a+c*Math.cos(e),i=b+c*Math.sin(e);return{hasCircle:!0,startX:f,startY:g,endX:h,endY:i,startAngle:d,endAngle:e,circleX:a,circleY:b,circleRadius:c}};d.prototype.draw=function(a){var b=this.getEndPointsAndCircle();a.beginPath();a.arc(b.circleX,b.circleY,b.circleRadius,b.startAngle,b.endAngle,!1);a.stroke();var c=this.textBox.relDist,d=b.startAngle*(1-c)+b.endAngle*c,e=b.circleX+b.circleRadius*Math.cos(d),f=b.circleY+b.circleRadius*Math.sin(d);this.textBox.draw(e,f,d,this);this.parent.arrowIfReqd(a,b.endX,b.endY,b.endAngle+.4*Math.PI)};d.prototype.containsPoint=function(a,b){var c=this.getEndPointsAndCircle(),d=a-c.circleX,e=b-c.circleY,f=Math.sqrt(d*d+e*e)-c.circleRadius;return Math.abs(f)<this.parent.HIT_TARGET_PADDING};function e(a,b,c){this.parent=a;this.node=b;this.deltaX=0;this.deltaY=0;if(c){this.setAnchorPoint(c.x,c.y)}}e.prototype.setAnchorPoint=function(a,b){this.deltaX=a-this.node.x;this.deltaY=b-this.node.y;if(Math.abs(this.deltaX)<this.parent.SNAP_TO_PADDING){this.deltaX=0}if(Math.abs(this.deltaY)<this.parent.SNAP_TO_PADDING){this.deltaY=0}};e.prototype.getEndPoints=function(){var a=this.node.x+this.deltaX,b=this.node.y+this.deltaY,c=this.node.closestPointOnCircle(a,b);return{startX:a,startY:b,endX:c.x,endY:c.y}};e.prototype.draw=function(a){var b=this.getEndPoints();a.beginPath();a.moveTo(b.startX,b.startY);a.lineTo(b.endX,b.endY);a.stroke();this.parent.arrowIfReqd(a,b.endX,b.endY,Math.atan2(-this.deltaY,-this.deltaX))};e.prototype.containsPoint=function(a,b){var c=this.getEndPoints(),d=c.endX-c.startX,e=c.endY-c.startY,f=Math.sqrt(d*d+e*e),g=(d*(a-c.startX)+e*(b-c.startY))/(f*f),h=(d*(b-c.startY)-e*(a-c.startX))/f;return 0<g&&1>g&&Math.abs(h)<this.parent.HIT_TARGET_PADDING};function f(a,b,c){this.parent=a;this.from=b;this.to=c}f.prototype.draw=function(a){a.beginPath();a.moveTo(this.to.x,this.to.y);a.lineTo(this.from.x,this.from.y);a.stroke();this.parent.arrowIfReqd(a,this.to.x,this.to.y,Math.atan2(this.to.y-this.from.y,this.to.x-this.from.x))};function g(a,b,c,d){this.BUTTON_WIDTH=60;this.BUTTON_HEIGHT=25;this.TEXT_OFFSET_X=30;this.TEXT_OFFSET_Y=17;this.topX=b;this.topY=c;this.parent=a;this.text=d;this.highLighted=!1}g.prototype.containsPoint=function(b,c){return a.isInside({x:b,y:c},{x:this.topX,y:this.topY,width:this.BUTTON_WIDTH,height:this.BUTTON_HEIGHT})};g.prototype.draw=function(a){if(this.highLighted){a.fillStyle="#FFFFFF"}else{a.fillStyle="#F0F0F0"}a.fillRect(this.topX,this.topY,this.BUTTON_WIDTH,this.BUTTON_HEIGHT);a.lineWidth=.5;a.strokeStyle="#000000";a.strokeRect(this.topX,this.topY,this.BUTTON_WIDTH,this.BUTTON_HEIGHT);a.font="12pt Arial";a.fillStyle="#000000";a.textAlign="center";a.fillText(this.text,this.topX+this.TEXT_OFFSET_X,this.topY+this.TEXT_OFFSET_Y);a.textAlign="left"};g.prototype.onClick=function(){};function h(a,b,c){g.call(this,a,b,c,"Help");this.helpOpen=!1;this.LINE_HEIGHT=18;this.HELP_INDENT=5}h.prototype=new g;h.prototype.draw=function(a){var b,c,d,e;g.prototype.draw.call(this,a);if(this.helpOpen){e=this.parent.helpText;a.font="12pt Arial";b=e.split("\n");d=this.topY+this.BUTTON_HEIGHT;for(c=0;c<b.length;c+=1){d+=this.LINE_HEIGHT;a.fillText(b[c],this.topX+this.HELP_INDENT,d)}}};h.prototype.onClick=function(){this.helpOpen=!this.helpOpen;this.parent.draw()};function i(a,b){this.text=a;this.parent=b;this.caretPosition=a.length;this.relDist=.5;this.offset=b.parent.textOffset();this.dragged=!1;this.boundingBox={}}i.prototype.insertChar=function(a){this.text=this.text.slice(0,this.caretPosition)+a+this.text.slice(this.caretPosition);this.caretRight()};i.prototype.deleteChar=function(){if(0<this.caretPosition){this.text=this.text.slice(0,this.caretPosition-1)+this.text.slice(this.caretPosition);this.caretLeft()}};i.prototype.caretLeft=function(){if(0<this.caretPosition){this.caretPosition--}};i.prototype.caretRight=function(){if(this.caretPosition<this.text.length){this.caretPosition++}};i.prototype.containsPoint=function(b,c){return a.isInside({x:b,y:c},this.boundingBox)};i.prototype.setMouseStart=function(a,b){this.mouseOffsetX=this.position.x-a;this.mouseOffsetY=this.position.y-b};i.prototype.setAnchorPoint=function(b,c){b+=this.mouseOffsetX||0;c+=this.mouseOffsetY||0;var d=this.parent.getEndPointsAndCircle(),e,f;if(d.hasCircle){var g=Math.atan2(c-d.circleY,b-d.circleX);if(g<d.startAngle){g+=2*Math.PI}if(d.endAngle<d.startAngle){d.endAngle+=2*Math.PI}if(d.isReversed){e=(g-d.startAngle-2*Math.PI)/(d.endAngle-d.startAngle-2*Math.PI)}else{e=(g-d.startAngle)/(d.endAngle-d.startAngle)}f=a.vectorMagnitude({x:b-d.circleX,y:c-d.circleY})-d.circleRadius}else{var h={x:b-d.startX,y:c-d.startY},i={x:d.endX-d.startX,y:d.endY-d.startY},j=a.scalarProjection(h,i);e=j/a.vectorMagnitude(i);f=Math.sqrt(Math.pow(a.vectorMagnitude(h),2)-Math.pow(j,2));var k=a.isCCW(h,i),l=0!=this.parent.lineAngleAdjust;if(!k&&l||k&&!l){f*=-1}}if(0<e&&1>e){this.relDist=e;this.offset=Math.round(f);this.dragged=!0}};i.prototype.draw=function(b,d,e,f){var g=f.parent,h=g.getCanvas().getContext("2d");h.font=g.fontSize()+"px Arial";var c=a.convertLatexShortcuts(this.text.slice(0,this.caretPosition)),i=a.convertLatexShortcuts(this.text.slice(this.caretPosition)),j=h.measureText(c+i).width,k=Math.round(g.fontSize()/2);if(null!==e){var l=Math.cos(e),m=Math.sin(e);b+=this.offset*l;d+=this.offset*m;if(!this.dragged){var n=j/2*(0<l?1:-1),o=k/2*(0<m?1:-1),p=m*Math.pow(Math.abs(m),40)*n-l*Math.pow(Math.abs(l),10)*o;b+=n-m*p;d+=o+l*p}this.position={x:Math.round(b),y:Math.round(d)}}b-=j/2;b=Math.round(b);d=Math.round(d);if("advancedFillText"in h){h.advancedFillText(this.text,this.text,b+j/2,d,e)}else{var q=h.fillStyle;h.fillStyle="rgba(255, 255, 255, 0.7)";h.fillRect(b,d-k,j,2*k);h.fillStyle=q;k=Math.round(g.fontSize()/3);h.fillText(c,b,d+k);var r=b+h.measureText(c).width;h.fillText(i,r,d+k);k=Math.round(g.fontSize()/2);if(f==g.selectedObject&&g.caretVisible&&g.hasFocus()&&document.hasFocus()){h.beginPath();h.moveTo(r,d-k);h.lineTo(r,d+k);h.stroke()}}this.boundingBox={x:b,y:d-k,height:2*k,width:j}};return{Node:b,Link:c,SelfLink:d,TemporaryLink:f,StartLink:e,Button:g,HelpBox:h,TextBox:i}});
//# sourceMappingURL=graphelements.min.js.map

define ("qtype_coderunner/ui_gapfiller",["jquery"],function(a){function b(b,c,d,e){var f;this.textArea=a(document.getElementById(b));this.readOnly=this.textArea.prop("readonly");this.templateParams=e;this.fail=!1;this.htmlDiv=null;this.source=e.gapfiller_ui_source||"globalextra";if("globalextra"!==this.source&&"test0"!==this.source){alert("Invalid source for HTML in ui_gapfiller");this.source="globalextra"}if("globalextra"==this.source){f=this.textArea.attr("data-globalextra")}else{f=this.textArea.attr("data-test0")}this.html=f.replace("<","&lt;");this.reload()}b.prototype.failed=function(){return this.fail};b.prototype.sync=function(){var b=[],c=!0;this.getFields().each(function(){var d,e;d=a(this).attr("name");if("cr_gapfiller_field"!==d){alert("Unexpected UI element found in answer box")}else{e=a(this).val();b.push(e);if(""!==e){c=!1}}});if(c){this.textArea.val("")}else{this.textArea.val(JSON.stringify(b))}};b.prototype.getElement=function(){return this.htmlDiv};b.prototype.getFields=function(){return a(this.htmlDiv).find(".coderunner-ui-element")};b.prototype.setField=function(a,b){if("checkbox"===a.attr("type")||"radio"===a.attr("type")){a.prop("checked",a.val()===b)}else{a.val(b)}};b.prototype.markedUpHtml=function(){function a(a){for(var b,d="{[(*+\\",e="",f=0;f<a.length;f++){b=a[f];for(var g=0;g<d.length;g++){if(b===d[g]){b="\\"+b}}e+=b}return e}var b=a("{["),c=a("]}"),d=new RegExp(b+" *((?:\\d+)|(?:\\d+, *\\d+)) *"+c),e=this.html.split(d),f="<pre>"+e[0],g;for(g=1;g<e.length;g+=2){f+=this.markUp(e[g]);if(g+1<e.length){f+=e[g+1]}}f=f+"</pre>";return f};b.prototype.markUp=function(a){var d,e="";function b(a){return"<input name=\"cr_gapfiller_field\" class=\"coderunner-ui-element\" size=\""+a+"\">"}function c(a,b){return"<textarea name=\"cr_gapfiller_field\" class =\"coderunner-ui-element\" rows=\""+a+"\" cols=\""+b+"\" style=\"width:auto;\" />"}d=a.split(",");if(1==d.length){e=b(parseInt(d[0]))}else{e=c(parseInt(d[0]),parseInt(d[1]))}return e};b.prototype.reload=function(){var b=a(this.textArea).val(),c,d,e;this.htmlDiv=a("<div style='height:fit-content' class='qtype-coderunner-html-outer-div'>"+this.markedUpHtml()+"</div>");if(b){try{c=JSON.parse(b);e=this.getFields();if(e.length!==c.length){this.fail=!0}else{for(d=0;d<c.length;d++){this.setField(a(e[d]),c[d])}}}catch(a){}}};b.prototype.resize=function(){};b.prototype.hasFocus=function(){var a=!1;this.getFields().each(function(){if(this===document.activeElement){a=!0}});return a};b.prototype.destroy=function(){this.sync();a(this.htmlDiv).remove();this.htmlDiv=null};return{Constructor:b}});
//# sourceMappingURL=ui_gapfiller.min.js.map

define ("qtype_coderunner/ajaxquestionloader",["jquery"],function(a){return{loadQuestionText:function(b,c,d){var e=a("#"+c);if(1!=e.length){e.append("<div style=\"colour:red\">Failed to load problem spec<div>");return}a.getJSON(M.cfg.wwwroot+"/question/type/coderunner/problemspec.php",{questionid:b,sesskey:M.cfg.sesskey,filename:d},function(a){if(a.filecontentsb64){e.append("<div><a download href=\"data:application/pdf;base64,"+a.filecontentsb64+"\">Problem spec</a></div>")}else{e.append("<div style=\"colour:red\">Failed to load problem spec<div>")}}).fail(function(){e.append("<div style=\"colour:red\">Failed to load problem spec<div>")})}}});
//# sourceMappingURL=ajaxquestionloader.min.js.map

define ("qtype_coderunner/userinterfacewrapper",["jquery"],function(a){function b(b,c){var d,e,f=this;this.GUTTER=14;this.MIN_WRAPPER_HEIGHT=50;this.taId=c;this.loadFailId=c+"_loadfailerr";this.textArea=a(document.getElementById(c));e=this.textArea.attr("data-params");if(e){this.templateParams=JSON.parse(e)}else{this.templateParams={}}this.templateParams.lang=this.textArea.attr("data-lang");this.readOnly=this.textArea.prop("readonly");this.isLoading=!1;this.loadFailed=!1;this.retries=0;d=Math.max(parseInt(this.textArea.css("height")),this.MIN_WRAPPER_HEIGHT);this.wrapperNode=a("<div id='"+this.taId+"_wrapper' class='ui_wrapper'></div>");this.textArea.after(this.wrapperNode);this.wrapperNode.hide();this.wrapperNode.css({resize:"vertical",overflow:"hidden",minHeight:d,width:"100%",border:"1px solid darkgrey"});this.textArea.data("current-ui-wrapper",this);this.uiInstance=null;this.loadUi(b,this.templateParams);a(document).mousemove(function(){f.checkForResize()});a(window).resize(function(){f.checkForResize()});this.textArea.closest("form").submit(function(){if(null!==f.uiInstance){f.uiInstance.sync()}});a(document.body).on("keydown",function(a){if(a.keyCode===77&&a.ctrlKey&&a.altKey){if(null!==f.uiInstance||f.loadFailed){f.stop()}else{f.restart()}}})}b.prototype.loadUi=function(b,c){var e=this;function d(b,c){require(["core/str"],function(d){var e=d.get_string(b,"qtype_coderunner"),f=d.get_string("ui_fallback","qtype_coderunner");a.when(e,f).done(function(a,b){c.html(a+"<br>"+b)})})}if(this.isLoading){this.retries+=1;if(20<this.retries){alert("Failed to load "+b+" UI component. If this error persists, please report it to the forum on coderunner.org.nz");this.retries=0;this.loading=0}else{setTimeout(function(){e.loadUi(b,c)},200)}return}this.retries=0;this.params=c;this.stop();this.uiname=b;if(""===this.uiname||"none"===this.uiname||sessionStorage.getItem("disableUis")){this.uiInstance=null}else{this.isLoading=!0;require(["qtype_coderunner/ui_"+this.uiname],function(b){var f,g,i,j,k;j=e.wrapperNode.innerHeight()-e.GUTTER;k=e.wrapperNode.innerWidth();f=new b.Constructor(e.taId,k,j,c);if(f.failed()){e.loadFailed=!0;e.wrapperNode.hide();f.destroy();e.uiInstance=null;e.textArea.addClass("uiloadfailed");g="<div id=\""+e.loadFailId+"\"class=\"uiloadfailed\"></div>";i=a(g);i.insertBefore(e.textArea);d(f.failMessage(),i)}else{e.hLast=0;e.wLast=0;e.textArea.hide();e.wrapperNode.show();e.wrapperNode.append(f.getElement());e.uiInstance=f;e.loadFailed=!1;e.checkForResize()}e.isLoading=!1})}};b.prototype.stop=function(){if(null!==this.uiInstance){this.textArea.show();if(this.uiInstance.hasFocus()){this.textArea.focus();this.textArea[0].selectionStart=this.textArea[0].value.length}this.uiInstance.destroy();this.uiInstance=null;this.wrapperNode.hide()}this.loadFailed=!1;this.textArea.removeClass("uiloadfailed");a(document.getElementById(this.loadFailId)).remove()};b.prototype.restart=function(){if(null===this.uiInstance){this.loadUi(this.uiname,this.params)}};b.prototype.checkForResize=function(){var b,c,d,e,f,g;if(this.uiInstance){b=this.wrapperNode.innerHeight();d=this.wrapperNode.innerWidth();if(b!=this.hLast||d!=this.wLast){f=this.wrapperNode.offset().left;g=a(window).innerWidth()-f-25;c=b-this.GUTTER;e=Math.min(g,d);this.uiInstance.resize(e,c);this.hLast=this.wrapperNode.innerHeight();this.wLast=this.wrapperNode.innerWidth()}}};return{newUiWrapper:function(a,c){if(a){return new b(a,c)}else{return null}},InterfaceWrapper:b}});
//# sourceMappingURL=userinterfacewrapper.min.js.map

define ("qtype_coderunner/authorform",["jquery","qtype_coderunner/userinterfacewrapper"],function(a,b){var c={template:["#id_template","value",""],iscombinatortemplate:["#id_iscombinatortemplate","checked","",function(a){return"1"===a?!0:!1}],cputimelimitsecs:["#id_cputimelimitsecs","value",""],memlimitmb:["#id_memlimitmb","value",""],sandbox:["#id_sandbox","value","DEFAULT"],sandboxparams:["#id_sandboxparams","value",""],testsplitterre:["#id_testsplitterre","value","",function(a){return a.replace("\n","\\n")}],allowmultiplestdins:["#id_allowmultiplestdins","checked","",function(a){return"1"===a?!0:!1}],grader:["#id_grader","value","EqualityGrader"],resultcolumns:["#id_resultcolumns","value",""],language:["#id_language","value",""],acelang:["#id_acelang","value",""],uiplugin:["#id_uiplugin","value","ace"]};return{initEditForm:function(d){var r=a("#id_coderunnertype"),s=a("#id_template"),t=a("#id_globalextra"),u=a("#id_useace"),v=a("#id_language"),w=a("#id_acelang"),x=a("#id_customise"),y=a("#id_iscombinatortemplate"),z=a("#id_testsplitterre"),A=a("#id_allowmultiplestdins"),B=a("#id_customisationheader"),C=a("#id_advancedcustomisationheader"),D=x.prop("checked"),E=a("#id_prototypetype"),F=a("#id_answerpreloadhdr"),G=a("#id_typename"),H=a("input[name=\"courseid\"]").prop("value"),I=a("#qtype-help"),J=a("select#id_precheck"),K=a("div.testtype"),L=a("#id_missing_prototype"),N=a("#id_uiplugin");function e(c,d){var e=a(document.getElementById(c)),f,g=e.attr("data-lang"),h=e.attr("data-params"),i={},j;e.attr("data-globalextra",t.val());e.attr("data-test0",a("#id_testcode_0").val());try{i=JSON.parse(h)}catch(a){}d=d.toLowerCase();if("none"===d){d=""}if("id_templateparams"==c){f=""}else{f=v.prop("value");if("id_template"!==c&&w.prop("value")){f=m(w.prop("value"))}}j=e.data("current-ui-wrapper");if(j&&j.uiname===d&&g==f){return}e.attr("data-lang",f);if(!j){j=new b.InterfaceWrapper(d,c)}else{i.lang=f;j.loadUi(d,i)}}function f(){var a=N.val();if(a&&"html"!==a){e("id_answer",a);e("id_answerpreload",a)}}function g(a){var b=a?"block":"none";B.css("display",b);C.css("display",b);if(a&&u.prop("checked")){e("id_template","ace")}}function h(){var a=y.prop("checked");z.prop("disabled",!a);A.prop("disabled",!a)}function i(b,d){var e,f,i;for(var j in c){e=c[j];f=d[j]?d[j]:e[2];if(3<e.length){i=e[3];f=i(f)}a(e[0]).prop(e[1],f)}G.prop("value",b);x.prop("checked",!1);I.html(k(b,d.questiontext));g(!1);h()}function j(a,b){var c;window.alert(l("prototype_load_failure")+b);c=l("prototype_error")+"\n";c+=b+"\n";c+="CourseId: "+H+", qtype: "+a;s.prop("value",c)}function k(a,b){var c="<p class=\"question-type-details-header\">";c+=l("coderunner_question_type");c+=a+"</p>\n"+b;return c}function l(a){return d[a]}function m(a){var b,c;if(0>a.indexOf(",")){return a}else{b=a.split(",");for(c=0;c<b.length;c++){if(b[c].endsWith("*")){return b[c].substr(0,b[c].length-1)}}return 0<b.length?b[0]:""}}function n(){var b=r.children("option:selected").text();if(""!==b&&"Undefined"!==b){r.children("option:first-child").prop("disabled","disabled");a.getJSON(M.cfg.wwwroot+"/question/type/coderunner/ajax.php",{qtype:b,courseid:H,sesskey:M.cfg.sesskey},function(a){if(a.success){i(b,a);f()}else{j(b,a.error)}}).fail(function(){window.alert(l("error_loading_prototype"));s.prop("value",l("ajax_error"))})}}function o(){if("3"===J.val()){K.show()}else{K.hide()}}function p(){if("ace"===N.val()){f()}}function q(){if(u.prop("checked")){e("id_template","ace")}}if(1==E.prop("value")){window.alert(l("proceed_at_own_risk"));E.prop("disabled",!0);r.prop("disabled",!0);x.prop("disabled",!0)}(function(){var b=L.prop("value"),c=null;if(""!==b){c=a("<p>"+L.prop("value")+"</p>");a("#id_qtype_coderunner_error_div").append(c)}})();g(D);if(!D){n()}else{f();I.html("<p>"+l("info_unavailable")+"</p>")}o();if(u.prop("checked")){e("id_templateparams","ace")}x.on("change",function(){var a=x.prop("checked");if(a){g(!0)}else{if(window.confirm(l("confirm_proceed"))){g(!1)}else{x.prop("checked",!0)}}});w.on("change",p);v.on("change",function(){q();p()});r.on("change",function(){if(!x.prop("checked")||window.confirm(l("question_type_changed"))){n()}});u.on("change",function(){var a=u.prop("checked");if(a){e("id_template","ace");e("id_templateparams","ace")}else{e("id_template","");e("id_templateparams","")}});N.on("change",f);J.on("change",o);var O=new MutationObserver(function(){f()});O.observe(F.get(0),{attributes:!0});a("button.replaceexpectedwithgot").click(function(){var b=a(this).prev("pre[id^=\"id_got_\"]"),c=b.attr("id").replace("id_got_","");a("#id_expected_"+c).val(b.text());a("#id_fail_expected_"+c).html(b.text());a(".failrow_"+c).addClass("fixed");a(this).prop("disabled",!0)})}}});
//# sourceMappingURL=authorform.min.js.map

define('qtype_ordering/autoscroll', ["jquery"],function(a){var b={SCROLL_THRESHOLD:30,SCROLL_FREQUENCY:1e3/60,SCROLL_SPEED:.5,scrollingId:null,scrollAmount:0,callback:null,start:function(c){a(window).on("mousemove",b.mouseMove),a(window).on("touchmove",b.touchMove),b.callback=c},stop:function(){a(window).off("mousemove",b.mouseMove),a(window).off("touchmove",b.touchMove),null!==b.scrollingId&&b.stopScrolling()},touchMove:function(a){for(var c=0;c<a.changedTouches.length;c++)b.handleMove(a.changedTouches[c].clientX,a.changedTouches[c].clientY)},mouseMove:function(a){b.handleMove(a.clientX,a.clientY)},handleMove:function(c,d){d<b.SCROLL_THRESHOLD?b.scrollAmount=-Math.min(b.SCROLL_THRESHOLD-d,b.SCROLL_THRESHOLD):d>a(window).height()-b.SCROLL_THRESHOLD?b.scrollAmount=Math.min(d-(a(window).height()-b.SCROLL_THRESHOLD),b.SCROLL_THRESHOLD):b.scrollAmount=0,b.scrollAmount&&null===b.scrollingId?b.startScrolling():b.scrollAmount||null===b.scrollingId||b.stopScrolling()},startScrolling:function(){var c=a(document).height()-a(window).height();b.scrollingId=window.setInterval(function(){var d=a(window).scrollTop(),e=Math.round(b.scrollAmount*b.SCROLL_SPEED);if(d+e<0&&(e=-d),d+e>c&&(e=c-d),0!==e){a(window).scrollTop(d+e);var f=a(window).scrollTop()-d;0!==f&&b.callback&&b.callback(f)}},b.SCROLL_FREQUENCY)},stopScrolling:function(){window.clearInterval(b.scrollingId),b.scrollingId=null}};return{start:b.start,stop:b.stop}});
define ("qtype_ordering/drag_reorder",["jquery",require.specified("core/dragdrop")?"core/dragdrop":"qtype_ordering/dragdrop",require.specified("core/key_codes")?"core/key_codes":"qtype_ordering/key_codes"],function(a,b,c){return function(d){var e=null,f=null,g=null,h=null,j=null,k=null,l=function(c,h){k=a(d.list);e={time:new Date().getTime(),x:h.x,y:h.y};g=a(c.currentTarget).closest(d.itemInPage);if("undefined"!=typeof d.reorderStart){d.reorderStart(g.closest(d.list),g)}f=t();j=a(d.proxyHtml.replace("%%ITEM_HTML%%",g.html()).replace("%%ITEM_CLASS_NAME%%",g.attr("class")).replace("%%LIST_CLASS_NAME%%",k.attr("class")));a(document.body).append(j);j.css("position","absolute");j.css(g.offset());j.width(g.outerWidth());j.height(g.outerHeight());g.addClass(d.itemMovingClass);n(g);b.start(c,j,m,o)},m=function(){var b=g.closest(d.list),c=null,e=null;b.find(d.item).each(function(b,d){var f=s(d,j);if(null===c||f<e){c=a(d);e=f}});if(c[0]===g[0]){return}if(r(j)<r(c)){g.insertBefore(c)}else{g.insertAfter(c)}n(g)},n=function(a){for(var b=a.closest("ol, ul"),c=b.find("li"),d=c.length,e=0;e<d;++e){if(a[0]===c[e]){j.find("li").attr("value",e+1);break}}},o=function(a,b){if("undefined"!=typeof d.reorderEnd){d.reorderEnd(g.closest(d.list),g)}var c=t();if(!u(f,c)){d.reorderDone(g.closest(d.list),g,c)}else if(500>new Date().getTime()-e.time&&10>Math.abs(e.x-a)&&10>Math.abs(e.y-b)){g[0].focus()}j.remove();j=null;g.removeClass(d.itemMovingClass);g=null;e=null},p=function(a,b){switch(a.keyCode){case c.space:case c.arrowRight:case c.arrowDown:a.preventDefault();a.stopPropagation();var d=b.next();if(d.length){d.insertBefore(b)}break;case c.arrowLeft:case c.arrowUp:a.preventDefault();a.stopPropagation();var e=b.prev();if(e.length){e.insertAfter(b)}break;}},q=function(a){return a.offset().left+a.outerWidth()/2},r=function(a){return a.offset().top+a.outerHeight()/2},s=function(b,c){var d=a(b),e=a(c),f=q(d)-q(e),g=r(d)-r(e);return Math.sqrt(f*f+g*g)},t=function(){return(g||h).closest(d.list).find(d.item).map(function(a,b){return d.idGetter(b)}).get()},u=function(a,b){return a.length===b.length&&a.every(function(a,c){return a===b[c]})};d.itemInPage=function combineSelectors(a,b){var c=[];a.split(",").forEach(function(a){b.split(",").forEach(function(b){c.push(a.trim()+" "+b.trim())})});return c.join(", ")}(d.list,d.item);a(d.list).on("mousedown touchstart",d.item,function(a){var c=b.prepare(a);if(c.start){l(a,c)}});a(d.list).on("keydown",d.item,function(b){h=a(b.currentTarget).closest(d.itemInPage);f=t();p(b,h);var c=t();if(!u(f,c)){d.reorderDone(h.closest(d.list),h,c)}});a(d.itemInPage).attr("tabindex","0")}});
//# sourceMappingURL=drag_reorder.min.js.map

define('qtype_ordering/key_codes', [],function(){return{tab:9,enter:13,escape:27,space:32,end:35,home:36,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,8:56,asterix:106,pageUp:33,pageDown:34}});
define ("qtype_ordering/reorder",["jquery","qtype_ordering/drag_reorder"],function(a,b){return{init:function init(c,d){new b({list:"ul#"+c,item:"li.sortableitem",proxyHtml:"<div class=\"que ordering dragproxy\"><ul class=\"%%LIST_CLASS_NAME%%\"><li class=\"%%ITEM_CLASS_NAME%% item-moving\">%%ITEM_HTML%%</li></ul></div>",itemMovingClass:"current-drop",idGetter:function idGetter(b){return a(b).attr("id")},nameGetter:function nameGetter(b){return a(b).text},reorderStart:function reorderStart(){},reorderEnd:function reorderEnd(){},reorderDone:function reorderDone(b,c,e){a("input#"+d)[0].value=e.join(",")}})}}});
//# sourceMappingURL=reorder.min.js.map

define('qtype_ordering/dragdrop', ["jquery","qtype_ordering/autoscroll"],function(a,b){var c={eventCaptureOptions:{passive:!1,capture:!0},dragProxy:null,onMove:null,onDrop:null,initialPosition:null,initialX:null,initialY:null,touching:null,prepare:function(a){a.preventDefault();var b;if(b="touchstart"===a.type?null===c.touching&&a.changedTouches.length>0:1===a.which){var d=c.getEventXY(a);return d.start=!0,d}return{start:!1}},start:function(a,d,e,f){var g=c.getEventXY(a);switch(c.initialX=g.x,c.initialY=g.y,c.initialPosition=d.offset(),c.dragProxy=d,c.onMove=e,c.onDrop=f,a.type){case"mousedown":c.addEventSpecial("mousemove",c.mouseMove),c.addEventSpecial("mouseup",c.mouseUp);break;case"touchstart":c.addEventSpecial("touchend",c.touchEnd),c.addEventSpecial("touchcancel",c.touchEnd),c.addEventSpecial("touchmove",c.touchMove),c.touching=a.changedTouches[0].identifier;break;default:throw new Error("Unexpected event type: "+a.type)}b.start(c.scroll)},addEventSpecial:function(a,b){try{window.addEventListener(a,b,c.eventCaptureOptions)}catch(d){c.eventCaptureOptions=!0,window.addEventListener(a,b,c.eventCaptureOptions)}},getEventXY:function(a){switch(a.type){case"touchstart":return{x:a.changedTouches[0].pageX,y:a.changedTouches[0].pageY};case"mousedown":return{x:a.pageX,y:a.pageY};default:throw new Error("Unexpected event type: "+a.type)}},touchMove:function(a){a.preventDefault();for(var b=0;b<a.changedTouches.length;b++)a.changedTouches[b].identifier===c.touching&&c.handleMove(a.changedTouches[b].pageX,a.changedTouches[b].pageY)},mouseMove:function(a){c.handleMove(a.pageX,a.pageY)},handleMove:function(b,d){var e=c.dragProxy.offset(),f=e.top-parseInt(c.dragProxy.css("top")),g=e.left-parseInt(c.dragProxy.css("left")),h=a(document).height()-c.dragProxy.outerHeight()-f,i=a(document).width()-c.dragProxy.outerWidth()-g,j=-f,k=-g,l=c.initialPosition,m={top:Math.max(j,Math.min(h,l.top+(d-c.initialY)-f)),left:Math.max(k,Math.min(i,l.left+(b-c.initialX)-g))};c.dragProxy.css(m),c.onMove(b,d,c.dragProxy)},touchEnd:function(a){a.preventDefault();for(var b=0;b<a.changedTouches.length;b++)a.changedTouches[b].identifier===c.touching&&c.handleEnd(a.changedTouches[b].pageX,a.changedTouches[b].pageY)},mouseUp:function(a){c.handleEnd(a.pageX,a.pageY)},handleEnd:function(a,d){null!==c.touching?(window.removeEventListener("touchend",c.touchEnd,c.eventCaptureOptions),window.removeEventListener("touchcancel",c.touchEnd,c.eventCaptureOptions),window.removeEventListener("touchmove",c.touchMove,c.eventCaptureOptions),c.touching=null):(window.removeEventListener("mousemove",c.mouseMove,c.eventCaptureOptions),window.removeEventListener("mouseup",c.mouseUp,c.eventCaptureOptions)),b.stop(),c.onDrop(a,d,c.dragProxy)},scroll:function(b){var d=a(document).height()-c.dragProxy.outerHeight(),e=c.dragProxy.offset();e.top=Math.min(d,e.top+b),c.dragProxy.css(e)}};return{prepare:c.prepare,start:c.start}});
define('mod_assign/grading_review_panel', ["jquery","mod_assign/grading_events"],function(a,b){var c=function(){this._region=a('[data-region="review-panel-content"]'),this.registerEventListeners()};return c.prototype._region=null,c.prototype.getReviewPanel=function(a){var b=this._region.data("panel-owner");return"undefined"==typeof b&&this._region.data("review-panel-plugin",a),this._region.data("review-panel-plugin")==a&&this._region[0]},c.prototype.getTogglePanelButton=function(){return this.getPanelElement().find('[data-region="review-panel-toggle"]')},c.prototype.getPanelElement=function(){return a('[data-region="review-panel"]')},c.prototype.getPanelContentElement=function(){return a('[data-region="review-panel-content"]')},c.prototype.togglePanel=function(){this.getPanelElement().hasClass("collapsed")?a(document).trigger(b.EXPAND_REVIEW_PANEL):a(document).trigger(b.COLLAPSE_REVIEW_PANEL)},c.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed").removeClass("grade-panel-collapsed"),this.getPanelContentElement().attr("aria-hidden",!0)},c.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed"),this.getPanelContentElement().removeAttr("aria-hidden")},c.prototype.registerEventListeners=function(){var c=this.getTogglePanelButton();c.click(function(a){this.togglePanel(),a.preventDefault()}.bind(this)),c.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.togglePanel(),a.preventDefault())}.bind(this));var d=a(document);d.on(b.COLLAPSE_REVIEW_PANEL,function(){this.collapsePanel()}.bind(this)),d.on(b.COLLAPSE_GRADE_PANEL,function(){this.expandPanel(),this.getPanelElement().addClass("grade-panel-collapsed")}.bind(this)),d.on(b.EXPAND_REVIEW_PANEL,function(){this.expandPanel()}.bind(this)),d.on(b.EXPAND_GRADE_PANEL,function(){this.getPanelElement().removeClass("grade-panel-collapsed")}.bind(this))},c});
define('mod_assign/grading_form_change_checker', ["jquery"],function(a){return{saveFormState:function(b){a(b).trigger("save-form-state");var c=a(b).serialize();a(b).data("saved-form-state",c)},checkFormForChanges:function(b){a(b).trigger("save-form-state");var c=a(b).serialize(),d=a(b).data("saved-form-state");return"undefined"!=typeof d&&d!=c}}});
define('mod_assign/grading_panel', ["jquery","core/yui","core/notification","core/templates","core/fragment","core/ajax","core/str","mod_assign/grading_form_change_checker","mod_assign/grading_events"],function(a,b,c,d,e,f,g,h,i){var j=function(b){this._regionSelector=b,this._region=a(b),this._userCache=[],this.registerEventListeners()};return j.prototype._regionSelector=null,j.prototype._lastUserId=0,j.prototype._lastAttemptNumber=-1,j.prototype._region=null,j.prototype.nextUserId=null,j.prototype.nextUser=!1,j.prototype._niceReplaceNodeContents=function(b,c,e){var f=a.Deferred();return b.fadeOut("fast",function(){d.replaceNodeContents(b,c,e),b.fadeIn("fast",function(){f.resolve()})}),f.promise()},j.prototype._saveFormState=function(){"undefined"!=typeof window.tinyMCE&&window.tinyMCE.triggerSave();var b=a('[data-region="grading-actions-form"] [name="sendstudentnotifications"]').prop("checked");a('.gradeform [name="sendstudentnotifications"]').val(b)},j.prototype._submitForm=function(b,d,e){var g=a(this._region.find("form.gradeform"));a('[data-region="overlay"]').show(),g.trigger("save-form-state");var h=g.serialize(),i=this._region.attr("data-assignmentid");f.call([{methodname:"mod_assign_submit_grading_form",args:{assignmentid:i,userid:this._lastUserId,jsonformdata:JSON.stringify(h)},done:this._handleFormSubmissionResponse.bind(this,h,d,e),fail:c.exception}])},j.prototype._handleFormSubmissionResponse=function(d,e,f,h){"undefined"==typeof e&&(e=this._lastUserId),h.length?a(document).trigger("reset",[this._lastUserId,d]):(g.get_strings([{key:"changessaved",component:"core"},{key:"gradechangessaveddetail",component:"mod_assign"}]).done(function(a){c.alert(a[0],a[1])}).fail(c.exception),b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()}),e==this._lastUserId?a(document).trigger("reset",e):f?a(document).trigger("done-saving-show-next",!0):a(document).trigger("user-changed",e)),a('[data-region="overlay"]').hide()},j.prototype._resetForm=function(b,c,d){var e=a.Event("custom");"undefined"==typeof c&&(c=this._lastUserId),this._lastUserId=0,this._refreshGradingPanel(e,c,d)},j.prototype._chooseAttempt=function(b){var d=a(b.target),e=d.data("submissions"),f=a(document.getElementById(e)),h=f.clone(),i=h.wrap(a("<form/>")).html();g.get_strings([{key:"viewadifferentattempt",component:"mod_assign"},{key:"view",component:"core"},{key:"cancel",component:"core"}]).done(function(b){c.confirm(b[0],i,b[1],b[2],function(){var b=a("input:radio[name='select-attemptnumber']:checked").val();this._refreshGradingPanel(null,this._lastUserId,"",b)}.bind(this))}.bind(this)).fail(c.exception)},j.prototype._addPopoutButtons=function(b){var e=a(b);d.render("mod_assign/popout_button",{}).done(function(a){var b=e.find('[data-fieldtype="filemanager"],[data-fieldtype="editor"],[data-fieldtype="grading"]').closest(".fitem");b.addClass("has-popout").find("label").parent().append(a),e.on("click",'[data-region="popout-button"]',this._togglePopout.bind(this))}.bind(this)).fail(c.exception)},j.prototype._togglePopout=function(b){b.preventDefault();var c=a(b.target).closest(".fitem");c.hasClass("popout")?a(".popout").removeClass("popout"):(a(".popout").removeClass("popout"),c.addClass("popout"),c.addClass("moodle-has-zindex"))},j.prototype._refreshGradingPanel=function(b,f,g,i){var j=this._region.attr("data-contextid");"undefined"==typeof g&&(g=""),"undefined"==typeof i&&(i=-1),this._lastUserId==f&&this._lastAttemptNumber==i&&""===g||(this._lastUserId=f,this._lastAttemptNumber=i,a(document).trigger("start-loading-user"),window.M.util.js_pending("mod-assign-loading-user"),d.render("mod_assign/loading",{}).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){if(f>0){this._region.show();var b={userid:f,attemptnumber:i,jsonformdata:JSON.stringify(g)};e.loadFragment("mod_assign","gradingpanel",j,b).done(function(b,d){this._niceReplaceNodeContents(this._region,b,d).done(function(){h.saveFormState('[data-region="grade-panel"] .gradeform'),a(document).on("editor-content-restored",function(){h.saveFormState('[data-region="grade-panel"] .gradeform')}),a('[data-region="attempt-chooser"]').on("click",this._chooseAttempt.bind(this)),this._addPopoutButtons('[data-region="grade-panel"] .gradeform'),a(document).trigger("finish-loading-user"),window.M.util.js_complete("mod-assign-loading-user")}.bind(this)).fail(c.exception)}.bind(this)).fail(c.exception),a('[data-region="review-panel"]').show()}else this._region.hide(),a('[data-region="review-panel"]').hide(),a(document).trigger("finish-loading-user"),window.M.util.js_complete("mod-assign-loading-user")}.bind(this))}.bind(this)).fail(c.exception))},j.prototype._getNextUser=function(a,b){this.nextUserId=b.nextUserId,this.nextUser=b.nextUser},j.prototype._handleSaveAndShowNext=function(){this._submitForm(null,this.nextUserId,this.nextUser)},j.prototype.getPanelElement=function(){return a('[data-region="grade-panel"]')},j.prototype.collapsePanel=function(){this.getPanelElement().addClass("collapsed")},j.prototype.expandPanel=function(){this.getPanelElement().removeClass("collapsed")},j.prototype.registerEventListeners=function(){var b=a(document),c=a(this._region);c.on("submit","form",function(a){a.preventDefault()}),b.on("next-user",this._getNextUser.bind(this)),b.on("user-changed",this._refreshGradingPanel.bind(this)),b.on("save-changes",this._submitForm.bind(this)),b.on("save-and-show-next",this._handleSaveAndShowNext.bind(this)),b.on("reset",this._resetForm.bind(this)),b.on("save-form-state",this._saveFormState.bind(this)),b.on(i.COLLAPSE_GRADE_PANEL,function(){this.collapsePanel()}.bind(this)),b.on(i.COLLAPSE_REVIEW_PANEL,function(){this.expandPanel()}.bind(this)),b.on(i.EXPAND_GRADE_PANEL,function(){this.expandPanel()}.bind(this))},j});
define('mod_assign/participant_selector', ["core/ajax","jquery","core/templates"],function(a,b,c){return{processResults:function(a,b){return b},transport:function(d,e,f,g){var h=b(d).attr("data-assignmentid"),i=b(d).attr("data-groupid"),j=b('[data-region="configure-filters"] input[type="checkbox"]'),k=[];j.each(function(a,c){k[b(c).attr("name")]=b(c).prop("checked")}),a.call([{methodname:"mod_assign_list_participants",args:{assignid:h,groupid:i,filter:e,limit:30,includeenrolments:!1}}])[0].then(function(a){var d=[],e=b("[data-showuseridentity]").data("showuseridentity").split(",");return b.each(a,function(a,f){var g=f,h=[],i=!0;k.filter_submitted&&!f.submitted&&(i=!1),k.filter_notsubmitted&&f.submitted&&(i=!1),k.filter_requiregrading&&!f.requiregrading&&(i=!1),k.filter_grantedextension&&!f.grantedextension&&(i=!1),i&&(b.each(e,function(a,b){"undefined"!=typeof f[b]&&""!==f[b]&&(g.hasidentity=!0,h.push(f[b]))}),g.identity=h.join(", "),d.push(c.render("mod_assign/list_participant_user_summary",g).then(function(a){return{value:f.id,label:a}})))}),b.when.apply(b,d)}).then(function(){var a=[];arguments[0]&&(a=Array.prototype.slice.call(arguments)),f(a)})["catch"](g)}}});
define('mod_assign/grading_navigation_user_info', ["jquery","core/notification","core/ajax","core/templates"],function(a,b,c,d){var e=function(b){this._regionSelector=b,this._region=a(b),this._userCache={},a(document).on("user-changed",this._refreshUserInfo.bind(this))};return e.prototype._regionSelector=null,e.prototype._userCache=null,e.prototype._region=null,e.prototype._lastUserId=0,e.prototype._getAssignmentId=function(){return this._region.attr("data-assignmentid")},e.prototype._refreshUserInfo=function(e,f){var g=a.Deferred();this._region.attr("data-userid",f),this._lastUserId!=f&&(this._lastUserId=f,d.render("mod_assign/loading",{}).done(function(e,h){if(this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,e,h),this._region.fadeIn("fast")}.bind(this)),f<0)return void d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception);if("undefined"!=typeof this._userCache[f])g.resolve(this._userCache[f]);else{var i=this._getAssignmentId(),j=c.call([{methodname:"mod_assign_get_participant",args:{userid:f,assignid:i,embeduser:!0}}]);j[0].done(function(a){a.hasOwnProperty("id")?(this._userCache[f]=a,g.resolve(this._userCache[f])):g.reject("No users")}.bind(this)).fail(b.exception)}g.done(function(c){var e=a("[data-showuseridentity]").data("showuseridentity").split(","),f=[];c.courseid=a('[data-region="grading-navigation-panel"]').attr("data-courseid"),c.user&&(a.each(e,function(a,b){"undefined"!=typeof c.user[b]&&""!==c.user[b]&&(c.hasidentity=!0,f.push(c.user[b]))}),c.identity=f.join(", "),c.user.profileimageurl&&(c.profileimageurl=c.user.profileimageurl)),d.render("mod_assign/grading_navigation_user_summary",c).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception)}.bind(this)).fail(function(){d.render("mod_assign/grading_navigation_no_users",{}).done(function(a,b){this._region.fadeOut("fast",function(){d.replaceNodeContents(this._region,a,b),this._region.fadeIn("fast")}.bind(this))}.bind(this)).fail(b.exception)}.bind(this))}.bind(this)).fail(b.exception))},e});
define('mod_assign/grading_navigation', ["jquery","core/notification","core/str","core/form-autocomplete","core/ajax","mod_assign/grading_form_change_checker"],function(a,b,c,d,e,f){var g=function(e){this._regionSelector=e,this._region=a(e),this._filters=[],this._users=[],this._filteredUsers=[],this._loadAllUsers(),this._region.find('[data-action="previous-user"]').on("click",this._handlePreviousUser.bind(this)),this._region.find('[data-action="next-user"]').on("click",this._handleNextUser.bind(this)),this._region.find('[data-action="change-user"]').on("change",this._handleChangeUser.bind(this)),this._region.find('[data-region="user-filters"]').on("click",this._toggleExpandFilters.bind(this)),a(document).on("user-changed",this._refreshSelector.bind(this)),a(document).on("done-saving-show-next",this._handleNextUser.bind(this));var f=this._region.find('[data-region="user-filters"]'),g=a(document.getElementById(f.attr("aria-controls")));g.on("change",'[type="checkbox"]',this._filterChanged.bind(this));var h=a('[data-region="grading-navigation-panel"]').data("first-userid");h&&this._selectUserById(h),c.get_string("changeuser","mod_assign").done(function(a){d.enhance("[data-action=change-user]",!1,"mod_assign/participant_selector",a)}).fail(b.exception),a(document).bind("start-loading-user",function(){this._isLoading=!0}.bind(this)),a(document).bind("finish-loading-user",function(){this._isLoading=!1}.bind(this))};return g.prototype._isLoading=!1,g.prototype._regionSelector=null,g.prototype._filters=null,g.prototype._users=null,g.prototype._region=null,g.prototype._loadAllUsers=function(){var a=this._region.find("[data-action=change-user]"),c=a.attr("data-assignmentid"),d=a.attr("data-groupid");e.call([{methodname:"mod_assign_list_participants",args:{assignid:c,groupid:d,filter:"",onlyids:!0},done:this._usersLoaded.bind(this),fail:b.exception}])},g.prototype._usersLoaded=function(b){if(this._filteredUsers=this._users=b,this._users.length){var c=this._region.find('[data-region="user-filters"]'),d=a(document.getElementById(c.attr("aria-controls")));d.find('[type="checkbox"]').trigger("change")}else this._selectNoUser();this._triggerNextUserEvent()},g.prototype._checkClickOutsideConfigureFilters=function(b){var c=this._region.find('[data-region="configure-filters"]');if(!c.is(b.target)&&0===c.has(b.target).length){var d=this._region.find('[data-region="user-filters"]');c.hide(),c.attr("aria-hidden","true"),d.attr("aria-expanded","false"),a(document).unbind("click.mod_assign_grading_navigation")}},g.prototype._filterChanged=function(d){var e=a(d.target).attr("name"),f=e.split("_").pop(),g=a(d.target).prop("checked");if(g)this._filters.indexOf(f)==-1&&(this._filters[this._filters.length]=f);else{var h=this._filters.indexOf(f);h!=-1&&this._filters.splice(h,1)}var i=[];this._region.find('[data-region="configure-filters"]').find('[type="checkbox"]').each(function(b,c){a(c).prop("checked")&&(i[i.length]=a(c).closest("label").text())}),i.length?this._region.find('[data-region="user-filters"] span').text(i.join(", ")):c.get_string("nofilters","mod_assign").done(function(a){this._region.find('[data-region="user-filters"] span').text(a)}.bind(this)).fail(b.exception);var j=this._region.find("[data-action=change-user]"),k=j.attr("data-selected"),l=0;this._filteredUsers=[],a.each(this._users,function(b,c){var d=!0;a.each(this._filters,function(a,b){"submitted"==b?"0"==c.submitted&&(d=!1):"notsubmitted"==b?"1"==c.submitted&&(d=!1):"requiregrading"==b?"0"==c.requiregrading&&(d=!1):"grantedextension"==b&&"0"==c.grantedextension&&(d=!1)}),d&&(this._filteredUsers[this._filteredUsers.length]=c,k==c.id&&(l=this._filteredUsers.length-1))}.bind(this)),this._filteredUsers.length?this._selectUserById(this._filteredUsers[l].id):this._selectNoUser(),this._triggerNextUserEvent()},g.prototype._selectNoUser=function(){this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",-1)})}):a(document).trigger("user-changed",-1))},g.prototype._selectUserById=function(d){var e=this._region.find("[data-action=change-user]"),g=parseInt(d,10);this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",g)})}):(e.attr("data-selected",d),!isNaN(g)&&g>0&&a(document).trigger("user-changed",d)))},g.prototype._toggleExpandFilters=function(b){b.preventDefault();var c=a(b.target).closest('[data-region="user-filters"]'),d="true"==c.attr("aria-expanded"),e=a(document.getElementById(c.attr("aria-controls")));d?(e.hide(),e.attr("aria-hidden","true"),c.attr("aria-expanded","false"),a(document).unbind("click.mod_assign_grading_navigation")):(e.css("display","inline-block"),e.attr("aria-hidden","false"),c.attr("aria-expanded","true"),b.stopPropagation(),a(document).on("click.mod_assign_grading_navigation",this._checkClickOutsideConfigureFilters.bind(this)))},g.prototype._handlePreviousUser=function(a){a.preventDefault();var b=this._region.find("[data-action=change-user]"),c=b.attr("data-selected"),d=0,e=0;for(d=0;d<this._filteredUsers.length;d++)if(this._filteredUsers[d].id==c){e=d;break}var f=this._filteredUsers.length,g=e-1;g<0&&(g=f-1),f&&this._selectUserById(this._filteredUsers[g].id)},g.prototype._handleNextUser=function(b,c){b.preventDefault();var d=this._region.find("[data-action=change-user]"),e=d.attr("data-selected"),f=0,g=0;for(f=0;f<this._filteredUsers.length;f++)if(this._filteredUsers[f].id==e){g=f;break}var h=this._filteredUsers.length,i=(g+1)%h;if(c&&h){var j=this._filteredUsers[i].id,k=parseInt(j,10);d.attr("data-selected",j),!isNaN(k)&&k>0&&a(document).trigger("user-changed",j)}else h&&this._selectUserById(this._filteredUsers[i].id)},g.prototype._refreshCount=function(){var a=this._region.find("[data-action=change-user]"),d=a.attr("data-selected"),e=0,f=0;if(isNaN(d)||d<=0)this._region.find('[data-region="user-count"]').hide();else{for(this._region.find('[data-region="user-count"]').show(),e=0;e<this._filteredUsers.length;e++)if(this._filteredUsers[e].id==d){f=e;break}var g=this._filteredUsers.length;g&&(f+=1);var h={x:f,y:g};c.get_string("xofy","mod_assign",h).done(function(a){this._region.find('[data-region="user-count-summary"]').text(a)}.bind(this)).fail(b.exception)}},g.prototype._refreshSelector=function(a,b){var c=this._region.find("[data-action=change-user]");b=parseInt(b,10),!isNaN(b)&&b>0&&c.attr("data-selected",b),this._refreshCount()},g.prototype._triggerNextUserEvent=function(){this._filteredUsers.length>1?a(document).trigger("next-user",{nextUserId:null,nextUser:!0}):a(document).trigger("next-user",{nextUser:!1})},g.prototype._handleChangeUser=function(){var d=this._region.find("[data-action=change-user]"),e=parseInt(d.val(),10);this._isLoading||(f.checkFormForChanges('[data-region="grade-panel"] .gradeform')?c.get_strings([{key:"unsavedchanges",component:"mod_assign"},{key:"unsavedchangesquestion",component:"mod_assign"},{key:"saveandcontinue",component:"mod_assign"},{key:"cancel",component:"core"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){a(document).trigger("save-changes",e)})}):!isNaN(e)&&e>0&&(d.attr("data-selected",e),a(document).trigger("user-changed",e)))},g});
define('mod_assign/grading_events', function(){return{COLLAPSE_REVIEW_PANEL:"grading:collapse-review-panel",EXPAND_REVIEW_PANEL:"grading:expand-review-panel",COLLAPSE_GRADE_PANEL:"grading:collapse-grade-panel",EXPAND_GRADE_PANEL:"grading:expand-grade-panel"}});
define('mod_assign/grading_actions', ["jquery","mod_assign/grading_events"],function(a,b){var c=function(b){this._regionSelector=b,this._region=a(b),this.registerEventListeners()};return c.prototype._regionSelector=null,c.prototype._lastUserId=0,c.prototype._region=null,c.prototype._showActionsForm=function(a,b){var c=this._region.find("[data-region=grading-actions-form]");b!=this._lastUserId&&b>0&&(this._lastUserId=b),b>0?c.removeClass("hide"):c.addClass("hide")},c.prototype._trigger=function(b){a(document).trigger(b)},c.prototype.getReviewPanelElement=function(){return a('[data-region="review-panel"]')},c.prototype.hasReviewPanelElement=function(){return this.getReviewPanelElement().length>0},c.prototype.getCollapseGradePanelButton=function(){return a('[data-region="grade-actions"] .collapse-grade-panel')},c.prototype.getCollapseReviewPanelButton=function(){return a('[data-region="grade-actions"] .collapse-review-panel')},c.prototype.getExpandAllPanelsButton=function(){return a('[data-region="grade-actions"] .collapse-none')},c.prototype.resetLayoutButtons=function(){this.getCollapseGradePanelButton().removeClass("active"),this.getCollapseReviewPanelButton().removeClass("active"),this.getExpandAllPanelsButton().removeClass("active")},c.prototype.collapseReviewPanel=function(){a(document).trigger(b.COLLAPSE_REVIEW_PANEL),a(document).trigger(b.EXPAND_GRADE_PANEL),this.resetLayoutButtons(),this.getCollapseReviewPanelButton().addClass("active")},c.prototype.collapseGradePanel=function(){a(document).trigger(b.COLLAPSE_GRADE_PANEL),a(document).trigger(b.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getCollapseGradePanelButton().addClass("active")},c.prototype.expandAllPanels=function(){a(document).trigger(b.EXPAND_GRADE_PANEL),a(document).trigger(b.EXPAND_REVIEW_PANEL),this.resetLayoutButtons(),this.getExpandAllPanelsButton().addClass("active")},c.prototype.registerEventListeners=function(){if(this.hasReviewPanelElement()){var b=this.getCollapseReviewPanelButton();b.click(function(a){this.collapseReviewPanel(),a.preventDefault()}.bind(this)),b.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.collapseReviewPanel(),a.preventDefault())}.bind(this));var c=this.getCollapseGradePanelButton();c.click(function(a){this.collapseGradePanel(),a.preventDefault()}.bind(this)),c.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.collapseGradePanel(),a.preventDefault())}.bind(this));var d=this.getExpandAllPanelsButton();d.click(function(a){this.expandAllPanels(),a.preventDefault()}.bind(this)),d.keydown(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||13!==a.keyCode&&32!==a.keyCode||(this.expandAllPanels(),a.preventDefault())}.bind(this))}a(document).on("user-changed",this._showActionsForm.bind(this)),this._region.find('[name="savechanges"]').on("click",this._trigger.bind(this,"save-changes")),this._region.find('[name="saveandshownext"]').on("click",this._trigger.bind(this,"save-and-show-next")),this._region.find('[name="resetbutton"]').on("click",this._trigger.bind(this,"reset")),this._region.find("form").on("submit",function(a){a.preventDefault()})},c});
define('mod_choice/select_all_choices', ["jquery"],function(a){return{init:function(){a(".selectallnone a").on("click",function(b){b.preventDefault(),a("#attemptsform").find("input:checkbox").prop("checked",a(this).data("selectInfo"))})}}});
define('mod_choicegroup/select_all_choices', ["jquery"],function(a){return{init:function(){a(".selectallnone a").on("click",function(b){b.preventDefault(),a("#attemptsform").find("input:checkbox").prop("checked",a(this).data("selectInfo"))})}}});
define('mod_choicegroup/choicegroupdatadisplay', ["jquery","core/str"],function(a,b){return{init:function(){a(".choicegroup-memberdisplay").click(function(c){c.preventDefault(),a(".choicegroups-membersnames").toggleClass("hidden");var d=b.get_string("showgroupmembers","mod_choicegroup"),e=b.get_string("hidegroupmembers","mod_choicegroup");a(".choicegroups-membersnames").is(":visible")?a.when(e).done(function(b){a(".choicegroup-memberdisplay").html(b)}):a.when(d).done(function(b){a(".choicegroup-memberdisplay").html(b)})}),a(".choicegroup-descriptiondisplay").click(function(c){c.preventDefault(),a(".choicegroups-descriptions").toggleClass("hidden");var d=b.get_string("hidedescription","mod_choicegroup"),e=b.get_string("showdescription","mod_choicegroup");a(".choicegroups-descriptions").is(":visible")?a.when(d).done(function(b){a(".choicegroup-descriptiondisplay").html(b)}):a.when(e).done(function(b){a(".choicegroup-descriptiondisplay").html(b)})})}}});
define('mod_feedback/edit', ["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={deleteItem:function(b){b.preventDefault();var e=a(b.currentTarget).attr("href");c.get_strings([{key:"confirmation",component:"admin"},{key:"confirmdeleteitem",component:"mod_feedback"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).then(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location=e})})["catch"]()},setup:function(){a("body").delegate('[data-action="delete"]',"click",e.deleteItem)}};return{setup:e.setup}});
define('mod_lti/external_registration_return', [],function(){return{init:function(a,b,c,d){window.parent&&window.parent.triggerExternalRegistrationComplete({message:a,error:b,id:c,status:d})}}});
define('mod_lti/keys', [],function(){return{ENTER:13,SPACE:32}});
define('mod_lti/contentitem_return', ["jquery"],function(a){return{init:function(b){a(window).ready(function(){window!=top?parent.processContentItemReturnData(b):window.processContentItemReturnData(b)})}}});
define('mod_lti/tool_proxy_card_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/tool_proxy","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h){var i={DELETE_BUTTON:".delete",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},j=2e3,k=function(a){return a.find(i.DELETE_BUTTON)},l=function(a){return a.find(i.ACTIVATE_BUTTON)},m=function(a){return a.attr("data-proxy-id")},n=function(a){a.removeClass("announcement loading success fail capabilities")},o=function(a){n(a),a.addClass("announcement loading")},p=function(a){a.removeClass("announcement loading")},q=function(b){var c=a.Deferred();return n(b),b.addClass("announcement success"),setTimeout(function(){b.removeClass("announcement success"),c.resolve()},j),c},r=function(b){var c=a.Deferred();return n(b),b.addClass("announcement fail"),setTimeout(function(){b.removeClass("announcement fail"),c.resolve()},j),c},s=function(b){var d=a.Deferred(),f=m(b);return o(b),""===f?a.Deferred().resolve():(h.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){e["delete"](f).done(function(){p(b),q(b).done(function(){b.remove(),d.resolve()}).fail(c.exception)}).fail(function(a){r(b),d.reject(a)})},function(){p(b),d.resolve()})}).fail(function(a){p(b),c.exception(a),d.reject(a)}),d)},t=function(b){var c={proxyid:m(b)};a(document).trigger(f.START_EXTERNAL_REGISTRATION,c)},u=function(a){var b=k(a);b.click(function(b){b.preventDefault(),s(a)}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),b.click())});var c=l(a);c.click(function(b){b.preventDefault(),t(a)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),c.click())})};return{init:function(a){u(a)}}});
define('mod_lti/tool_card_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h){var i={DELETE_BUTTON:".delete",NAME_ELEMENT:".name",DESCRIPTION_ELEMENT:".description",CAPABILITIES_CONTAINER:".capabilities-container",ACTIVATE_BUTTON:".tool-card-footer a.activate"},j=2e3,k=function(a){return a.find(i.DELETE_BUTTON)},l=function(a){return a.find(i.NAME_ELEMENT)},m=function(a){return a.find(i.DESCRIPTION_ELEMENT)},n=function(a){return a.find(i.ACTIVATE_BUTTON)},o=function(a){return!!n(a).length},p=function(a){return a.find(i.CAPABILITIES_CONTAINER)},q=function(a){return!!p(a).length},r=function(a){return a.attr("data-type-id")},s=function(a){a.removeClass("announcement loading success fail capabilities")},t=function(a){s(a),a.addClass("announcement loading")},u=function(a){a.removeClass("announcement loading")},v=function(b){var c=a.Deferred();return s(b),b.addClass("announcement success"),setTimeout(function(){b.removeClass("announcement success"),c.resolve()},j),c},w=function(b){var c=a.Deferred();return s(b),b.addClass("announcement fail"),setTimeout(function(){b.removeClass("announcement fail"),c.resolve()},j),c},x=function(b){var d=a.Deferred(),f=r(b);return t(b),""===f?a.Deferred().resolve():(h.get_strings([{key:"delete",component:"mod_lti"},{key:"delete_confirmation",component:"mod_lti"},{key:"delete",component:"mod_lti"},{key:"cancel",component:"core"}]).done(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){e["delete"](f).done(function(){u(b),v(b).done(function(){b.remove()}).fail(c.exception).always(function(){d.resolve()})}).fail(function(a){w(b),d.reject(a)})},function(){u(b),d.resolve()})}).fail(function(a){u(b),c.exception(a),d.reject(a)}),d)},y=function(a,b){a.attr("data-val-snapshot",b)},z=function(a){return a.attr("data-val-snapshot")},A=function(a){var b=m(a);if(!b.hasClass("loading")){var c=b.text().trim();y(b,c)}},B=function(b){var d=r(b);if(""===d)return a.Deferred().resolve();var f=m(b);if(f.hasClass("loading"))return a.Deferred().resolve();var g=f.text().trim(),h=z(f);if(h==g)return a.Deferred().resolve();f.addClass("loading");var i=e.update({id:d,description:g});return i.done(function(a){f.removeClass("loading"),f.text(a.description)}).fail(c.exception),i.fail(function(){f.removeClass("loading")}),i},C=function(a){var b=l(a);if(!b.hasClass("loading")){var c=b.text().trim();y(b,c)}},D=function(b){var c=r(b);if(""===c)return a.Deferred().resolve();var d=l(b);if(d.hasClass("loading"))return a.Deferred().resolve();var f=d.text().trim(),g=z(d);if(g==f)return a.Deferred().resolve();d.addClass("loading");var h=e.update({id:c,name:f});return h.done(function(a){d.removeClass("loading"),d.text(a.name)}),h.fail(function(){d.removeClass("loading")}),h},E=function(b){var c=r(b);if(""===c)return a.Deferred().resolve();t(b);var f=e.update({id:c,state:e.constants.state.configured});return f.then(function(a){return u(b),v(b),a}).then(function(a){return d.render("mod_lti/tool_card",a)}).then(function(a){var c=a[0],e=a[1];d.replaceNode(b,c,e)})["catch"](function(){u(b),w(b)}),f},F=function(a){a.addClass("announcement capabilities")},G=function(a){a.removeClass("announcement capabilities")},H=function(a){q(a)?F(a):E(a)},I=function(a){var b=k(a);b.click(function(b){b.preventDefault(),x(a)}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),b.click())});var c=m(a);c.focus(function(b){b.preventDefault(),A(a)}),c.blur(function(b){b.preventDefault(),B(a)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode==g.ENTER&&(a.preventDefault(),c.blur())});var d=l(a);if(d.focus(function(b){b.preventDefault(),C(a)}),d.blur(function(b){b.preventDefault(),D(a)}),d.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode==g.ENTER&&(a.preventDefault(),d.blur())}),o(a)){var e=n(a);e.click(function(b){b.preventDefault(),H(a)}),e.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=g.ENTER&&a.keyCode!=g.SPACE||(a.preventDefault(),e.click())})}if(q(a)){var h=p(a);h.on(f.CAPABILITIES_AGREE,function(){E(a)}),h.on(f.CAPABILITIES_DECLINE,function(){G(a)})}};return{init:function(a){I(a)}}});
define('mod_lti/external_registration', ["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/tool_proxy","mod_lti/tool_type","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-page-container",EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER:"#external-registration-template-container",EXTERNAL_REGISTRATION_CANCEL_BUTTON:"#cancel-external-registration",TOOL_TYPE_CAPABILITIES_CONTAINER:"#tool-type-capabilities-container",TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER:"#tool-type-capabilities-template-container",CAPABILITIES_AGREE_CONTAINER:".capabilities-container"},k=function(){return a(j.EXTERNAL_REGISTRATION_CANCEL_BUTTON)},l=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_TEMPLATE_CONTAINER)},n=function(){return a(j.TOOL_TYPE_CAPABILITIES_CONTAINER)},o=function(){return a(j.TOOL_TYPE_CAPABILITIES_TEMPLATE_CONTAINER)},p=function(){n().addClass("loading")},q=function(){n().removeClass("loading")},r=function(){k().addClass("loading")},s=function(){k().removeClass("loading")},t=function(){n().addClass("hidden")},u=function(){n().removeClass("hidden")},v=function(){l().addClass("hidden")},w=function(){l().removeClass("hidden")},x=function(a){var b=k();b.attr("data-tool-proxy-id",a)},y=function(){var a=k();return a.attr("data-tool-proxy-id")},z=function(){var a=k();a.removeAttr("data-tool-proxy-id")},A=function(){return!!y()},B=function(){var a=k();return a.attr("data-tool-proxy-new")&&A()},C=function(){var a=k();return a.attr("data-tool-proxy-new","new")},D=function(){var a=k();return a.removeAttr("data-tool-proxy-new")},E=function(a){var c={methodname:"mod_lti_get_tool_proxy_registration_request",args:{id:a}};return b.call([c])[0]},F=function(){r();var b=a.Deferred();if(B()){var d=y();f["delete"](d).done(function(){b.resolve()}).fail(function(a){b.reject(a)})}else b.resolve();return b.done(function(){L(),s()}).fail(function(b){c.exception(b),L(),s(),i.get_string("failedtodeletetoolproxy","mod_lti").done(function(b){var c={message:b,error:!0};a(document).trigger(e.REGISTRATION_FEEDBACK,c)}).fail(c.exception)}),b},G=function(a){var b=d.render("mod_lti/tool_proxy_registration_form",a);return b.done(function(a,b){var c=m();c.append(a),d.runTemplateJS(b),c.find("form").submit(),w()}).fail(c.exception),b},H=function(a){return g.update({id:a.id,state:g.constants.state.configured})},I=function(b){var f=a.Deferred();return d.render("mod_lti/tool_type_capabilities_agree",b).done(function(a,c){var g=o();v(),u(),d.replaceNodeContents(g,a,c);var h=g.find(j.CAPABILITIES_AGREE_CONTAINER);h.on(e.CAPABILITIES_AGREE,function(){p(),H(b).always(function(){q(),g.empty(),f.resolve()})}),h.on(e.CAPABILITIES_DECLINE,function(){g.empty(),f.resolve()})}).fail(f.reject),f.done(function(){t()}).fail(c.exception),f},J=function(b){var c=a.Deferred();return b&&""!==b?f.create({regurl:b}).done(function(a){C(),c=K(a.id)}).fail(function(b){F();var d={message:b.message,error:!0};a(document).trigger(e.REGISTRATION_FEEDBACK,d),c.reject(b)}):c.resolve(),c},K=function(b){var c=a.Deferred();return x(b),E(b).done(function(a){G(a).done(function(){c.resolve()}).fail(c.fail)}).fail(c.fail),c},L=function(){A()&&z(),D(!1),v();var b=m();b.empty(),a(document).trigger(e.STOP_EXTERNAL_REGISTRATION)},M=function(){a(document).on(e.START_EXTERNAL_REGISTRATION,function(a,b){b&&(b.url&&J(b.url),b.proxyid&&K(b.proxyid))});var b=k();b.click(function(a){a.preventDefault(),F()}),b.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=h.ENTER&&a.keyCode!=h.SPACE||(a.preventDefault(),F())}),window.triggerExternalRegistrationComplete=function(b){var d=a.Deferred(),f={message:"",error:!1};if("success"==b.status){if(i.get_string("successfullycreatedtooltype","mod_lti").done(function(a){f.message=a}).fail(c.exception),d.done(function(){L(),a(document).trigger(e.REGISTRATION_FEEDBACK,f),a(document).trigger(e.NEW_TOOL_TYPE)}).fail(c.exception),B()){var h=y();g.getFromToolProxyId(h).done(function(a){if(a&&a.length){var b=a[0];b.hascapabilitygroups?I(b).always(function(){d.resolve()}):d.resolve()}else d.resolve()}).fail(function(){d.resolve()})}}else f.message=b.error,f.error=!0,d.done(function(){F().always(function(){a(document).trigger(e.REGISTRATION_FEEDBACK,f)})}).fail(c.exception),d.resolve();return d}};return{init:function(){M()}}});
define('mod_lti/tool_type', ["core/ajax","core/notification"],function(a,b){return{query:function(c){var d={methodname:"mod_lti_get_tool_types",args:c||{}},e=a.call([d])[0];return e.fail(b.exception),e},create:function(b){var c={methodname:"mod_lti_create_tool_type",args:b},d=a.call([c])[0];return d},update:function(c){var d={methodname:"mod_lti_update_tool_type",args:c},e=a.call([d])[0];return e.fail(b.exception),e},"delete":function(c){var d={methodname:"mod_lti_delete_tool_type",args:{id:c}},e=a.call([d])[0];return e.fail(b.exception),e},getFromToolProxyId:function(a){return this.query({toolproxyid:a})},isCartridge:function(b){var c={methodname:"mod_lti_is_cartridge",args:{url:b}},d=a.call([c])[0];return d},constants:{state:{configured:1,pending:2,rejected:3}}}});
define('mod_lti/form-field', ["jquery"],function(a){var b=function(a,b,c,d){this.name=a,this.id="id_"+this.name,this.selector="#"+this.id,this.type=b,this.resetIfUndefined=c,this.defaultValue=d};return b.TYPES={TEXT:1,SELECT:2,CHECKBOX:3,EDITOR:4},b.prototype.setFieldValue=function(c){if(null===c){if(!this.resetIfUndefined)return;c=this.defaultValue}switch(this.type){case b.TYPES.CHECKBOX:c?a(this.selector).prop("checked",!0):a(this.selector).prop("checked",!1);break;case b.TYPES.EDITOR:if("undefined"!=typeof c.text){var d=a(this.selector+"editable");d.length?d.html(c.text):"undefined"!=typeof tinyMCE&&tinyMCE.execInstanceCommand(this.id,"mceInsertContent",!1,c.text),a(this.selector).val(c.text)}break;default:a(this.selector).val(c)}},b});
define('mod_lti/tool_configure_controller', ["jquery","core/ajax","core/notification","core/templates","mod_lti/events","mod_lti/keys","mod_lti/tool_type","mod_lti/tool_proxy","core/str"],function(a,b,c,d,e,f,g,h,i){var j={EXTERNAL_REGISTRATION_CONTAINER:"#external-registration-container",EXTERNAL_REGISTRATION_PAGE_CONTAINER:"#external-registration-page-container",CARTRIDGE_REGISTRATION_CONTAINER:"#cartridge-registration-container",CARTRIDGE_REGISTRATION_FORM:"#cartridge-registration-form",ADD_TOOL_FORM:"#add-tool-form",TOOL_LIST_CONTAINER:"#tool-list-container",TOOL_CREATE_BUTTON:"#tool-create-button",REGISTRATION_CHOICE_CONTAINER:"#registration-choice-container",TOOL_URL:"#tool-url"},k=function(){return a(j.TOOL_CREATE_BUTTON)},l=function(){return a(j.TOOL_LIST_CONTAINER)},m=function(){return a(j.EXTERNAL_REGISTRATION_CONTAINER)},n=function(){return a(j.CARTRIDGE_REGISTRATION_CONTAINER)},o=function(){return a(j.REGISTRATION_CHOICE_CONTAINER)},p=function(){return a(j.TOOL_URL).val()},q=function(){m().addClass("hidden")},r=function(){n().addClass("hidden")},s=function(){o().addClass("hidden")},t=function(){r(),s(),m().removeClass("hidden"),w(m())},u=function(a){q(),s(),n().removeClass("hidden"),n().find(j.CARTRIDGE_REGISTRATION_FORM).attr("data-cartridge-url",a),w(n())},v=function(){q(),r(),o().removeClass("hidden"),w(o())},w=function(a){var b=a.children().detach();b.appendTo(a)},x=function(){l().addClass("hidden")},y=function(){l().removeClass("hidden")},z=function(a){var b=a.error?"error":"success";c.addNotification({message:a.message,type:b})},A=function(a){a.addClass("loading")},B=function(a){a.removeClass("loading")},C=function(){var b=a.Deferred(),e=l();A(e),a.when(g.query(),h.query({orphanedonly:!0})).done(function(a,c){d.render("mod_lti/tool_list",{tools:a,proxies:c}).done(function(a,c){e.empty(),e.append(a),d.runTemplateJS(c),b.resolve()}).fail(b.reject)}).fail(b.reject),b.fail(c.exception).always(function(){B(e)})},D=function(){var b=p().trim();if(""===b)return a.Deferred().resolve();var d=k();A(d);var f=g.isCartridge(b);return f.always(function(){B(d)}),f.done(function(c){c.iscartridge?(a(j.TOOL_URL).val(""),a(document).trigger(e.START_CARTRIDGE_REGISTRATION,b)):a(document).trigger(e.START_EXTERNAL_REGISTRATION,{url:b})}),f.fail(function(){i.get_string("errorbadurl","mod_lti").done(function(b){a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)}),f},E=function(){a(document).on(e.NEW_TOOL_TYPE,function(){C()}),a(document).on(e.START_EXTERNAL_REGISTRATION,function(){t(),a(j.TOOL_URL).val(""),x()}),a(document).on(e.STOP_EXTERNAL_REGISTRATION,function(){y(),v()}),a(document).on(e.START_CARTRIDGE_REGISTRATION,function(a,b){u(b)}),a(document).on(e.STOP_CARTRIDGE_REGISTRATION,function(){n().find(j.CARTRIDGE_REGISTRATION_FORM).removeAttr("data-cartridge-url"),v()}),a(document).on(e.REGISTRATION_FEEDBACK,function(a,b){z(b)});var b=a(j.ADD_TOOL_FORM);b.submit(function(a){a.preventDefault(),D()})};return{init:function(){E(),C()}}});
define('mod_lti/events', [],function(){return{NEW_TOOL_TYPE:"lti.tool.type.new",START_EXTERNAL_REGISTRATION:"lti.registration.external.start",STOP_EXTERNAL_REGISTRATION:"lti.registration.external.stop",START_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.start",STOP_CARTRIDGE_REGISTRATION:"lti.registration.cartridge.stop",REGISTRATION_FEEDBACK:"lti.registration.feedback",CAPABILITIES_AGREE:"lti.tool.type.capabilities.agree",CAPABILITIES_DECLINE:"lti.tool.type.capabilities.decline"}});
define('mod_lti/cartridge_registration_form', ["jquery","core/ajax","core/notification","mod_lti/tool_type","mod_lti/events","mod_lti/keys","core/str"],function(a,b,c,d,e,f,g){var h={CARTRIDGE_URL:"#cartridge-url",CONSUMER_KEY:"#registration-key",SHARED_SECRET:"#registration-secret",REGISTRATION_FORM:"#cartridge-registration-form",REGISTRATION_SUBMIT_BUTTON:"#cartridge-registration-submit",REGISTRATION_CANCEL_BUTTON:"#cartridge-registration-cancel"},i=function(){return a(h.REGISTRATION_FORM).attr("data-cartridge-url")},j=function(){return a(h.REGISTRATION_SUBMIT_BUTTON)},k=function(){return a(h.REGISTRATION_CANCEL_BUTTON)},l=function(){return a(h.CONSUMER_KEY).val()},m=function(){return a(h.SHARED_SECRET).val()},n=function(){j().addClass("loading")},o=function(){j().removeClass("loading")},p=function(){return j().hasClass("loading")},q=function(){if(p())return!1;var b=i();if(""===b)return!1;n();var f=l(),h=m(),j=d.create({cartridgeurl:b,key:f,secret:h});return j.done(function(){g.get_string("successfullycreatedtooltype","mod_lti").done(function(b){a(document).trigger(e.NEW_TOOL_TYPE),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION),a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b})}).fail(c.exception)}).fail(function(){g.get_string("failedtocreatetooltype","mod_lti").done(function(b){a(document).trigger(e.NEW_TOOL_TYPE),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION),a(document).trigger(e.REGISTRATION_FEEDBACK,{message:b,error:!0})}).fail(c.exception)}).always(function(){o()}),j},r=function(){var b=a(h.REGISTRATION_FORM);b.submit(function(a){a.preventDefault(),q()});var c=k();c.click(function(b){b.preventDefault(),a(document).trigger(e.STOP_CARTRIDGE_REGISTRATION)}),c.keypress(function(a){a.metaKey||a.shiftKey||a.altKey||a.ctrlKey||a.keyCode!=f.ENTER&&a.keyCode!=f.SPACE||(a.preventDefault(),c.click())})};return{init:function(){r()}}});
define('mod_lti/tool_proxy', ["core/ajax","core/notification"],function(a,b){return{query:function(c){var d={methodname:"mod_lti_get_tool_proxies",args:c||{}},e=a.call([d])[0];return e.fail(b.exception),e},"delete":function(c){var d={methodname:"mod_lti_delete_tool_proxy",args:{id:c}},e=a.call([d])[0];return e.fail(b.exception),e},create:function(b){var c={methodname:"mod_lti_create_tool_proxy",args:b},d=a.call([c])[0];return d}}});
define('mod_lti/contentitem', ["jquery","core/notification","core/str","core/templates","mod_lti/form-field","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){var h,i,j={init:function(a,e,j){i=j;var k={url:a,postData:e},l=d.render("mod_lti/contentitem",k);return h?(h.setBody(l),void h.show()):void c.get_string("selectcontent","lti").then(function(a){return f.create({title:a,body:l,large:!0})}).then(function(a){h=a,a.getRoot().on(g.hidden,function(){a.setBody(""),b.fetchNotifications()}),a.show()})["catch"](b.exception)}},k=[new e("name",e.TYPES.TEXT,(!1),""),new e("introeditor",e.TYPES.EDITOR,(!1),""),new e("toolurl",e.TYPES.TEXT,(!0),""),new e("securetoolurl",e.TYPES.TEXT,(!0),""),new e("instructorchoiceacceptgrades",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorchoicesendname",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorchoicesendemailaddr",e.TYPES.CHECKBOX,(!0),(!0)),new e("instructorcustomparameters",e.TYPES.TEXT,(!0),""),new e("icon",e.TYPES.TEXT,(!0),""),new e("secureicon",e.TYPES.TEXT,(!0),""),new e("launchcontainer",e.TYPES.SELECT,(!0),0),new e("grade_modgrade_point",e.TYPES.TEXT,(!1),""),new e("cmidnumber",e.TYPES.TEXT,(!0),"")];return window.processContentItemReturnData=function(a){h&&h.hide();var b;for(b in k){var c=k[b],d=null;"undefined"!=typeof a[c.name]&&(d=a[c.name]),c.setFieldValue(d)}i&&i()},j});
define('mod_quiz/add_random_question', ["mod_quiz/add_question_modal_launcher","mod_quiz/modal_add_random_question"],function(a,b){return{init:function(c,d,e,f){a.init(b.TYPE,'.menu [data-action="addarandomquestion"]',c,function(a,b){b.setCategory(d),b.setReturnUrl(e),b.setCMID(f)})}}});
define('mod_quiz/modal_add_random_question', ["jquery","core/yui","core/notification","core/modal","core/modal_events","core/modal_registry","core/fragment","core/templates"],function(a,b,c,d,e,f,g,h){var i=!1,j={EXISTING_CATEGORY_CONTAINER:'[data-region="existing-category-container"]',EXISTING_CATEGORY_FORM_ELEMENT:"#id_existingcategoryheader",NEW_CATEGORY_CONTAINER:'[data-region="new-category-container"]',NEW_CATEGORY_FORM_ELEMENT:"#id_newcategoryheader",TAB_CONTENT:'[data-region="tab-content"]',ADD_ON_PAGE_FORM_ELEMENT:'[name="addonpage"]',SUBMIT_BUTTON_ELEMENT:'input[type="submit"]',CANCEL_BUTTON_ELEMENT:'input[type="submit"][name="cancel"]',FORM_HEADER:"legend",BUTTON_CONTAINER:".fitem"},k=function(a){d.call(this,a),this.contextId=null,this.addOnPageId=null,this.category=null,this.returnUrl=null,this.cmid=null,this.loadedForm=!1};return k.TYPE="mod_quiz-quiz-add-random-question",k.prototype=Object.create(d.prototype),k.prototype.constructor=k,k.prototype.setContextId=function(a){this.contextId=a},k.prototype.getContextId=function(){return this.contextId},k.prototype.setAddOnPageId=function(a){this.addOnPageId=a,this.getBody().find(j.ADD_ON_PAGE_FORM_ELEMENT).val(a)},k.prototype.getAddOnPageId=function(){return this.addOnPageId},k.prototype.setCategory=function(a){this.category=a},k.prototype.getCategory=function(){return this.category},k.prototype.setReturnUrl=function(a){this.returnUrl=a},k.prototype.getReturnUrl=function(){return this.returnUrl},k.prototype.setCMID=function(a){this.cmid=a},k.prototype.getCMID=function(){return this.cmid},k.prototype.moveFormElementIntoTab=function(b,c){var d=b.find(j.SUBMIT_BUTTON_ELEMENT),e=a('<div class="modal-footer m-t-1" data-region="footer"></div>');b.find(j.FORM_HEADER).addClass("hidden"),b.wrap(c),d.closest(j.BUTTON_CONTAINER).remove(),d.appendTo(e),e.appendTo(b)},k.prototype.moveTabsIntoTabContent=function(a){var b=this.getBody().find(j.TAB_CONTENT).empty();a.find('[role="tabpanel"]').wrapAll(b)},k.prototype.moveCancelButtonToTabs=function(a){var b=a.find(j.CANCEL_BUTTON_ELEMENT).addClass("m-l-1"),c=a.find('[data-region="footer"]');b.closest(j.BUTTON_CONTAINER).remove(),b.clone().appendTo(c)},k.prototype.loadForm=function(){return g.loadFragment("mod_quiz","add_random_question_form",this.getContextId(),{addonpage:this.getAddOnPageId(),cat:this.getCategory(),returnurl:this.getReturnUrl(),cmid:this.getCMID()}).then(function(b,c){var d=a(b),e=d.find(j.EXISTING_CATEGORY_FORM_ELEMENT),f=this.getBody().find(j.EXISTING_CATEGORY_CONTAINER),g=d.find(j.NEW_CATEGORY_FORM_ELEMENT),i=this.getBody().find(j.NEW_CATEGORY_CONTAINER);this.moveFormElementIntoTab(e,f),this.moveFormElementIntoTab(g,i),this.moveTabsIntoTabContent(d),this.moveCancelButtonToTabs(d),h.replaceNode(this.getBody().find(j.TAB_CONTENT),d,c)}.bind(this)).then(function(){b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()})}).fail(c.exception)},k.prototype.show=function(){d.prototype.show.call(this),this.loadedForm||(this.loadForm(),this.loadedForm=!0)},i||(f.register(k.TYPE,k,"mod_quiz/modal_add_random_question"),i=!0),k});
define('mod_quiz/preflightcheck', ["jquery","core/yui"],function(a,b){var c={confirmDialogue:null,init:function(a,d,e,f){var g=a;b.use("moodle-core-notification",function(){b.one(e)&&(c.confirmDialogue=new M.core.dialogue({headerContent:d,bodyContent:b.one(e),draggable:!0,visible:!1,center:!0,modal:!0,width:null,extraClasses:["mod_quiz_preflight_popup"]}),b.one(a).on("click",c.displayDialogue),b.one("#id_cancel").on("click",c.hideDialogue),g=c.confirmDialogue.get("boundingBox").one('[name="submitbutton"]')),f&&b.one(g).on("click",c.launchQuizPopup,c,f)})},displayDialogue:function(a){a&&a.halt(),c.confirmDialogue.show()},hideDialogue:function(a){a&&a.halt(),c.confirmDialogue.hide(a)},launchQuizPopup:function(a,c){a.halt(),b.use("moodle-core-formchangechecker","io-form",function(){M.core_formchangechecker.reset_form_dirty_state();var d=a.target.ancestor("form");window.openpopup(a,{url:d.get("action")+"?"+b.IO.stringify(d).replace(/\bcancel=/,"x="),windowname:"quizpopup",options:c,fullscreen:!0})})}};return c});
define('mod_quiz/add_random_form', ["jquery","mod_quiz/random_question_form_preview"],function(a,b){var c=2e3,d={PREVIEW_CONTAINER:'[data-region="random-question-preview-container"]',CATEGORY_FORM_ELEMENT:'[name="category"]',SUBCATEGORY_FORM_ELEMENT:'[name="includesubcategories"]',TAG_IDS_FORM_ELEMENT:'[name="fromtags[]"]'},e=function(a){return a.find(d.CATEGORY_FORM_ELEMENT).val()},f=function(a){var b=e(a),c=b.split(",");return c[0]},g=function(a,b){var c=e(a);return b.indexOf(c)>-1},h=function(a,b){return!!g(a,b)||a.find(d.SUBCATEGORY_FORM_ELEMENT).is(":checked")},i=function(a){var b=a.find(d.TAG_IDS_FORM_ELEMENT).val();return b.map(function(a){var b=a.split(",");return b[0]})},j=function(a,c,e){var g=a.find(d.PREVIEW_CONTAINER);b.reload(g,f(a),h(a,e),i(a),c)},k=function(a){return a.closest(d.CATEGORY_FORM_ELEMENT).length>0||(a.closest(d.SUBCATEGORY_FORM_ELEMENT).length>0||a.closest(d.TAG_IDS_FORM_ELEMENT).length>0)},l=function(d,e,f){var g=null;d.on("change",function(h){k(a(h.target))&&(b.showLoadingIcon(d),g&&clearTimeout(g),g=setTimeout(function(){j(d,e,f)},c))})},m=function(b,c,d,e){if(1==e){var f=a("#"+b);j(f,c,d,e),l(f,c,d,e)}};return{init:m}});
define('mod_quiz/quizquestionbank', ["mod_quiz/add_question_modal_launcher","mod_quiz/modal_quiz_question_bank"],function(a,b){return{init:function(c){a.init(b.TYPE,'.menu [data-action="questionbank"]',c)}}});
define('mod_quiz/random_question_form_preview', ["jquery","core/ajax","core/str","core/notification","core/templates","core/paged_content_factory"],function(a,b,c,d,e,f){var g=5,h="mod_quiz/random_question_form_preview_question_list",i={LOADING_ICON_CONTAINER:'[data-region="overlay-icon-container"]',QUESTION_COUNT_CONTAINER:'[data-region="question-count-container"]',QUESTION_LIST_CONTAINER:'[data-region="question-list-container"]'},j=function(a){a.find(i.LOADING_ICON_CONTAINER).removeClass("hidden")},k=function(a){a.find(i.LOADING_ICON_CONTAINER).addClass("hidden")},l=function(a,b){c.get_string("questionsmatchingfilter","mod_quiz",b).then(function(b){a.find(i.QUESTION_COUNT_CONTAINER).html(b)}).fail(d.exception)},m=function(a,c,d,e,f,g){var h={methodname:"core_question_get_random_question_summaries",args:{categoryid:a,includesubcategories:c,tagids:d,contextid:e,limit:f,offset:g}};return b.call([h])[0]},n=function(a,b,c,i,j,k){return f.createFromAjax(j,g,function(f){return f.map(function(f){var g=f.limit,j=f.offset;return 0==j?e.render(h,{questions:k}):m(a,b,c,i,g,j).then(function(a){var b=a.questions;return e.render(h,{questions:b})}).fail(d.exception)})})},o=function(b,c,f,h,o){return j(b),m(c,f,h,o,g,0).then(function(a){var c=a.totalcount;return l(b,c),a}).then(function(b){var d=b.totalcount,e=b.questions;return e.length?n(c,f,h,o,d,e):a.Deferred().resolve("","")}).then(function(a,c){var d=b.find(i.QUESTION_LIST_CONTAINER);e.replaceNodeContents(d,a,c)}).always(function(){k(b)}).fail(d.exception)};return{reload:o,showLoadingIcon:j,hideLoadingIcon:k}});
define('mod_quiz/add_question_modal_launcher', ["jquery","core/notification","core/modal_factory"],function(a,b,c){return{init:function(d,e,f,g){var h=a("body");return c.create({type:d,large:!0,preShowCallback:function(b,c){b=a(b),c.setContextId(f),c.setAddOnPageId(b.attr("data-addonpage")),c.setTitle(b.attr("data-header")),g&&g(b,c)}},[h,e]).fail(b.exception)}}});
define('mod_quiz/modal_quiz_question_bank', ["jquery","core/yui","core/notification","core/modal","core/modal_events","core/modal_registry","core/fragment"],function(a,b,c,d,e,f,g){var h=!1,i={ADD_TO_QUIZ_CONTAINER:"td.addtoquizaction",ANCHOR:"a[href]",PREVIEW_CONTAINER:"td.previewaction",SEARCH_OPTIONS:"#advancedsearch",DISPLAY_OPTIONS:"#displayoptions",ADD_QUESTIONS_FORM:'form[action="edit.php"]'},j=function(a){d.call(this,a),this.contextId=null,this.addOnPageId=null};return j.TYPE="mod_quiz-quiz-question-bank",j.prototype=Object.create(d.prototype),j.prototype.constructor=j,j.prototype.setContextId=function(a){this.contextId=a},j.prototype.getContextId=function(){return this.contextId},j.prototype.setAddOnPageId=function(a){this.addOnPageId=a},j.prototype.getAddOnPageId=function(){return this.addOnPageId},j.prototype.show=function(){return this.reloadBodyContent(window.location.search),d.prototype.show.call(this)},j.prototype.reloadBodyContent=function(a){var b=g.loadFragment("mod_quiz","quiz_question_bank",this.getContextId(),{querystring:a}).fail(c.exception);this.setBody(b)},j.prototype.handleAddToQuizEvent=function(a,b){var c=b.attr("href")+"&addonpage="+this.getAddOnPageId();b.attr("href",c)},j.prototype.handlePreviewContainerEvent=function(a,b){var c=["height=600","width=800","top=0","left=0","menubar=0","location=0","scrollbars","resizable","toolbar","status","directories=0","fullscreen=0","dependent"];window.openpopup(a,{url:b.attr("href"),name:"questionpreview",options:c.join(",")})},j.prototype.handleDisplayOptionFormEvent=function(b){b.stopPropagation(),b.preventDefault();var c=a(b.target).closest(i.DISPLAY_OPTIONS),d="?"+c.serialize();this.reloadBodyContent(d)},j.prototype.registerDisplayOptionListeners=function(){this.getModal().on("change",i.DISPLAY_OPTIONS,function(b){var c=a(b.target);c.attr("aria-autocomplete")||this.handleDisplayOptionFormEvent(b)}.bind(this)),this.getModal().on("submit",i.DISPLAY_OPTIONS,function(a){this.handleDisplayOptionFormEvent(a)}.bind(this))},j.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.registerDisplayOptionListeners(),this.getModal().on("submit",i.ADD_QUESTIONS_FORM,function(b){var c=a(b.currentTarget);a("<input />").attr("type","hidden").attr("name","addonpage").attr("value",this.getAddOnPageId()).appendTo(c)}.bind(this)),this.getModal().on("click",i.ANCHOR,function(b){var c=a(b.currentTarget);return c.closest(i.ADD_TO_QUIZ_CONTAINER).length?void this.handleAddToQuizEvent(b,c):c.closest(i.PREVIEW_CONTAINER).length?void this.handlePreviewContainerEvent(b,c):void(c.closest(i.SEARCH_OPTIONS).length||(b.preventDefault(),this.reloadBodyContent(c.prop("search"))))}.bind(this)),this.getRoot().on(e.bodyRendered,function(){b.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()})})},h||(f.register(j.TYPE,j,"core/modal"),h=!0),j});
define('mod_survey/validation', ["jquery","core/str","core/modal_factory","core/notification"],function(a,b,c,d){return{ensureRadiosChosen:function(e){var f=b.get_strings([{key:"error",component:"moodle"},{key:"questionsnotanswered",component:"survey"}]).then(function(a){return c.create({type:c.types.CANCEL,title:a[0],body:a[1]})})["catch"](d.exception),g=a("#"+e);g.submit(function(a){return 0===g.find('input:radio[data-survey-default="true"]:checked').length||(a.preventDefault(),f.then(function(a){return a.show(),!1}))})}}});
define('mod_workshop/workshopview', ["jquery"],function(a){function b(b){var c=0;b.height("auto"),b.each(function(){var b=a(this).height();b>c&&(c=b)}),b.height(c)}return{init:function(){var c=a(".path-mod-workshop .userplan dt"),d=a(".path-mod-workshop .userplan dd");b(c),b(d),a(window).on("resize",function(){b(c),b(d)})}}});
define ("mod_zoom/form",["jquery"],function(a){return{init:function init(){var b=a("input[name=\"option_jbh\"][type!=\"hidden\"]"),c=a("input[name=\"option_waiting_room\"][type!=\"hidden\"]");b.change(function(){if(!0==b.is(":checked")){c.prop("checked",!1)}});c.change(function(){if(!0==c.is(":checked")){b.prop("checked",!1)}})}}});
//# sourceMappingURL=form.min.js.map

define ("mod_zoom/toggle_text",["exports","core/str"],function(a,b){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;function c(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function d(a){return function(){var b=this,d=arguments;return new Promise(function(e,f){var i=a.apply(b,d);function g(a){c(i,e,f,g,h,"next",a)}function h(a){c(i,e,f,g,h,"throw",a)}g(void 0)})}}a.init=function init(){var a=document.querySelector("#show-more-button"),c=document.querySelector("#show-more-body");a.addEventListener("click",d(regeneratorRuntime.mark(function d(){return regeneratorRuntime.wrap(function(d){while(1){switch(d.prev=d.next){case 0:if(!(""==c.style.display)){d.next=7;break}c.style.display="none";d.next=4;return(0,b.get_string)("meeting_invite_show","mod_zoom");case 4:a.innerHTML=d.sent;d.next=11;break;case 7:c.style.display="";d.next=10;return(0,b.get_string)("meeting_invite_hide","mod_zoom");case 10:a.innerHTML=d.sent;case 11:case"end":return d.stop();}}},d)})))}});
//# sourceMappingURL=toggle_text.min.js.map

define('enrol_manual/quickenrolment', ["core/templates","jquery","core/str","core/config","core/notification","core/modal_factory","core/modal_events","core/fragment","core/pending"],function(a,b,c,d,e,f,g,h,i){var j={COHORTSELECT:"#id_cohortlist",TRIGGERBUTTONS:".enrolusersbutton.enrol_manual_plugin [type='submit']",UNWANTEDHIDDENFIELDS:":input[value='_qf__force_multiselect_submission']"},k=function(a){this.contextid=a.contextid,this.initModal()};return k.prototype.courseid=0,k.prototype.modal=null,k.prototype.initModal=function(){var a=b(j.TRIGGERBUTTONS);b.when(c.get_strings([{key:"enroluserscohorts",component:"enrol_manual"},{key:"enrolusers",component:"enrol_manual"}]),f.create({type:f.types.SAVE_CANCEL,large:!0},a)).then(function(a,c){this.modal=c,c.setTitle(a[1]),c.setSaveButtonText(a[1]),c.getRoot().on(g.save,this.submitForm.bind(this)),c.getRoot().on("submit","form",this.submitFormAjax.bind(this)),c.getRoot().on(g.hidden,function(){c.setBody("")}),c.getRoot().on(g.shown,function(){var d=new i("enrol_manual/quickenrolment:initModal:shown"),f=this.getBody();f.then(function(d){var e=b(d).find(j.COHORTSELECT).length?0:1;c.setSaveButtonText(a[e])}).then(d.resolve)["catch"](e.exception),c.setBody(f)}.bind(this))}.bind(this)).fail(e.exception)},k.prototype.submitForm=function(a){a.preventDefault(),this.modal.getRoot().find("form").submit()},k.prototype.submitFormAjax=function(a){a.preventDefault();var c=this.modal.getRoot().find("form"),f=c.find(j.UNWANTEDHIDDENFIELDS);f.each(function(){b(this).remove()});var g=c.serialize();this.modal.hide();var h={type:"GET",processData:!1,contentType:"application/json"},i=d.wwwroot+"/enrol/manual/ajax.php?"+g;b.ajax(i,h).then(function(a){a.error?e.addNotification({message:a.error,type:"error"}):("undefined"!=typeof window.M.core_formchangechecker&&window.M.core_formchangechecker.reset_form_dirty_state(),window.location.reload())}).fail(e.exception)},k.prototype.getBody=function(){return h.loadFragment("enrol_manual","enrol_users_form",this.contextid,{}).fail(e.exception)},k.prototype.getFooter=function(){return a.render("enrol_manual/enrol_modal_footer",{})},{init:function(a){new k(a)}}});
define('enrol_manual/form-potential-user-selector', ["jquery","core/ajax","core/templates","core/str"],function(a,b,c,d){var e=100;return{processResults:function(b,c){var d=[];return a.isArray(c)?(a.each(c,function(a,b){d.push({value:b.id,label:b._label})}),d):c},transport:function(f,g,h,i){var j,k=a(f).attr("courseid"),l=a(f).attr("userfields").split(",");"undefined"==typeof k&&(k="1");var m=a(f).attr("enrolid");"undefined"==typeof m&&(m=""),j=b.call([{methodname:"core_enrol_get_potential_users",args:{courseid:k,enrolid:m,search:g,searchanywhere:!0,page:0,perpage:e+1}}]),j[0].then(function(b){var f=[],g=0;return b.length<=e?(a.each(b,function(b,d){var e=d,g=[];a.each(l,function(a,b){"undefined"!=typeof d[b]&&""!==d[b]&&(e.hasidentity=!0,g.push(d[b]))}),e.identity=g.join(", "),f.push(c.render("enrol_manual/form-user-selector-suggestion",e))}),a.when.apply(a.when,f).then(function(){var c=arguments;a.each(b,function(a,b){b._label=c[g],g++}),h(b)})):d.get_string("toomanyuserstoshow","core",">"+e).then(function(a){h(a)})}).fail(i)}}});
define('message_popup/notification_area_content_area', ["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f){var g={CONTAINER:'[data-region="notification-area"]',CONTENT:'[data-region="content"]',HEADER:'[data-region="header"]',FOOTER:'[data-region="footer"]',TOGGLE_MODE:'[data-action="toggle-mode"]'},h={HEADER:"message_popup/notification_area_content_area_header",CONTENT:"message_popup/notification_area_content_area_content",FOOTER:"message_popup/notification_area_content_area_footer"},i=function(b,c){this.root=a(b),this.container=this.root.closest(g.CONTAINER),this.userId=c,this.header=this.root.find(g.HEADER),this.content=this.root.find(g.CONTENT),this.footer=this.root.find(g.FOOTER),this.registerEventListeners()};return i.prototype.getRoot=function(){return this.root},i.prototype.getContainer=function(){return this.container},i.prototype.getUserId=function(){return this.userId},i.prototype.getHeader=function(){return this.header},i.prototype.getContent=function(){return this.content},i.prototype.getFooter=function(){return this.footer},i.prototype.show=function(){this.getContainer().addClass("show-content-area")},i.prototype.hide=function(){this.getContainer().removeClass("show-content-area")},i.prototype.setHeaderHTML=function(a){this.getHeader().empty().html(a)},i.prototype.setContentHTML=function(a){this.getContent().empty().html(a)},i.prototype.setFooterHTML=function(a){this.getFooter().empty().html(a)},i.prototype.showNotification=function(c){var d=b.render(h.HEADER,c).done(function(a){this.setHeaderHTML(a)}.bind(this)),e=b.render(h.CONTENT,c).done(function(a){this.setContentHTML(a)}.bind(this)),g=b.render(h.FOOTER,c).done(function(a){this.setFooterHTML(a)}.bind(this));return a.when(d,e,g).done(function(){this.show(),this.getContainer().trigger(f.notificationShown,[c])}.bind(this))},i.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate]),this.getRoot().on(d.events.activate,g.VIEW_TOGGLE,function(){this.hide()}.bind(this)),this.getContainer().on(f.showNotification,function(a,b){this.showNotification(b)}.bind(this))},i});
define('message_popup/notification_repository', ["core/ajax","core/notification"],function(a,b){var c=function(c){"undefined"==typeof c.limit&&(c.limit=20),"undefined"==typeof c.offset&&(c.offset=0);var d={methodname:"message_popup_get_popup_notifications",args:c},e=a.call([d])[0];return e.fail(b.exception),e},d=function(c){var d={methodname:"message_popup_get_unread_popup_notification_count",args:c},e=a.call([d])[0];return e.fail(b.exception),e},e=function(c){var d={methodname:"core_message_mark_all_notifications_as_read",args:c},e=a.call([d])[0];return e.fail(b.exception),e},f=function(c,d){var e={notificationid:c};d&&(e.timeread=d);var f={methodname:"core_message_mark_notification_read",args:e},g=a.call([f])[0];return g.fail(b.exception),g};return{query:c,countUnread:d,markAllAsRead:e,markAsRead:f}});
define('message_popup/message_popover_controller', ["jquery","core/ajax","core/templates","core/str","core/notification","core/custom_interaction_events","core/popover_region_controller","core_message/message_repository","core/url"],function(a,b,c,d,e,f,g,h,i){var j={MARK_ALL_READ_BUTTON:'[data-action="mark-all-read"]',CONTENT:'[data-region="messages"]',CONTENT_ITEM_CONTAINER:'[data-region="message-content-item-container"]',EMPTY_MESSAGE:'[data-region="empty-message"]',COUNT_CONTAINER:'[data-region="count-container"]'},k=function(a){g.call(this,a),this.markAllReadButton=this.root.find(j.MARK_ALL_READ_BUTTON),this.content=this.root.find(j.CONTENT),this.userId=this.root.attr("data-userid"),this.limit=20,this.offset=0,this.loadedAll=!1,this.initialLoad=!1,this.unreadCount=this.root.find(j.COUNT_CONTAINER).html()};return k.prototype=Object.create(g.prototype),k.prototype.constructor=k,k.prototype.getContent=function(){return this.content},k.prototype.incrementOffset=function(){this.offset+=this.limit},k.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?d.get_string("hidemessagewindow","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):this.unreadCount?d.get_string("showmessagewindowwithcount","message",this.unreadCount).done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):d.get_string("showmessagewindownonew","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},k.prototype.renderUnreadCount=function(){var a=this.root.find(j.COUNT_CONTAINER);this.unreadCount?(a.text(this.unreadCount),a.removeClass("hidden")):a.addClass("hidden")},k.prototype.hideUnreadCount=function(){this.root.find(j.COUNT_CONTAINER).addClass("hidden")},k.prototype.renderMessages=function(b,d){var e=[];return a.each(b,function(a,b){b.contexturl=i.relativeUrl("/message/index.php",{user:this.userId,id:b.userid}),b.profileurl=i.relativeUrl("/user/profile.php",{id:b.userid});var d=c.render("message_popup/message_content_item",b).then(function(a,b){return{html:a,js:b}});e.push(d)}.bind(this)),a.when.apply(a,e).then(function(){a.each(arguments,function(a,b){d.append(b.html),c.runTemplateJS(b.js)})})},k.prototype.loadMoreMessages=function(){if(this.isLoading||this.loadedAll)return a.Deferred().resolve();this.startLoading();var b={userid:this.userId,limit:this.limit,offset:this.offset},c=this.getContent();return h.query(b).then(function(a){var b=a.contacts;return this.loadedAll=!b.length||b.length<this.limit,this.initialLoad=!0,this.updateButtonAriaLabel(),!!b.length&&(this.incrementOffset(),this.renderMessages(b,c))}.bind(this)).always(function(){this.stopLoading()}.bind(this))},k.prototype.markAllAsRead=function(){return this.markAllReadButton.hasClass("loading")?a.Deferred().resolve():(this.markAllReadButton.addClass("loading"),h.markAllAsRead({useridto:this.userId}).then(function(){this.unreadCount=0,this.hideUnreadCount(),this.getContent().find(j.CONTENT_ITEM_CONTAINER).removeClass("unread")}.bind(this)).always(function(){this.markAllReadButton.removeClass("loading")}.bind(this)))},k.prototype.registerEventListeners=function(){f.define(this.root,[f.events.keyboardActivate]),this.root.on(this.events().menuOpened,function(){this.hideUnreadCount(),this.updateButtonAriaLabel(),this.initialLoad||this.loadMoreMessages()}.bind(this)),this.root.on(this.events().menuClosed,function(){this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this)),this.root.on(f.events.scrollBottom,function(){this.loadMoreMessages()}.bind(this)),this.root.on(f.events.activate,j.MARK_ALL_READ_BUTTON,function(a,b){this.markAllAsRead(),a.stopPropagation(),b.originalEvent.preventDefault()}.bind(this)),f.define(this.getContentContainer(),[f.events.scrollLock]),a(document).on("messagearea:conversationselected",function(){this.unreadCount--,this.renderUnreadCount()}.bind(this))},k});
define('message_popup/notification_popover_controller', ["jquery","core/ajax","core/templates","core/str","core/url","core/notification","core/custom_interaction_events","core/popover_region_controller","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f,g,h,i,j){var k={MARK_ALL_READ_BUTTON:'[data-action="mark-all-read"]',ALL_NOTIFICATIONS_CONTAINER:'[data-region="all-notifications"]',NOTIFICATION:'[data-region="notification-content-item-container"]',UNREAD_NOTIFICATION:'[data-region="notification-content-item-container"].unread',NOTIFICATION_LINK:'[data-action="content-item-link"]',EMPTY_MESSAGE:'[data-region="empty-message"]',COUNT_CONTAINER:'[data-region="count-container"]'},l=function(a){h.call(this,a),this.markAllReadButton=this.root.find(k.MARK_ALL_READ_BUTTON),this.unreadCount=0,this.userId=this.root.attr("data-userid"),this.container=this.root.find(k.ALL_NOTIFICATIONS_CONTAINER),this.limit=20,this.offset=0,this.loadedAll=!1,this.initialLoad=!1,this.unreadCount=this.root.find(k.COUNT_CONTAINER).html()};return l.prototype=Object.create(h.prototype),l.prototype.constructor=l,l.prototype.updateButtonAriaLabel=function(){this.isMenuOpen()?d.get_string("hidenotificationwindow","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):this.unreadCount?d.get_string("shownotificationwindowwithcount","message",this.unreadCount).done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this)):d.get_string("shownotificationwindownonew","message").done(function(a){this.menuToggle.attr("aria-label",a)}.bind(this))},l.prototype.getContent=function(){return this.container},l.prototype.getOffset=function(){return this.offset},l.prototype.incrementOffset=function(){this.offset+=this.limit},l.prototype.hasDoneInitialLoad=function(){return this.initialLoad},l.prototype.hasLoadedAllContent=function(){return this.loadedAll},l.prototype.setLoadedAllContent=function(a){this.loadedAll=a},l.prototype.renderUnreadCount=function(){var a=this.root.find(k.COUNT_CONTAINER);this.unreadCount?(a.text(this.unreadCount),a.removeClass("hidden")):a.addClass("hidden")},l.prototype.hideUnreadCount=function(){this.root.find(k.COUNT_CONTAINER).addClass("hidden")},l.prototype.getNotificationElement=function(a){var b=this.root.find(k.NOTIFICATION+'[data-id="'+a+'"]');return 1==b.length?b:null},l.prototype.renderNotifications=function(b,d){var f=[];return a.each(b,function(a,b){var d=this.getOffset()-this.limit;b.viewmoreurl=e.relativeUrl("/message/output/popup/notifications.php",{notificationid:b.id,offset:d});var g={notificationid:b.id};b.contexturl&&(g.redirecturl=encodeURIComponent(b.contexturl)),b.contexturl=e.relativeUrl("message/output/popup/mark_notification_read.php",g);var h=c.render("message_popup/notification_content_item",b).then(function(a,b){return{html:a,js:b}});f.push(h)}.bind(this)),a.when.apply(a,f).then(function(){a.each(arguments,function(a,b){d.append(b.html),c.runTemplateJS(b.js)})})},l.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent())return a.Deferred().resolve();this.startLoading();var b={limit:this.limit,offset:this.getOffset(),useridto:this.userId},c=this.getContent();return i.query(b).then(function(a){var b=a.notifications;return this.unreadCount=a.unreadcount,this.setLoadedAllContent(!b.length||b.length<this.limit),this.initialLoad=!0,this.updateButtonAriaLabel(),!!b.length&&(this.incrementOffset(),this.renderNotifications(b,c))}.bind(this)).always(function(){this.stopLoading()}.bind(this))},l.prototype.markAllAsRead=function(){return this.markAllReadButton.addClass("loading"),i.markAllAsRead({useridto:this.userId}).then(function(){this.unreadCount=0,this.root.find(k.UNREAD_NOTIFICATION).removeClass("unread")}.bind(this)).always(function(){this.markAllReadButton.removeClass("loading")}.bind(this))},l.prototype.registerEventListeners=function(){g.define(this.root,[g.events.activate]),this.root.on(g.events.activate,k.MARK_ALL_READ_BUTTON,function(a,b){this.markAllAsRead(),a.stopPropagation(),b.originalEvent.preventDefault()}.bind(this)),this.root.on(g.events.activate,k.NOTIFICATION_LINK,function(b){var c=a(b.target).closest(k.NOTIFICATION);c.hasClass("unread")&&(this.unreadCount--,c.removeClass("unread")),b.stopPropagation()}.bind(this)),this.root.on(this.events().menuOpened,function(){this.hideUnreadCount(),this.updateButtonAriaLabel(),this.hasDoneInitialLoad()||this.loadMoreNotifications()}.bind(this)),this.root.on(this.events().menuClosed,function(){this.renderUnreadCount(),this.updateButtonAriaLabel()}.bind(this)),this.root.on(this.events().startLoading,function(){this.getContent().attr("aria-busy","true")}.bind(this)),this.root.on(this.events().stopLoading,function(){this.getContent().attr("aria-busy","false")}.bind(this)),this.getContentContainer().on(g.events.scrollBottom,function(){this.isLoading||this.hasLoadedAllContent()||this.loadMoreNotifications()}.bind(this)),g.define(this.getContentContainer(),[g.events.scrollLock]),a(document).on(j.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);c&&c.removeClass("unread"),this.unreadCount--,this.renderUnreadCount()}}.bind(this))},l});
define('message_popup/notification_area_control_area', ["jquery","core/templates","core/notification","core/custom_interaction_events","message_popup/notification_repository","message_popup/notification_area_events"],function(a,b,c,d,e,f){var g={CONTAINER:'[data-region="notification-area"]',CONTENT:'[data-region="content"]',NOTIFICATION:'[data-region="notification-content-item-container"]',CAN_RECEIVE_FOCUS:'input:not([type="hidden"]), a[href], button, textarea, select, [tabindex]'},h={NOTIFICATION:"message_popup/notification_content_item"},i=function(b,c){this.root=a(b),this.container=this.root.closest(g.CONTAINER),this.userId=c,this.content=this.root.find(g.CONTENT),this.offset=0,this.limit=20,this.initialLoad=!1,this.isLoading=!1,this.loadedAll=!1,this.notifications={},this.registerEventListeners()};return i.prototype.getRoot=function(){return this.root},i.prototype.getContainer=function(){return this.container},i.prototype.getUserId=function(){return this.userId},i.prototype.getContent=function(){return this.content},i.prototype.getOffset=function(){return this.offset},i.prototype.getLimit=function(){return this.limit},i.prototype.setOffset=function(a){this.offset=a},i.prototype.setLimit=function(a){this.limit=a},i.prototype.incrementOffset=function(){this.offset+=this.limit},i.prototype.startLoading=function(){this.isLoading=!0,this.getRoot().addClass("loading")},i.prototype.stopLoading=function(){this.isLoading=!1,this.getRoot().removeClass("loading")},i.prototype.hasDoneInitialLoad=function(){return this.initialLoad},i.prototype.hasLoadedAllContent=function(){return this.loadedAll},i.prototype.setLoadedAllContent=function(a){this.loadedAll=a},i.prototype.setCacheNotification=function(a){this.notifications[a.id]=a},i.prototype.getCacheNotification=function(a){return this.notifications[a]},i.prototype.getNotificationElement=function(a){var b=this.getRoot().find(g.NOTIFICATION+'[data-id="'+a+'"]');return 1==b.length?b:null},i.prototype.scrollNotificationIntoView=function(a){var b=a.position(),c=this.getRoot(),d=b.top-c.scrollTop();if(d>c.innerHeight()){var e=a.outerHeight();e=4*e;var f=b.top-e;c.scrollTop(f)}},i.prototype.showNotification=function(b){if("object"!=typeof b&&(b=this.getNotificationElement(b)),b&&b.length){this.getRoot().find(g.NOTIFICATION).removeClass("selected"),b.addClass("selected").find(g.CAN_RECEIVE_FOCUS).focus();var c=b.attr("data-id"),d=this.getCacheNotification(c);this.scrollNotificationIntoView(b),this.getContainer().trigger(f.showNotification,[a.extend({},d)])}},i.prototype.markNotificationAsRead=function(a){return e.markAsRead(a.attr("data-id")).done(function(){a.removeClass("unread")})},i.prototype.renderNotifications=function(c){var d=[],e=this.getContent();return a.each(c,function(a,c){var e=c.contexturl;delete c.contexturl;var f=b.render(h.NOTIFICATION,c).then(function(a,b){return c.contexturl=e,this.setCacheNotification(c),{html:a,js:b}}.bind(this));d.push(f)}.bind(this)),a.when.apply(a,d).then(function(){a.each(arguments,function(a,c){e.append(c.html),b.runTemplateJS(c.js)})})},i.prototype.loadMoreNotifications=function(){if(this.isLoading||this.hasLoadedAllContent())return a.Deferred().resolve();this.startLoading();var b={limit:this.getLimit(),offset:this.getOffset(),useridto:this.getUserId()};this.initialLoad||(b.limit=this.getOffset()+this.getLimit(),b.offset=0);var c=e.query(b).then(function(a){var b=a.notifications;return this.unreadCount=a.unreadcount,this.setLoadedAllContent(!b.length||b.length<this.getLimit()),this.initialLoad=!0,!!b.length&&(this.incrementOffset(),this.renderNotifications(b))}.bind(this)).always(function(){this.stopLoading()}.bind(this));return c},i.prototype.registerEventListeners=function(){d.define(this.getRoot(),[d.events.activate,d.events.scrollBottom,d.events.scrollLock,d.events.up,d.events.down]),this.getRoot().on(d.events.scrollBottom,function(){this.loadMoreNotifications()}.bind(this)),this.getRoot().on(d.events.activate,g.NOTIFICATION,function(b){var c=a(b.target).closest(g.NOTIFICATION);this.showNotification(c)}.bind(this)),this.getRoot().on(d.events.up,g.NOTIFICATION,function(b,c){var d=a(b.target).closest(g.NOTIFICATION);this.showNotification(d.prev()),c.originalEvent.preventDefault()}.bind(this)),this.getRoot().on(d.events.down,g.NOTIFICATION,function(b,c){var d=a(b.target).closest(g.NOTIFICATION);this.showNotification(d.next()),c.originalEvent.preventDefault()}.bind(this)),this.getContainer().on(f.notificationShown,function(a,b){if(!b.read){var c=this.getNotificationElement(b.id);c&&this.markNotificationAsRead(c);var d=this.getCacheNotification(b.id);d&&(d.read=!0)}}.bind(this))},i});
define('message_popup/notification_area_events', [],function(){return{showNotification:"notification-area-events:showNotification",notificationShown:"notification-area-events:notificationShown"}});
define('block_myoverview/paging_bar', ["jquery","core/custom_interaction_events"],function(a,b){var c={ROOT:'[data-region="paging-bar"]',PAGE_ITEM:'[data-region="page-item"]',ACTIVE_PAGE_ITEM:'[data-region="page-item"].active'},d={PAGE_SELECTED:"block_myoverview-paging-bar-page-selected"},e=function(a,b){return a.find(c.PAGE_ITEM+'[data-page-number="'+b+'"]')},f=function(a,b){var c=b.attr("data-page-number");return"first"==c?c=1:"last"==c&&(c=a.attr("data-page-count")),c},g=function(g){g=a(g),b.define(g,[b.events.activate]),g.on(b.events.activate,c.PAGE_ITEM,function(b,h){var i=a(b.target).closest(c.PAGE_ITEM),j=g.find(c.ACTIVE_PAGE_ITEM),k=f(g,i),l=k==f(g,j);l||(g.find(c.PAGE_ITEM).removeClass("active"),e(g,k).addClass("active")),g.trigger(d.PAGE_SELECTED,[{pageNumber:k,isSamePage:l}]),h.originalEvent.preventDefault()})};return{registerEventListeners:g,events:d,rootSelector:c.ROOT}});
define('block_myoverview/tab_preferences', ["jquery","core/ajax","core/custom_interaction_events","core/notification"],function(a,b,c,d){var e=function(e){c.define(e,[c.events.activate]),e.on(c.events.activate,"[data-toggle='tab']",function(c){var e=a(c.currentTarget).data("tabname");"function"==typeof window.history.pushState&&window.history.pushState(null,null,"?myoverviewtab="+e);var f={methodname:"core_user_update_user_preferences",args:{preferences:[{type:"block_myoverview_last_tab",value:e}]}};b.call([f])[0].fail(d.exception)})};return{registerEventListeners:e}});
define('block_myoverview/calendar_events_repository', ["jquery","core/ajax","core/notification"],function(a,b,c){var d=20,e=function(a){a.hasOwnProperty("limit")||(a.limit=d),a.limitnum=a.limit,delete a.limit,a.hasOwnProperty("starttime")&&(a.timesortfrom=a.starttime,delete a.starttime),a.hasOwnProperty("endtime")&&(a.timesortto=a.endtime,delete a.endtime);var e={methodname:"core_calendar_get_action_events_by_course",args:a},f=b.call([e])[0];return f.fail(c.exception),f},f=function(a){a.hasOwnProperty("limit")||(a.limit=10),a.limitnum=a.limit,delete a.limit,a.hasOwnProperty("starttime")&&(a.timesortfrom=a.starttime,delete a.starttime),a.hasOwnProperty("endtime")&&(a.timesortto=a.endtime,delete a.endtime);var d={methodname:"core_calendar_get_action_events_by_courses",args:a},e=b.call([d])[0];return e.fail(c.exception),e},g=function(a){a.hasOwnProperty("limit")||(a.limit=d),a.limitnum=a.limit,delete a.limit,a.hasOwnProperty("starttime")&&(a.timesortfrom=a.starttime,delete a.starttime),a.hasOwnProperty("endtime")&&(a.timesortto=a.endtime,delete a.endtime),a.limittononsuspendedevents=!0;var e={methodname:"core_calendar_get_action_events_by_timesort",args:a},f=b.call([e])[0];return f.fail(c.exception),f};return{queryByTime:g,queryByCourse:e,queryByCourses:f}});
define('block_myoverview/paging_content', ["jquery","core/templates","block_myoverview/paging_bar"],function(a,b,c){var d={ROOT:'[data-region="paging-content"]',PAGE_REGION:'[data-region="paging-content-item"]'},e=function(b,c){this.root=a(b),this.pagingBar=a(c)};return e.rootSelector=d.ROOT,e.prototype.createPage=function(a){return this.loadContent(a).then(function(a,c){b.appendNodeContents(this.root,a,c)}.bind(this)).then(function(){return this.findPage(a)}.bind(this))},e.prototype.findPage=function(a){return this.root.find('[data-page="'+a+'"]')},e.prototype.showPage=function(a){var b=this.findPage(a);this.root.find(d.PAGE_REGION).addClass("hidden"),b.length?b.removeClass("hidden"):this.createPage(a).done(function(a){a.removeClass("hidden")})},e.prototype.registerEventListeners=function(){this.pagingBar.on(c.events.PAGE_SELECTED,function(a,b){b.isSamePage||this.showPage(b.pageNumber)}.bind(this))},e});
define('block_myoverview/event_list', ["jquery","core/notification","core/templates","core/custom_interaction_events","block_myoverview/calendar_events_repository"],function(a,b,c,d,e){var f=86400,g={EMPTY_MESSAGE:'[data-region="empty-message"]',ROOT:'[data-region="event-list-container"]',EVENT_LIST:'[data-region="event-list"]',EVENT_LIST_CONTENT:'[data-region="event-list-content"]',EVENT_LIST_GROUP_CONTAINER:'[data-region="event-list-group-container"]',LOADING_ICON_CONTAINER:'[data-region="loading-icon-container"]',VIEW_MORE_BUTTON:'[data-action="view-more"]'},h={EVENT_LIST_ITEMS:"block_myoverview/event-list-items",COURSE_EVENT_LIST_ITEMS:"block_myoverview/course-event-list-items"},i=function(a){a.attr("data-loaded-all",!0)},j=function(a){return!!a.attr("data-loaded-all")},k=function(a){var b=a.find(g.LOADING_ICON_CONTAINER),c=a.find(g.VIEW_MORE_BUTTON);a.addClass("loading"),b.removeClass("hidden"),c.prop("disabled",!0)},l=function(a){var b=a.find(g.LOADING_ICON_CONTAINER),c=a.find(g.VIEW_MORE_BUTTON);a.removeClass("loading"),b.addClass("hidden"),j(a)?c.addClass("hidden"):c.prop("disabled",!1)},m=function(a){return a.hasClass("loading")},n=function(a){a.attr("data-has-events",!0)},o=function(a){return!!a.attr("data-has-events")},p=function(a,b){b?n(a):o(a)||q(a)},q=function(a){a.find(g.EVENT_LIST_CONTENT).addClass("hidden"),a.find(g.EMPTY_MESSAGE).removeClass("hidden")},r=function(a,b,d){return a.removeClass("hidden"),c.render(d,{events:b}).done(function(b,d){c.appendNodeContents(a.find(g.EVENT_LIST),b,d)})},s=function(a,b){var c=b.timesort||0;return c-a},t=function(a,b,c){var d=a.attr("data-midnight"),e=+c.attr("data-start-day")*f,g=+c.attr("data-end-day")*f,h=s(d,b);return""===c.attr("data-end-day")?e<=h:e<=h&&h<g},u=function(b,c){return function(d){return t(b,d,a(c))}},v=function(b,c){var d=0,e=h.EVENT_LIST_ITEMS;return b.attr("data-course-id")&&(e=h.COURSE_EVENT_LIST_ITEMS),a.when.apply(a,a.map(b.find(g.EVENT_LIST_GROUP_CONTAINER),function(f){var g=c.filter(u(b,f));return g.length?(d+=g.length,r(a(f),g,e)):null})).then(function(){return d})},w=function(c,d){c=a(c);var g=+c.attr("data-limit"),h=+c.attr("data-course-id"),j=c.attr("data-last-id"),n=c.attr("data-midnight"),o=n-14*f;if(m(c))return a.Deferred().resolve();if(k(c),"undefined"==typeof d){var q={starttime:o,limit:g};j&&(q.aftereventid=j),h?(q.courseid=h,d=e.queryByCourse(q)):d=e.queryByTime(q)}return d.then(function(a){if(!a.events.length)return i(c),0;var b=a.events;return c.attr("data-last-id",b[b.length-1].id),b.length<g&&i(c),v(c,b).then(function(a){return a<b.length&&i(c),b.length})}).then(function(a){return p(c,a)}).fail(b.exception).always(function(){l(c)})},x=function(a){d.define(a,[d.events.activate]),a.on(d.events.activate,g.VIEW_MORE_BUTTON,function(){w(a)})};return{init:function(b){b=a(b),w(b),x(b)},registerEventListeners:x,load:w,rootSelector:g.ROOT}});
define('block_myoverview/event_list_by_course', ["jquery","block_myoverview/event_list","block_myoverview/calendar_events_repository"],function(a,b,c){var d=86400,e={EVENTS_BY_COURSE_CONTAINER:'[data-region="course-events-container"]',EVENT_LIST_CONTAINER:'[data-region="event-list-container"]'},f=function(f){var g=f.find(e.EVENTS_BY_COURSE_CONTAINER);if(g.length){var h=g.find(e.EVENT_LIST_CONTAINER).first(),i=h.attr("data-midnight"),j=i-14*d,k=h.attr("data-limit"),l=g.map(function(){return a(this).attr("data-course-id")}).get(),m=c.queryByCourses({courseids:l,starttime:j,limit:k});g.each(function(c,d){d=a(d);var e=d.attr("data-course-id"),f=d.find(b.rootSelector),g=a.Deferred();m.done(function(a){var b=[],c=a.groupedbycourse.filter(function(a){return a.courseid==e});c.length&&(b=c[0].events),g.resolve({events:b})}).fail(function(a){g.reject(a)}),b.load(f,g)})}};return{init:function(b){b=a(b),f(b)}}});
define('block_navigation/nav_loader', ["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){function e(a){return a.closest("[data-block]").attr("data-instanceid")}var f=c.wwwroot+"/lib/ajax/getnavbranch.php";return{load:function(b){b=a(b);var g=a.Deferred(),h={elementid:b.attr("data-node-id"),id:b.attr("data-node-key"),type:b.attr("data-node-type"),sesskey:c.sesskey,instance:e(b)},i={type:"POST",dataType:"json",data:h};return a.ajax(f,i).done(function(a){d.render(b,a),g.resolve()}),g}}});
define('block_navigation/navblock', ["jquery","core/tree"],function(a,b){return{init:function(a){var c=new b(".block_navigation .block_tree");c.finishExpandingGroup=function(c){b.prototype.finishExpandingGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})},c.collapseGroup=function(c){b.prototype.collapseGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})}}}});
define('block_navigation/site_admin_loader', ["jquery","core/ajax","core/config","block_navigation/ajax_response_renderer"],function(a,b,c,d){var e=71,f=c.wwwroot+"/lib/ajax/getsiteadminbranch.php";return{load:function(b){b=a(b);var g=a.Deferred(),h={type:e,sesskey:c.sesskey},i={type:"POST",dataType:"json",data:h};return a.ajax(f,i).done(function(a){d.render(b,a),g.resolve()}),g}}});
define('block_navigation/ajax_response_renderer', ["jquery","core/templates","core/notification","core/url"],function(a,b,c,d){function e(g,h){var i=a("<ul></ul>");i.attr("role","group"),i.attr("aria-hidden",!0),a.each(h,function(g,h){if("object"==typeof h){var j=a("<li></li>"),k=a("<p></p>"),l=h.id||h.key+"_tree_item",m=null,n=!(!h.expandable&&!h.haschildren);k.addClass("tree_item"),k.attr("id",l),k.attr("role","treeitem"),k.attr("tabindex","-1"),h.requiresajaxloading&&(k.attr("data-requires-ajax",!0),k.attr("data-node-id",h.id),k.attr("data-node-key",h.key),k.attr("data-node-type",h.type)),n&&(j.addClass("collapsed contains_branch"),k.attr("aria-expanded",!1),k.addClass("branch"));var o=null;if(h.link){var p=a('<a title="'+h.title+'" href="'+h.link+'"></a>');o=p,p.append('<span class="item-content-wrap">'+h.name+"</span>"),h.hidden&&p.addClass("dimmed"),k.append(p)}else{var q=a("<span></span>");o=q,q.append('<span class="item-content-wrap">'+h.name+"</span>"),h.hidden&&q.addClass("dimmed"),k.append(q)}!h.icon||n&&h.type!==f.ACTIVITY&&h.type!==f.RESOURCE||(j.addClass("item_with_icon"),k.addClass("hasicon"),h.type===f.ACTIVITY||h.type===f.RESOURCE?(m=a("<img/>"),m.attr("alt",h.icon.alt),m.attr("title",h.icon.title),m.attr("src",d.imageUrl(h.icon.pix,h.icon.component)),a.each(h.icon.classes,function(a,b){m.addClass(b)}),o.prepend(m)):("moodle"==h.icon.component&&(h.icon.component="core"),b.renderPix(h.icon.pix,h.icon.component,h.icon.title).then(function(a){o.prepend(a)})["catch"](c.exception))),j.append(k),i.append(j),h.children&&h.children.length?e(k,h.children):n&&!h.requiresajaxloading&&(j.removeClass("contains_branch"),k.addClass("emptybranch"))}}),g.parent().append(i);var j=g.attr("id")+"_group";i.attr("id",j),g.attr("aria-owns",j),g.attr("role","treeitem")}var f={ACTIVITY:40,RESOURCE:50};return{render:function(a,b){if(b.children&&b.children.length){e(a,b.children);var c=a.children("[role='treeitem']").first(),d=a.find("#"+c.attr("aria-owns"));c.attr("aria-expanded",!0),d.attr("aria-hidden",!1)}else a.parent().hasClass("contains_branch")&&(a.parent().removeClass("contains_branch"),a.addClass("emptybranch"))}}});
define('block_settings/settingsblock', ["jquery","core/tree"],function(a,b){return{init:function(a,c){var d=new b(".block_settings .block_tree");if(c){var e=d.treeRoot.find("#"+c),f=e.children("a").first();f.replaceWith('<span tabindex="0">'+f.html()+"</span>")}d.finishExpandingGroup=function(c){b.prototype.finishExpandingGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})},d.collapseGroup=function(c){b.prototype.collapseGroup.call(this,c),Y.use("moodle-core-event",function(){Y.Global.fire(M.core.globalEvents.BLOCK_CONTENT_UPDATED,{instanceid:a})})}}}});
define ("block_stash/trade-dialogue",["core/templates","block_stash/dialogue-base"],function(a,b){function c(){b.prototype.constructor.apply(this,[])}c.prototype=Object.create(b.prototype);c.prototype.constructor=c;c.prototype._render=function(){return a.render("block_stash/trade_success")};return c});
//# sourceMappingURL=trade-dialogue.min.js.map

define ("block_stash/stash-area",["jquery","core/templates","block_stash/counselor","block_stash/item-dialogue","block_stash/drop","block_stash/trade"],function(a,b,c,d,e,f){function g(b){this._node=a(b);this._setUp()}g.prototype._node=null;g.prototype._userItemTemplate="block_stash/user_item";g.prototype._setUp=function(){c.on(e.prototype.EVENT_PICKEDUP,this._dropPickedUpListener.bind(this));c.on(f.prototype.EVENT_TRADE,this._dropPickedUpListener.bind(this));this._setUpUserItemAreClickable()};g.prototype.addUserItem=function(c){return this._renderUserItem(c).then(function(d,e){var f=a(d),g=this._node.find(".item-list");f.data("useritem",c);this._makeUserItemNodeClickable(f);g.append(" ");g.append(f);b.runTemplateJS(e)}.bind(this))};g.prototype.containsItem=function(a){return 0<this.getUserItemNode(a).length};g.prototype._dropPickedUpListener=function(a,b){var c=b.useritem;if(this.containsItem(c.getItem().get("id"))){this.updateUserItemQuantity(c)}else{this.addUserItem(c).then(function(){this._node.find(".empty-content").remove()}.bind(this))}};g.prototype.getUserItemNode=function(a){return this._node.find(".block-stash-item[data-id="+a+"]")};g.prototype._makeUserItemNodeClickable=function(a){a.attr("tabindex",0);a.attr("role","button");a.attr("aria-haspopup","true")};g.prototype._renderUserItem=function(a){return b.render(this._userItemTemplate,{item:a.getItem().getData(),useritem:a.getData()})};g.prototype._setUpUserItemAreClickable=function(){this._node.find(".item-list .block-stash-item").each(function(b,c){this._makeUserItemNodeClickable(a(c))}.bind(this));var b=function(b){var c=a(b.currentTarget),e=c.data("id");if(!e){return}var f=new d(e);b.preventDefault();f.show(b)},c=".block-stash-item[aria-haspopup=\"true\"]";this._node.find(".item-list").delegate(c,"click",b);this._node.find(".item-list").delegate(c,"keydown",function(a){if(13!=a.keyCode&&32!=a.keyCode){return}b(a)})};g.prototype.updateUserItemQuantity=function(a){var b=this.getUserItemNode(a.getItem().get("id")),c=b.find(".item-quantity"),d=a.get("quantity"),e=parseInt(c.text(),10);c.text(d);b.removeClass("item-quantity-"+e);b.addClass("item-quantity-"+d)};return g});
//# sourceMappingURL=stash-area.min.js.map

define ("block_stash/drop-snippet-maker",["jquery"],function(a){function b(a){this._drop=a}b.prototype.IMAGE="image";b.prototype.IMAGEANDBUTTON="imageandbutton";b.prototype.TEXT="text";b.prototype._actionText=null;b.prototype._displayType=b.prototype.IMAGEANDBUTTON;b.prototype._label=null;b.prototype._getActionText=function(){if(null===this._actionText||""===this._actionText.trim()){return this.getDefaultActionText()}return this._actionText};b.prototype._getAnchor=function(){return a("<a href=\"#\"></a>")};b.prototype.getDefaultActionText=function(){return"Pick up!"};b.prototype.getDefaultLabel=function(){return"Pick up '"+this.getItem().get("name")+"'"};b.prototype._getDisplayButton=function(){var b=a("<div class=\"item-action\"></div>"),c=a("<button class=\"btn btn-secondary\"></button>");c.text(this._getActionText());b.append(c);return b};b.prototype._getDisplayImage=function(){var b=a("<div class=\"item-image\"></div>"),c=a("<div class=\"item-label\"></div>");b.addClass("item-image");b.css("backgroundImage","url("+this.getItem().get("imageurl")+")");c.text(this.getItem().get("name"));c.attr("title",this.getItem().get("name"));b.append(c);return b};b.prototype.getDrop=function(){return this._drop};b.prototype.getDisplay=function(){return this._getDisplayType(this._displayType)};b.prototype._getDisplayType=function(b){var c,d;if(b==this.IMAGE){c=a("<div class=\"block-stash-item\"></div>");d=this._getAnchor();d.append(this._getDisplayImage());c.append(d)}else if(b==this.IMAGEANDBUTTON){c=a("<div class=\"block-stash-item\"></div>");c.append(this._getDisplayImage());c.append(this._getDisplayButton())}else{c=a("<span></span>");d=this._getAnchor();d.text(this._getLabel());c.append(d)}return c};b.prototype.getItem=function(){return this._drop.getItem()};b.prototype._getLabel=function(){if(null===this._label||""===this._label.trim()){return this.getDefaultLabel()}return this._label};b.prototype.getSnippet=function(){var b=a("<div>"),c=this.uuid(),d=a("<span id=\""+c+"\">"),e=a("<script type=\"text/javascript\">"),f=this.getDrop().get("id"),g=this.getDrop().get("hashcode"),h=this.getDisplay(),i="";i="require([\"jquery\", \"block_stash/drop\"], function($, D) { var d = new D({id: "+f+", hashcode: \""+g+"\"}), n = $(\"#"+c+"\"); if (!n.length) return; n.removeClass(); d.isVisible().then(function() { n.show(); }); n.find(\"a, button\").click(function(e) { e.preventDefault(); d.pickup(); n.remove(); });})";i=this._wrapForOnReady(i);b.append(d);d.css("display","none");d.append(h);d.append(e);e.html(i);return b.html()};b.prototype.setDisplayType=function(a){this._displayType=a};b.prototype.setActionText=function(a){this._actionText=a};b.prototype.setLabel=function(a){this._label=a};b.prototype.uuid=function(){return Math.random().toString(36).substring(2,7)+new Date().getTime().toString(36)};b.prototype._wrapForOnReady=function(a){return"document.addEventListener(\"DOMContentLoaded\", function(e) {"+a+"});"};return b});
//# sourceMappingURL=drop-snippet-maker.min.js.map

define ("block_stash/drop-snippet-dialogue",["core/templates","block_stash/dialogue-base"],function(a,b){function c(a,c,d){this._drop=a;this._warnings=c;this._altSnippetMaker=d;this.setTitle(a.get("name"));b.prototype.constructor.apply(this,[])}c.prototype=Object.create(b.prototype);c.prototype.constructor=c;c.prototype._drop=null;c.prototype._altSnippetMaker=null;c.prototype._warnings=null;c.prototype._render=function(){var b={drop:this._drop.getData(),dropjson:JSON.stringify(this._drop.getData()),item:this._drop.getItem().getData(),itemjson:JSON.stringify(this._drop.getItem().getData()),altsnippetmaker:this._altSnippetMaker,warnings:this._warnings,haswarnings:this._warnings&&this._warnings.length};return a.render("block_stash/drop_snippet_dialogue",b).then(function(b,c){this._setDialogueContent(b);this.center();a.runTemplateJS(c)}.bind(this))};return c});
//# sourceMappingURL=drop-snippet-dialogue.min.js.map

define ("block_stash/trade",["jquery","core/ajax","core/log","block_stash/base","block_stash/counselor","block_stash/trade-dialogue","block_stash/item","block_stash/user-item"],function(a,b,c,d,e,f,g,h){function i(a){d.prototype.constructor.apply(this,[a])}i.prototype=Object.create(d.prototype);i.prototype.EVENT_TRADE="trade:pickedup";i.prototype.do=function(){return b.call([{methodname:"block_stash_complete_trade",args:{tradeid:this.get("id"),hashcode:this.get("hashcode")}}])[0].fail(function(){c.debug("The trade could not be completed.")}).then(function(a){if(a){for(var b in a.gaineditems){var c=new h(a.gaineditems[b].useritem,new g(a.gaineditems[b].item));e.trigger(this.EVENT_TRADE,{id:this.get("id"),hashcode:this.get("hashcode"),useritem:c})}for(var b in a.removeditems){var c=new h(a.removeditems[b].useritem,new g(a.removeditems[b].item));e.trigger(this.EVENT_TRADE,{id:this.get("id"),hashcode:this.get("hashcode"),useritem:c})}}}.bind(this))};return i});
//# sourceMappingURL=trade.min.js.map

define ("block_stash/trade-snippet-dialogue",["core/templates","block_stash/dialogue-base","core/ajax"],function(a,b,c){function d(a,c,d){window.console.log("other");this._trade=a;this._warnings=c;this._altSnippetMaker=d;this.setTitle(a.get("name"));b.prototype.constructor.apply(this,[])}d.prototype=Object.create(b.prototype);d.prototype.constructor=d;d.prototype._trade=null;d.prototype._warnings=null;d.prototype._render=function(){var b={trade:this._trade.getData(),tradejson:JSON.stringify(this._trade.getData()),warnings:this._warnings,haswarnings:this._warnings&&this._warnings.length,altsnippetmaker:this._altSnippetMaker};return c.call([{methodname:"block_stash_get_trade_items",args:{tradeid:this._trade.get("id")}}])[0].then(function(c){b.tradeitems=c;a.render("block_stash/trade_snippet_dialogue",b).then(function(b,c){this._setDialogueContent(b);this.center();a.runTemplateJS(c)}.bind(this))}.bind(this))};return d});
//# sourceMappingURL=trade-snippet-dialogue.min.js.map

define ("block_stash/drop",["jquery","core/ajax","core/log","block_stash/base","block_stash/counselor","block_stash/item","block_stash/user-item"],function(a,b,c,d,e,f,g){function h(a,b){d.prototype.constructor.apply(this,[a]);this._item=b}h.prototype=Object.create(d.prototype);h.prototype.EVENT_PICKEDUP="drop:pickedup";h.prototype.getItem=function(){return this._item};h.prototype.isVisible=function(){return b.call([{methodname:"block_stash_is_drop_visible",args:{dropid:this.get("id"),hashcode:this.get("hashcode")}}])[0].then(function(b){if(!b){return a.Deferred().reject()}return!0})};h.prototype.pickup=function(){return b.call([{methodname:"block_stash_pickup_drop",args:{dropid:this.get("id"),hashcode:this.get("hashcode")}}])[0].fail(function(){c.debug("The item could not be picked up.")}).then(function(a){var b=new g(a.useritem,new f(a.item));e.trigger(this.EVENT_PICKEDUP,{id:this.get("id"),hashcode:this.get("hashcode"),useritem:b})}.bind(this))};return h});
//# sourceMappingURL=drop.min.js.map

define ("block_stash/trade-item-dialogue",["core/templates","block_stash/dialogue-base","core/ajax"],function(a,b,c){function d(a,c,d){this.setTitle(d);this._courseid=a;this._type=c;b.prototype.constructor.apply(this,[])}d.prototype=Object.create(b.prototype);d.prototype.constructor=d;d.prototype._courseid=null;d.prototype._type=null;d.prototype._render=function(){return c.call([{methodname:"block_stash_get_items",args:{courseid:this._courseid}}])[0].then(function(b){var c=b;c.type=this._type;a.render("block_stash/trade_item_picker",c).then(function(b,c){a.runTemplateJS(c);this._setDialogueContent(b);this.center()}.bind(this))}.bind(this))};return d});
//# sourceMappingURL=trade-item-dialogue.min.js.map

define ("block_stash/item-selector-dialogue",["jquery","block_stash/dialogue-base","core/templates","core/ajax","core/str"],function(a,b,c,d,e){function f(a,c,d,e){this._userid=a;this._courseid=c;this._sesskey=d;this._warnings=e;b.prototype.constructor.apply(this,[])}f.prototype=Object.create(b.prototype);f.prototype.constructor=f;f.prototype._userid=null;f.prototype._courseid=null;f.prototype._sesskey=null;f.prototype._warnings=null;f.prototype._render=function(){var b=this,f=d.call([{methodname:"block_stash_get_items",args:{courseid:this._courseid}}]),g=e.get_string("additem","block_stash");return a.when(f[0],g).then(function(a,d){var e={userid:b._userid,courseid:b._courseid,items:a.items,sesskey:b._sesskey,warnings:b._warnings};c.render("block_stash/item_select_dialogue",e).then(function(a,e){b.setTitle(d);b._setDialogueContent(a);b.center();c.runTemplateJS(e)})})};return f});
//# sourceMappingURL=item-selector-dialogue.min.js.map

define ("block_stash/drop-snippet-ui",["jquery"],function(a){function b(b,c){this._container=a(c);this._maker=b;this._init()}b.prototype._container=null;b.prototype._appearanceNode=null;b.prototype._labelNode=null;b.prototype._actionTextNode=null;b.prototype._previewNode=null;b.prototype._actionTextNode=null;b.prototype._snippetNode=null;b.prototype._actionTextZoneNode=null;b.prototype._labelZoneNode=null;b.prototype._init=function(){this._appearanceNode=this.find("[name=displaytype]");this._labelNode=this.find("[name=label]");this._actionTextNode=this.find("[name=actiontext]");this._snippetNode=this.find("[name=\"snippet\"]");this._previewNode=this.find(".preview");this._labelZoneNode=this.find(".snippet-label");this._actionTextZoneNode=this.find(".snippet-actiontext");this._labelNode.attr("placeholder",this._maker.getDefaultLabel());this._actionTextNode.attr("placeholder",this._maker.getDefaultActionText());this._maker.setLabel(this._labelNode.val());this._maker.setDisplayType(this._appearanceNode.val());this._maker.setActionText(this._actionTextNode.val());this._updateForm();this._setListeners();this.update()};b.prototype.find=function(a){return this._container.find(a)};b.prototype._setListeners=function(){this._appearanceNode.change(function(b){this._maker.setDisplayType(a(b.currentTarget).val());this._updateForm();this.update()}.bind(this));this._labelNode.on("keyup",function(b){this._maker.setLabel(a(b.currentTarget).val());this._updateForm();this.update()}.bind(this));this._actionTextNode.on("keyup",function(b){this._maker.setActionText(a(b.currentTarget).val());this._updateForm();this.update()}.bind(this))};b.prototype.update=function(){var a=this._maker.getDisplay();a.find("a, input").click(function(a){a.preventDefault()});this._snippetNode.val(this._maker.getSnippet());this._previewNode.html(a)};b.prototype._updateForm=function(){var a=this._appearanceNode.val();if(a==this._maker.IMAGEANDBUTTON){this._labelZoneNode.hide();this._actionTextZoneNode.show()}else if(a==this._maker.TEXT){this._labelZoneNode.show();this._actionTextZoneNode.hide()}else{this._labelZoneNode.hide();this._actionTextZoneNode.hide()}};return b});
//# sourceMappingURL=drop-snippet-ui.min.js.map

define ("block_stash/user-item",["block_stash/base"],function(a){function b(b,c){a.prototype.constructor.apply(this,[b]);this._item=c}b.prototype=Object.create(a.prototype);b.prototype.getItem=function(){return this._item};return b});
//# sourceMappingURL=user-item.min.js.map

define ("block_stash/item",["core/ajax","block_stash/base"],function(a,b){function c(a){b.prototype.constructor.apply(this,[a])}c.prototype=Object.create(b.prototype);c.getItem=function(b){return a.call([{methodname:"block_stash_get_item",args:{itemid:b}}])[0].then(function(a){return new c(a)})};return c});
//# sourceMappingURL=item.min.js.map

define ("block_stash/dialogue-base",["jquery","core/yui","core/str"],function(a,b,c){function d(){var c=a.Deferred();this._ready=c.promise();b.use("moodle-core-notification",function(){this._init().then(function(){c.resolve()})}.bind(this))}d.prototype._dialogue=null;d.prototype._ready=null;d.prototype._title="&hellip;";d.prototype.center=function(){this._dialogue.centerDialogue()};d.prototype._init=function(){var e=a.Deferred(),f=b.Node.create("<p style=\"text-align: center;\"><img src=\""+M.util.image_url("y/loading")+"\" alt=\"\"></p>"),g;g=new M.core.dialogue({draggable:!0,modal:!0,width:"600px"});this._dialogue=g;var h=g.hide;g.hide=function(){h.apply(g,arguments);this.destroy()}.bind(g);g.getStdModNode(b.WidgetStdMod.HEADER).prepend(b.Node.create("<h1>"));this._updateDialogueTitle();this._setDialogueContent(f);e.resolve();this._render().fail(function(){c.get_string("error","core").then(function(b){return b}).fail(function(){return""}).always(function(a){this._setDialogueContent(a)}.bind(this))}.bind(this));return e.promise()};d.prototype.close=function(){this._dialogue.destroy()};d.prototype.find=function(a){return this._container.find(a)};d.prototype._render=function(){};d.prototype.show=function(a){this._ready.then(function(){this._dialogue.show(a)}.bind(this))};d.prototype._setDialogueContent=function(a){this._dialogue.setStdModContent(b.WidgetStdMod.BODY,a,b.WidgetStdMod.REPLACE)};d.prototype.setTitle=function(a){this._title=a;this._updateDialogueTitle()};d.prototype._updateDialogueTitle=function(){if(!this._dialogue){return}this._dialogue.getStdModNode(b.WidgetStdMod.HEADER).one("h1").setHTML(this._title)};return d});
//# sourceMappingURL=dialogue-base.min.js.map

define ("block_stash/trade-snippet-shortcode-maker",["jquery","block_stash/trade-snippet-maker"],function(a,b){function c(){b.prototype.constructor.apply(this,arguments)}c.prototype=Object.create(b.prototype);c.prototype.getSnippet=function(){var a=this.getTrade(),b=a.get("hashcode").substring(0,6);return"[stashtrade secret=\""+b+"\"]"};return c});
//# sourceMappingURL=trade-snippet-shortcode-maker.min.js.map

define ("block_stash/trade-snippet-maker",[],function(){function a(a){this._trade=a}a.prototype.getTrade=function(){return this._trade};a.prototype.getSnippet=function(){var a="[trade:",b="",c=this.getTrade(),d=3;a+=c.get("id")+":";b+="]";d=Math.max(3,32-(a.length+b.length));return a+c.get("hashcode").substring(0,d)+b};return a});
//# sourceMappingURL=trade-snippet-maker.min.js.map

define ("block_stash/drop-snippet-shortcode-maker",["jquery","block_stash/drop-snippet-maker"],function(a,b){function c(){b.prototype.constructor.apply(this,arguments)}c.prototype=Object.create(b.prototype);c.prototype._getActionText=function(){var a=b.prototype._getActionText.apply(this,arguments);return a.replace("\"","\\\"")};c.prototype._getLabel=function(){var a=b.prototype._getLabel.apply(this,arguments);return a.replace("\"","\\\"")};c.prototype.getSnippet=function(){var a=this.getDrop(),b=a.get("hashcode").substring(0,6),c="[stashdrop secret=\""+b+"\"",d="",e=!0;if(this._displayType==this.IMAGEANDBUTTON){d=this._getActionText()}else if(this._displayType==this.TEXT){e=!1;d=this._getLabel()}if(d.length){c+=" text=\""+d+"\""}if(e){c+=" image"}return c+"]"};return c});
//# sourceMappingURL=drop-snippet-shortcode-maker.min.js.map

define ("block_stash/item-dialogue",["core/templates","block_stash/dialogue-base","block_stash/item"],function(a,b,c){function d(a){this._itemId=a;b.prototype.constructor.apply(this,[])}d.prototype=Object.create(b.prototype);d.prototype.constructor=d;d.prototype._itemId=null;d.prototype._render=function(){return c.getItem(this._itemId).then(function(b){var c=b.getData();a.render("block_stash/item_detail",c).then(function(b,d){a.runTemplateJS(d);this.setTitle(c.name);this._setDialogueContent(b);this.center()}.bind(this))}.bind(this))};return d});
//# sourceMappingURL=item-dialogue.min.js.map

define ("block_stash/trade-area",["jquery","core/templates","block_stash/counselor","block_stash/drop","core/notification","block_stash/trade"],function(a,b,c,d,e,f){function g(b){this._node=a(b);this._setUp();this._update()}g.prototype._node=null;g.prototype._setUp=function(){c.on(d.prototype.EVENT_PICKEDUP,this._dropPickedUpListener.bind(this));c.on(f.prototype.EVENT_TRADE,this._dropPickedUpListener.bind(this))};g.prototype.containsItem=function(a){return 0<this.getTradeItemNode(a).length};g.prototype._dropPickedUpListener=function(a,b){var c=b.useritem;if(this.containsItem(c.getItem().get("id"))){this.updateTradeItemUserQuantity(c)}};g.prototype.canTradeItems=function(){var b=this._node.find(".removed-items"),c=!0;b.each(function(b,d){c=c&&a(d).data("hasenough")});return c};g.prototype.getTradeItemNode=function(a){return this._node.find(".removed-items[data-itemid="+a+"]")};g.prototype.updateTradeItemUserQuantity=function(c){var d=c.getItem().get("id"),f=this.getTradeItemNode(d),g=parseInt(c.get("quantity"),10),h=parseInt(f.attr("data-quantity"),10),i=f.parent().attr("data-tradeid"),j=c.getItem().get("name");b.render("block_stash/tradeitem_detail",{enoughitems:g>=h,itemid:d,quantity:h,name:j,userquantity:g}).done(function(c,e){b.replaceNodeContents(a(".block-stash-trade-item-"+d+"[data-tradeid=\""+i+"\"]"),c,e);this._update()}.bind(this)).fail(e.exception)};g.prototype._update=function(){var a=this._node.find(".accept-trade button").first();if(!a){return}if(!this.canTradeItems()){a.prop("disabled",!0)}else{a.prop("disabled",!1)}};return g});
//# sourceMappingURL=trade-area.min.js.map

define ("block_stash/base",[],function(){function a(a){this._data=a||{}}a.prototype._data=null;a.prototype.get=function(a){return this._data[a]};a.prototype.getData=function(){return this._data};return a});
//# sourceMappingURL=base.min.js.map

define ("block_stash/counselor",["jquery"],function(a){function b(){this._node=a("<div>")}b.prototype._node=null;b.prototype.ITEM_SAVE="item-save";b.prototype.on=function(a,b){this._node.on(a,b)};b.prototype.trigger=function(a,b){this._node.trigger(a,[b])};return new b});
//# sourceMappingURL=counselor.min.js.map

define('block_xp/cm-selector', ["jquery","core/ajax","block_xp/course-resource-selector","block_xp/cm-resource-selector"],function(a,b,c,d){function e(b,e){function g(){l.val(""),m.val(""),n.clear(),i.find(".cm-search").hide(),i.find(".course-search .course-not-selected").show(),i.find(".course-search .course-selected").hide(),j=null,l.focus()}function h(a){j=a,f=a,i.find(".course-search .course-selected span").text(a.fullname),i.find(".course-search .course-selected").show(),i.find(".course-search .course-not-selected").hide(),i.find(".cm-search").show(),n.clear(),o.initForCourse(a.id),m.val(""),m.focus()}e=e||f;var i=a(b),j=null,k=i.find(".search-result-contents"),l=i.find(".search-term-course"),m=i.find(".search-term-cm"),n=new c(k,l);n.onResourceSelected(function(a,b){b._iscourse&&h(b.course)});var o=new d(k,m);o.onResourceSelected(function(a,b){b._iscm&&i.trigger("cm-selected",{cm:b.cm,course:j})}),i.find(".course-selection-change").on("click",function(){g()}),e?h(e):g()}var f=null;return{init:e}});
define('block_xp/cm-rule', ["jquery","core/templates","core/str","block_xp/dialogue-base"],function(a,b,c,d){function e(a){this.initWithCourse=a||null,d.prototype.constructor.apply(this,[])}function f(b){a(g).on("click",i,function(c){c.preventDefault();var d=a(c.target).closest(h);if(d){var f=new e(b);f.on("cm-selected",function(a,b){var c=b.cm,e=b.course;d.find(".cm-rule-contextid").val(c.contextid),d.find(".cm-selected").text(M.util.get_string("rulecmdescwithcourse","block_xp",{contextname:c.name,coursename:e.shortname})),d.addClass("has-cm")}),f.show()}})}var g=".block-xp-filters",h=".block_xp-cm-rule-widget",i=".block_xp-cm-rule-widget button",j=".block_xp-cm-selector-widget";return e.prototype=Object.create(d.prototype),e.prototype.constructor=e,e.prototype._render=function(){var a=JSON.stringify(this.initWithCourse);return c.get_string("cmselector","block_xp").then(function(c){return b.render("block_xp/cm-selector",{initwithcoursejson:a}).then(function(a,d){this.setTitle(c),this._setDialogueContent(a),b.runTemplateJS(d),this.center(),this.find(j).on("cm-selected",function(a,b){this.trigger("cm-selected",b),this.close()}.bind(this))}.bind(this))}.bind(this))},{init:f}});
define('block_xp/course-resource-selector', ["jquery","core/ajax","block_xp/resource-selector"],function(a,b,c){function d(a,b){c.prototype.constructor.apply(this,[a,this.searchFunction.bind(this),b])}return d.prototype=Object.create(c.prototype),d.prototype.constructor=d,d.prototype.searchFunction=function(a){var c=[{methodname:"block_xp_search_courses",args:{query:a}}];return b.call(c)[0].then(function(a){return a.map(function(a){return{_iscourse:!0,name:a.fullname,subname:a.shortname,course:a}})})},d});
define ("block_xp/cm-resource-selector",["jquery","core/ajax","block_xp/throttler","block_xp/resource-selector"],function(a,b,c,d){function e(a,b){d.prototype.constructor.apply(this,[a,this.filterFunction.bind(this),b]);this.resources=[];this.courseId=null;this.throttler=new c(100);this.setMinChars(0)}e.prototype=Object.create(d.prototype);e.prototype.constructor=e;e.prototype.initForCourse=function(a){if(this.courseId==a){this.displayResults(this.resources);return}this.displaySearching();this.courseId=a;this.fetchAllForCourse(a).then(function(b){if(this.courseId!=a){return}this.resources=b;this.displayResults(this.resources)}.bind(this)).fail(function(){this.resources=[];this.displayEmptyResults()}.bind(this))};e.prototype.fetchAllForCourse=function(a){return b.call([{methodname:"block_xp_search_modules",args:{courseid:a,query:"*"}}])[0].then(function(a){return a.reduce(function(a,b){return a.concat(b.modules.map(function(a){return{_iscm:!0,subname:b.name,name:a.name,cm:a}}))},[])})};e.prototype.filterFunction=function(a){a=(a||"").toLowerCase();if(!a){return this.resources}return this.resources.filter(function(b){return-1<b.name.toLowerCase().indexOf(a)})};return e});
//# sourceMappingURL=cm-resource-selector.min.js.map

define('block_xp/resource-selector', ["jquery","core/ajax","block_xp/throttler"],function(a,b,c){function d(b,d,e){this._eventNode=a("<div>"),this.container=a(b),this.searchId=0,this.searchTermNode=e,this.resultsContainer=b.find("tbody"),this.emptyResultsNode=b.find(".results-empty"),this.searchingResultsNode=b.find(".searching-results"),this.searchResultsNode=b.find(".search-results"),this.resourceTemplateNode=b.find(".resource-template"),this.resourceTemplateNode.hide(),this.resourceTemplate=this.resourceTemplateNode.clone(),this.resourceTemplate.removeClass("resource-template"),this.resourceTemplate.show(),this.throttler=new c(300),this.searchFunction=d,this._setEventListeners(),this.minChars=3}return d.prototype.clear=function(){this.resultsContainer.empty()},d.prototype.displayEmptyResults=function(){this.searchingResultsNode.hide(),this.emptyResultsNode.show(),this.searchResultsNode.hide()},d.prototype.displayNothing=function(){this.searchingResultsNode.hide(),this.emptyResultsNode.hide(),this.searchResultsNode.hide()},d.prototype.displayResults=function(a){return a&&a.length?(this._publishResults(a),this.searchingResultsNode.hide(),this.emptyResultsNode.hide(),void this.searchResultsNode.show()):void this.displayEmptyResults()},d.prototype.displaySearching=function(){this.searchingResultsNode.show(),this.emptyResultsNode.hide(),this.searchResultsNode.hide()},d.prototype.getResources=function(b){return a.when(this.searchFunction(b))},d.prototype.onResourceSelected=function(a){this._eventNode.on("resource-selected",a)},d.prototype.search=function(a){this.searchId+=1,this._performSearch(a,this.searchId)},d.prototype.setMinChars=function(a){this.minChars=a},d.prototype._onSearchTermKeyUp=function(a){var b=a.target.value;return"string"!=typeof b||b.length<this.minChars?(this.searchingResultsNode.hide(),void this.throttler.cancel()):(this.displaySearching(),this.searchId+=1,void this.throttler.schedule(this._performSearchFactory(b,this.searchId)))},d.prototype._onSelect=function(b){b.preventDefault();var c=a(b.target).closest(".resource-node").data("resource");c&&this._eventNode.trigger("resource-selected",c)},d.prototype._performSearchFactory=function(a,b){return function(){this._performSearch(a,b)}.bind(this)},d.prototype._performSearch=function(a,b){return this.getResources(a).then(function(a){this.searchId==b&&this.displayResults(a)}.bind(this)).fail(function(){this.displayEmptyResults()}.bind(this))},d.prototype._publishResults=function(a){this.clear(),a.forEach(function(a){var b=this.resourceTemplate.clone();b.find(".resource-name").text(a.name),a.subname?b.find(".resource-subname").text(a.subname):b.find(".resource-subname").hide(),b.data("resource",a),this.resultsContainer.append(b)}.bind(this))},d.prototype._setEventListeners=function(){this.searchTermNode.on("keyup",this._onSearchTermKeyUp.bind(this)),this.searchResultsNode.on("click","button",this._onSelect.bind(this))},d});
define('block_xp/dialogue-base', ["jquery","core/yui","core/str"],function(a,b,c){function d(){this._eventNode=a("<div>");var c=a.Deferred();this._ready=c.promise(),b.use("moodle-core-notification",function(){this._init().then(function(){c.resolve()})}.bind(this))}return d.prototype._dialogue=null,d.prototype._eventNode=null,d.prototype._ready=null,d.prototype._title="&hellip;",d.prototype.center=function(){this._dialogue.centerDialogue()},d.prototype._init=function(){var d,e=a.Deferred(),f=b.Node.create('<p style="text-align: center;"><img src="'+M.util.image_url("y/loading")+'" alt=""></p>');d=new M.core.dialogue({draggable:!0,modal:!0,width:"600px"}),this._dialogue=d;var g=d.hide;return d.hide=function(){g.apply(d,arguments),this.destroy()}.bind(d),d.getStdModNode(b.WidgetStdMod.HEADER).prepend(b.Node.create("<h1>")),this._updateDialogueTitle(),this._setDialogueContent(f),e.resolve(),this._render().fail(function(){c.get_string("error","core").then(function(a){return a}).fail(function(){return""}).always(function(a){this._setDialogueContent(a)}.bind(this))}.bind(this)),e.promise()},d.prototype.close=function(){this.trigger("dialogue-closed"),this._dialogue.destroy(),this._eventNode=null},d.prototype.find=function(c){return a(this._dialogue.getStdModNode(b.WidgetStdMod.BODY).getDOMNode()).find(c)},d.prototype.on=function(a,b){this._eventNode.on(a,b)},d.prototype._render=function(){},d.prototype.show=function(a){this._ready.then(function(){this._dialogue.show(a)}.bind(this))},d.prototype._setDialogueContent=function(a){this._dialogue.setStdModContent(b.WidgetStdMod.BODY,a,b.WidgetStdMod.REPLACE)},d.prototype.setTitle=function(a){this._title=a,this._updateDialogueTitle()},d.prototype.trigger=function(a,b){this._eventNode.trigger(a,b)},d.prototype._updateDialogueTitle=function(){this._dialogue&&this._dialogue.getStdModNode(b.WidgetStdMod.HEADER).one("h1").setHTML(this._title)},d});
define('block_xp/throttler', [],function(){function a(a){this.delay=a||300,this.timeout=null,this.time=new Date}return a.prototype.cancel=function(){clearTimeout(this.timeout)},a.prototype.schedule=function(a){var b=new Date;this.time.getTime()+this.delay>b&&clearTimeout(this.timeout),this.time=b,this.timeout=setTimeout(a,this.delay)},a});
define('media_videojs/loader', ["jquery","core/event"],function(a,b){var c,d=function(d){c=d,e(null,a("body")),b.getLegacyEvents().done(function(b){a(document).on(b.FILTER_CONTENT_UPDATED,e)})},e=function(b,d){var e=".mediaplugin_videojs";d.find(e).addBack(e).find("audio, video").each(function(){var b=a(this).attr("id"),d=a(this).data("setup-lazy"),e=["media_videojs/video-lazy"];d.techOrder&&d.techOrder.indexOf("youtube")!==-1&&e.push("media_videojs/Youtube-lazy"),d.techOrder&&d.techOrder.indexOf("flash")!==-1&&e.push("media_videojs/videojs-flash-lazy"),require(e,function(a){c&&(c(a),c=null),a(b,d)})})};return{setUp:d}});
define('filter_oembed/oembed', ["jquery","filter_oembed/preloader","filter_oembed/responsivecontent"],function(a,b,c){return{init:function(){var d=function(){var b=function(b){return!!b.className&&a(b).is(".oembed-content, .oembed-card-container")},d=new MutationObserver(function(d){d.forEach(function(d){for(var e in d.addedNodes){var f=d.addedNodes[e];b(f)&&c.apply(a(f).find("> *:not(video):first-child, .oembed-card"))}})}),e={attributes:!0,childList:!0,characterData:!0,subtree:!0},f=document.body;d.observe(f,e)};d(),a(document).ready(function(){b.apply(),c.apply()})}}});
define('filter_oembed/responsivecontent', ["jquery"],function(a){var b=function(){this.apply=function(b){if(!b){var c=".oembed-content:not(.oembed-responsive) > *:not(video):first-child,";c+=" .oembed-card:not(.oembed-processed)",b=a(c)}a(b).each(function(){var b=a(this).parent();if(!b.hasClass("oembed-responsive")){var c,d,e;e=this.getAttribute("data-aspect-ratio"),null!==e&&"0"!==e||(c=this.width||this.offsetWidth,d=this.height||this.offsetHeight,(c.indexOf("%")>-1&&d.indexOf("%")==-1||c.indexOf("%")==-1&&d.indexOf("%")>-1)&&(a(this).parent().attr("data-card-width")&&a(this).parent().attr("data-card-height")?(c=a(this).parent().attr("data-card-width"),d=a(this).parent().attr("data-card-height")):(c=this.offsetWidth,d=this.offsetHeight)),c=parseInt(c),d=parseInt(d),e=d/c,this.setAttribute("data-aspect-ratio",e));var f=this.tagName.toLowerCase();"iframe"===f&&(a(this).removeAttr("width"),a(this).removeAttr("height")),c=parseInt(this.offsetWidth);var g={width:"100%"};if(a(this).css(g),!b.find(".oembed-responsive-pad").length){var h=100*e,i='<div class="oembed-responsive-pad" style="padding-top:'+h+'%"></div>';b.append(i)}b.addClass("oembed-responsive")}})}};return new b});
define('filter_oembed/manageproviders', ["jquery","core/notification","core/ajax","core/templates","core/fragment","core/str","filter_oembed/list"],function(a,b,c,d,e,f,g){return{prevEditId:null,reloadRow:function(e,f,g,h){g=g?g:"reload",c.call([{methodname:"filter_oembed_provider_manage",args:{pid:e,action:g},done:function(b){d.render("filter_oembed/managementpagerow",b.providermodel).done(function(b){a(f).replaceWith(b),f=a("#oembed-display-providers_"+e),"function"==typeof h&&h(f)})},fail:function(a){b.exception(a)}}],!0,!0)},reloadProviders:function(e){c.call([{methodname:"filter_oembed_providers",args:{scope:"all"},done:function(b){d.render("filter_oembed/managementpage",b).done(function(b){var c=a(a.parseHTML(b)).html();a("#providermanagement").html(c),"function"==typeof e&&e()})},fail:function(a){b.exception(a)}}],!0,!0)},listenEnableDisable:function(){var b=this;a("#providermanagement").on("click",".oembed-provider-actions .filter-oembed-visibility",function(c){c.preventDefault();var d=a(this).parents("tr")[0],e=a(d).data("pid"),f=!a(d).hasClass("dimmed_text"),g=f?"disable":"enable";b.reloadRow(e,d,g)})},listenDelete:function(){var d=function(d){var e=a(d).data("pid");c.call([{methodname:"filter_oembed_provider_manage",args:{pid:e,action:"delete"},done:function(){a(d).remove()},fail:function(a){b.exception(a)}}],!0,!0)};a("#providermanagement").on("click",".oembed-provider-actions .filter-oembed-delete",function(c){c.preventDefault();var e=a(this).parents("tr")[0],g=a(a(this).parents("td").find(".list-providername")[0]).text();f.get_strings([{key:"deleteprovidertitle",component:"filter_oembed"},{key:"deleteproviderconfirm",component:"filter_oembed",param:g},{key:"ok",component:"core"},{key:"cancel",component:"core"}]).done(function(a){var c=a[0],f=a[1],g=a[2],h=a[3];b.confirm(c,f,g,h,function(){d(e)})})})},listenEdit:function(){var b=this,c=function(b){var c="#oembed-display-providers_"+b;a(c).removeClass("oembed-provider-editing"),a(c+" form").remove(),a(c+" td div.alert").remove()},f=function(b,c,f){var g,h=new RegExp("(?:course-)(\\S)"),i=h.exec(a("body").attr("class")),j=parseInt(i[1]);g=c?{formdata:c,pid:b}:{pid:b},e.loadFragment("filter_oembed","provider",j,g).done(function(c,e){a("#oembed-display-providers_"+b).addClass("oembed-provider-editing"),d.replaceNodeContents(a("#oembed-display-providers_"+b+" .oembed-provider-details"),c,e),"function"==typeof f&&f()})};a("#providermanagement").on("click",".oembed-provider-actions .filter-oembed-edit",function(d){d.preventDefault();var e=a(this).parents("tr")[0],g=a(e).data("pid");null!==b.prevEditId&&(c(b.prevEditId),c(g)),b.prevEditId=g,f(g)}),a("#providermanagement").on("click",".oembed-provider-details form #id_submitbutton",function(d){d.preventDefault();var e=a(this).parents("tr")[0],g=a(e).data("pid"),h=a(this).parents("form")[0],i=a(h).find('input[name="source"]').val();a(h).trigger("save-form-state");var j=a(h).serialize();f(g,j,function(){var d="#oembed-display-providers_"+g+" .oembed-provider-details",f=d+" div.alert-success",h=a(f);if(h.length){var j=h[0].outerHTML;if(c(g),i.indexOf("download::")>-1){var k=d+" .js-oembed-newprovider",l=a(k);l.length&&(g=l.data("newproviderid"))}var m=function(){var b=a("#oembed-display-providers_"+g+" td");a(b).append(j),a(b).find(" div.alert-success").attr("tabindex",-1),a(b).find(" div.alert-success").focus()};i.indexOf("download::")>-1?b.reloadProviders(m):b.reloadRow(g,e,"reload",m)}})}),a("#providermanagement").on("click",".oembed-provider-details form #id_cancel",function(b){b.preventDefault();var d=a(this).parents("tr")[0];c(a(d).data("pid"))})},init:function(){var a={valueNames:["list-providername"]};new g("providermanagement",a),this.listenEnableDisable(),this.listenDelete(),this.listenEdit()}}});
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(c,d){"use strict";var e=c.document,f=a("./src/utils/get-by-class"),g=a("./src/utils/extend"),h=a("./src/utils/index-of"),i=a("./src/utils/events"),j=a("./src/utils/to-string"),k=a("./src/utils/natural-sort"),l=a("./src/utils/classes"),m=a("./src/utils/get-attribute"),n=a("./src/utils/to-array"),o=function(b,c,p){var q,r=this,s=a("./src/item")(r),t=a("./src/add-async")(r);q={start:function(){r.listClass="list",r.searchClass="search",r.sortClass="sort",r.page=1e4,r.i=1,r.items=[],r.visibleItems=[],r.matchingItems=[],r.searched=!1,r.filtered=!1,r.searchColumns=d,r.handlers={updated:[]},r.plugins={},r.valueNames=[],r.utils={getByClass:f,extend:g,indexOf:h,events:i,toString:j,naturalSort:k,classes:l,getAttribute:m,toArray:n},r.utils.extend(r,c),r.listContainer="string"==typeof b?e.getElementById(b):b,r.listContainer&&(r.list=f(r.listContainer,r.listClass,!0),r.parse=a("./src/parse")(r),r.templater=a("./src/templater")(r),r.search=a("./src/search")(r),r.filter=a("./src/filter")(r),r.sort=a("./src/sort")(r),this.handlers(),this.items(),r.update(),this.plugins())},handlers:function(){for(var a in r.handlers)r[a]&&r.on(a,r[a])},items:function(){r.parse(r.list),p!==d&&r.add(p)},plugins:function(){for(var a=0;a<r.plugins.length;a++){var b=r.plugins[a];r[b.name]=b,b.init(r,o)}}},this.reIndex=function(){r.items=[],r.visibleItems=[],r.matchingItems=[],r.searched=!1,r.filtered=!1,r.parse(r.list)},this.toJSON=function(){for(var a=[],b=0,c=r.items.length;b<c;b++)a.push(r.items[b].values());return a},this.add=function(a,b){if(0!==a.length){if(b)return void t(a,b);var c=[],e=!1;a[0]===d&&(a=[a]);for(var f=0,g=a.length;f<g;f++){var h=null;e=r.items.length>r.page,h=new s(a[f],d,e),r.items.push(h),c.push(h)}return r.update(),c}},this.show=function(a,b){return this.i=a,this.page=b,r.update(),r},this.remove=function(a,b,c){for(var d=0,e=0,f=r.items.length;e<f;e++)r.items[e].values()[a]==b&&(r.templater.remove(r.items[e],c),r.items.splice(e,1),f--,e--,d++);return r.update(),d},this.get=function(a,b){for(var c=[],d=0,e=r.items.length;d<e;d++){var f=r.items[d];f.values()[a]==b&&c.push(f)}return c},this.size=function(){return r.items.length},this.clear=function(){return r.templater.clear(),r.items=[],r},this.on=function(a,b){return r.handlers[a].push(b),r},this.off=function(a,b){var c=r.handlers[a],d=h(c,b);return d>-1&&c.splice(d,1),r},this.trigger=function(a){for(var b=r.handlers[a].length;b--;)r.handlers[a][b](r);return r},this.reset={filter:function(){for(var a=r.items,b=a.length;b--;)a[b].filtered=!1;return r},search:function(){for(var a=r.items,b=a.length;b--;)a[b].found=!1;return r}},this.update=function(){var a=r.items,b=a.length;r.visibleItems=[],r.matchingItems=[],r.templater.clear();for(var c=0;c<b;c++)a[c].matching()&&r.matchingItems.length+1>=r.i&&r.visibleItems.length<r.page?(a[c].show(),r.visibleItems.push(a[c]),r.matchingItems.push(a[c])):a[c].matching()?(r.matchingItems.push(a[c]),a[c].hide()):a[c].hide();return r.trigger("updated"),r},q.start()};"function"==typeof define&&define.amd&&define('filter_oembed/list', function(){return o}),b.exports=o,c.List=o}(window)},{"./src/add-async":2,"./src/filter":3,"./src/item":4,"./src/parse":5,"./src/search":6,"./src/sort":7,"./src/templater":8,"./src/utils/classes":9,"./src/utils/events":10,"./src/utils/extend":11,"./src/utils/get-attribute":12,"./src/utils/get-by-class":13,"./src/utils/index-of":14,"./src/utils/natural-sort":15,"./src/utils/to-array":16,"./src/utils/to-string":17}],2:[function(a,b,c){b.exports=function(a){var b=function(c,d,e){var f=c.splice(0,50);e=e||[],e=e.concat(a.add(f)),c.length>0?setTimeout(function(){b(c,d,e)},1):(a.update(),d(e))};return b}},{}],3:[function(a,b,c){b.exports=function(a){return a.handlers.filterStart=a.handlers.filterStart||[],a.handlers.filterComplete=a.handlers.filterComplete||[],function(b){if(a.trigger("filterStart"),a.i=1,a.reset.filter(),void 0===b)a.filtered=!1;else{a.filtered=!0;for(var c=a.items,d=0,e=c.length;d<e;d++){var f=c[d];b(f)?f.filtered=!0:f.filtered=!1}}return a.update(),a.trigger("filterComplete"),a.visibleItems}}},{}],4:[function(a,b,c){b.exports=function(a){return function(b,c,d){var e=this;this._values={},this.found=!1,this.filtered=!1;var f=function(b,c,d){if(void 0===c)d?e.values(b,d):e.values(b);else{e.elm=c;var f=a.templater.get(e,b);e.values(f)}};this.values=function(b,c){if(void 0===b)return e._values;for(var d in b)e._values[d]=b[d];c!==!0&&a.templater.set(e,e.values())},this.show=function(){a.templater.show(e)},this.hide=function(){a.templater.hide(e)},this.matching=function(){return a.filtered&&a.searched&&e.found&&e.filtered||a.filtered&&!a.searched&&e.filtered||!a.filtered&&a.searched&&e.found||!a.filtered&&!a.searched},this.visible=function(){return!(!e.elm||e.elm.parentNode!=a.list)},f(b,c,d)}}},{}],5:[function(a,b,c){b.exports=function(b){var c=a("./item")(b),d=function(a){for(var b=a.childNodes,c=[],d=0,e=b.length;d<e;d++)void 0===b[d].data&&c.push(b[d]);return c},e=function(a,d){for(var e=0,f=a.length;e<f;e++)b.items.push(new c(d,a[e]))},f=function(a,c){var d=a.splice(0,50);e(d,c),a.length>0?setTimeout(function(){f(a,c)},1):(b.update(),b.trigger("parseComplete"))};return b.handlers.parseComplete=b.handlers.parseComplete||[],function(){var a=d(b.list),c=b.valueNames;b.indexAsync?f(a,c):e(a,c)}}},{"./item":4}],6:[function(a,b,c){b.exports=function(a){var b,c,d,e,f={resetList:function(){a.i=1,a.templater.clear(),e=void 0},setOptions:function(a){2==a.length&&a[1]instanceof Array?c=a[1]:2==a.length&&"function"==typeof a[1]?e=a[1]:3==a.length&&(c=a[1],e=a[2])},setColumns:function(){0!==a.items.length&&void 0===c&&(c=void 0===a.searchColumns?f.toArray(a.items[0].values()):a.searchColumns)},setSearchString:function(b){b=a.utils.toString(b).toLowerCase(),b=b.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),d=b},toArray:function(a){var b=[];for(var c in a)b.push(c);return b}},g={list:function(){for(var b=0,c=a.items.length;b<c;b++)g.item(a.items[b])},item:function(a){a.found=!1;for(var b=0,d=c.length;b<d;b++)if(g.values(a.values(),c[b]))return void(a.found=!0)},values:function(c,e){return!!(c.hasOwnProperty(e)&&(b=a.utils.toString(c[e]).toLowerCase(),""!==d&&b.search(d)>-1))},reset:function(){a.reset.search(),a.searched=!1}},h=function(b){return a.trigger("searchStart"),f.resetList(),f.setSearchString(b),f.setOptions(arguments),f.setColumns(),""===d?g.reset():(a.searched=!0,e?e(d,c):g.list()),a.update(),a.trigger("searchComplete"),a.visibleItems};return a.handlers.searchStart=a.handlers.searchStart||[],a.handlers.searchComplete=a.handlers.searchComplete||[],a.utils.events.bind(a.utils.getByClass(a.listContainer,a.searchClass),"keyup",function(b){var c=b.target||b.srcElement,d=""===c.value&&!a.searched;d||h(c.value)}),a.utils.events.bind(a.utils.getByClass(a.listContainer,a.searchClass),"input",function(a){var b=a.target||a.srcElement;""===b.value&&h("")}),h}},{}],7:[function(a,b,c){b.exports=function(a){a.sortFunction=a.sortFunction||function(b,c,d){return d.desc="desc"==d.order,a.utils.naturalSort(b.values()[d.valueName],c.values()[d.valueName],d)};var b={els:void 0,clear:function(){for(var c=0,d=b.els.length;c<d;c++)a.utils.classes(b.els[c]).remove("asc"),a.utils.classes(b.els[c]).remove("desc")},getOrder:function(b){var c=a.utils.getAttribute(b,"data-order");return"asc"==c||"desc"==c?c:a.utils.classes(b).has("desc")?"asc":a.utils.classes(b).has("asc")?"desc":"asc"},getInSensitive:function(b,c){var d=a.utils.getAttribute(b,"data-insensitive");"false"===d?c.insensitive=!1:c.insensitive=!0},setOrder:function(c){for(var d=0,e=b.els.length;d<e;d++){var f=b.els[d];if(a.utils.getAttribute(f,"data-sort")===c.valueName){var g=a.utils.getAttribute(f,"data-order");"asc"==g||"desc"==g?g==c.order&&a.utils.classes(f).add(c.order):a.utils.classes(f).add(c.order)}}}},c=function(){a.trigger("sortStart");var c={},d=arguments[0].currentTarget||arguments[0].srcElement||void 0;d?(c.valueName=a.utils.getAttribute(d,"data-sort"),b.getInSensitive(d,c),c.order=b.getOrder(d)):(c=arguments[1]||c,c.valueName=arguments[0],c.order=c.order||"asc",c.insensitive="undefined"==typeof c.insensitive||c.insensitive),b.clear(),b.setOrder(c),c.sortFunction=c.sortFunction||a.sortFunction,a.items.sort(function(a,b){var d="desc"===c.order?-1:1;return c.sortFunction(a,b,c)*d}),a.update(),a.trigger("sortComplete")};return a.handlers.sortStart=a.handlers.sortStart||[],a.handlers.sortComplete=a.handlers.sortComplete||[],b.els=a.utils.getByClass(a.listContainer,a.sortClass),a.utils.events.bind(b.els,"click",c),a.on("searchStart",b.clear),a.on("filterStart",b.clear),c}},{}],8:[function(a,b,c){var d=function(a){var b,c=this,d=function(){b=c.getItemSource(a.item),b=c.clearSourceItem(b,a.valueNames)};this.clearSourceItem=function(b,c){for(var d=0,e=c.length;d<e;d++){var f;if(c[d].data)for(var g=0,h=c[d].data.length;g<h;g++)b.setAttribute("data-"+c[d].data[g],"");else c[d].attr&&c[d].name?(f=a.utils.getByClass(b,c[d].name,!0),f&&f.setAttribute(c[d].attr,"")):(f=a.utils.getByClass(b,c[d],!0),f&&(f.innerHTML=""));f=void 0}return b},this.getItemSource=function(b){if(void 0===b){for(var c=a.list.childNodes,d=0,e=c.length;d<e;d++)if(void 0===c[d].data)return c[d].cloneNode(!0)}else{if(/^tr[\s>]/.exec(b)){var f=document.createElement("table");return f.innerHTML=b,f.firstChild}if(b.indexOf("<")!==-1){var g=document.createElement("div");return g.innerHTML=b,g.firstChild}var h=document.getElementById(a.item);if(h)return h}throw new Error("The list need to have at list one item on init otherwise you'll have to add a template.")},this.get=function(b,d){c.create(b);for(var e={},f=0,g=d.length;f<g;f++){var h;if(d[f].data)for(var i=0,j=d[f].data.length;i<j;i++)e[d[f].data[i]]=a.utils.getAttribute(b.elm,"data-"+d[f].data[i]);else d[f].attr&&d[f].name?(h=a.utils.getByClass(b.elm,d[f].name,!0),e[d[f].name]=h?a.utils.getAttribute(h,d[f].attr):""):(h=a.utils.getByClass(b.elm,d[f],!0),e[d[f]]=h?h.innerHTML:"");h=void 0}return e},this.set=function(b,d){var e=function(b){for(var c=0,d=a.valueNames.length;c<d;c++)if(a.valueNames[c].data){for(var e=a.valueNames[c].data,f=0,g=e.length;f<g;f++)if(e[f]===b)return{data:b}}else{if(a.valueNames[c].attr&&a.valueNames[c].name&&a.valueNames[c].name==b)return a.valueNames[c];if(a.valueNames[c]===b)return b}},f=function(c,d){var f,g=e(c);g&&(g.data?b.elm.setAttribute("data-"+g.data,d):g.attr&&g.name?(f=a.utils.getByClass(b.elm,g.name,!0),f&&f.setAttribute(g.attr,d)):(f=a.utils.getByClass(b.elm,g,!0),f&&(f.innerHTML=d)),f=void 0)};if(!c.create(b))for(var g in d)d.hasOwnProperty(g)&&f(g,d[g])},this.create=function(a){if(void 0!==a.elm)return!1;var d=b.cloneNode(!0);return d.removeAttribute("id"),a.elm=d,c.set(a,a.values()),!0},this.remove=function(b){b.elm.parentNode===a.list&&a.list.removeChild(b.elm)},this.show=function(b){c.create(b),a.list.appendChild(b.elm)},this.hide=function(b){void 0!==b.elm&&b.elm.parentNode===a.list&&a.list.removeChild(b.elm)},this.clear=function(){if(a.list.hasChildNodes())for(;a.list.childNodes.length>=1;)a.list.removeChild(a.list.firstChild)},d()};b.exports=function(a){return new d(a)}},{}],9:[function(a,b,c){function d(a){if(!a||!a.nodeType)throw new Error("A DOM element reference is required");this.el=a,this.list=a.classList}var e=a("./index-of"),f=/\s+/,g=Object.prototype.toString;b.exports=function(a){return new d(a)},d.prototype.add=function(a){if(this.list)return this.list.add(a),this;var b=this.array(),c=e(b,a);return~c||b.push(a),this.el.className=b.join(" "),this},d.prototype.remove=function(a){if("[object RegExp]"==g.call(a))return this.removeMatching(a);if(this.list)return this.list.remove(a),this;var b=this.array(),c=e(b,a);return~c&&b.splice(c,1),this.el.className=b.join(" "),this},d.prototype.removeMatching=function(a){for(var b=this.array(),c=0;c<b.length;c++)a.test(b[c])&&this.remove(b[c]);return this},d.prototype.toggle=function(a,b){return this.list?("undefined"!=typeof b?b!==this.list.toggle(a,b)&&this.list.toggle(a):this.list.toggle(a),this):("undefined"!=typeof b?b?this.add(a):this.remove(a):this.has(a)?this.remove(a):this.add(a),this)},d.prototype.array=function(){var a=this.el.getAttribute("class")||"",b=a.replace(/^\s+|\s+$/g,""),c=b.split(f);return""===c[0]&&c.shift(),c},d.prototype.has=d.prototype.contains=function(a){return this.list?this.list.contains(a):!!~e(this.array(),a)}},{"./index-of":14}],10:[function(a,b,c){var d=window.addEventListener?"addEventListener":"attachEvent",e=window.removeEventListener?"removeEventListener":"detachEvent",f="addEventListener"!==d?"on":"",g=a("./to-array");c.bind=function(a,b,c,e){a=g(a);for(var h=0;h<a.length;h++)a[h][d](f+b,c,e||!1)},c.unbind=function(a,b,c,d){a=g(a);for(var h=0;h<a.length;h++)a[h][e](f+b,c,d||!1)}},{"./to-array":16}],11:[function(a,b,c){b.exports=function(a){for(var b,c=Array.prototype.slice.call(arguments,1),d=0;b=c[d];d++)if(b)for(var e in b)a[e]=b[e];return a}},{}],12:[function(a,b,c){b.exports=function(a,b){var c=a.getAttribute&&a.getAttribute(b)||null;if(!c)for(var d=a.attributes,e=d.length,f=0;f<e;f++)void 0!==b[f]&&b[f].nodeName===b&&(c=b[f].nodeValue);return c}},{}],13:[function(a,b,c){b.exports=function(){return document.getElementsByClassName?function(a,b,c){return c?a.getElementsByClassName(b)[0]:a.getElementsByClassName(b)}:document.querySelector?function(a,b,c){return b="."+b,c?a.querySelector(b):a.querySelectorAll(b)}:function(a,b,c){var d=[],e="*";null===a&&(a=document);for(var f=a.getElementsByTagName(e),g=f.length,h=new RegExp("(^|\\s)"+b+"(\\s|$)"),i=0,j=0;i<g;i++)if(h.test(f[i].className)){if(c)return f[i];d[j]=f[i],j++}return d}}()},{}],14:[function(a,b,c){var d=[].indexOf;b.exports=function(a,b){if(d)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1}},{}],15:[function(a,b,c){b.exports=function(a,b,c){var d,e,f=/(^([+\-]?(?:\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[\da-fA-F]+$|\d+)/g,g=/^\s+|\s+$/g,h=/\s+/g,i=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,j=/^0x[0-9a-f]+$/i,k=/^0/,l=c||{},m=function(a){return l.insensitive&&(""+a).toLowerCase()||""+a},n=m(a)||"",o=m(b)||"",p=n.replace(f,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),q=o.replace(f,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),r=parseInt(n.match(j),16)||1!==p.length&&Date.parse(n),s=parseInt(o.match(j),16)||r&&o.match(i)&&Date.parse(o)||null,t=function(a,b){return(!a.match(k)||1==b)&&parseFloat(a)||a.replace(h," ").replace(g,"")||0};if(s){if(r<s)return-1;if(r>s)return 1}for(var u=0,v=p.length,w=q.length,x=Math.max(v,w);u<x;u++){if(d=t(p[u],v),e=t(q[u],w),isNaN(d)!==isNaN(e))return isNaN(d)?1:-1;if(typeof d!=typeof e&&(d+="",e+=""),d<e)return-1;if(d>e)return 1}return 0}},{}],16:[function(a,b,c){function d(a){return"[object Array]"===Object.prototype.toString.call(a)}b.exports=function(a){if("undefined"==typeof a)return[];if(null===a)return[null];if(a===window)return[window];if("string"==typeof a)return[a];if(d(a))return a;if("number"!=typeof a.length)return[a];if("function"==typeof a&&a instanceof Function)return[a];for(var b=[],c=0;c<a.length;c++)(Object.prototype.hasOwnProperty.call(a,c)||c in a)&&b.push(a[c]);return b.length?b:[]}},{}],17:[function(a,b,c){b.exports=function(a){return a=void 0===a?"":a,a=null===a?"":a,a=a.toString()}},{}]},{},[1]);
define('filter_oembed/preloader', ["jquery"],function(a){return{apply:function(){a(".oembed-card-play").on("click",function(){var b=a(this).parent(".oembed-card"),c=a(b.data("embed")),d=a(b).width(),e=a(b).height();if(a(c).find("iframe").length){var f=a(a(c).find("iframe")[0]),g=f.attr("src"),h=g.indexOf("?")>-1?"&":"?";g+=h+"autoplay=1",g+="&auto_play=1",f.attr("src",g)}c.attr("data-card-width",d),c.attr("data-card-height",e),b.parent(".oembed-card-container").replaceWith(c)})}}});
define ("filter_poodll/poodll_red5recorder",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/lzloader"],function(a,b,c,d,e){"use strict";b.debug("PoodLL Red5 Recorder: initialising");return{supports_current_browser:function supports_current_browser(a){var d=c.is_ios(),e=c.is_android();if(d||1>a.flashonandroid&&e){return!1}else{if("audio"!=a.mediatype&&"video"!=a.mediatype){return!1}b.debug("PoodLL Red5 Recorder: supports this browser");return!0}},embed:function embed(b,c){switch(c.mediatype){case"video":var d=a.parseJSON(c.red5video_widgetjson);break;case"audio":default:var d=a.parseJSON(c.red5audio_widgetjson);}e.embed.swf(d)}}});
//# sourceMappingURL=poodll_red5recorder.min.js.map

define ("filter_poodll/poodll_pushmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/upskin_radial","filter_poodll/upskin_bar","filter_poodll/anim_hwave_mic","filter_poodll/dlg_devicesettings"],function(a,b,c,d,e,f,g,h){"use strict";c.debug("PoodLL Push Skin: initialising");return{instanceprops:null,pmr:null,devsettings:null,therecanim:null,buttonmode:null,strings:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=h.clone();this.devsettings.init(b,a);this.strings=this.pmr.fetch_strings();this.strings.recui_pushtospeak=M.util.get_string("recui_pushtospeak","filter_poodll")},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(a){this.set_visual_mode("allfinished",a)},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" width=\"320\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+" hide\"></audio>"},fetch_preview_video:function fetch_preview_video(a){return this.fetch_preview_audio(a)},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+" hide\" ></audio>"},fetch_resource_video:function fetch_resource_video(a){return this.fetch_resource_audio(a)},onfinalspeechcapture:function onfinalspeechcapture(){this.just_stop()},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){this.fetch_instanceprops();this.set_visual_mode("startbuttonrecording",a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.preview.attr("src",null);b.uploader.Output("");this.therecanim.start();b.timer.reset();b.timer.start();this.update_status(a);this.set_visual_mode("startbuttonrecording",a)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops();b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){this.stop_and_upload(a)}},update_status:function update_status(){var a=this.fetch_instanceprops();a.controlbar.status.html(a.timer.fetch_display_time())},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(),d=f.clone();d.init(c.config,b,c.controlbar.playcanvas,c.controlbar.status);return d},set_button_style:function set_button_style(b){a.each(["testbuttonready","testbuttonrecording","startbuttonready","startbuttoncountdown","startbuttonrecording","uploading","allfinished"],function(b,c){a(".poodll_mediarecorderbox_push").removeClass("poodll_mediarecorder_push_"+c);a(".poodll_mediarecorderbox_push").removeClass("push_canclick")});a(".poodll_mediarecorderbox_push").addClass("poodll_mediarecorder_push_"+b);if("testbuttonready"==b||"startbuttonready"==b){a(".poodll_mediarecorderbox_push").addClass("push_canclick")}},set_visual_mode:function set_visual_mode(a){var b=this,c=this.fetch_instanceprops();this.buttonmode=a;c.config.hermes.postMessage({type:"recorderstatus",status:a});switch(a){case"startbuttonready":c.controlbar.thecaption.text(b.strings.recui_pushtospeak);c.controlbar.thecaption.show();c.controlbar.playcanvas.hide();c.controlbar.status.hide();c.controlbar.settingsicon.hide();b.set_button_style(a);break;case"startbuttonrecording":c.controlbar.thecaption.hide();c.controlbar.playcanvas.show();b.set_button_style(a);c.controlbar.status.hide();break;case"uploading":c.controlbar.thecaption.html("<i class=\"fa fa-spinner fa-spin fa-3x fa-fw\"></i>");c.controlbar.thecaption.show();c.controlbar.playcanvas.hide();b.set_button_style(a);c.controlbar.status.hide();break;case"allfinished":c.controlbar.thecaption.text("Finished");c.controlbar.thecaption.show();c.controlbar.playcanvas.hide();c.controlbar.status.hide();b.set_button_style(a);break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){return this.prepare_controlbar_audio(a,b,c,d)},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d){var e=this.fetch_instanceprops(),f=e.config.media_skin_style,g=this.fetch_status_bar("push"),h="<div class=\"poodll_mediarecorderholder_push "+"poodll_mediarecorder_audio"+"\" id=\"holder_"+c+"\">";h+="<div class=\"poodll_mediarecorderbox_push\" id=\""+c+"\">";h+=this.devsettings.fetch_dialogue_box();h+=e.downloaddialog.fetch_dialogue_box();h+=e.errordialog.fetch_dialogue_box();h+="<div class=\"style-holder "+f+"\">";h+=d,h+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";h+="<canvas id=\""+c+"_playcanvas\" class=\"poodll_mediarecorder_playcanvas_push\" width=\"180\" height=\"50\"></canvas>";h+="<span id=\""+c+"_caption\" class=\"poodll_mediarecorder_caption_push\"></span>";h+=g,h+="</div></div></div>";a(b).prepend(h);var i={settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),status:a("#"+c+" .poodll_status_push"),preview:a("#"+c+" .poodll_preview_push"),bigbutton:a("#"+c+".poodll_mediarecorderbox_push"),playcanvas:a("#"+c+"_playcanvas"),thecaption:a("#"+c+"_caption"),themicicon:a("#"+c+"_micicon"),stopbutton:a("#"+c+" .poodll_mediarecorder_bogusstopbutton_push"),startbutton:a("#"+c+" .poodll_mediarecorder_bogusstartbutton_push")};e.downloaddialog.set_dialogue_box(i.downloaddialog);e.errordialog.set_dialogue_box(i.errorsdialog);this.devsettings.set_dialogue_box(i.settingsdialog);return i},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(b,d){var f=this,h=this.pmr,i=this.fetch_instanceprops();i.config.recanim="hwave_mic";var e=g.clone();f.therecanim=e;e.init(i.audioanalyser,i.controlbar.playcanvas.get(0));this.set_visual_mode("startbuttonready");i.controlbar.bigbutton.click(function(g){c.debug(g.target);var e=!1;if(g.target===f||a(g.target).hasClass("style-holder")||a(g.target).hasClass("poodll_mediarecorderbox_push")||a(g.target).hasClass("poodll_mediarecorder_caption_push")||a(g.target).hasClass("poodll_mediarecorder_playcanvas_push")){e=!0}if(!e){return}switch(f.buttonmode){case"startbuttonready":var j={};j.type="recorderstatus";j.status="startbuttonrecording";i.config.hermes.postMessage(j);i.timer.disable();h.do_start_audio(i,b);f.set_visual_mode("startbuttonrecording");break;case"startbuttonrecording":f.just_stop(d);break;case"oldstartbuttonready":var k=function(){var a=new Date().getTime(),c=a-l;if(c>m){i.timer.enable();h.do_start_audio(i,b)}else{var d=!1;if(0>n&&0<c){d=m/1e3}else if(1e3>n&&1e3<c){d=m/1e3-1}else if(2e3>n&&2e3<c){d=m/1e3-2}if(d){var e={type:"countdownstatus",status:d};i.config.hermes.postMessage(e)}n=c;setTimeout(k,100)}};i.config.hermes.enable();f.set_visual_mode("startbuttoncountdown");var l=new Date().getTime(),m=3e3,n=-1;setTimeout(k,100);break;case"stopbutton":f.stop_and_upload();}});i.controlbar.settingsicon.click(function(a){c.debug("we no proapagato");a.stopPropagation();if(!f.uploaded){f.devsettings.open()}else{i.downloaddialog.open()}});window.onbeforeunload=function(){}},just_stop:function just_stop(){var a=this.pmr,b=this.fetch_instanceprops(),c=this.therecanim;if(b.mediaRecorder){a.do_stop_audio(b)}c.clear();b.config.hermes.enable();this.set_visual_mode("startbuttonready")},stop_and_upload:function stop_and_upload(a){var b=this,c=this.pmr,d=this.fetch_instanceprops(),e=b.therecanim;c.do_stop_audio(d);e.clear();d.timer.stop();b.update_status(a);var f=function(){if(d.blobs&&0<d.blobs.length){c.do_save_audio(d);d.uploaded=!0}else{setTimeout(f,200)}};setTimeout(f,200);b.set_visual_mode("uploading")},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_pushmediaskin.min.js.map

define ("filter_poodll/poodll_oncemediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/upskin_radial","filter_poodll/anim_hwave_mic","filter_poodll/dlg_devicesettings"],function(a,b,c,d,e,f,g){"use strict";c.debug("PoodLL Once Recorder Skin: initialising");return{instanceprops:null,pmr:null,devsettings:null,therecanim:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=g.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" width=\"320\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+"\" style=\"display: none;\" playsinline=\"playsinline\" muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_preview_"+a+"\" style=\"display: none;\" playsinline=\"playsinline\" muted></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" playsinline=\"playsinline\"></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" playsinline=\"playsinline\"></video>"},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops();b.uploader.Output("");b.timer.reset();b.timer.start();this.update_status(a);this.set_visual_mode("recordingmode",a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops();b.controlbar.preview.attr("src",null);b.uploader.Output("");this.therecanim.start();b.timer.reset();b.timer.start();this.update_status(a);this.set_visual_mode("recordingmode",a)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops();this.therecanim.displaytime=b.timer.fetch_display_time();this.update_status(a);if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(){var a=this.fetch_instanceprops();a.controlbar.status.html(a.timer.fetch_display_time())},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(),d=e.clone();d.init(c.config,b,c.controlbar.uploadcanvas,c.controlbar.uploadmessages);d.setDrawParam("lineWidth",2);d.setDrawParam("font","14px Arial");return d},set_visual_mode:function set_visual_mode(a){var b=this,c=this.fetch_instanceprops();switch(a){case"readymode":c.controlbar.status.show();b.enable_button(c.controlbar.startbutton);b.disable_button(c.controlbar.finishedbutton);b.disable_button(c.controlbar.stopbutton);c.controlbar.uploadcanvas.hide();b.therecanim.setDrawParam("wavColor","#CCCCCC");b.therecanim.clear();if("video"==c.config.mediatype){c.controlbar.playcanvas.hide();c.controlbar.preview.show()}else{c.controlbar.playcanvas.show();c.controlbar.preview.hide()}break;case"recordingmode":b.enable_button(c.controlbar.stopbutton);b.disable_button(c.controlbar.startbutton);if("video"==c.config.mediatype){c.controlbar.playcanvas.hide();c.controlbar.preview.show()}else{c.controlbar.playcanvas.show();c.controlbar.preview.hide()}c.controlbar.uploadcanvas.hide();b.therecanim.setDrawParam("wavColor","#FF0000");b.therecanim.clear();c.controlbar.status.show();break;case"aftermode":b.disable_button(c.controlbar.startbutton);b.disable_button(c.controlbar.stopbutton);b.therecanim.setDrawParam("wavColor","#CCCCCC");b.therecanim.clear();c.controlbar.playcanvas.hide();if("video"==c.config.mediatype){c.controlbar.preview.hide()}c.controlbar.uploadcanvas.show();c.controlbar.status.show();break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",j=this.pmr.fetch_strings(),k=j.recui_record,l=j.recui_testmic,m=j.recui_stop,n=this.fetch_status_bar("once"),o="<div class=\"poodll_mediarecorderholder_once "+i+"\" id=\"holder_"+c+"\">";o+="<div class=\"poodll_mediarecorderbox_once\" id=\""+c+"\">";o+=this.devsettings.fetch_dialogue_box();o+=g.downloaddialog.fetch_dialogue_box();o+=g.errordialog.fetch_dialogue_box();o+="<div class=\"style-holder "+h+"\">";o+=d,o+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn-poodllsettings\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";o+="<canvas id=\""+c+"_playcanvas\" width=\"250\" height=\"50\" class=\"poodll_mediarecorder_playcanvas_once\"></canvas>";o+=n,o+="<button type=\"button\" class=\"poodll_mediarecorder_button_once poodll_start-recording_once\">"+k+"</button>";o+="<button type=\"button\" class=\"poodll_mediarecorder_button_once poodll_stop-recording_once\">"+m+"</button>";if("audio"==f){o+="<canvas id=\""+c+"_uploadcanvas\" width=\"250\" height=\"50\" class=\"poodll_mediarecorder_uploadcanvas_once\"></canvas>"}else{o+="<canvas id=\""+c+"_uploadcanvas\" width=\"130\" height=\"210\" class=\"poodll_mediarecorder_uploadcanvas_once\"></canvas>"}o+="<div class=\"poodll_uploadmessages_once\"></div>";o+="</div></div></div>";a(b).prepend(o);var p={settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),status:a("#"+c+" .poodll_status_once"),preview:a("#"+c+" .poodll_preview_once"),startbutton:a("#"+c+" .poodll_start-recording_once"),stopbutton:a("#"+c+" .poodll_stop-recording_once"),playcanvas:a("#"+c+"_playcanvas"),uploadcanvas:a("#"+c+"_uploadcanvas"),uploadmessages:a("#"+c+" .poodll_uploadmessages_once")};g.downloaddialog.set_dialogue_box(p.downloaddialog);g.errordialog.set_dialogue_box(p.errorsdialog);this.devsettings.set_dialogue_box(p.settingsdialog);return p},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){var c=this,d=this.pmr,e=this.fetch_instanceprops();e.config.recanim="hwave_mic";var g=f.clone();c.therecanim=g;g.init(e.audioanalyser,e.controlbar.playcanvas.get(0));this.set_visual_mode("readymode",b);e.controlbar.settingsicon.click(function(){if(!c.uploaded){c.devsettings.open()}else{e.downloaddialog.open()}});e.controlbar.startbutton.click(function(){e.config.hermes.enable();e.timer.enable();d.do_start_audio(e,a)});e.controlbar.stopbutton.click(function(){d.do_stop_audio(e);g.clear();e.timer.stop();c.update_status(b);var a=function(){if(e.blobs&&0<e.blobs.length){d.do_save_audio(e);e.uploaded=!0;c.disable_button(e.controlbar.startbutton)}else{setTimeout(a,200)}};setTimeout(a,200);c.set_visual_mode("aftermode",b)});window.onbeforeunload=function(){}},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_oncemediaskin.min.js.map

define ("filter_poodll/poodll_warningmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd"],function(a,b,c){"use strict";c.debug("PoodLL Warning Media skin: initialising");return{instanceprops:null,pmr:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b},fetch_status_bar:function fetch_status_bar(){return""},fetch_preview_audio:function fetch_preview_audio(){return""},fetch_preview_video:function fetch_preview_video(){return""},fetch_resource_audio:function fetch_resource_audio(){return""},fetch_resource_video:function fetch_resource_video(){return""},fetch_uploader_skin:function fetch_uploader_skin(){return!1},handle_timer_update:function handle_timer_update(){},onUploadSuccess:function onUploadSuccess(){},onUploadFailure:function onUploadFailure(){},onMediaSuccess_video:function onMediaSuccess_video(){},onMediaSuccess_audio:function onMediaSuccess_audio(){},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_events(b)},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){return this.register_events(b)},fetch_instance_props:function fetch_instance_props(){return this.instanceprops},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instance_props();switch(f){case"audio":case"video":default:var h=M.util.get_string("recui_unsupportedbrowser","filter_poodll");}var i=g.config.media_skin_style,j="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",k="<div class=\"poodll_mediarecorderholder_warning "+j+"\" id=\"holder_"+c+"\">";k+="<div class=\"poodll_mediarecorderbox_warning\" id=\""+c+"\">";k+="<div class=\"style-holder "+i+"\">";k+="<div class=\"poodll_mediarecorderbox_warning_message "+i+"\">"+h+"</div>";k+="</div></div></div>";a(b).prepend(k);return{}},register_events:function register_events(){}}});
//# sourceMappingURL=poodll_warningmediaskin.min.js.map

define ("filter_poodll/msr_plain",["jquery","core/log","filter_poodll/utils_amd"],function(a,b,c){"use strict";b.debug("PoodLL Plain Recorder: initialising");return{timeout:0,mediaRecorder:null,mediaStream:null,audioctx:null,msr:null,mediaType:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c,d){this.msr=a;this.mediaStream=b;this.audioctx=c;this.mediaType=d},start:function start(a){var d=this;if("audio"===this.mediaType){if(this.mediaStream.getVideoTracks().length&&this.mediaStream.getAudioTracks().length){var e;if(!!navigator.mozGetUserMedia){e=new MediaStream;e.addTrack(this.mediaStream.getAudioTracks()[0])}else{e=new MediaStream(this.mediaStream.getAudioTracks())}this.mediaStream=e}}this.mimeType=!1;if("audio"===this.mediaType){if(!MediaRecorder.isTypeSupported){this.mimeType="audio/mp4"}else{for(var f=["ogg","webm","quicktime","mp4","m4a","wav"],g=0,h;g<f.length;g++){h="audio/"+f[g];if(MediaRecorder.isTypeSupported(h)){this.mimeType=h;break}}if(!1===this.mimeType){this.mimeType=c.is_chrome()?"audio/webm":"audio/ogg"}}}else{if(!MediaRecorder.isTypeSupported){this.mimeType="video/mp4"}else{for(var j=["webm","ogv","quicktime","mp4","mpeg"],g=0,h;g<j.length;g++){h="video/"+j[g];if(MediaRecorder.isTypeSupported(h)){this.mimeType=h;break}}if(!1===this.mimeType){this.mimeType="video/webm"}}}try{this.mediaRecorder=new MediaRecorder(this.mediaStream,{mimeType:this.mimeType})}catch(a){this.mediaRecorder=new MediaRecorder(this.mediaStream);b.debug("MediaRecorder API seems unable to record mimeType:"+this.mimeType)}b.debug("msr_plain using mime type:",this.mimeType);this.mediaRecorder.ignoreMutedMedia=this.ignoreMutedMedia||!1;this.mediaRecorder.ondataavailable=function(a){if(!a.data||!a.data.size){return}var b=new Blob([a.data],{type:d.mimeType});d.msr.ondataavailable(b)};this.mediaRecorder.onerror=function(a){if("InvalidState"===a.name){b.debug("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.")}else if("OutOfMemory"===a.name){b.debug("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.")}else if("IllegalStreamModification"===a.name){b.debug("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.")}else if("OtherRecordingError"===a.name){b.debug("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.")}else if("GenericError"===a.name){b.debug("The UA cannot provide the codec or recording option that has been requested.",a)}else{b.debug("MediaRecorder Error",a)}if(!!d.mediaRecorder&&"inactive"!==d.mediaRecorder.state&&"stopped"!==d.mediaRecorder.state){d.mediaRecorder.stop()}};var k=this.audioctx.createMediaStreamSource(this.mediaStream);k.connect(this.msr.audioanalyser.core);try{d.mediaRecorder.start(a)}catch(a){d.mediaRecorder=null}},stop:function stop(){if(!this.mediaRecorder){return}if("recording"===this.mediaRecorder.state){this.mediaRecorder.stop()}},pause:function pause(){if(!this.mediaRecorder){return}if("recording"===this.mediaRecorder.state){this.mediaRecorder.pause()}},resume:function resume(){if(!this.mediaRecorder){return}if("paused"===this.mediaRecorder.state){this.mediaRecorder.resume()}},clearRecordedData:function clearRecordedData(){if(!this.mediaRecorder){return}this.pause();this.stop()},isMediaStreamActive:function isMediaStreamActive(){if("active"in this.mediaStream){if(!this.mediaStream.active){return!1}}else if("ended"in this.mediaStream){if(this.mediaStream.ended){return!1}}return!0},looper:function looper(){if(!this.mediaRecorder){return}if(!1===this.isMediaStreamActive()){this.stop();return}setTimeout(this.looper,1e3)}}});
//# sourceMappingURL=msr_plain.min.js.map

define ("filter_poodll/audioanalyser",["jquery","core/log"],function(a,b){"use strict";b.debug("audioanalyser: initialising");return{acontext:null,core:null,freq_data:null,wav_data:null,theinterval:null,clone:function clone(){return a.extend(!0,{},this)},clear:function clear(){clearInterval(this.theinterval);this.theinterval=null},init:function init(a){if(this.theinterval){this.clear()}this.acontext=a;this.core=this.acontext.createAnalyser()},start:function start(){if(this.theinterval){this.clear()}var a=this.core.frequencyBinCount;this.freq_data=new Uint8Array(a);this.wav_data=new Uint8Array(a);var b=this;this.theinterval=setInterval(function(){b.process_recent_data(b)},2e3)},process_recent_data:function process_recent_data(a){a.core.getByteTimeDomainData(a.wav_data);a.wav_event(a.wav_data);a.core.getByteFrequencyData(a.freq_data);a.freq_event(a.freq_data)},wav_event:function wav_event(){},freq_event:function freq_event(){}}});
//# sourceMappingURL=audioanalyser.min.js.map

define ("filter_poodll/anim_words",["jquery","core/log","filter_poodll/speech_poodll"],function(a,b,c){"use strict";b.debug("anim_words: initialising");return{analyser:null,cvs:null,cvsctx:null,speechrec:null,enabled:!1,drawparams:{textColor:"#0",wavColor:"#0",font:"14px Comic Sans MS",textAlign:"center"},clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.cvs=b;this.cvsctx=b.getContext("2d");this.analyser=a;this.speechrec=c.clone();this.speechrec.init("en-US")},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height);this.enabled=!1;this.speechrec.stop()},start:function start(){this.enabled=!0;var a=this;this.analyser.core.fftSize=2048;var b=this.analyser.core.fftSize,c=new Uint8Array(b),d=this.cvs.width,e=this.cvs.height;this.cvsctx.clearRect(0,0,d,this.ceight);var f=["..","..","..","..","..","..","..",".."];this.speechrec.oninterimspeechcapture=function(a){var b=a.split(" ");f=f.concat(b)};this.speechrec.start();var g=function(){if(!a.enabled){return}var h=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,j=h(g);a.analyser.core.getByteTimeDomainData(c);a.cvsctx.clearRect(0,0,d,e);a.cvsctx.lineWidth=2;a.cvsctx.strokeStyle=a.drawparams.wavColor;a.cvsctx.beginPath();for(var k=0,l=0;l<b;l++){var m=c[l]/128,n=m*e/2;if(0==l){a.cvsctx.moveTo(k,n)}else{a.cvsctx.lineTo(k,n)}k+=1*d/b}a.cvsctx.lineTo(d,e/2);a.cvsctx.stroke();a.cvsctx.font=a.drawparams.font;a.cvsctx.fillStyle=a.drawparams.textColor;a.cvsctx.textAlign=a.drawparams.textAlign;var o=e/4;for(l=1;9>l;l++){a.cvsctx.fillText(f[f.length-l],d/4*(l%4)+d/8,5>l?o:3*o)}};g()}}});
//# sourceMappingURL=anim_words.min.js.map

define ("filter_poodll/uploader",["jquery","core/log","filter_poodll/upskin_plain"],function(a,b,c){"use strict";b.debug("Universal Uploader: initialising");return{config:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,d){this.config=b;if(d){this.upskin=d}else{this.upskin=c.clone();this.upskin.init(b,a,!1,!1)}this.upskin.initControls();this.registerEvents()},registerEvents:function registerEvents(){var a=this;if(this.config.hermes){this.config.hermes.on("fetch_upload_url",function(){a.fetchNewUploadDetails()})}},fetchNewUploadDetails:function fetchNewUploadDetails(){var a=new XMLHttpRequest,c=this;a.onreadystatechange=function(){if(4===this.readyState){if(200==a.status){var d=a.responseText,e=JSON.parse(d);if(e){if(0<e.returnCode){var f={id:c.config.id,type:"error",code:e.returnCode,message:e.returnMessage};c.config.hermes.postMessage(f)}else{c.config.allowedURL=e.allowedURL;c.config.posturl=e.postURL;c.config.filename=e.filename;c.config.s3filename=e.s3filename;c.config.s3root=e.s3root;c.config.cloudfilename=e.shortfilename;c.config.cloudroot=e.shortroot}}else{b.debug("error:"+e.message)}}else{b.debug("Not 200 response:"+a.status)}}};var d="wstoken="+this.config.wstoken+"&wsfunction="+"local_cpapi_fetch_upload_details"+"&moodlewsrestformat="+this.config.moodlewsrestformat+"&mediatype="+this.config.mediatype+"&parent="+this.config.parent+"&appid="+this.config.appid+"&owner="+this.config.owner+"&region="+this.config.region+"&expiredays="+this.config.expiredays+"&transcode="+this.config.transcode+"&transcoder="+this.config.transcoder+"&transcribe="+this.config.transcribe+"&subtitle="+this.config.subtitle+"&transcribelanguage="+this.config.language+"&transcribevocab="+this.config.transcribevocab+"&notificationurl="+this.config.notificationurl+"&sourcemimetype="+this.config.sourcemimetype,e=M.cfg.wwwroot+"/webservice/rest/server.php";a.open("POST",e,!0);a.setRequestHeader("Cache-Control","no-cache");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(d)},uploadBlob:function uploadBlob(a,b){this.uploadFile(a,b)},extractFilename:function extractFilename(a){var b=a.indexOf("success<filename>");if(1>b){return!1}var c=a.indexOf("</filename>"),d=a.substring(b+"success<filename>".length,c);return d},fetchFileExtension:function fetchFileExtension(a){var b="";switch(a){case"image/jpeg":b="jpg";break;case"image/png":b="png";break;case"audio/wav":b="wav";break;case"audio/ogg":b="ogg";break;case"audio/mpeg3":b="mp3";break;case"audio/mp3":b="mp3";break;case"audio/webm":b="webm";break;case"audio/wma":b="wma";break;case"audio/x-mpeg-3":b="mp3";break;case"audio/mp4":case"audio/m4a":case"audio/x-m4a":b="m4a";break;case"audio/3gpp":b="3gpp";break;case"video/mpeg3":b="3gpp";break;case"video/m4v":b="m4v";break;case"video/mp4":b="mp4";break;case"video/mov":case"video/quicktime":b="mov";break;case"video/webm":b="webm";break;case"video/wmv":b="wmv";break;case"video/ogg":b="ogg";break;}return b},pokeFilename:function pokeFilename(c,d){var e="";if("undefined"!=typeof d.config.updatecontrol&&""!==d.config.updatecontrol){e=a("[id=\""+d.config.updatecontrol+"\"]")}if(1>e.length){e=a("[id=\""+d.config.updatecontrol+"\"]",window.parent.document)}if(0<e.length){e.get(0).value=c}else{b.debug("upload failed #2");d.upskin.showMessage(M.util.get_string("recui_uploaderror","filter_poodll"),"recui_uploaderror");return!1}e.trigger("change");return!0},alertRecorderSuccess:function alertRecorderSuccess(a){if(this.config.hasOwnProperty("onuploadsuccess")){this.config.onuploadsuccess(a)}},alertRecorderFailure:function alertRecorderFailure(a){if(this.config.hasOwnProperty("onuploadfailure")){this.config.onuploadfailure(a)}},completeAfterProcessing:function completeAfterProcessing(c,d,e){this.upskin.showMessage(M.util.get_string("recui_awaitingconversion","filter_poodll"),"recui_awaitingconversion");if(c.config.iframeembed){d=c.config.s3root+c.config.s3filename}var f={type:"awaitingprocessing",mediaurl:d,mediafilename:c.config.s3filename,sourcefilename:c.config.sourcefilename,sourcemimetype:c.config.sourcemimetype,s3root:c.config.s3root,id:c.config.id,updatecontrol:c.config.updatecontrol};if(c.config.transcribe){f.transcripturl=d+".txt";f.transcriptfilename=c.config.s3filename+".txt"}c.config.hermes.postMessage(f);var g=this;a.ajax({url:c.config.s3root+c.config.s3filename,method:"HEAD",cache:!1,error:function error(){b.debug("403 errors are normal here, till the file arrives back from conversion");setTimeout(function(){g.completeAfterProcessing(c,d,e+500)},e)},success:function success(a,b,f){switch(f.status){case 200:g.doUploadCompleteCallback(c,d);break;default:setTimeout(function(){g.completeAfterProcessing(c,d,e+500)},e);}}})},doUploadCompleteCallback:function doUploadCompleteCallback(a,b){if(a.config.iframeembed){b=a.config.s3root+a.config.s3filename}var c=[];c[0]=a.config.widgetid;c[1]="filesubmitted";c[2]=b;c[3]=a.config.updatecontrol;c[4]=a.config.s3filename;this.upskin.showMessage(M.util.get_string("recui_uploadsuccess","filter_poodll"),"recui_uploadsuccess");if(!a.config.iframeembed){if(a.config.callbackjs&&""!=a.config.callbackjs){if("function"==typeof a.config.callbackjs){a.config.callbackjs(c)}else{this.executeFunctionByName(a.config.callbackjs,window,c)}}else{a.pokeFilename(b,a)}}else{var d={type:"filesubmitted",mediaurl:a.config.s3root+a.config.s3filename,mediafilename:a.config.s3filename,sourcefilename:a.config.sourcefilename,sourcemimetype:a.config.sourcemimetype,s3root:a.config.s3root,id:a.config.id,updatecontrol:a.config.updatecontrol};if(a.config.transcribe){d.transcripturl=a.config.s3root+a.config.s3filename+".txt";d.transcriptfilename=a.config.s3filename+".txt"}a.config.hermes.postMessage(d)}},postProcessUpload:function postProcessUpload(c,d){var e=c.currentTarget;if(4==e.readyState){d.upskin.deactivateProgressSession();a(window).off("beforeunload",this.preventPrematureLeaving);if(200==e.status){var f=d.config.filename;if(!f){f=d.extractFilename(e.responseText)}if(!f){b.debug("upload failed #1");b.debug(e);return}if(d.config.iframeembed){this.completeAfterProcessing(d,f,1e3)}else{this.doUploadCompleteCallback(d,f)}this.alertRecorderSuccess(d.config.widgetid)}else{b.debug("upload failed #3");b.debug(e);d.upskin.showMessage(M.util.get_string("recui_uploaderror","filter_poodll"),"recui_uploaderror");this.alertRecorderFailure(d.config.widgetid)}}},preventPrematureLeaving:function preventPrematureLeaving(){return M.util.get_string("recui_waitwaitstilluploading","filter_poodll")},uploadFile:function uploadFile(b,c){var d=new XMLHttpRequest,e=this.config,f=this,g=this.fetchFileExtension(c);if("undefined"==typeof e.iframeembed){e.iframeembed=!1}var h=e.using_s3;this.upskin.initProgressSession(d);a(window).on("beforeunload",this.preventPrematureLeaving);this.upskin.showMessage(M.util.get_string("recui_uploading","filter_poodll"),"recui_uploading");f.config.sourcemimetype=c;f.config.sourcefilename=f.config.s3filename;d.onreadystatechange=function(a){if(h&&4===this.readyState){if(e.iframeembed){f.update_filenames(f,g)}else{f.postprocess_s3_upload(f)}}f.postProcessUpload(a,f)};if(h){d.open("put",e.posturl,!0);d.setRequestHeader("Content-Type","application/octet-stream");d.send(b)}else{if(!(b instanceof Blob)){var i="datatype=uploadfile";i+="&paramone="+encodeURIComponent(b);i+="&paramtwo="+g;i+="&paramthree="+e.mediatype;i+="&requestid="+e.widgetid;i+="&contextid="+e.p2;i+="&component="+e.p3;i+="&filearea="+e.p4;i+="&itemid="+e.p5;d.open("POST",e.posturl,!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.setRequestHeader("Cache-Control","no-cache");d.send(i)}else{var j=new window.FileReader;j.readAsDataURL(b);j.onloadend=function(){var a=j.result,b="datatype=uploadfile";b+="&paramone="+encodeURIComponent(a);b+="&paramtwo="+g;b+="&paramthree="+e.mediatype;b+="&requestid="+e.widgetid;b+="&contextid="+e.p2;b+="&component="+e.p3;b+="&filearea="+e.p4;b+="&itemid="+e.p5;d.open("POST",e.posturl,!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.setRequestHeader("Cache-Control","no-cache");d.send(b)}}}},uploadMultiPartFile:function uploadMultiPartFile(b,c){var d=new XMLHttpRequest,e=this.config,f=this,g=this.fetchFileExtension(c);if("undefined"==typeof e.iframeembed){e.iframeembed=!1}var h=e.using_s3;this.upskin.initProgressSession(d);a(window).on("beforeunload",this.preventPrematureLeaving);this.upskin.showMessage(M.util.get_string("recui_uploading","filter_poodll"),"recui_uploading");f.config.sourcemimetype=c;f.config.sourcefilename=f.config.s3filename;d.onreadystatechange=function(a){if(h&&4===this.readyState){if(e.iframeembed){f.update_filenames(f,g)}else{f.postprocess_s3_upload(f)}}f.postProcessUpload(a,f)};if(h){d.open("put",e.posturl,!0);d.setRequestHeader("Content-Type","application/octet-stream");d.send(b)}},update_filenames:function update_filenames(a,b){var c=a.config;switch(c.mediatype){case"audio":a.config.sourcefilename=c.s3filename.replace(".mp3","."+b);if(!c.transcode){a.config.s3filename=a.config.sourcefilename;a.config.cloudfilename=a.config.s3filename}break;case"video":a.config.sourcefilename=c.s3filename.replace(".mp4","."+b);if(!c.transcode){a.config.s3filename=a.config.sourcefilename}break;}},postprocess_s3_upload:function postprocess_s3_upload(a){var b=a.config,c=new FormData;c.append("datatype","handles3upload");c.append("contextid",b.p2);c.append("component",b.p3);c.append("filearea",b.p4);c.append("itemid",b.p5);c.append("filename",b.filename);c.append("mediatype",b.mediatype);if(!navigator.sendBeacon){navigator.sendBeacon=function(a,b){window.fetch(a,{method:"POST",body:b,credentials:"include"})}}navigator.sendBeacon(M.cfg.wwwroot+"/filter/poodll/poodllfilelib.php",c)},executeFunctionByName:function executeFunctionByName(a,b,c){for(var d=a.split("."),e=d.pop(),f=0;f<d.length;f++){b=b[d[f]]}return b[e].call(this,c)},dataURItoBlob:function dataURItoBlob(a,b){for(var c=atob(a.split(",")[1]),d=new ArrayBuffer(c.length),e=new Uint8Array(d),f=0;f<c.length;f++){e[f]=c.charCodeAt(f)}return new Blob([d],{type:b})},Output:function Output(a){this.upskin.showMessage(a,"recorderskinmsg")}}});
//# sourceMappingURL=uploader.min.js.map

define ("filter_poodll/timer",["jquery","core/log"],function(a,b){"use strict";b.debug("Timer: initialising");return{increment:1,initseconds:0,seconds:0,finalseconds:0,intervalhandle:null,callback:null,enabled:!1,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.initseconds=parseInt(a);this.seconds=parseInt(a);this.callback=b;this.enabled=!0},start:function start(){if(!this.enabled){return}var a=this;this.finalseconds=0;if(0<this.initseconds){this.increment=-1}else{this.increment=1}this.intervalhandle=this.customSetInterval(function(){a.seconds=a.seconds+a.increment;a.finalseconds=a.finalseconds+1;a.callback()},1e3)},customSetInterval:function customSetInterval(a,b){var d=Date.now(),e=b,f={};function c(){var g=Date.now(),h=g-d;d=g;e=b+e-h;f.id=setTimeout(c,e);a()}f.id=setTimeout(c,b);return f},disable:function disable(){this.enabled=!1},enable:function enable(){this.enabled=!0},fetch_display_time:function fetch_display_time(a){if(!a){a=this.seconds}var b="00"+parseInt(a/3600);b=b.substr(b.length-2,2);var c="00"+parseInt(a/60);c=c.substr(c.length-2,2);var d="00"+parseInt(a%60);d=d.substr(d.length-2,2);var e=b+":"+c+":"+d;return e},stop:function stop(){clearTimeout(this.intervalhandle.id)},reset:function reset(){this.seconds=this.initseconds},pause:function pause(){this.increment=0},resume:function resume(){if(0<this.initseconds){this.increment=-1}else{this.increment=1}}}});
//# sourceMappingURL=timer.min.js.map

define ("filter_poodll/template_amd",["jquery","core/log"],function(a,b){"use strict";b.debug("Filter Poodll initialising");return{allopts:{},extscripts:{},csslinks:[],jslinks:[],appendjspath:function appendjspath(a){require.config({paths:{theprefix:a}})},injectcss:function injectcss(a){var b=document.createElement("link");b.href=a;if(a.toLowerCase().lastIndexOf(".html")==a.length-5){b.rel="import"}else{b.type="text/css";b.rel="stylesheet"}document.getElementsByTagName("head")[0].appendChild(b)},loadtemplate:function loadtemplate(b){var c="#filter_poodll_amdopts_"+b.AUTOID,d=a(c).get(0);if(d){b=JSON.parse(d.value);a(c).remove()}if(b.CSSLINK){if(0>this.csslinks.indexOf(b.CSSLINK)){this.csslinks.push(b.CSSLINK);this.injectcss(b.CSSLINK)}}if(b.CSSUPLOAD){if(0>this.csslinks.indexOf(b.CSSUPLOAD)){this.csslinks.push(b.CSSUPLOAD);this.injectcss(b.CSSUPLOAD)}}if(b.CSSCUSTOM){if(0>this.csslinks.indexOf(b.CSSCUSTOM)){this.csslinks.push(b.CSSCUSTOM);this.injectcss(b.CSSCUSTOM)}}if("undefined"!=typeof b.TEMPLATEID){require(["filter_poodll_d"+b.TEMPLATEID],function(a){a(b)})}}}});
//# sourceMappingURL=template_amd.min.js.map

function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}(function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module){module.exports=e()}else if("function"==typeof define&&define.amd){define ("filter_poodll/adapter",[],e)}else{var t;if("undefined"!=typeof window){t=window}else if("undefined"!=typeof global){t=global}else if("undefined"!=typeof self){t=self}else{t=this}t.adapter=e()}})(function(){return function c(d,e,t){function r(i,o){if(!e[i]){if(!d[i]){var s="function"==typeof require&&require;if(!o&&s)return s(i,!0);if(n)return n(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=e[i]={exports:{}};d[i][0].call(p.exports,function(t){var e=d[i][1][t];return r(e?e:t)},p,p.exports,c,d,e,t)}return e[i].exports}for(var n="function"==typeof require&&require,a=0;a<t.length;a++){r(t[a])}return r}({1:[function(e,t){'use strict';var d=e("sdp");function r(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function a(e,t,r,a,n){var i=d.writeRtpDescription(e.kind,t);i+=d.writeIceParameters(e.iceGatherer.getLocalParameters());i+=d.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":n||"active");i+="a=mid:"+e.mid+"\r\n";if(e.rtpSender&&e.rtpReceiver){i+="a=sendrecv\r\n"}else if(e.rtpSender){i+="a=sendonly\r\n"}else if(e.rtpReceiver){i+="a=recvonly\r\n"}else{i+="a=inactive\r\n"}if(e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(a?a.id:"-")+" "+o+"\r\n";i+="a="+s;i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s;if(e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s;i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+d.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+d.localCName+"\r\n"}return i}function n(e,t){var r=!1;e=JSON.parse(JSON.stringify(e));return e.filter(function(e){if(e&&(e.urls||e.url)){var a=e.urls||e.url;if(e.url&&!e.urls){console.warn("RTCIceServer.url is deprecated! Use urls instead.")}var n="string"==typeof a;if(n){a=[a]}a=a.filter(function(e){var a=0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!r;if(a){r=!0;return!0}return 0===e.indexOf("stun:")&&14393<=t&&-1===e.indexOf("?transport=udp")});delete e.url;e.urls=n?a[0]:a;return!!a.length}})}function i(e,t){var r={codecs:[],headerExtensions:[],fecMechanisms:[]},a=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++){if(t[r].payloadType===e||t[r].preferredPayloadType===e){return t[r]}}},n=function(e,t,r,n){var i=a(e.parameters.apt,r),o=a(t.parameters.apt,n);return i&&o&&i.name.toLowerCase()===o.name.toLowerCase()};e.codecs.forEach(function(a){for(var o=0,s;o<t.codecs.length;o++){s=t.codecs[o];if(a.name.toLowerCase()===s.name.toLowerCase()&&a.clockRate===s.clockRate){if("rtx"===a.name.toLowerCase()&&a.parameters&&s.parameters.apt){if(!n(a,s,e.codecs,t.codecs)){continue}}s=JSON.parse(JSON.stringify(s));s.numChannels=Math.min(a.numChannels,s.numChannels);r.codecs.push(s);s.rtcpFeedback=s.rtcpFeedback.filter(function(e){for(var t=0;t<a.rtcpFeedback.length;t++){if(a.rtcpFeedback[t].type===e.type&&a.rtcpFeedback[t].parameter===e.parameter){return!0}}return!1});break}}});e.headerExtensions.forEach(function(e){for(var a=0,n;a<t.headerExtensions.length;a++){n=t.headerExtensions[a];if(e.uri===n.uri){r.headerExtensions.push(n);break}}});return r}function o(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function s(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});if(!r){e.addRemoteCandidate(t)}return!r}function c(t,r){var a=new Error(r);a.name=t;a.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[t];return a}t.exports=function(e,t){function p(t,r){r.addTrack(t);r.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function m(t,r){r.removeTrack(t);r.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}function l(t,r,a,n){var i=new Event("track");i.track=r;i.receiver=a;i.transceiver={receiver:a};i.streams=n;e.setTimeout(function(){t._dispatchEvent("track",i)})}var h=function(r){var a=this,o=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){a[e]=o[e].bind(o)});this.canTrickleIceCandidates=null;this.needNegotiation=!1;this.localStreams=[];this.remoteStreams=[];this.localDescription=null;this.remoteDescription=null;this.signalingState="stable";this.iceConnectionState="new";this.connectionState="new";this.iceGatheringState="new";r=JSON.parse(JSON.stringify(r||{}));this.usingBundle="max-bundle"===r.bundlePolicy;if("negotiate"===r.rtcpMuxPolicy){throw c("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported")}else if(!r.rtcpMuxPolicy){r.rtcpMuxPolicy="require"}switch(r.iceTransportPolicy){case"all":case"relay":break;default:r.iceTransportPolicy="all";break;}switch(r.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:r.bundlePolicy="balanced";break;}r.iceServers=n(r.iceServers||[],t);this._iceGatherers=[];if(r.iceCandidatePoolSize){for(var s=r.iceCandidatePoolSize;0<s;s--){this._iceGatherers.push(new e.RTCIceGatherer({iceServers:r.iceServers,gatherPolicy:r.iceTransportPolicy}))}}else{r.iceCandidatePoolSize=0}this._config=r;this.transceivers=[];this._sdpSessionId=d.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0;this._isClosed=!1};h.prototype.onicecandidate=null;h.prototype.onaddstream=null;h.prototype.ontrack=null;h.prototype.onremovestream=null;h.prototype.onsignalingstatechange=null;h.prototype.oniceconnectionstatechange=null;h.prototype.onconnectionstatechange=null;h.prototype.onicegatheringstatechange=null;h.prototype.onnegotiationneeded=null;h.prototype.ondatachannel=null;h.prototype._dispatchEvent=function(e,t){if(this._isClosed){return}this.dispatchEvent(t);if("function"==typeof this["on"+e]){this["on"+e](t)}};h.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)};h.prototype.getConfiguration=function(){return this._config};h.prototype.getLocalStreams=function(){return this.localStreams};h.prototype.getRemoteStreams=function(){return this.remoteStreams};h.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length,a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r){a.iceTransport=this.transceivers[0].iceTransport;a.dtlsTransport=this.transceivers[0].dtlsTransport}else{var n=this._createIceAndDtlsTransports();a.iceTransport=n.iceTransport;a.dtlsTransport=n.dtlsTransport}if(!t){this.transceivers.push(a)}return a};h.prototype.addTrack=function(t,r){if(this._isClosed){throw c("InvalidStateError","Attempted to call addTrack on a closed peerconnection.")}var a=this.transceivers.find(function(e){return e.track===t});if(a){throw c("InvalidAccessError","Track already exists.")}for(var n,o=0;o<this.transceivers.length;o++){if(!this.transceivers[o].track&&this.transceivers[o].kind===t.kind){n=this.transceivers[o]}}if(!n){n=this._createTransceiver(t.kind)}this._maybeFireNegotiationNeeded();if(-1===this.localStreams.indexOf(r)){this.localStreams.push(r)}n.track=t;n.stream=r;n.rtpSender=new e.RTCRtpSender(t,n.dtlsTransport);return n.rtpSender};h.prototype.addStream=function(e){var r=this;if(15025<=t){e.getTracks().forEach(function(t){r.addTrack(t,e)})}else{var a=e.clone();e.getTracks().forEach(function(e,t){var r=a.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})});a.getTracks().forEach(function(e){r.addTrack(e,a)})}};h.prototype.removeTrack=function(r){if(this._isClosed){throw c("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.")}if(!(r instanceof e.RTCRtpSender)){throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.")}var a=this.transceivers.find(function(e){return e.rtpSender===r});if(!a){throw c("InvalidAccessError","Sender was not created by this connection.")}var n=a.stream;a.rtpSender.stop();a.rtpSender=null;a.track=null;a.stream=null;var i=this.transceivers.map(function(e){return e.stream});if(-1===i.indexOf(n)&&-1<this.localStreams.indexOf(n)){this.localStreams.splice(this.localStreams.indexOf(n),1)}this._maybeFireNegotiationNeeded()};h.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});if(r){t.removeTrack(r)}})};h.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})};h.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})};h.prototype._createIceGatherer=function(t,r){var a=this;if(r&&0<t){return this.transceivers[0].iceGatherer}else if(this._iceGatherers.length){return this._iceGatherers.shift()}var n=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(n,"state",{value:"new",writable:!0});this.transceivers[t].bufferedCandidateEvents=[];this.transceivers[t].bufferCandidates=function(e){var r=!e.candidate||0===Object.keys(e.candidate).length;n.state=r?"completed":"gathering";if(null!==a.transceivers[t].bufferedCandidateEvents){a.transceivers[t].bufferedCandidateEvents.push(e)}};n.addEventListener("localcandidate",this.transceivers[t].bufferCandidates);return n};h.prototype._gather=function(t,r){var a=this,n=this.transceivers[r].iceGatherer;if(n.onlocalcandidate){return}var i=this.transceivers[r].bufferedCandidateEvents;this.transceivers[r].bufferedCandidateEvents=null;n.removeEventListener("localcandidate",this.transceivers[r].bufferCandidates);n.onlocalcandidate=function(e){if(a.usingBundle&&0<r){return}var i=new Event("icecandidate");i.candidate={sdpMid:t,sdpMLineIndex:r};var o=e.candidate,s=!o||0===Object.keys(o).length;if(s){if("new"===n.state||"gathering"===n.state){n.state="completed"}}else{if("new"===n.state){n.state="gathering"}o.component=1;o.ufrag=n.getLocalParameters().usernameFragment;var c=d.writeCandidate(o);i.candidate=Object.assign(i.candidate,d.parseCandidate(c));i.candidate.candidate=c;i.candidate.toJSON=function(){return{candidate:i.candidate.candidate,sdpMid:i.candidate.sdpMid,sdpMLineIndex:i.candidate.sdpMLineIndex,usernameFragment:i.candidate.usernameFragment}}}var p=d.getMediaSections(a.localDescription.sdp);if(!s){p[i.candidate.sdpMLineIndex]+="a="+i.candidate.candidate+"\r\n"}else{p[i.candidate.sdpMLineIndex]+="a=end-of-candidates\r\n"}a.localDescription.sdp=d.getDescription(a.localDescription.sdp)+p.join("");var m=a.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});if("gathering"!==a.iceGatheringState){a.iceGatheringState="gathering";a._emitGatheringStateChange()}if(!s){a._dispatchEvent("icecandidate",i)}if(m){a._dispatchEvent("icecandidate",new Event("icecandidate"));a.iceGatheringState="complete";a._emitGatheringStateChange()}};e.setTimeout(function(){i.forEach(function(t){n.onlocalcandidate(t)})},0)};h.prototype._createIceAndDtlsTransports=function(){var t=this,r=new e.RTCIceTransport(null);r.onicestatechange=function(){t._updateIceConnectionState();t._updateConnectionState()};var a=new e.RTCDtlsTransport(r);a.ondtlsstatechange=function(){t._updateConnectionState()};a.onerror=function(){Object.defineProperty(a,"state",{value:"failed",writable:!0});t._updateConnectionState()};return{iceTransport:r,dtlsTransport:a}};h.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;if(t){delete t.onlocalcandidate;delete this.transceivers[e].iceGatherer}var r=this.transceivers[e].iceTransport;if(r){delete r.onicestatechange;delete this.transceivers[e].iceTransport}var a=this.transceivers[e].dtlsTransport;if(a){delete a.ondtlsstatechange;delete a.onerror;delete this.transceivers[e].dtlsTransport}};h.prototype._transceive=function(e,r,a){var n=i(e.localCapabilities,e.remoteCapabilities);if(r&&e.rtpSender){n.encodings=e.sendEncodingParameters;n.rtcp={cname:d.localCName,compound:e.rtcpParameters.compound};if(e.recvEncodingParameters.length){n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc}e.rtpSender.send(n)}if(a&&e.rtpReceiver&&0<n.codecs.length){if("video"===e.kind&&e.recvEncodingParameters&&15019>t){e.recvEncodingParameters.forEach(function(e){delete e.rtx})}if(e.recvEncodingParameters.length){n.encodings=e.recvEncodingParameters}else{n.encodings=[{}]}n.rtcp={compound:e.rtcpParameters.compound};if(e.rtcpParameters.cname){n.rtcp.cname=e.rtcpParameters.cname}if(e.sendEncodingParameters.length){n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc}e.rtpReceiver.receive(n)}};h.prototype.setLocalDescription=function(e){var t=this;if(-1===["offer","answer"].indexOf(e.type)){return Promise.reject(c("TypeError","Unsupported type \""+e.type+"\""))}if(!o("setLocalDescription",e.type,t.signalingState)||t._isClosed){return Promise.reject(c("InvalidStateError","Can not set local "+e.type+" in state "+t.signalingState))}var r,a;if("offer"===e.type){r=d.splitSections(e.sdp);a=r.shift();r.forEach(function(e,r){var a=d.parseRtpParameters(e);t.transceivers[r].localCapabilities=a});t.transceivers.forEach(function(e,r){t._gather(e.mid,r)})}else if("answer"===e.type){r=d.splitSections(t.remoteDescription.sdp);a=r.shift();var n=0<d.matchPrefix(a,"a=ice-lite").length;r.forEach(function(e,r){var o=t.transceivers[r],s=o.iceGatherer,c=o.iceTransport,p=o.dtlsTransport,m=o.localCapabilities,l=o.remoteCapabilities,h=d.isRejected(e)&&0===d.matchPrefix(e,"a=bundle-only").length;if(!h&&!o.rejected){var g=d.getIceParameters(e,a),f=d.getDtlsParameters(e,a);if(n){f.role="server"}if(!t.usingBundle||0===r){t._gather(o.mid,r);if("new"===c.state){c.start(s,g,n?"controlling":"controlled")}if("new"===p.state){p.start(f)}}var C=i(m,l);t._transceive(o,0<C.codecs.length,!1)}})}t.localDescription={type:e.type,sdp:e.sdp};if("offer"===e.type){t._updateSignalingState("have-local-offer")}else{t._updateSignalingState("stable")}return Promise.resolve()};h.prototype.setRemoteDescription=function(r){var a=this;if(-1===["offer","answer"].indexOf(r.type)){return Promise.reject(c("TypeError","Unsupported type \""+r.type+"\""))}if(!o("setRemoteDescription",r.type,a.signalingState)||a._isClosed){return Promise.reject(c("InvalidStateError","Can not set remote "+r.type+" in state "+a.signalingState))}var n={};a.remoteStreams.forEach(function(e){n[e.id]=e});var i=[],h=d.splitSections(r.sdp),g=h.shift(),f=0<d.matchPrefix(g,"a=ice-lite").length,C=0<d.matchPrefix(g,"a=group:BUNDLE ").length;a.usingBundle=C;var v=d.matchPrefix(g,"a=ice-options:")[0];if(v){a.canTrickleIceCandidates=0<=v.substr(14).split(" ").indexOf("trickle")}else{a.canTrickleIceCandidates=!1}h.forEach(function(o,c){var l=d.splitLines(o),h=d.getKind(o),v=d.isRejected(o)&&0===d.matchPrefix(o,"a=bundle-only").length,y=l[0].substr(2).split(" ")[2],u=d.getDirection(o,g),T=d.parseMsid(o),S=d.getMid(o)||d.generateIdentifier();if("application"===h&&"DTLS/SCTP"===y||v){a.transceivers[c]={mid:S,kind:h,rejected:!0};return}if(!v&&a.transceivers[c]&&a.transceivers[c].rejected){a.transceivers[c]=a._createTransceiver(h,!0)}var R,P,E,k,b,_,x,L,M,I=d.parseRtpParameters(o),D,w;if(!v){D=d.getIceParameters(o,g);w=d.getDtlsParameters(o,g);w.role="client"}x=d.parseRtpEncodingParameters(o);var j=d.parseRtcpParameters(o),O=0<d.matchPrefix(o,"a=end-of-candidates",g).length,A=d.matchPrefix(o,"a=candidate:").map(function(e){return d.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===r.type||"answer"===r.type)&&!v&&C&&0<c&&a.transceivers[c]){a._disposeIceAndDtlsTransports(c);a.transceivers[c].iceGatherer=a.transceivers[0].iceGatherer;a.transceivers[c].iceTransport=a.transceivers[0].iceTransport;a.transceivers[c].dtlsTransport=a.transceivers[0].dtlsTransport;if(a.transceivers[c].rtpSender){a.transceivers[c].rtpSender.setTransport(a.transceivers[0].dtlsTransport)}if(a.transceivers[c].rtpReceiver){a.transceivers[c].rtpReceiver.setTransport(a.transceivers[0].dtlsTransport)}}if("offer"===r.type&&!v){R=a.transceivers[c]||a._createTransceiver(h);R.mid=S;if(!R.iceGatherer){R.iceGatherer=a._createIceGatherer(c,C)}if(A.length&&"new"===R.iceTransport.state){if(O&&(!C||0===c)){R.iceTransport.setRemoteCandidates(A)}else{A.forEach(function(e){s(R.iceTransport,e)})}}L=e.RTCRtpReceiver.getCapabilities(h);if(15019>t){L.codecs=L.codecs.filter(function(e){return"rtx"!==e.name})}_=R.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var U=!1;if("sendrecv"===u||"sendonly"===u){U=!R.rtpReceiver;b=R.rtpReceiver||new e.RTCRtpReceiver(R.dtlsTransport,h);if(U){var G;M=b.track;if(T&&"-"===T.stream){}else if(T){if(!n[T.stream]){n[T.stream]=new e.MediaStream;Object.defineProperty(n[T.stream],"id",{get:function get(){return T.stream}})}Object.defineProperty(M,"id",{get:function get(){return T.track}});G=n[T.stream]}else{if(!n.default){n.default=new e.MediaStream}G=n.default}if(G){p(M,G);R.associatedRemoteMediaStreams.push(G)}i.push([M,b,G])}}else if(R.rtpReceiver&&R.rtpReceiver.track){R.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===R.rtpReceiver.track.id});if(t){m(t,e)}});R.associatedRemoteMediaStreams=[]}R.localCapabilities=L;R.remoteCapabilities=I;R.rtpReceiver=b;R.rtcpParameters=j;R.sendEncodingParameters=_;R.recvEncodingParameters=x;a._transceive(a.transceivers[c],!1,U)}else if("answer"===r.type&&!v){R=a.transceivers[c];P=R.iceGatherer;E=R.iceTransport;k=R.dtlsTransport;b=R.rtpReceiver;_=R.sendEncodingParameters;L=R.localCapabilities;a.transceivers[c].recvEncodingParameters=x;a.transceivers[c].remoteCapabilities=I;a.transceivers[c].rtcpParameters=j;if(A.length&&"new"===E.state){if((f||O)&&(!C||0===c)){E.setRemoteCandidates(A)}else{A.forEach(function(e){s(R.iceTransport,e)})}}if(!C||0===c){if("new"===E.state){E.start(P,D,"controlling")}if("new"===k.state){k.start(w)}}a._transceive(R,"sendrecv"===u||"recvonly"===u,"sendrecv"===u||"sendonly"===u);if(b&&("sendrecv"===u||"sendonly"===u)){M=b.track;if(T){if(!n[T.stream]){n[T.stream]=new e.MediaStream}p(M,n[T.stream]);i.push([M,b,n[T.stream]])}else{if(!n.default){n.default=new e.MediaStream}p(M,n.default);i.push([M,b,n.default])}}else{delete R.rtpReceiver}}});if(a._dtlsRole===void 0){a._dtlsRole="offer"===r.type?"active":"passive"}a.remoteDescription={type:r.type,sdp:r.sdp};if("offer"===r.type){a._updateSignalingState("have-remote-offer")}else{a._updateSignalingState("stable")}Object.keys(n).forEach(function(t){var r=n[t];if(r.getTracks().length){if(-1===a.remoteStreams.indexOf(r)){a.remoteStreams.push(r);var o=new Event("addstream");o.stream=r;e.setTimeout(function(){a._dispatchEvent("addstream",o)})}i.forEach(function(e){var t=e[0],n=e[1];if(r.id!==e[2].id){return}l(a,t,n,[r])})}});i.forEach(function(e){if(e[2]){return}l(a,e[0],e[1],[])});e.setTimeout(function(){if(!(a&&a.transceivers)){return}a.transceivers.forEach(function(e){if(e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length){console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification");e.iceTransport.addRemoteCandidate({})}})},4e3);return Promise.resolve()};h.prototype.close=function(){this.transceivers.forEach(function(e){if(e.iceTransport){e.iceTransport.stop()}if(e.dtlsTransport){e.dtlsTransport.stop()}if(e.rtpSender){e.rtpSender.stop()}if(e.rtpReceiver){e.rtpReceiver.stop()}});this._isClosed=!0;this._updateSignalingState("closed")};h.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)};h.prototype._maybeFireNegotiationNeeded=function(){var t=this;if("stable"!==this.signalingState||!0===this.needNegotiation){return}this.needNegotiation=!0;e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0)};h.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){t[e.iceTransport.state]++});e="new";if(0<t.failed){e="failed"}else if(0<t.checking){e="checking"}else if(0<t.disconnected){e="disconnected"}else if(0<t.new){e="new"}else if(0<t.connected){e="connected"}else if(0<t.completed){e="completed"}if(e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}};h.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){t[e.iceTransport.state]++;t[e.dtlsTransport.state]++});t.connected+=t.completed;e="new";if(0<t.failed){e="failed"}else if(0<t.connecting){e="connecting"}else if(0<t.disconnected){e="disconnected"}else if(0<t.new){e="new"}else if(0<t.connected){e="connected"}if(e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}};h.prototype.createOffer=function(){var r=this;if(r._isClosed){return Promise.reject(c("InvalidStateError","Can not call createOffer after close"))}var n=r.transceivers.filter(function(e){return"audio"===e.kind}).length,i=r.transceivers.filter(function(e){return"video"===e.kind}).length,o=arguments[0];if(o){if(o.mandatory||o.optional){throw new TypeError("Legacy mandatory/optional constraints not supported.")}if(o.offerToReceiveAudio!==void 0){if(!0===o.offerToReceiveAudio){n=1}else if(!1===o.offerToReceiveAudio){n=0}else{n=o.offerToReceiveAudio}}if(o.offerToReceiveVideo!==void 0){if(!0===o.offerToReceiveVideo){i=1}else if(!1===o.offerToReceiveVideo){i=0}else{i=o.offerToReceiveVideo}}}r.transceivers.forEach(function(e){if("audio"===e.kind){n--;if(0>n){e.wantReceive=!1}}else if("video"===e.kind){i--;if(0>i){e.wantReceive=!1}}});while(0<n||0<i){if(0<n){r._createTransceiver("audio");n--}if(0<i){r._createTransceiver("video");i--}}var s=d.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);r.transceivers.forEach(function(a,n){var i=a.track,o=a.kind,s=a.mid||d.generateIdentifier();a.mid=s;if(!a.iceGatherer){a.iceGatherer=r._createIceGatherer(n,r.usingBundle)}var c=e.RTCRtpSender.getCapabilities(o);if(15019>t){c.codecs=c.codecs.filter(function(e){return"rtx"!==e.name})}c.codecs.forEach(function(e){if("H264"===e.name&&e.parameters["level-asymmetry-allowed"]===void 0){e.parameters["level-asymmetry-allowed"]="1"}if(a.remoteCapabilities&&a.remoteCapabilities.codecs){a.remoteCapabilities.codecs.forEach(function(t){if(e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate){e.preferredPayloadType=t.payloadType}})}});c.headerExtensions.forEach(function(e){var t=a.remoteCapabilities&&a.remoteCapabilities.headerExtensions||[];t.forEach(function(t){if(e.uri===t.uri){e.id=t.id}})});var p=a.sendEncodingParameters||[{ssrc:1001*(2*n+1)}];if(i){if(15019<=t&&"video"===o&&!p[0].rtx){p[0].rtx={ssrc:p[0].ssrc+1}}}if(a.wantReceive){a.rtpReceiver=new e.RTCRtpReceiver(a.dtlsTransport,o)}a.localCapabilities=c;a.sendEncodingParameters=p});if("max-compat"!==r._config.bundlePolicy){s+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}s+="a=ice-options:trickle\r\n";r.transceivers.forEach(function(e,t){s+=a(e,e.localCapabilities,"offer",e.stream,r._dtlsRole);s+="a=rtcp-rsize\r\n";if(e.iceGatherer&&"new"!==r.iceGatheringState&&(0===t||!r.usingBundle)){e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1;s+="a="+d.writeCandidate(e)+"\r\n"});if("completed"===e.iceGatherer.state){s+="a=end-of-candidates\r\n"}}});var p=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(p)};h.prototype.createAnswer=function(){var r=this;if(r._isClosed){return Promise.reject(c("InvalidStateError","Can not call createAnswer after close"))}if(!("have-remote-offer"===r.signalingState||"have-local-pranswer"===r.signalingState)){return Promise.reject(c("InvalidStateError","Can not call createAnswer in signalingState "+r.signalingState))}var n=d.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);if(r.usingBundle){n+="a=group:BUNDLE "+r.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}var o=d.getMediaSections(r.remoteDescription.sdp).length;r.transceivers.forEach(function(e,s){if(s+1>o){return}if(e.rejected){if("application"===e.kind){n+="m=application 0 DTLS/SCTP 5000\r\n"}else if("audio"===e.kind){n+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n"}else if("video"===e.kind){n+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"}n+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n";return}if(e.stream){var c;if("audio"===e.kind){c=e.stream.getAudioTracks()[0]}else if("video"===e.kind){c=e.stream.getVideoTracks()[0]}if(c){if(15019<=t&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx){e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}}}}var d=i(e.localCapabilities,e.remoteCapabilities),p=d.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length;if(!p&&e.sendEncodingParameters[0].rtx){delete e.sendEncodingParameters[0].rtx}n+=a(e,d,"answer",e.stream,r._dtlsRole);if(e.rtcpParameters&&e.rtcpParameters.reducedSize){n+="a=rtcp-rsize\r\n"}});var s=new e.RTCSessionDescription({type:"answer",sdp:n});return Promise.resolve(s)};h.prototype.addIceCandidate=function(e){var t=this,r;if(e&&!(e.sdpMLineIndex!==void 0||e.sdpMid)){return Promise.reject(new TypeError("sdpMLineIndex or sdpMid required"))}return new Promise(function(a,n){if(!t.remoteDescription){return n(c("InvalidStateError","Can not add ICE candidate without a remote description"))}else if(!e||""===e.candidate){for(var o=0;o<t.transceivers.length;o++){if(t.transceivers[o].rejected){continue}t.transceivers[o].iceTransport.addRemoteCandidate({});r=d.getMediaSections(t.remoteDescription.sdp);r[o]+="a=end-of-candidates\r\n";t.remoteDescription.sdp=d.getDescription(t.remoteDescription.sdp)+r.join("");if(t.usingBundle){break}}}else{var p=e.sdpMLineIndex;if(e.sdpMid){for(var m=0;m<t.transceivers.length;m++){if(t.transceivers[m].mid===e.sdpMid){p=m;break}}}var l=t.transceivers[p];if(l){if(l.rejected){return a()}var h=0<Object.keys(e.candidate).length?d.parseCandidate(e.candidate):{};if("tcp"===h.protocol&&(0===h.port||9===h.port)){return a()}if(h.component&&1!==h.component){return a()}if(0===p||0<p&&l.iceTransport!==t.transceivers[0].iceTransport){if(!s(l.iceTransport,h)){return n(c("OperationError","Can not add ICE candidate"))}}var g=e.candidate.trim();if(0===g.indexOf("a=")){g=g.substr(2)}r=d.getMediaSections(t.remoteDescription.sdp);r[p]+="a="+(h.type?g:"end-of-candidates")+"\r\n";t.remoteDescription.sdp=d.getDescription(t.remoteDescription.sdp)+r.join("")}else{return n(c("OperationError","Can not add ICE candidate"))}}a()})};h.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var r=null;this.transceivers.forEach(function(e){if(e.rtpSender&&e.rtpSender.track===t){r=e.rtpSender}else if(e.rtpReceiver&&e.rtpReceiver.track===t){r=e.rtpReceiver}});if(!r){throw c("InvalidAccessError","Invalid selector.")}return r.getStats()}var a=[];this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){if(e[t]){a.push(e[t].getStats())}})});return Promise.all(a).then(function(e){var t=new Map;e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})});return t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var a=e[t];if(a&&a.prototype&&a.prototype.getStats){var n=a.prototype.getStats;a.prototype.getStats=function(){return n.apply(this).then(function(e){var t=new Map;Object.keys(e).forEach(function(a){e[a].type=r(e[a]);t.set(a,e[a])});return t})}}});var g=["createOffer","createAnswer"];g.forEach(function(e){var t=h.prototype[e];h.prototype[e]=function(){var e=arguments;if("function"==typeof e[0]||"function"==typeof e[1]){return t.apply(this,[arguments[2]]).then(function(t){if("function"==typeof e[0]){e[0].apply(null,[t])}},function(t){if("function"==typeof e[1]){e[1].apply(null,[t])}})}return t.apply(this,arguments)}});g=["setLocalDescription","setRemoteDescription","addIceCandidate"];g.forEach(function(e){var t=h.prototype[e];h.prototype[e]=function(){var e=arguments;if("function"==typeof e[1]||"function"==typeof e[2]){return t.apply(this,arguments).then(function(){if("function"==typeof e[1]){e[1].apply(null)}},function(t){if("function"==typeof e[2]){e[2].apply(null,[t])}})}return t.apply(this,arguments)}});["getStats"].forEach(function(e){var t=h.prototype[e];h.prototype[e]=function(){var e=arguments;if("function"==typeof e[1]){return t.apply(this,arguments).then(function(){if("function"==typeof e[1]){e[1].apply(null)}})}return t.apply(this,arguments)}});return h}},{sdp:2}],2:[function(e,t){'use strict';var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier();r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})};r.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})};r.getDescription=function(e){var t=r.splitSections(e);return t&&t[0]};r.getMediaSections=function(e){var t=r.splitSections(e);t.shift();return t};r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})};r.parseCandidate=function(e){var t;if(0===e.indexOf("a=candidate:")){t=e.substring(12).split(" ")}else{t=e.substring(10).split(" ")}for(var r={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},a=8;a<t.length;a+=2){switch(t[a]){case"raddr":r.relatedAddress=t[a+1];break;case"rport":r.relatedPort=parseInt(t[a+1],10);break;case"tcptype":r.tcpType=t[a+1];break;case"ufrag":r.ufrag=t[a+1];r.usernameFragment=t[a+1];break;default:r[t[a]]=t[a+1];break;}}return r};r.writeCandidate=function(e){var t=[e.foundation,e.component,e.protocol.toUpperCase(),e.priority,e.ip,e.port],r=e.type;t.push("typ");t.push(r);if("host"!==r&&e.relatedAddress&&e.relatedPort){t.push("raddr");t.push(e.relatedAddress);t.push("rport");t.push(e.relatedPort)}if(e.tcpType&&"tcp"===e.protocol.toLowerCase()){t.push("tcptype");t.push(e.tcpType)}if(e.usernameFragment||e.ufrag){t.push("ufrag");t.push(e.usernameFragment||e.ufrag)}return"candidate:"+t.join(" ")};r.parseIceOptions=function(e){return e.substr(14).split(" ")};r.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};t=t[0].split("/");r.name=t[0];r.clockRate=parseInt(t[1],10);r.channels=3===t.length?parseInt(t[2],10):1;r.numChannels=r.channels;return r};r.writeRtpMap=function(e){var t=e.payloadType;if(e.preferredPayloadType!==void 0){t=e.preferredPayloadType}var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"};r.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}};r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"};r.parseFmtp=function(e){for(var t={},r,a=e.substr(e.indexOf(" ")+1).split(";"),n=0;n<a.length;n++){r=a[n].trim().split("=");t[r[0].trim()]=r[1]}return t};r.writeFmtp=function(e){var t="",r=e.payloadType;if(e.preferredPayloadType!==void 0){r=e.preferredPayloadType}if(e.parameters&&Object.keys(e.parameters).length){var a=[];Object.keys(e.parameters).forEach(function(t){if(e.parameters[t]){a.push(t+"="+e.parameters[t])}else{a.push(t)}});t+="a=fmtp:"+r+" "+a.join(";")+"\r\n"}return t};r.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}};r.writeRtcpFb=function(e){var t="",r=e.payloadType;if(e.preferredPayloadType!==void 0){r=e.preferredPayloadType}if(e.rtcpFeedback&&e.rtcpFeedback.length){e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})}return t};r.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},a=e.indexOf(":",t);if(-1<a){r.attribute=e.substr(t+1,a-t-1);r.value=e.substr(a+1)}else{r.attribute=e.substr(t+1)}return r};r.getMid=function(e){var t=r.matchPrefix(e,"a=mid:")[0];if(t){return t.substr(6)}};r.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}};r.getDtlsParameters=function(e,t){var a=r.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:a.map(r.parseFingerprint)}};r.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"});return r};r.getIceParameters=function(e,t){var a=r.splitLines(e);a=a.concat(r.splitLines(t));var n={usernameFragment:a.filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:a.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)};return n};r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"};r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=r.splitLines(e),n=a[0].split(" "),o=3;o<n.length;o++){var s=n[o],c=r.matchPrefix(e,"a=rtpmap:"+s+" ")[0];if(c){var d=r.parseRtpMap(c),p=r.matchPrefix(e,"a=fmtp:"+s+" ");d.parameters=p.length?r.parseFmtp(p[0]):{};d.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+s+" ").map(r.parseRtcpFb);t.codecs.push(d);switch(d.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(d.name.toUpperCase());break;default:break;}}}r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))});return t};r.writeRtpDescription=function(e,t){var a="";a+="m="+e+" ";a+=0<t.codecs.length?"9":"0";a+=" UDP/TLS/RTP/SAVPF ";a+=t.codecs.map(function(e){if(e.preferredPayloadType!==void 0){return e.preferredPayloadType}return e.payloadType}).join(" ")+"\r\n";a+="c=IN IP4 0.0.0.0\r\n";a+="a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){a+=r.writeRtpMap(e);a+=r.writeFmtp(e);a+=r.writeRtcpFb(e)});var n=0;t.codecs.forEach(function(e){if(e.maxptime>n){n=e.maxptime}});if(0<n){a+="a=maxptime:"+n+"\r\n"}a+="a=rtcp-mux\r\n";if(t.headerExtensions){t.headerExtensions.forEach(function(e){a+=r.writeExtmap(e)})}return a};r.parseRtpEncodingParameters=function(e){var t=[],a=r.parseRtpParameters(e),n=-1!==a.fecMechanisms.indexOf("RED"),i=-1!==a.fecMechanisms.indexOf("ULPFEC"),o=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<o.length&&o[0].ssrc,c,d=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.substr(17).split(" ");return t.map(function(e){return parseInt(e,10)})});if(0<d.length&&1<d[0].length&&d[0][0]===s){c=d[0][1]}a.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var r={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};if(s&&c){r.rtx={ssrc:c}}t.push(r);if(n){r=JSON.parse(JSON.stringify(r));r.fec={ssrc:c,mechanism:i?"red+ulpfec":"red"};t.push(r)}}});if(0===t.length&&s){t.push({ssrc:s})}var p=r.matchPrefix(e,"b=");if(p.length){if(0===p[0].indexOf("b=TIAS:")){p=parseInt(p[0].substr(7),10)}else if(0===p[0].indexOf("b=AS:")){p=.95*(1e3*parseInt(p[0].substr(5),10))-16000}else{p=void 0}t.forEach(function(e){e.maxBitrate=p})}return t};r.parseRtcpParameters=function(e){var t={},a=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];if(a){t.cname=a.value;t.ssrc=a.ssrc}var n=r.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length;t.compound=0===n.length;var i=r.matchPrefix(e,"a=rtcp-mux");t.mux=0<i.length;return t};r.parseMsid=function(e){var t,a=r.matchPrefix(e,"a=msid:");if(1===a.length){t=a[0].substr(7).split(" ");return{stream:t[0],track:t[1]}}var n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});if(0<n.length){t=n[0].value.split(" ");return{stream:t[0],track:t[1]}}};r.generateSessionId=function(){return Math.random().toString().substr(2,21)};r.writeSessionBoilerplate=function(e,t){var a,n=t!==void 0?t:2;if(e){a=e}else{a=r.generateSessionId()}return"v=0\r\no=thisisadapterortc "+a+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"};r.writeMediaSection=function(e,t,a,n){var i=r.writeRtpDescription(e.kind,t);i+=r.writeIceParameters(e.iceGatherer.getLocalParameters());i+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===a?"actpass":"active");i+="a=mid:"+e.mid+"\r\n";if(e.direction){i+="a="+e.direction+"\r\n"}else if(e.rtpSender&&e.rtpReceiver){i+="a=sendrecv\r\n"}else if(e.rtpSender){i+="a=sendonly\r\n"}else if(e.rtpReceiver){i+="a=recvonly\r\n"}else{i+="a=inactive\r\n"}if(e.rtpSender){var o="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+o;i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o;if(e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o;i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"}return i};r.getDirection=function(e,t){for(var a=r.splitLines(e),n=0;n<a.length;n++){switch(a[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return a[n].substr(2);default:}}if(t){return r.getDirection(t)}return"sendrecv"};r.getKind=function(e){var t=r.splitLines(e),a=t[0].split(" ");return a[0].substr(2)};r.isRejected=function(e){return"0"===e.split(" ",2)[1]};r.parseMLine=function(e){var t=r.splitLines(e),a=t[0].substr(2).split(" ");return{kind:a[0],port:parseInt(a[1],10),protocol:a[2],fmt:a.slice(3).join(" ")}};r.parseOLine=function(e){var t=r.matchPrefix(e,"o=")[0],a=t.substr(2).split(" ");return{username:a[0],sessionId:a[1],sessionVersion:parseInt(a[2],10),netType:a[3],addressType:a[4],address:a[5]}};if("object"===_typeof(t)){t.exports=r}},{}],3:[function(e,t){(function(r){'use strict';var a=e("./adapter_factory.js");t.exports=a({window:r.window})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":4}],4:[function(e,t){'use strict';var r=e("./utils");t.exports=function(t,a){var n=t&&t.window,i={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var o in a){if(hasOwnProperty.call(a,o)){i[o]=a[o]}}var s=r.log,c=r.detectBrowser(n),d=e("./chrome/chrome_shim")||null,p=e("./edge/edge_shim")||null,m=e("./firefox/firefox_shim")||null,l=e("./safari/safari_shim")||null,h=e("./common_shim")||null,g={browserDetails:c,commonShim:h,extractVersion:r.extractVersion,disableLog:r.disableLog,disableWarnings:r.disableWarnings};switch(c.browser){case"chrome":if(!d||!d.shimPeerConnection||!i.shimChrome){s("Chrome shim is not included in this adapter release.");return g}s("adapter.js shimming chrome.");g.browserShim=d;h.shimCreateObjectURL(n);d.shimGetUserMedia(n);d.shimMediaStream(n);d.shimSourceObject(n);d.shimPeerConnection(n);d.shimOnTrack(n);d.shimAddTrackRemoveTrack(n);d.shimGetSendersWithDtmf(n);d.shimSenderReceiverGetStats(n);h.shimRTCIceCandidate(n);h.shimMaxMessageSize(n);h.shimSendThrowTypeError(n);break;case"firefox":if(!m||!m.shimPeerConnection||!i.shimFirefox){s("Firefox shim is not included in this adapter release.");return g}s("adapter.js shimming firefox.");g.browserShim=m;h.shimCreateObjectURL(n);m.shimGetUserMedia(n);m.shimSourceObject(n);m.shimPeerConnection(n);m.shimOnTrack(n);m.shimRemoveStream(n);m.shimSenderGetStats(n);m.shimReceiverGetStats(n);m.shimRTCDataChannel(n);h.shimRTCIceCandidate(n);h.shimMaxMessageSize(n);h.shimSendThrowTypeError(n);break;case"edge":if(!p||!p.shimPeerConnection||!i.shimEdge){s("MS edge shim is not included in this adapter release.");return g}s("adapter.js shimming edge.");g.browserShim=p;h.shimCreateObjectURL(n);p.shimGetUserMedia(n);p.shimPeerConnection(n);p.shimReplaceTrack(n);h.shimMaxMessageSize(n);h.shimSendThrowTypeError(n);break;case"safari":if(!l||!i.shimSafari){s("Safari shim is not included in this adapter release.");return g}s("adapter.js shimming safari.");g.browserShim=l;h.shimCreateObjectURL(n);l.shimRTCIceServerUrls(n);l.shimCallbacksAPI(n);l.shimLocalStreamsAPI(n);l.shimRemoteStreamsAPI(n);l.shimTrackEventTransceiver(n);l.shimGetUserMedia(n);l.shimCreateOfferLegacy(n);h.shimRTCIceCandidate(n);h.shimMaxMessageSize(n);h.shimSendThrowTypeError(n);break;default:s("Unsupported browser!");break;}return g}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":11,"./safari/safari_shim":13,"./utils":14}],5:[function(e,t){'use strict';var n=e("../utils.js"),i=n.log;function r(e,t,a){if(!t||a.has(t.id)){return}a.set(t.id,t);Object.keys(t).forEach(function(n){if(n.endsWith("Id")){r(e,e.get(t[n]),a)}else if(n.endsWith("Ids")){t[n].forEach(function(t){r(e,e.get(t),a)})}})}function a(e,t,a){var n=a?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t){return i}var o=[];e.forEach(function(e){if("track"===e.type&&e.trackIdentifier===t.id){o.push(e)}});o.forEach(function(t){e.forEach(function(a){if(a.type===n&&a.trackId===t.id){r(e,a,i)}})});return i}t.exports={shimGetUserMedia:e("./getusermedia"),shimMediaStream:function shimMediaStream(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function shimOnTrack(t){if("object"===_typeof(t)&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get:function get(){return this._ontrack},set:function set(e){if(this._ontrack){this.removeEventListener("track",this._ontrack)}this.addEventListener("track",this._ontrack=e)}});var r=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){var a=this;if(!a._ontrackpoly){a._ontrackpoly=function(r){r.stream.addEventListener("addtrack",function(e){var n;if(t.RTCPeerConnection.prototype.getReceivers){n=a.getReceivers().find(function(t){return t.track&&t.track.id===e.track.id})}else{n={track:e.track}}var i=new Event("track");i.track=e.track;i.receiver=n;i.transceiver={receiver:n};i.streams=[r.stream];a.dispatchEvent(i)});r.stream.getTracks().forEach(function(e){var n;if(t.RTCPeerConnection.prototype.getReceivers){n=a.getReceivers().find(function(t){return t.track&&t.track.id===e.id})}else{n={track:e}}var i=new Event("track");i.track=e;i.receiver=n;i.transceiver={receiver:n};i.streams=[r.stream];a.dispatchEvent(i)})};a.addEventListener("addstream",a._ontrackpoly)}return r.apply(a,arguments)}}else if(!("RTCRtpTransceiver"in t)){n.wrapPeerConnectionEvent(t,"track",function(t){if(!t.transceiver){t.transceiver={receiver:t.receiver}}return t})}},shimGetSendersWithDtmf:function shimGetSendersWithDtmf(e){if("object"===_typeof(e)&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){if(this._dtmf===void 0){if("audio"===t.kind){this._dtmf=e.createDTMFSender(t)}else{this._dtmf=null}}return this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var r=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e){var a=this,n=r.apply(a,arguments);if(!n){n=t(a,e);a._senders.push(n)}return n};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;a.apply(t,arguments);var r=t._senders.indexOf(e);if(-1!==r){t._senders.splice(r,1)}}}var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;r._senders=r._senders||[];n.apply(r,[e]);e.getTracks().forEach(function(e){r._senders.push(t(r,e))})};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[];i.apply(t,[e]);e.getTracks().forEach(function(e){var r=t._senders.find(function(t){return t.track===e});if(r){t._senders.splice(t._senders.indexOf(r),1)}})}}else if("object"===_typeof(e)&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=o.apply(e,[]);t.forEach(function(t){t._pc=e});return t};Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function get(){if(this._dtmf===void 0){if("audio"===this.track.kind){this._dtmf=this._pc.createDTMFSender(this.track)}else{this._dtmf=null}}return this._dtmf}})}},shimSenderReceiverGetStats:function shimSenderReceiverGetStats(e){if(!("object"===_typeof(e)&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver)){return}if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;if(t){e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);r.forEach(function(t){t._pc=e});return r}}var r=e.RTCPeerConnection.prototype.addTrack;if(r){e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);e._pc=this;return e}}e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return a(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var i=e.RTCPeerConnection.prototype.getReceivers;if(i){e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=i.apply(e,[]);t.forEach(function(t){t._pc=e});return t}}n.wrapPeerConnectionEvent(e,"track",function(t){t.receiver._pc=t.srcElement;return t});e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return a(t,e.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype)){return}var o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var t=this;if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var a=arguments[0],n,i,s;t.getSenders().forEach(function(e){if(e.track===a){if(n){s=!0}else{n=e}}});t.getReceivers().forEach(function(e){if(e.track===a){if(i){s=!0}else{i=e}}return e.track===a});if(s||n&&i){return Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError"))}else if(n){return n.getStats()}else if(i){return i.getStats()}return Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(t,arguments)}},shimSourceObject:function shimSourceObject(e){var t=e&&e.URL;if("object"===_typeof(e)){if(e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)){Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function get(){return this._srcObject},set:function set(e){var r=this;this._srcObject=e;if(this.src){t.revokeObjectURL(this.src)}if(!e){this.src="";return}this.src=t.createObjectURL(e);e.addEventListener("addtrack",function(){if(r.src){t.revokeObjectURL(r.src)}r.src=t.createObjectURL(e)});e.addEventListener("removetrack",function(){if(r.src){t.revokeObjectURL(r.src)}r.src=t.createObjectURL(e)})}})}}},shimAddTrackRemoveTrackWithNative:function shimAddTrackRemoveTrackWithNative(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){if(!r){return t.apply(this,arguments)}this._shimmedLocalStreams=this._shimmedLocalStreams||{};var a=t.apply(this,arguments);if(!this._shimmedLocalStreams[r.id]){this._shimmedLocalStreams[r.id]=[r,a]}else if(-1===this._shimmedLocalStreams[r.id].indexOf(a)){this._shimmedLocalStreams[r.id].push(a)}return a};var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};e.getTracks().forEach(function(e){var r=t.getSenders().find(function(t){return t.track===e});if(r){throw new DOMException("Track already exists.","InvalidAccessError")}});var a=t.getSenders();r.apply(this,arguments);var n=t.getSenders().filter(function(e){return-1===a.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(n)};var a=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[e.id];return a.apply(this,arguments)};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};if(e){Object.keys(this._shimmedLocalStreams).forEach(function(r){var a=t._shimmedLocalStreams[r].indexOf(e);if(-1!==a){t._shimmedLocalStreams[r].splice(a,1)}if(1===t._shimmedLocalStreams[r].length){delete t._shimmedLocalStreams[r]}})}return n.apply(this,arguments)}},shimAddTrackRemoveTrack:function shimAddTrackRemoveTrack(e){var a=n.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&65<=a.version){return this.shimAddTrackRemoveTrackWithNative(e)}var i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=i.apply(this);e._reverseStreams=e._reverseStreams||{};return t.map(function(t){return e._reverseStreams[t.id]})};var o=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;r._streams=r._streams||{};r._reverseStreams=r._reverseStreams||{};t.getTracks().forEach(function(e){var t=r.getSenders().find(function(t){return t.track===e});if(t){throw new DOMException("Track already exists.","InvalidAccessError")}});if(!r._reverseStreams[t.id]){var a=new e.MediaStream(t.getTracks());r._streams[t.id]=a;r._reverseStreams[a.id]=t;t=a}o.apply(r,[t])};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{};t._reverseStreams=t._reverseStreams||{};s.apply(t,[t._streams[e.id]||e]);delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id];delete t._streams[e.id]};e.RTCPeerConnection.prototype.addTrack=function(r,a){var n=this;if("closed"===n.signalingState){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}var t=[].slice.call(arguments,1);if(1!==t.length||!t[0].getTracks().find(function(e){return e===r})){throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError")}var i=n.getSenders().find(function(e){return e.track===r});if(i){throw new DOMException("Track already exists.","InvalidAccessError")}n._streams=n._streams||{};n._reverseStreams=n._reverseStreams||{};var o=n._streams[a.id];if(o){o.addTrack(r);Promise.resolve().then(function(){n.dispatchEvent(new Event("negotiationneeded"))})}else{var s=new e.MediaStream([r]);n._streams[a.id]=s;n._reverseStreams[s.id]=a;n.addStream(s)}return n.getSenders().find(function(e){return e.track===r})};function t(e,t){var r=t.sdp;Object.keys(e._reverseStreams||[]).forEach(function(t){var a=e._reverseStreams[t],n=e._streams[a.id];r=r.replace(new RegExp(n.id,"g"),a.id)});return new RTCSessionDescription({type:t.type,sdp:r})}function r(e,t){var r=t.sdp;Object.keys(e._reverseStreams||[]).forEach(function(t){var a=e._reverseStreams[t],n=e._streams[a.id];r=r.replace(new RegExp(a.id,"g"),n.id)});return new RTCSessionDescription({type:t.type,sdp:r})}["createOffer","createAnswer"].forEach(function(r){var a=e.RTCPeerConnection.prototype[r];e.RTCPeerConnection.prototype[r]=function(){var e=this,r=arguments,n=arguments.length&&"function"==typeof arguments[0];if(n){return a.apply(e,[function(a){var n=t(e,a);r[0].apply(null,[n])},function(e){if(r[1]){r[1].apply(null,e)}},arguments[2]])}return a.apply(e,arguments).then(function(r){return t(e,r)})}});var c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;if(!arguments.length||!arguments[0].type){return c.apply(e,arguments)}arguments[0]=r(e,arguments[0]);return c.apply(e,arguments)};var d=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function get(){var e=this,r=d.get.apply(this);if(""===r.type){return r}return t(e,r)}});e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===t.signalingState){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}if(!e._pc){throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError")}var r=e._pc===t;if(!r){throw new DOMException("Sender was not created by this connection.","InvalidAccessError")}t._streams=t._streams||{};var a;Object.keys(t._streams).forEach(function(r){var n=t._streams[r].getTracks().find(function(t){return e.track===t});if(n){a=t._streams[r]}});if(a){if(1===a.getTracks().length){t.removeStream(t._reverseStreams[a.id])}else{a.removeTrack(e.track)}t.dispatchEvent(new Event("negotiationneeded"))}}},shimPeerConnection:function shimPeerConnection(e){var t=n.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection){e.RTCPeerConnection=function(t,r){i("PeerConnection");if(t&&t.iceTransportPolicy){t.iceTransports=t.iceTransportPolicy}return new e.webkitRTCPeerConnection(t,r)};e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype;if(e.webkitRTCPeerConnection.generateCertificate){Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function get(){return e.webkitRTCPeerConnection.generateCertificate}})}}else{var r=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var a=[],o=0,s;o<e.iceServers.length;o++){s=e.iceServers[o];if(!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")){n.deprecated("RTCIceServer.url","RTCIceServer.urls");s=JSON.parse(JSON.stringify(s));s.urls=s.url;a.push(s)}else{a.push(e.iceServers[o])}}e.iceServers=a}return new r(e,t)};e.RTCPeerConnection.prototype=r.prototype;Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function get(){return r.generateCertificate}})}var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var n=this,i=arguments;if(0<arguments.length&&"function"==typeof e){return a.apply(this,arguments)}if(0===a.length&&(0===arguments.length||"function"!=typeof arguments[0])){return a.apply(this,[])}var o=function(e){var t={},r=e.result();r.forEach(function(e){var r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){r[t]=e.stat(t)});t[r.id]=r});return t},s=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(2<=arguments.length){var c=function(e){i[1](s(o(e)))};return a.apply(this,[c,arguments[0]])}return new Promise(function(e,t){a.apply(n,[function(t){e(s(o(t)))},t])}).then(t,r)};if(51>t.version){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,a=new Promise(function(a,n){r.apply(t,[e[0],a,n])});if(2>e.length){return a}return a.then(function(){e[1].apply(null,[])},function(t){if(3<=e.length){e[2].apply(null,[t])}})}})}if(52>t.version){["createOffer","createAnswer"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(1>arguments.length||1===arguments.length&&"object"===_typeof(arguments[0])){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(a,n){r.apply(e,[a,n,t])})}return r.apply(this,arguments)}})}["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]);return r.apply(this,arguments)}});var o=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}return o.apply(this,arguments)}}}},{"../utils.js":14,"./getusermedia":6}],6:[function(e,t){'use strict';var r=e("../utils.js"),a=r.log;t.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,i=function(e){if("object"!==_typeof(e)||e.mandatory||e.optional){return e}var t={};Object.keys(e).forEach(function(a){if("require"===a||"advanced"===a||"mediaSource"===a){return}var n="object"===_typeof(e[a])?e[a]:{ideal:e[a]};if(n.exact!==void 0&&"number"==typeof n.exact){n.min=n.max=n.exact}var r=function(e,t){if(e){return e+t.charAt(0).toUpperCase()+t.slice(1)}return"deviceId"===t?"sourceId":t};if(n.ideal!==void 0){t.optional=t.optional||[];var i={};if("number"==typeof n.ideal){i[r("min",a)]=n.ideal;t.optional.push(i);i={};i[r("max",a)]=n.ideal;t.optional.push(i)}else{i[r("",a)]=n.ideal;t.optional.push(i)}}if(n.exact!==void 0&&"number"!=typeof n.exact){t.mandatory=t.mandatory||{};t.mandatory[r("",a)]=n.exact}else{["min","max"].forEach(function(e){if(n[e]!==void 0){t.mandatory=t.mandatory||{};t.mandatory[r(e,a)]=n[e]}})}});if(e.advanced){t.optional=(t.optional||[]).concat(e.advanced)}return t},o=function(e,r){if(61<=t.version){return r(e)}e=JSON.parse(JSON.stringify(e));if(e&&"object"===_typeof(e.audio)){var o=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}};e=JSON.parse(JSON.stringify(e));o(e.audio,"autoGainControl","googAutoGainControl");o(e.audio,"noiseSuppression","googNoiseSuppression");e.audio=i(e.audio)}if(e&&"object"===_typeof(e.video)){var s=e.video.facingMode;s=s&&("object"===_typeof(s)?s:{ideal:s});var c=66>t.version;if(s&&("user"===s.exact||"environment"===s.exact||"user"===s.ideal||"environment"===s.ideal)&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete e.video.facingMode;var p;if("environment"===s.exact||"environment"===s.ideal){p=["back","rear"]}else if("user"===s.exact||"user"===s.ideal){p=["front"]}if(p){return n.mediaDevices.enumerateDevices().then(function(t){t=t.filter(function(e){return"videoinput"===e.kind});var n=t.find(function(e){return p.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});if(!n&&t.length&&-1!==p.indexOf("back")){n=t[t.length-1]}if(n){e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}}e.video=i(e.video);a("chrome: "+JSON.stringify(e));return r(e)})}}e.video=i(e.video)}a("chrome: "+JSON.stringify(e));return r(e)},s=function(t){return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[t.name]||t.name,message:t.message,constraint:t.constraintName,toString:function toString(){return this.name+(this.message&&": ")+this.message}}};n.getUserMedia=function getUserMedia_(e,t,r){o(e,function(e){n.webkitGetUserMedia(e,t,function(t){if(r){r(s(t))}})})};var c=function(e){return new Promise(function(t,r){n.getUserMedia(e,t,r)})};if(!n.mediaDevices){n.mediaDevices={getUserMedia:c,enumerateDevices:function enumerateDevices(){return new Promise(function(t){var r={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:r[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function getSupportedConstraints(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}}if(!n.mediaDevices.getUserMedia){n.mediaDevices.getUserMedia=function(e){return c(e)}}else{var d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return o(e,function(e){return d(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length){t.getTracks().forEach(function(e){e.stop()});throw new DOMException("","NotFoundError")}return t},function(t){return Promise.reject(s(t))})})}}if("undefined"==typeof n.mediaDevices.addEventListener){n.mediaDevices.addEventListener=function(){a("Dummy mediaDevices.addEventListener called.")}}if("undefined"==typeof n.mediaDevices.removeEventListener){n.mediaDevices.removeEventListener=function(){a("Dummy mediaDevices.removeEventListener called.")}}}},{"../utils.js":14}],7:[function(e,t){'use strict';var r=e("sdp"),a=e("./utils");t.exports={shimRTCIceCandidate:function shimRTCIceCandidate(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype){return}var n=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if("object"===_typeof(e)&&e.candidate&&0===e.candidate.indexOf("a=")){e=JSON.parse(JSON.stringify(e));e.candidate=e.candidate.substr(2)}if(e.candidate&&e.candidate.length){var t=new n(e),a=r.parseCandidate(e.candidate),i=Object.assign(t,a);i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}};return i}return new n(e)};t.RTCIceCandidate.prototype=n.prototype;a.wrapPeerConnectionEvent(t,"icecandidate",function(r){if(r.candidate){Object.defineProperty(r,"candidate",{value:new t.RTCIceCandidate(r.candidate),writable:"false"})}return r})},shimCreateObjectURL:function shimCreateObjectURL(e){var t=e&&e.URL;if(!("object"===_typeof(e)&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL)){return}var r=t.createObjectURL.bind(t),n=t.revokeObjectURL.bind(t),i=new Map,o=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++o;i.set(t,e);a.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream");return t}return r(e)};t.revokeObjectURL=function(e){n(e);i.delete(e)};var s=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function get(){return s.get.apply(this)},set:function set(e){this.srcObject=i.get(e)||null;return s.set.apply(this,[e])}});var c=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){if(2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()){this.srcObject=i.get(arguments[1])||null}return c.apply(this,arguments)}},shimMaxMessageSize:function shimMaxMessageSize(e){if(e.RTCSctpTransport||!e.RTCPeerConnection){return}var t=a.detectBrowser(e);if(!("sctp"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function get(){return"undefined"==typeof this._sctp?null:this._sctp}})}var n=function(e){var t=r.splitSections(e.sdp);t.shift();return t.some(function(e){var t=r.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},i=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||2>t.length){return-1}var r=parseInt(t[1],10);return r!==r?-1:r},o=function(e){var r=65536;if("firefox"===t.browser){if(57>t.version){if(-1===e){r=16384}else{r=2147483637}}else if(60>t.version){r=57===t.version?65535:65536}else{r=2147483637}}return r},s=function(e,a){var n=65536;if("firefox"===t.browser&&57===t.version){n=65535}var i=r.matchPrefix(e.sdp,"a=max-message-size:");if(0<i.length){n=parseInt(i[0].substr(19),10)}else if("firefox"===t.browser&&-1!==a){n=2147483637}return n},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;e._sctp=null;if(n(arguments[0])){var t=i(arguments[0]),r=o(t),a=s(arguments[0],t),d;if(0===r&&0===a){d=Number.POSITIVE_INFINITY}else if(0===r||0===a){d=Math.max(r,a)}else{d=Math.min(r,a)}var p={};Object.defineProperty(p,"maxMessageSize",{get:function get(){return d}});e._sctp=p}return c.apply(e,arguments)}},shimSendThrowTypeError:function shimSendThrowTypeError(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype)){return}function t(e,t){var r=e.send;e.send=function(){var a=arguments[0],n=a.length||a.size||a.byteLength;if("open"===e.readyState&&t.sctp&&n>t.sctp.maxMessageSize){throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)")}return r.apply(e,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=this,a=r.apply(e,arguments);t(a,e);return a};a.wrapPeerConnectionEvent(e,"datachannel",function(r){t(r.channel,r.target);return r})}}},{"./utils":14,sdp:2}],8:[function(e,t){'use strict';var r=e("../utils"),a=e("./filtericeservers"),n=e("rtcpeerconnection-shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function shimPeerConnection(e){var t=r.detectBrowser(e);if(e.RTCIceGatherer){if(!e.RTCIceCandidate){e.RTCIceCandidate=function(e){return e}}if(!e.RTCSessionDescription){e.RTCSessionDescription=function(e){return e}}if(15025>t.version){var i=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function set(e){i.set.call(this,e);var t=new Event("enabled");t.enabled=e;this.dispatchEvent(t)}})}}if(e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function get(){if(this._dtmf===void 0){if("audio"===this.track.kind){this._dtmf=new e.RTCDtmfSender(this)}else if("video"===this.track.kind){this._dtmf=null}}return this._dtmf}})}if(e.RTCDtmfSender&&!e.RTCDTMFSender){e.RTCDTMFSender=e.RTCDtmfSender}var o=n(e,t.version);e.RTCPeerConnection=function(e){if(e&&e.iceServers){e.iceServers=a(e.iceServers)}return new o(e)};e.RTCPeerConnection.prototype=o.prototype},shimReplaceTrack:function shimReplaceTrack(e){if(e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)){e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack}}}},{"../utils":14,"./filtericeservers":9,"./getusermedia":10,"rtcpeerconnection-shim":1}],9:[function(e,t){'use strict';var r=e("../utils");t.exports=function(e,t){var a=!1;e=JSON.parse(JSON.stringify(e));return e.filter(function(e){if(e&&(e.urls||e.url)){var n=e.urls||e.url;if(e.url&&!e.urls){r.deprecated("RTCIceServer.url","RTCIceServer.urls")}var i="string"==typeof n;if(i){n=[n]}n=n.filter(function(e){var r=0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!a;if(r){a=!0;return!0}return 0===e.indexOf("stun:")&&14393<=t&&-1===e.indexOf("?transport=udp")});delete e.url;e.urls=i?n[0]:n;return!!n.length}})}},{"../utils":14}],10:[function(e,t){'use strict';t.exports=function(e){var t=e&&e.navigator,r=function(t){return{name:{PermissionDeniedError:"NotAllowedError"}[t.name]||t.name,message:t.message,constraint:t.constraint,toString:function toString(){return this.name}}},a=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return a(e).catch(function(t){return Promise.reject(r(t))})}}},{}],11:[function(e,t){'use strict';var r=e("../utils");t.exports={shimGetUserMedia:e("./getusermedia"),shimOnTrack:function shimOnTrack(e){if("object"===_typeof(e)&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function get(){return this._ontrack},set:function set(e){if(this._ontrack){this.removeEventListener("track",this._ontrack);this.removeEventListener("addstream",this._ontrackpoly)}this.addEventListener("track",this._ontrack=e);this.addEventListener("addstream",this._ontrackpoly=function(t){t.stream.getTracks().forEach(function(e){var r=new Event("track");r.track=e;r.receiver={track:e};r.transceiver={receiver:r.receiver};r.streams=[t.stream];this.dispatchEvent(r)}.bind(this))}.bind(this))}})}if("object"===_typeof(e)&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function get(){return{receiver:this.receiver}}})}},shimSourceObject:function shimSourceObject(e){if("object"===_typeof(e)){if(e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)){Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function get(){return this.mozSrcObject},set:function set(e){this.mozSrcObject=e}})}}},shimPeerConnection:function shimPeerConnection(e){var t=r.detectBrowser(e);if("object"!==_typeof(e)||!(e.RTCPeerConnection||e.mozRTCPeerConnection)){return}if(!e.RTCPeerConnection){e.RTCPeerConnection=function(r,a){if(38>t.version){if(r&&r.iceServers){for(var n=[],o=0,s;o<r.iceServers.length;o++){s=r.iceServers[o];if(s.hasOwnProperty("urls")){for(var c=0,d;c<s.urls.length;c++){d={url:s.urls[c]};if(0===s.urls[c].indexOf("turn")){d.username=s.username;d.credential=s.credential}n.push(d)}}else{n.push(r.iceServers[o])}}r.iceServers=n}}return new e.mozRTCPeerConnection(r,a)};e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype;if(e.mozRTCPeerConnection.generateCertificate){Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function get(){return e.mozRTCPeerConnection.generateCertificate}})}e.RTCSessionDescription=e.mozRTCSessionDescription;e.RTCIceCandidate=e.mozRTCIceCandidate}["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var r=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]);return r.apply(this,arguments)}});var a=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}return a.apply(this,arguments)};var n=function(e){var t=new Map;Object.keys(e).forEach(function(r){t.set(r,e[r]);t[r]=e[r]});return t},o={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,r,a){return s.apply(this,[e||null]).then(function(a){if(48>t.version){a=n(a)}if(53>t.version&&!r){try{a.forEach(function(e){e.type=o[e.type]||e.type})}catch(t){if("TypeError"!==t.name){throw t}a.forEach(function(e,t){a.set(t,Object.assign({},e,{type:o[e.type]||e.type}))})}}return a}).then(r,a)}},shimSenderGetStats:function shimSenderGetStats(e){if(!("object"===_typeof(e)&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype){return}var t=e.RTCPeerConnection.prototype.getSenders;if(t){e.RTCPeerConnection.prototype.getSenders=function(){var e=this,r=t.apply(e,[]);r.forEach(function(t){t._pc=e});return r}}var r=e.RTCPeerConnection.prototype.addTrack;if(r){e.RTCPeerConnection.prototype.addTrack=function(){var e=r.apply(this,arguments);e._pc=this;return e}}e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},shimReceiverGetStats:function shimReceiverGetStats(e){if(!("object"===_typeof(e)&&e.RTCPeerConnection&&e.RTCRtpSender)){return}if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype){return}var t=e.RTCPeerConnection.prototype.getReceivers;if(t){e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,r=t.apply(e,[]);r.forEach(function(t){t._pc=e});return r}}r.wrapPeerConnectionEvent(e,"track",function(t){t.receiver._pc=t.srcElement;return t});e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},shimRemoveStream:function shimRemoveStream(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype){return}e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;r.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(r){if(r.track&&-1!==e.getTracks().indexOf(r.track)){t.removeTrack(r)}})}},shimRTCDataChannel:function shimRTCDataChannel(e){if(e.DataChannel&&!e.RTCDataChannel){e.RTCDataChannel=e.DataChannel}}}},{"../utils":14,"./getusermedia":12}],12:[function(e,t){'use strict';var r=e("../utils"),a=r.log;t.exports=function(e){var t=r.detectBrowser(e),n=e&&e.navigator,i=e&&e.MediaStreamTrack,o=function(t){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[t.name]||t.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[t.message]||t.message,constraint:t.constraint,toString:function toString(){return this.name+(this.message&&": ")+this.message}}},s=function(e,r,i){var s=function(e){if("object"!==_typeof(e)||e.require){return e}var t=[];Object.keys(e).forEach(function(a){if("require"===a||"advanced"===a||"mediaSource"===a){return}var n=e[a]="object"===_typeof(e[a])?e[a]:{ideal:e[a]};if(n.min!==void 0||n.max!==void 0||n.exact!==void 0){t.push(a)}if(n.exact!==void 0){if("number"==typeof n.exact){n.min=n.max=n.exact}else{e[a]=n.exact}delete n.exact}if(n.ideal!==void 0){e.advanced=e.advanced||[];var r={};if("number"==typeof n.ideal){r[a]={min:n.ideal,max:n.ideal}}else{r[a]=n.ideal}e.advanced.push(r);delete n.ideal;if(!Object.keys(n).length){delete e[a]}}});if(t.length){e.require=t}return e};e=JSON.parse(JSON.stringify(e));if(38>t.version){a("spec: "+JSON.stringify(e));if(e.audio){e.audio=s(e.audio)}if(e.video){e.video=s(e.video)}a("ff37: "+JSON.stringify(e))}return n.mozGetUserMedia(e,r,function(t){i(o(t))})},c=function(e){return new Promise(function(t,r){s(e,t,r)})};if(!n.mediaDevices){n.mediaDevices={getUserMedia:c,addEventListener:function addEventListener(){},removeEventListener:function removeEventListener(){}}}n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})};if(41>t.version){var d=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return d().then(void 0,function(t){if("NotFoundError"===t.name){return[]}throw t})}}if(49>t.version){var p=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return p(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length){t.getTracks().forEach(function(e){e.stop()});throw new DOMException("The object can not be found here.","NotFoundError")}return t},function(t){return Promise.reject(o(t))})}}if(!(55<t.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var m=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}},l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){if("object"===_typeof(e)&&"object"===_typeof(e.audio)){e=JSON.parse(JSON.stringify(e));m(e.audio,"autoGainControl","mozAutoGainControl");m(e.audio,"noiseSuppression","mozNoiseSuppression")}return l(e)};if(i&&i.prototype.getSettings){var h=i.prototype.getSettings;i.prototype.getSettings=function(){var e=h.apply(this,arguments);m(e,"mozAutoGainControl","autoGainControl");m(e,"mozNoiseSuppression","noiseSuppression");return e}}if(i&&i.prototype.applyConstraints){var g=i.prototype.applyConstraints;i.prototype.applyConstraints=function(e){if("audio"===this.kind&&"object"===_typeof(e)){e=JSON.parse(JSON.stringify(e));m(e,"autoGainControl","mozAutoGainControl");m(e,"noiseSuppression","mozNoiseSuppression")}return g.apply(this,[e])}}}n.getUserMedia=function(e,a,i){if(44>t.version){return s(e,a,i)}r.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");n.mediaDevices.getUserMedia(e).then(a,i)}}},{"../utils":14}],13:[function(e,t){'use strict';var r=e("../utils");t.exports={shimLocalStreamsAPI:function shimLocalStreamsAPI(e){if("object"!==_typeof(e)||!e.RTCPeerConnection){return}if(!("getLocalStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getLocalStreams=function(){if(!this._localStreams){this._localStreams=[]}return this._localStreams}}if(!("getStreamById"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;if(this._localStreams){this._localStreams.forEach(function(r){if(r.id===e){t=r}})}if(this._remoteStreams){this._remoteStreams.forEach(function(r){if(r.id===e){t=r}})}return t}}if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){if(!this._localStreams){this._localStreams=[]}if(-1===this._localStreams.indexOf(e)){this._localStreams.push(e)}var r=this;e.getTracks().forEach(function(a){t.call(r,a,e)})};e.RTCPeerConnection.prototype.addTrack=function(e,r){if(r){if(!this._localStreams){this._localStreams=[r]}else if(-1===this._localStreams.indexOf(r)){this._localStreams.push(r)}}return t.call(this,e,r)}}if(!("removeStream"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.removeStream=function(e){if(!this._localStreams){this._localStreams=[]}var t=this._localStreams.indexOf(e);if(-1===t){return}this._localStreams.splice(t,1);var r=this,a=e.getTracks();this.getSenders().forEach(function(e){if(-1!==a.indexOf(e.track)){r.removeTrack(e)}})}}},shimRemoteStreamsAPI:function shimRemoteStreamsAPI(e){if("object"!==_typeof(e)||!e.RTCPeerConnection){return}if(!("getRemoteStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}}if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function get(){return this._onaddstream},set:function set(e){var t=this;if(this._onaddstream){this.removeEventListener("addstream",this._onaddstream);this.removeEventListener("track",this._onaddstreampoly)}this.addEventListener("addstream",this._onaddstream=e);this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(function(e){if(!t._remoteStreams){t._remoteStreams=[]}if(0<=t._remoteStreams.indexOf(e)){return}t._remoteStreams.push(e);var r=new Event("addstream");r.stream=e;t.dispatchEvent(r)})})}})}},shimCallbacksAPI:function shimCallbacksAPI(e){if("object"!==_typeof(e)||!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype,r=t.createOffer,a=t.createAnswer,n=t.setLocalDescription,i=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){var a=2<=arguments.length?arguments[2]:arguments[0],n=r.apply(this,[a]);if(!t){return n}n.then(e,t);return Promise.resolve()};t.createAnswer=function(e,t){var r=2<=arguments.length?arguments[2]:arguments[0],n=a.apply(this,[r]);if(!t){return n}n.then(e,t);return Promise.resolve()};var s=function(e,t,r){var a=n.apply(this,[e]);if(!r){return a}a.then(t,r);return Promise.resolve()};t.setLocalDescription=s;s=function(e,t,r){var a=i.apply(this,[e]);if(!r){return a}a.then(t,r);return Promise.resolve()};t.setRemoteDescription=s;s=function(e,t,r){var a=o.apply(this,[e]);if(!r){return a}a.then(t,r);return Promise.resolve()};t.addIceCandidate=s},shimGetUserMedia:function shimGetUserMedia(e){var t=e&&e.navigator;if(!t.getUserMedia){if(t.webkitGetUserMedia){t.getUserMedia=t.webkitGetUserMedia.bind(t)}else if(t.mediaDevices&&t.mediaDevices.getUserMedia){t.getUserMedia=function(e,r,a){t.mediaDevices.getUserMedia(e).then(r,a)}.bind(t)}}},shimRTCIceServerUrls:function shimRTCIceServerUrls(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,a){if(e&&e.iceServers){for(var n=[],o=0,s;o<e.iceServers.length;o++){s=e.iceServers[o];if(!s.hasOwnProperty("urls")&&s.hasOwnProperty("url")){r.deprecated("RTCIceServer.url","RTCIceServer.urls");s=JSON.parse(JSON.stringify(s));s.urls=s.url;delete s.url;n.push(s)}else{n.push(e.iceServers[o])}}e.iceServers=n}return new t(e,a)};e.RTCPeerConnection.prototype=t.prototype;if("generateCertificate"in e.RTCPeerConnection){Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function get(){return t.generateCertificate}})}},shimTrackEventTransceiver:function shimTrackEventTransceiver(e){if("object"===_typeof(e)&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function get(){return{receiver:this.receiver}}})}},shimCreateOfferLegacy:function shimCreateOfferLegacy(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var r=this;if(e){if("undefined"!=typeof e.offerToReceiveAudio){e.offerToReceiveAudio=!!e.offerToReceiveAudio}var a=r.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});if(!1===e.offerToReceiveAudio&&a){if("sendrecv"===a.direction){if(a.setDirection){a.setDirection("sendonly")}else{a.direction="sendonly"}}else if("recvonly"===a.direction){if(a.setDirection){a.setDirection("inactive")}else{a.direction="inactive"}}}else if(!0===e.offerToReceiveAudio&&!a){r.addTransceiver("audio")}if("undefined"!=typeof e.offerToReceiveAudio){e.offerToReceiveVideo=!!e.offerToReceiveVideo}var n=r.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});if(!1===e.offerToReceiveVideo&&n){if("sendrecv"===n.direction){n.setDirection("sendonly")}else if("recvonly"===n.direction){n.setDirection("inactive")}}else if(!0===e.offerToReceiveVideo&&!n){r.addTransceiver("video")}}return t.apply(r,arguments)}}}},{"../utils":14}],14:[function(e,t){'use strict';var a=!0,n=!0;function r(e,t,r){var a=e.match(t);return a&&a.length>=r&&parseInt(a[r],10)}t.exports={extractVersion:r,wrapPeerConnectionEvent:function(e,t,r){if(!e.RTCPeerConnection){return}var a=e.RTCPeerConnection.prototype,n=a.addEventListener;a.addEventListener=function(e,a){if(e!==t){return n.apply(this,arguments)}var i=function(t){a(r(t))};this._eventMap=this._eventMap||{};this._eventMap[a]=i;return n.apply(this,[e,i])};var i=a.removeEventListener;a.removeEventListener=function(e,r){if(e!==t||!this._eventMap||!this._eventMap[r]){return i.apply(this,arguments)}var a=this._eventMap[r];delete this._eventMap[r];return i.apply(this,[e,a])};Object.defineProperty(a,"on"+t,{get:function get(){return this["_on"+t]},set:function set(e){if(this["_on"+t]){this.removeEventListener(t,this["_on"+t]);delete this["_on"+t]}if(e){this.addEventListener(t,this["_on"+t]=e)}},enumerable:!0,configurable:!0})},disableLog:function disableLog(e){if("boolean"!=typeof e){return new Error("Argument type: "+_typeof(e)+". Please use a boolean.")}a=e;return e?"adapter.js logging disabled":"adapter.js logging enabled"},disableWarnings:function disableWarnings(e){if("boolean"!=typeof e){return new Error("Argument type: "+_typeof(e)+". Please use a boolean.")}n=!e;return"adapter.js deprecation warnings "+(e?"disabled":"enabled")},log:function log(){if("object"===("undefined"==typeof window?"undefined":_typeof(window))){if(a){return}if("undefined"!=typeof console&&"function"==typeof console.log){console.log.apply(console,arguments)}}},deprecated:function deprecated(e,t){if(!n){return}console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function detectBrowser(e){var t=e&&e.navigator,a={};a.browser=null;a.version=null;if("undefined"==typeof e||!e.navigator){a.browser="Not a browser.";return a}if(t.mozGetUserMedia){a.browser="firefox";a.version=r(t.userAgent,/Firefox\/(\d+)\./,1)}else if(t.webkitGetUserMedia){a.browser="chrome";a.version=r(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)}else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/)){a.browser="edge";a.version=r(t.userAgent,/Edge\/(\d+).(\d+)$/,2)}else if(e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)){a.browser="safari";a.version=r(t.userAgent,/AppleWebKit\/(\d+)\./,1)}else{a.browser="Not a supported browser.";return a}return a}}},{}]},{},[3])(3)});
//# sourceMappingURL=adapter.min.js.map

define ("filter_poodll/anim_progress_radial",["jquery","core/log"],function(a,b){"use strict";b.debug("Radial Progress: initialising");return{playcanvas:null,context:null,x:null,y:null,currenttime:0,enabled:!1,showpercent:!1,drawparams:{lineWidth:10,barColor:"#ad2323",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:10,shadowColor:"#fff",font:"18px Arial",textAlign:"center",textBaseline:"middle"},clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c){this.playcanvas=a.get(0);this.x=this.playcanvas.width/2;this.y=this.playcanvas.height/2;this.context=this.playcanvas.getContext("2d");if(c){this.showpercent=c}if(c){this.setDrawParam("barColor",b)}},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.context.clearRect(0,0,this.playcanvas.width,this.playcanvas.height)},fetchCurrent:function fetchCurrent(){return 0},stop:function stop(){this.enabled=!1},start:function start(){this.clear();this.enabled=!0;var a=this;this.context.lineWidth=this.drawparams.lineWidth;this.context.strokeStyle=this.drawparams.barColor;this.context.setLineDash([]);this.context.shadowOffsetX=this.drawparams.shadowOffsetX;this.context.shadowOffsetY=this.drawparams.shadowOffsetY;this.context.shadowBlur=this.drawparams.shadowBlur;this.context.shadowColor=this.drawparams.shadowColor;this.context.font=this.drawparams.font;this.context.textAlign=this.drawparams.textAlign;this.context.textBaseline=this.drawparams.textBaseline;var b=function(){if(!a.enabled){return}a.clear();var c=Math.min(a.x,a.y)-a.context.lineWidth,d=2*Math.PI,e=Math.PI/2,f=a.fetchCurrent();a.context.beginPath();a.context.arc(a.x,a.y,c,-e,d*f-e,!1);if(a.showpercent){a.context.fillText(parseInt(100*f)+"%",a.x,a.y)}a.context.stroke();var g=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;g(b)};b()}}});
//# sourceMappingURL=anim_progress_radial.min.js.map

define ("filter_poodll/poodll_readseedmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/upskin_radial","filter_poodll/upskin_bar","filter_poodll/anim_hwave_mic","filter_poodll/dlg_devicesettings"],function(a,b,c,d,e,f,g,h){"use strict";c.debug("PoodLL Read Seed Skin: initialising");return{instanceprops:null,pmr:null,devsettings:null,therecanim:null,buttonmode:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=h.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(a){this.set_visual_mode("allfinished",a)},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" width=\"320\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+" hide\" playsInline muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return this.fetch_preview_audio(a)},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+" hide\" ></audio>"},fetch_resource_video:function fetch_resource_video(a){return this.fetch_resource_audio(a)},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){this.fetch_instanceprops(a);this.set_visual_mode("startbuttonrecording",a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.preview.attr("src",null);b.uploader.Output("");this.therecanim.start();b.timer.reset();b.timer.start();this.update_status(a);if("testbuttonrecording"!=this.buttonmode){this.set_visual_mode("startbuttonrecording",a)}},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){this.process_recording_stop(a)}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(a),d=f.clone();d.init(c.config,b,c.controlbar.playcanvas,c.controlbar.status);return d},set_button_style:function set_button_style(b){a.each(["testbuttonready","testbuttonrecording","startbuttonready","startbuttoncountdown","startbuttonrecording","uploading","allfinished"],function(b,c){a(".poodll_mediarecorderbox_readseed").removeClass("poodll_mediarecorder_readseed_"+c);a(".poodll_mediarecorderbox_readseed").removeClass("readseed_canclick")});a(".poodll_mediarecorderbox_readseed").addClass("poodll_mediarecorder_readseed_"+b);if("testbuttonready"==b||"startbuttonready"==b){a(".poodll_mediarecorderbox_readseed").addClass("readseed_canclick")}},set_visual_mode:function set_visual_mode(a,b){var c=this,d=this.fetch_instanceprops(b);this.buttonmode=a;d.config.hermes.postMessage({type:"recorderstatus",status:a});switch(a){case"testbuttonready":d.controlbar.status.hide();d.controlbar.thecaption.text("SPEAK");d.controlbar.thecaption.show();d.controlbar.playcanvas.hide();c.set_button_style(a);break;case"testbuttonrecording":d.controlbar.thecaption.hide();d.controlbar.playcanvas.show();c.set_button_style(a);break;case"startbuttonready":d.controlbar.thecaption.text("START");d.controlbar.thecaption.show();d.controlbar.playcanvas.hide();c.set_button_style(a);break;case"startbuttoncountdown":d.controlbar.thecaption.text("----------");d.controlbar.thecaption.show();d.controlbar.playcanvas.hide();c.set_button_style(a);break;case"startbuttonrecording":d.controlbar.playcanvas.show();if("1"==d.config.allowearlyexit&&d.timer.enabled){var e=M.util.get_string("recui_clicktofinish","filter_poodll");d.controlbar.thecaption.text(e);d.controlbar.thecaption.show()}else{d.controlbar.thecaption.hide()}c.set_button_style(a);break;case"uploading":d.controlbar.thecaption.html("<i class=\"fa fa-spinner fa-spin fa-3x fa-fw\"></i>");d.controlbar.thecaption.show();d.controlbar.playcanvas.hide();c.set_button_style(a);d.controlbar.status.show();break;case"allfinished":d.controlbar.thecaption.text("Finished");d.controlbar.thecaption.show();d.controlbar.playcanvas.hide();d.controlbar.status.hide();c.set_button_style(a);break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){return this.prepare_controlbar_audio(a,b,c,d)},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d){var e=this.fetch_instanceprops(c),f=e.config.media_skin_style,g=this.pmr.fetch_strings(),h=M.util.get_string("recui_startactivity","filter_poodll"),i=M.util.get_string("recui_testmic","filter_poodll"),j=M.util.get_string("recui_stop","filter_poodll"),k=this.fetch_status_bar("readseed"),l="<div class=\"poodll_mediarecorderholder_readseed "+"poodll_mediarecorder_audio"+"\" id=\"holder_"+c+"\">";l+="<div class=\"poodll_mediarecorderbox_readseed\" id=\""+c+"\">";l+=this.devsettings.fetch_dialogue_box();l+=e.downloaddialog.fetch_dialogue_box();l+=e.errordialog.fetch_dialogue_box();l+="<div class=\"style-holder "+f+"\">";l+=d,l+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";l+="<canvas id=\""+c+"_playcanvas\" class=\"poodll_mediarecorder_playcanvas_readseed\" width=\"180\" height=\"50\"></canvas>";l+="<span id=\""+c+"_caption\" class=\"poodll_mediarecorder_caption_readseed\"></span>";l+="<span id=\""+c+"_bogusstartbutton\" class=\"poodll_mediarecorder_bogusstartbutton_readseed\"></span>";l+="<span id=\""+c+"_bogusstopbutton\" class=\"poodll_mediarecorder_bogusstopbutton_readseed\"></span>";l+=k;l+="</div></div></div>";a(b).prepend(l);var m={settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),status:a("#"+c+" .poodll_status_readseed"),preview:a("#"+c+" .poodll_preview_readseed"),bigbutton:a("#"+c+".poodll_mediarecorderbox_readseed"),playcanvas:a("#"+c+"_playcanvas"),thecaption:a("#"+c+"_caption"),stopbutton:a("#"+c+" .poodll_mediarecorder_bogusstopbutton_readseed"),startbutton:a("#"+c+" .poodll_mediarecorder_bogusstartbutton_readseed")};e.downloaddialog.set_dialogue_box(m.downloaddialog);e.errordialog.set_dialogue_box(m.errorsdialog);this.devsettings.set_dialogue_box(m.settingsdialog);return m},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(b,d){var f=this,h=this.pmr,i=this.fetch_instanceprops(d);i.config.recanim="hwave_mic";var e=g.clone();f.therecanim=e;e.init(i.audioanalyser,i.controlbar.playcanvas.get(0));this.set_visual_mode("testbuttonready",d);i.controlbar.bigbutton.click(function(c){if(c.target!==this&&!a(c.target).hasClass("poodll_mediarecorder_caption_readseed")&&!a(c.target).hasClass("poodll_mediarecorder_playcanvas_readseed")){return}switch(f.buttonmode){case"testbuttonready":var g={};g.type="recorderstatus";g.status="testbuttonrecording";i.config.hermes.postMessage(g);i.config.hermes.disable();i.timer.disable();var j=function(){if(i.mediaRecorder){h.do_stop_audio(i)}e.clear();i.config.hermes.enable();if(e.sounddetected){f.set_visual_mode("startbuttonready",d)}else{i.config.hermes.postMessage({type:"recorderstatus",status:"testrecordingfailed"});f.set_visual_mode("testbuttonready",d)}};h.do_start_audio(i,b);setTimeout(j,4e3);f.set_visual_mode("testbuttonrecording",d);break;case"startbuttonready":var k=function(){var a=new Date().getTime(),c=a-l;if(c>m){i.timer.enable();h.do_start_audio(i,b)}else{var d=!1;if(0>n&&0<c){d=m/1e3}else if(1e3>n&&1e3<c){d=m/1e3-1}else if(2e3>n&&2e3<c){d=m/1e3-2}if(d){var e={type:"countdownstatus",status:d};i.config.hermes.postMessage(e)}n=c;setTimeout(k,100)}};i.config.hermes.enable();f.set_visual_mode("startbuttoncountdown",d);var l=new Date().getTime(),m=3e3,n=-1;setTimeout(k,100);break;case"startbuttonrecording":if("1"==i.config.allowearlyexit&&i.timer.enabled){f.process_recording_stop(d)}break;case"stopbutton":f.process_recording_stop();}});i.controlbar.settingsicon.click(function(a){c.debug("we no proapagato");a.stopPropagation();if(!f.uploaded){f.devsettings.open()}else{i.downloaddialog.open()}});window.onbeforeunload=function(){}},process_recording_stop:function process_recording_stop(a){var b=this,c=this.pmr,d=this.fetch_instanceprops(a),e=b.therecanim;c.do_stop_audio(d);e.clear();d.timer.stop();b.update_status(a);var f=function(){if(d.blobs&&0<d.blobs.length){c.do_save_audio(d);d.uploaded=!0}else{setTimeout(f,200)}};setTimeout(f,200);b.set_visual_mode("uploading",a)},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_readseedmediaskin.min.js.map

define ("filter_poodll/poodll_goldmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/anim_progress_radial","filter_poodll/anim_hwave","filter_poodll/anim_fbars","filter_poodll/anim_ripple","filter_poodll/anim_words","filter_poodll/speech_poodll","filter_poodll/dlg_devicesettings"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";c.debug("PoodLL Gold Skin: initialising");return{instanceprops:null,pmr:null,devsettings:null,therecanim:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=k.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" width=\"320\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+" hide\" playsinline=\"playsinline\" muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_preview_"+a+"\" width=\"320\" height=\"240\" playsinline=\"playsinline\" muted></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+" hide\" playsinline=\"playsinline\"></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+" hide\" playsinline=\"playsinline\"></video>"},fetch_uploader_skin:function fetch_uploader_skin(){return!1},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){this.fetch_instanceprops(a);this.set_visual_mode("recordingmode",a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.preview.attr("src",null);b.uploader.Output("");this.therecanim.start();b.timer.reset();b.timer.start();this.update_status(a);this.set_visual_mode("recordingmode",a)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},set_visual_mode:function set_visual_mode(a,b){var c=this,d=this.fetch_instanceprops(b);switch(a){case"startmode":c.enable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.playbutton);c.disable_button(d.controlbar.stopbutton);if(d.showupload){c.disable_button(d.controlbar.savebutton)}else{d.controlbar.savebutton.hide()}c.disable_button(d.controlbar.restartbutton);break;case"recordingmode":c.enable_button(d.controlbar.stopbutton);c.disable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.playbutton);if(d.showupload){c.disable_button(d.controlbar.savebutton)}else{d.controlbar.savebutton.hide()}c.disable_button(d.controlbar.restartbutton);if("video"==d.config.mediatype){d.controlbar.preview.removeClass("hide")}break;case"previewmode":if(d.showupload){d.controlbar.savebutton.removeClass("hide");d.controlbar.savebutton.removeClass("pmr_disabled");d.controlbar.savebutton.attr("disabled",!1)}else{d.controlbar.savebutton.hide();if("video"==d.config.mediatype){d.controlbar.preview.addClass("hide")}}if(!d.uploaded){c.enable_button(d.controlbar.startbutton);c.enable_button(d.controlbar.restartbutton)}c.enable_button(d.controlbar.stopbutton);c.enable_button(d.controlbar.playbutton);break;case"playingmode":c.enable_button(d.controlbar.stopbutton);if("video"==d.config.mediatype){c.enable_button(d.controlbar.preview);d.controlbar.preview.removeClass("hide")}c.disable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.playbutton);c.disable_button(d.controlbar.restartbutton);break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio";switch(g.config.size){case"small":break;case"big":break;case"auto":}var j=this.pmr.fetch_strings(),k="<div class=\"poodll_mediarecorderholder_gold "+i+"\" id=\"holder_"+c+"\">";k+="<div class=\"poodll_mediarecorderbox_gold\" id=\""+c+"\">";k+=this.devsettings.fetch_dialogue_box();k+=g.downloaddialog.fetch_dialogue_box();k+=g.errordialog.fetch_dialogue_box();k+="<div class=\"style-holder "+h+"\">";var l=this.fetch_status_bar("gold");k+=l,k+=d,k+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";k+="<canvas id=\""+c+"_playcanvas\"> width=\"250\" height=\"250\"></canvas>";k+="<button type=\"button\" class=\"poodll_mediarecorder_button_gold poodll_start-recording_gold\"><i class=\"fa fa-microphone\" aria-hidden=\"true\"></i></button>";k+="<button type=\"button\" class=\"poodll_mediarecorder_button_gold poodll_stop-recording_gold\"><i class=\"fa fa-stop\" aria-hidden=\"true\"></i></button>";k+="<div class=\"gold-save-button-wrapper\"><a class=\"btn btn-primary poodll_save-recording_gold\">Upload</a></div>";k+=" <button type=\"button\" class=\"poodll_mediarecorder_button_gold poodll_play-recording_gold\"><i class=\"fa fa-play\" aria-hidden=\"true\"></i></button>";k+="<div class=\"gold-restart-button-wrapper\"><a class=\"btn btn-success poodll_restart_gold \" >"+j.recui_restart+"</a></div>";k+="</div></div></div>";a(b).prepend(k);var m={settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),status:a("#"+c+" .poodll_status_gold"),preview:a("#"+c+" .poodll_preview_gold"),startbutton:a("#"+c+" .poodll_start-recording_gold"),stopbutton:a("#"+c+" .poodll_stop-recording_gold"),stopplayingbutton:a("#"+c+" .poodll_stop-playing_gold"),playbutton:a("#"+c+" .poodll_play-recording_gold"),savebutton:a("#"+c+" .poodll_save-recording_gold"),restartbutton:a("#"+c+" .poodll_restart_gold"),playcanvas:a("#"+c+"_playcanvas")};g.downloaddialog.set_dialogue_box(m.downloaddialog);g.errordialog.set_dialogue_box(m.errorsdialog);this.devsettings.set_dialogue_box(m.settingsdialog);return m},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(b,c){var d=this,j=this.pmr,k=this.fetch_instanceprops(c);this.set_visual_mode("startmode",c);var l=e.clone();l.init(k.controlbar.playcanvas);var m=null;switch(k.config.recanim){case"hwave":m=f.clone();break;case"fbars":m=g.clone();break;case"ripple":m=h.clone();break;case"words":m=i.clone();break;default:k.config.recanim="ripple";var m=h.clone();}m.init(k.audioanalyser,k.controlbar.playcanvas.get(0));k.controlbar.settingsicon.click(function(){if(!d.uploaded){d.devsettings.open()}else{k.downloaddialog.open()}});if("video"==k.config.mediatype){k.controlbar.preview.addClass("hide")}k.controlbar.preview.click(function(){console.log("clicked preview");a(this).addClass("hide");a(k.controlbar.stopbutton).trigger("click");if(a(this).hasClass("recorded")){a(this).removeClass("recorded")}else{a(this).addClass("recorded")}});k.controlbar.startbutton.click(function(){d.therecanim=m;j.do_start_audio(k,b)});k.controlbar.restartbutton.click(function(){d.set_visual_mode("startmode",c)});k.controlbar.stopbutton.click(function(){j.do_stop_audio(k);var a=k.controlbar.preview.get(0);a.pause();m.clear();l.stop();k.timer.stop();d.update_status(c);d.set_visual_mode("previewmode",c)});k.controlbar.playbutton.click(function(){if("video"==k.config.mediatype){if(a(k.controlbar.preview).hasClass("recorder")){a(k.controlbar.preview).removeClass("recorder");a(k.controlbar.preview).removeClass("hide")}}var b=k.controlbar.preview.get(0);j.do_play_audio(k,b);l.clear();l.fetchCurrent=function(){var a=k.controlbar.preview.prop("currentTime"),b=k.controlbar.preview.prop("duration");if(!isFinite(b)){b=k.timer.finalseconds}return a/b};l.start();d.set_visual_mode("playingmode",c)});k.controlbar.savebutton.click(function(){if(k.blobs&&0<k.blobs.length){j.do_save_audio(k);k.uploaded=!0;d.disable_button(k.controlbar.startbutton)}else{k.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}d.set_visual_mode("previewmode",c);return!1});window.onbeforeunload=function(){d.enable_button(k.controlbar.startbutton);var a=k.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}}},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_goldmediaskin.min.js.map

define ("filter_poodll/upskin_bar",["jquery","core/log","filter_poodll/anim_progress_bar"],function(a,b,c){"use strict";b.debug("upskin_bar: initialising");return{element:null,cvs:null,percent:0,progressbar:null,messagearea:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,d,e){this.config=a;this.element=b;this.cvs=d;this.progressbar=c.clone();this.messagearea=e},initControls:function initControls(){var a=this;this.progressbar.init(this.cvs,"#BCCCCC");this.progressbar.fetchCurrent=function(){return a.percent}},initProgressSession:function initProgressSession(a){var b=this;b.percent=0;var c=M.util.get_string("recui_uploading","filter_poodll");a.upload.addEventListener("progress",function(a){if(a.lengthComputable){b.percent=a.loaded/a.total;b.showMessage(c+"("+Math.floor(100*b.percent)+"%)")}});this.progressbar.start()},deactivateProgressSession:function deactivateProgressSession(){this.progressbar.stopthere();b.debug("deactivating session")},showMessage:function showMessage(a){this.messagearea.html(a)}}});
//# sourceMappingURL=upskin_bar.min.js.map

define ("filter_poodll/drawingboard_amd",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/drawingboard"],function(a,b,c,d,e){"use strict";b.debug("Filter PoodLL: drawingboard.js initialising");return{instanceprops:[],loaddrawingboard:function loaddrawingboard(b){var c="#amdopts_"+b.recorderid,f=a(c).get(0);if(f){b=JSON.parse(f.value);if(b.bgimage){var g="transparent"}else{var g="background";b.bgimage="#FFF"}this.config=b;a(c).remove()}var h="#"+b.recorderid+"drawing-board-id",i=new e.Board(b.recorderid+"_drawing-board-id",{recorderid:b.recorderid,size:3,background:b.bgimage,controls:["Color",{Size:{type:"auto"}},{DrawingMode:{filler:!1,eraser:!0,pencil:!0}},"Navigation"],droppable:!0,webStorage:!1,enlargeYourContainer:!0,eraserColor:g});b.db=i;var j=b.vectordata;if(j){if(0!=j.indexOf("{\"shapes\"")&&0!=j.indexOf("{\"colors\"")){i.history=Y.JSON.parse(j);i.setImg(i.history.values[i.history.position-1])}}b.uploader=d.clone();b.uploader.init(h,b);this.instanceprops[b.recorderid]=b;this.registerEvents(b.recorderid)},registerEvents:function registerEvents(b){var d=this.instanceprops[b];if(d.autosave){var e=function(){var a=document.getElementById(b+"_messages");if(a){a.innerHTML="File has not been saved.";var e=document.getElementById(b+"_btn_upload_whiteboard");e.disabled=!1;var f=c.timeouthandles[b];if(f){clearTimeout(f)}c.timeouthandles[b]=setTimeout(function(){c.WhiteboardUploadHandler(b,d.db,d,d.uploader)},d.autosave)}},f=function(){var a=document.getElementById(b+"_messages");if(a){var e=c.timeouthandles[b];if(e){clearTimeout(e)}c.timeouthandles[b]=setTimeout(function(){c.WhiteboardUploadHandler(b,d.db,d,d.uploader)},d.autosave)}};d.db.ev.bind("board:startDrawing",e);d.db.ev.bind("board:stopDrawing",f);d.db.ev.bind("board:reset",f);d.db.ev.bind("historyNavigation",f)}else{var f=function(){var a=document.getElementById(b+"_messages");if(a){a.innerHTML="File has not been saved."}};d.db.ev.bind("board:stopDrawing",f)}var g=a("#"+b+"_btn_upload_whiteboard");if(g){if(d.autosave){g.click(function(){c.WhiteboardUploadHandler(b,d.db,d,d.uploader)})}else{g.click(function(){var a=c.getCvs(b,d.db,d);c.pokeVectorData(b,d.db,d);d.uploader.uploadFile(a.toDataURL(),"image")})}}}}});
//# sourceMappingURL=drawingboard_amd.min.js.map

function _defineProperty(e,t,o){if(t in e){Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0})}else{e[t]=o}return e}function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}!function(o){if("object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=o();else if("function"==typeof define&&define.amd)define ("filter_poodll/literallycanvas",[],o);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LC=o()}}(function(){return function p(d,e,t){function a(o,r){if(!e[o]){if(!d[o]){var i="function"==typeof require&&require;if(!r&&i)return i(o,!0);if(n)return n(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var l=e[o]={exports:{}};d[o][0].call(l.exports,function(e){var t=d[o][1][e];return a(t?t:e)},l,l.exports,p,d,e,t)}return e[o].exports}for(var n="function"==typeof require&&require,o=0;o<t.length;o++){a(t[o])}return a}({1:[function(o,t){"use strict";function e(r,t){if(r===t)return!0;if("object"!=_typeof(r)||null===r||"object"!=_typeof(t)||null===t)return!1;var e=Object.keys(r),n=Object.keys(t);if(e.length!==n.length)return!1;for(var i=a.bind(t),o=0;o<e.length;o++){if(!i(e[o])||r[e[o]]!==t[e[o]])return!1}return!0}var a=Object.prototype.hasOwnProperty;t.exports=e},{}],2:[function(o,t){t.exports=o("react/lib/ReactComponentWithPureRenderMixin")},{"react/lib/ReactComponentWithPureRenderMixin":3}],3:[function(o,t){"use strict";var a=o("./shallowCompare");t.exports={shouldComponentUpdate:function shouldComponentUpdate(o,t){return a(this,o,t)}}},{"./shallowCompare":4}],4:[function(o,t){"use strict";var a=o("fbjs/lib/shallowEqual");t.exports=function(o,t,e){return!a(o.props,t)||!a(o.state,e)}},{"fbjs/lib/shallowEqual":1}],5:[function(n,t){var k,b,e,C,w,P,R,_,E,I,T,L,z,O,N,B=function(o,t){return function(){return o.apply(t,arguments)}},S=[].slice,v=[].indexOf||function(o){for(var t=0,a=this.length;a>t;t++){if(t in this&&this[t]===o)return t}return-1};w=n("./actions"),P=n("./bindEvents"),_=n("./math"),E=n("./shapes"),R=E.createShape,O=E.shapeToJSON,b=E.JSONToShape,I=n("./canvasRenderer").renderShapeToContext,T=n("./svgRenderer").renderShapeToSVG,L=n("./renderSnapshotToImage"),z=n("./renderSnapshotToSVG"),C=n("../tools/Pencil"),N=n("./util"),k="infinite",t.exports=e=function(){function e(o,t){this.setImageSize=B(this.setImageSize,this);var e,a;a=null,e=null,o instanceof HTMLElement?(e=o,a=t):a=o,this.opts=a||{},this.config={zoomMin:a.zoomMin||.2,zoomMax:a.zoomMax||4,zoomStep:a.zoomStep||.2},this.colors={primary:a.primaryColor||"#000",secondary:a.secondaryColor||"#fff",background:a.backgroundColor||"transparent"},this.watermarkImage=a.watermarkImage,this.watermarkScale=a.watermarkScale||1,this.backgroundCanvas=document.createElement("canvas"),this.backgroundCtx=this.backgroundCanvas.getContext("2d"),this.canvas=document.createElement("canvas"),this.canvas.style["background-color"]="transparent",this.buffer=document.createElement("canvas"),this.buffer.style["background-color"]="transparent",this.ctx=this.canvas.getContext("2d"),this.bufferCtx=this.buffer.getContext("2d"),this.backingScale=N.getBackingScale(this.ctx),this.backgroundShapes=a.backgroundShapes||[],this._shapesInProgress=[],this.shapes=[],this.undoStack=[],this.redoStack=[],this.isDragging=!1,this.position={x:0,y:0},this.scale=1,this.setTool(new this.opts.tools[0](this)),this.width=a.imageSize.width||k,this.height=a.imageSize.height||k,this.setZoom(this.scale),a.snapshot&&this.loadSnapshot(a.snapshot),this.isBound=!1,e&&this.bindToElement(e),this.respondToSizeChange=function(){}}return e.prototype.bindToElement=function(o){var t,a;return this.containerEl?void console.warn("Trying to bind Literally Canvas to a DOM element more than once is unsupported."):(this.containerEl=o,this._unsubscribeEvents=P(this,this.containerEl,this.opts.keyboardShortcuts),this.containerEl.style["background-color"]=this.colors.background,this.containerEl.appendChild(this.backgroundCanvas),this.containerEl.appendChild(this.canvas),this.isBound=!0,a=function(e){return function(){return e.keepPanInImageBounds(),e.repaintAllLayers()}}(this),this.respondToSizeChange=N.matchElementSize(this.containerEl,[this.backgroundCanvas,this.canvas],this.backingScale,a),this.watermarkImage&&(this.watermarkImage.onload=function(e){return function(){return e.repaintLayer("background")}}(this)),null!=(t=this.tool)&&t.didBecomeActive(this),a())},e.prototype._teardown=function(){var e;return null!=(e=this.tool)&&e.willBecomeInactive(this),"function"==typeof this._unsubscribeEvents&&this._unsubscribeEvents(),this.tool=null,this.containerEl=null,this.isBound=!1},e.prototype.trigger=function(o,t){return this.canvas.dispatchEvent(new CustomEvent(o,{detail:t})),null},e.prototype.on=function(o,a){var t;return t=function(e){return a(e.detail)},this.canvas.addEventListener(o,t),function(a){return function(){return a.canvas.removeEventListener(o,t)}}(this)},e.prototype.getRenderScale=function(){return this.scale*this.backingScale},e.prototype.clientCoordsToDrawingCoords=function(o,t){return{x:(o*this.backingScale-this.position.x)/this.getRenderScale(),y:(t*this.backingScale-this.position.y)/this.getRenderScale()}},e.prototype.drawingCoordsToClientCoords=function(o,t){return{x:o*this.getRenderScale()+this.position.x,y:t*this.getRenderScale()+this.position.y}},e.prototype.setImageSize=function(o,t){return this.width=o||k,this.height=t||k,this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("imageSizeChange",{width:this.width,height:this.height})},e.prototype.setTool=function(o){var t;return this.isBound&&null!=(t=this.tool)&&t.willBecomeInactive(this),this.tool=o,this.trigger("toolChange",{tool:o}),this.isBound?this.tool.didBecomeActive(this):void 0},e.prototype.setShapesInProgress=function(e){return this._shapesInProgress=e},e.prototype.pointerDown=function(o,t){var e;return e=this.clientCoordsToDrawingCoords(o,t),this.tool.usesSimpleAPI?(this.tool.begin(e.x,e.y,this),this.isDragging=!0,this.trigger("drawStart",{tool:this.tool})):(this.isDragging=!0,this.trigger("lc-pointerdown",{tool:this.tool,x:e.x,y:e.y,rawX:o,rawY:t}))},e.prototype.pointerMove=function(o,t){return N.requestAnimationFrame(function(e){return function(){var a,n;return a=e.clientCoordsToDrawingCoords(o,t),(null!=(n=e.tool)?n.usesSimpleAPI:0)?e.isDragging?(e.tool["continue"](a.x,a.y,e),e.trigger("drawContinue",{tool:e.tool})):void 0:e.isDragging?e.trigger("lc-pointerdrag",{tool:e.tool,x:a.x,y:a.y,rawX:o,rawY:t}):e.trigger("lc-pointermove",{tool:e.tool,x:a.x,y:a.y,rawX:o,rawY:t})}}(this))},e.prototype.pointerUp=function(o,t){var e;return e=this.clientCoordsToDrawingCoords(o,t),this.tool.usesSimpleAPI?this.isDragging?(this.tool.end(e.x,e.y,this),this.isDragging=!1,this.trigger("drawEnd",{tool:this.tool})):void 0:(this.isDragging=!1,this.trigger("lc-pointerup",{tool:this.tool,x:e.x,y:e.y,rawX:o,rawY:t}))},e.prototype.setColor=function(o,t){if(this.colors[o]=t,this.isBound){switch(o){case"background":this.containerEl.style.backgroundColor=this.colors.background,this.repaintLayer("background");break;case"primary":this.repaintLayer("main");break;case"secondary":this.repaintLayer("main");}return this.trigger(o+"ColorChange",this.colors[o]),"background"===o?this.trigger("drawingChange"):void 0}},e.prototype.getColor=function(e){return this.colors[e]},e.prototype.saveShape=function(o,t,a){return null==t&&(t=!0),null==a&&(a=null),a||(a=this.shapes.length?this.shapes[this.shapes.length-1].id:null),this.execute(new w.AddShapeAction(this,o,a)),t&&this.trigger("shapeSave",{shape:o,previousShapeId:a}),this.trigger("drawingChange")},e.prototype.pan=function(o,t){return this.setPan(this.position.x-o,this.position.y-t)},e.prototype.keepPanInImageBounds=function(){var o,a,i,s;return a=this.getRenderScale(),o=this.position,i=o.x,s=o.y,this.width!==k&&(i=this.canvas.width>this.width*a?(this.canvas.width-this.width*a)/2:Math.max(Math.min(0,i),this.canvas.width-this.width*a)),this.height!==k&&(s=this.canvas.height>this.height*a?(this.canvas.height-this.height*a)/2:Math.max(Math.min(0,s),this.canvas.height-this.height*a)),this.position={x:i,y:s}},e.prototype.setPan=function(o,t){return this.position={x:o,y:t},this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("pan",{x:this.position.x,y:this.position.y})},e.prototype.zoom=function(o){var t;return t=this.scale+o,t=Math.max(t,this.config.zoomMin),t=Math.min(t,this.config.zoomMax),t=Math.round(100*t)/100,this.setZoom(t)},e.prototype.setZoom=function(o){var t;return t=this.scale,this.scale=o,this.position.x=_.scalePositionScalar(this.position.x,this.canvas.width,t,this.scale),this.position.y=_.scalePositionScalar(this.position.y,this.canvas.height,t,this.scale),this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("zoom",{oldScale:t,newScale:this.scale})},e.prototype.setWatermarkImage=function(e){return this.watermarkImage=e,N.addImageOnload(e,function(e){return function(){return e.repaintLayer("background")}}(this)),e.width?this.repaintLayer("background"):void 0},e.prototype.repaintAllLayers=function(){var o,a,r,s;for(s=["background","main"],o=0,r=s.length;r>o;o++){a=s[o],this.repaintLayer(a)}return null},e.prototype.repaintLayer=function(o,t){var a;if(null==t&&(t="main"===o),this.isBound){switch(o){case"background":this.backgroundCtx.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height),a=function(e){return function(){return e.repaintLayer("background")}}(this),this.watermarkImage&&this._renderWatermark(this.backgroundCtx,!0,a),this.draw(this.backgroundShapes,this.backgroundCtx,a);break;case"main":a=function(e){return function(){return e.repaintLayer("main",!0)}}(this),t&&(this.buffer.width=this.canvas.width,this.buffer.height=this.canvas.height,this.bufferCtx.clearRect(0,0,this.buffer.width,this.buffer.height),this.draw(this.shapes,this.bufferCtx,a)),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),0<this.canvas.width&&0<this.canvas.height&&(this.ctx.fillStyle="#ccc",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.clipped(function(e){return function(){return e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.ctx.drawImage(e.buffer,0,0)}}(this),this.ctx),this.clipped(function(a){return function(){return a.transformed(function(){var t,s,l,p,d;for(l=a._shapesInProgress,p=[],t=0,s=l.length;s>t;t++){d=l[t],p.push(I(a.ctx,d,{bufferCtx:a.bufferCtx,shouldOnlyDrawLatest:!0}))}return p},a.ctx,a.bufferCtx)}}(this),this.ctx,this.bufferCtx));}return this.trigger("repaint",{layerKey:o})}},e.prototype._renderWatermark=function(o,t,a){return null==t&&(t=!0),this.watermarkImage.width?(o.save(),o.translate(o.canvas.width/2,o.canvas.height/2),o.scale(this.watermarkScale,this.watermarkScale),t&&o.scale(this.backingScale,this.backingScale),o.drawImage(this.watermarkImage,-this.watermarkImage.width/2,-this.watermarkImage.height/2),o.restore()):void(this.watermarkImage.onload=a)},e.prototype.drawShapeInProgress=function(o){return this.repaintLayer("main",!1),this.clipped(function(t){return function(){return t.transformed(function(){return I(t.ctx,o,{bufferCtx:t.bufferCtx,shouldOnlyDrawLatest:!0})},t.ctx,t.bufferCtx)}}(this),this.ctx,this.bufferCtx)},e.prototype.draw=function(a,r,e){var o;if(a.length)return o=function(){return function(){var t,n,l,p;for(l=[],t=0,n=a.length;n>t;t++){p=a[t],l.push(I(r,p,{retryCallback:e}))}return l}}(this),this.clipped(function(e){return function(){return e.transformed(o,r)}}(this),r)},e.prototype.clipped=function(){var i,d,g,m,y,f,x,b,C,w,v,P;for(g=arguments[0],i=2<=arguments.length?S.call(arguments,1):[],v=this.width===k?0:this.position.x,P=this.height===k?0:this.position.y,w=function(){switch(this.width){case k:return this.canvas.width;default:return this.width*this.getRenderScale();}}.call(this),m=function(){switch(this.height){case k:return this.canvas.height;default:return this.height*this.getRenderScale();}}.call(this),y=0,x=i.length;x>y;y++){d=i[y],d.save(),d.beginPath(),d.rect(v,P,w,m),d.clip()}for(g(),C=[],f=0,b=i.length;b>f;f++){d=i[f],C.push(d.restore())}return C},e.prototype.transformed=function(){var l,p,d,c,g,u,m,y,f;for(d=arguments[0],l=2<=arguments.length?S.call(arguments,1):[],c=0,u=l.length;u>c;c++){p=l[c],p.save(),p.translate(Math.floor(this.position.x),Math.floor(this.position.y)),f=this.getRenderScale(),p.scale(f,f)}for(d(),y=[],g=0,m=l.length;m>g;g++){p=l[g],y.push(p.restore())}return y},e.prototype.clear=function(o){var a,r;return null==o&&(o=!0),r=this.shapes,a=[],this.setShapesInProgress([]),this.execute(new w.ClearAction(this,r,a)),this.repaintLayer("main"),o&&this.trigger("clear",null),this.trigger("drawingChange",{})},e.prototype.execute=function(e){return this.undoStack.push(e),e["do"](),this.redoStack=[]},e.prototype.undo=function(){var e;if(this.undoStack.length)return e=this.undoStack.pop(),e.undo(),this.redoStack.push(e),this.trigger("undo",{action:e}),this.trigger("drawingChange",{})},e.prototype.redo=function(){var e;if(this.redoStack.length)return e=this.redoStack.pop(),this.undoStack.push(e),e["do"](),this.trigger("redo",{action:e}),this.trigger("drawingChange",{})},e.prototype.canUndo=function(){return!!this.undoStack.length},e.prototype.canRedo=function(){return!!this.redoStack.length},e.prototype.getPixel=function(o,t){var e,a;return e=this.drawingCoordsToClientCoords(o,t),a=this.ctx.getImageData(e.x,e.y,1,1).data,a[3]?"rgb("+a[0]+", "+a[1]+", "+a[2]+")":null},e.prototype.getContentBounds=function(){return N.getBoundingRect(this.shapes.concat(this.backgroundShapes).map(function(e){return e.getBoundingRect()}),this.width===k?0:this.width,this.height===k?0:this.height)},e.prototype.getDefaultImageRect=function(o,a){var s;return null==o&&(o={width:0,height:0}),null==a&&(a={top:0,right:0,bottom:0,left:0}),N.getDefaultImageRect(function(){var o,a,n,l;for(n=this.shapes.concat(this.backgroundShapes),l=[],o=0,a=n.length;a>o;o++){s=n[o],l.push(s.getBoundingRect(this.ctx))}return l}.call(this),o,a)},e.prototype.getImage=function(e){return null==e&&(e={}),null==e.includeWatermark&&(e.includeWatermark=!0),null==e.scaleDownRetina&&(e.scaleDownRetina=!0),null==e.scale&&(e.scale=1),e.scaleDownRetina||(e.scale*=this.backingScale),e.includeWatermark&&(e.watermarkImage=this.watermarkImage,e.watermarkScale=this.watermarkScale,e.scaleDownRetina||(e.watermarkScale*=this.backingScale)),L(this.getSnapshot(),e)},e.prototype.canvasForExport=function(){return this.repaintAllLayers(),N.combineCanvases(this.backgroundCanvas,this.canvas)},e.prototype.canvasWithBackground=function(e){return N.combineCanvases(e,this.canvasForExport())},e.prototype.getSnapshot=function(a){var l,p,d,c,h,g;for(null==a&&(a=null),null==a&&(a=["shapes","imageSize","colors","position","scale","backgroundShapes"]),g={},c=["colors","position","scale"],l=0,d=c.length;d>l;l++){p=c[l],0<=v.call(a,p)&&(g[p]=this[p])}return 0<=v.call(a,"shapes")&&(g.shapes=function(){var o,a,r,s;for(r=this.shapes,s=[],o=0,a=r.length;a>o;o++){h=r[o],s.push(O(h))}return s}.call(this)),0<=v.call(a,"backgroundShapes")&&(g.backgroundShapes=function(){var o,a,r,s;for(r=this.backgroundShapes,s=[],o=0,a=r.length;a>o;o++){h=r[o],s.push(O(h))}return s}.call(this)),0<=v.call(a,"imageSize")&&(g.imageSize={width:this.width,height:this.height}),g},e.prototype.getSnapshotJSON=function(){return console.warn("lc.getSnapshotJSON() is deprecated. use JSON.stringify(lc.getSnapshot()) instead."),JSON.stringify(this.getSnapshot())},e.prototype.getSVGString=function(e){return null==e&&(e={}),z(this.getSnapshot(),e)},e.prototype.loadSnapshot=function(a){var t,r,d,g,m,y,S,f,x,k;if(a){if(a.colors)for(y=["primary","secondary","background"],t=0,g=y.length;g>t;t++){d=y[t],this.setColor(d,a.colors[d])}if(a.shapes)for(this.shapes=[],S=a.shapes,r=0,m=S.length;m>r;r++){k=S[r],x=b(k),x&&this.execute(new w.AddShapeAction(this,x))}return a.backgroundShapes&&(this.backgroundShapes=function(){var t,r,s,l;for(s=a.backgroundShapes,l=[],t=0,r=s.length;r>t;t++){f=s[t],l.push(b(f))}return l}()),a.imageSize&&(this.width=a.imageSize.width,this.height=a.imageSize.height),a.position&&(this.position=a.position),a.scale&&(this.scale=a.scale),this.repaintAllLayers(),this.trigger("snapshotLoad"),this.trigger("drawingChange",{})}},e.prototype.loadSnapshotJSON=function(e){return console.warn("lc.loadSnapshotJSON() is deprecated. use lc.loadSnapshot(JSON.parse(snapshot)) instead."),this.loadSnapshot(JSON.parse(e))},e}()},{"../tools/Pencil":48,"./actions":7,"./bindEvents":8,"./canvasRenderer":9,"./math":14,"./renderSnapshotToImage":15,"./renderSnapshotToSVG":16,"./shapes":17,"./svgRenderer":18,"./util":19}],6:[function(a,t){var e,p,d,c;a("./fontmetrics.js"),c=function(l){var t,p,d,c,g,u,m,y;for(p=l.split(" "),d=0,g=0,u=p.length;u>g;g++){c=p[g],m=parseInt(c.replace("px",""),10),isNaN(m)||(d=m)}if(!d)throw"Font size not found";return y=l.substring(p[0].length+1).replace("bold ","").replace("italic ","").replace("underline ",""),t=y,{fontSize:d,fontFamily:t}},d=function(d,t,e){var n,g,m,y,S,f,x,k,b,C;if(!t.length)return["",""];for(g=0,f=0,x=0,C=!1;;){if(g+=1,m=g>=t.length,S=!m&&t[g].match(/\s/),y=S||m,b=t.substring(0,g),n=e?d.measureTextWidth(b).width<=e:!0,n&&(x=g),y&&C&&(C=!1,n&&(f=g)),C=!S,m||!n){if(n)return[t,""];if(0<f){for(k=f+1;k<t.length&&t[k].match("/s/");){k+=1}return[t.substring(0,f),t.substring(k)]}return[t.substring(0,x),t.substring(x)]}}},p=function(o,t,e){var n,g,m,y,S,f,x,k,b;for(b=t.split(/\r\n|\r|\n/g),m=[],n=0,g=b.length;g>n;n++){if(k=b[n],S=d(o,k,e),y=S[0],x=S[1],y)for(;y;){m.push(y),f=d(o,x,e),y=f[0],x=f[1]}else m.push(k)}return m},e=function(){function e(r,t,e,n,i){var o,s,d;this.text=t,this.font=e,this.forcedWidth=n,this.forcedHeight=i,d=c(this.font),o=d.fontFamily,s=d.fontSize,r.font=this.font,r.textBaseline="baseline",this.emDashWidth=r.measureTextWidth("\u2014",s,o).width,this.caratWidth=r.measureTextWidth("|",s,o).width,this.lines=p(r,this.text,this.forcedWidth),this.metricses=this.lines.map(function(t){return function(e){return r.measureText2(e||"X",s,t.font)}}(this)),this.metrics={ascent:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.ascent})),descent:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.descent})),fontsize:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.fontsize})),leading:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.leading})),width:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.width})),height:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.height})),bounds:{minx:Math.min.apply(Math,this.metricses.map(function(o){var t;return t=o.bounds,t.minx})),miny:Math.min.apply(Math,this.metricses.map(function(o){var t;return t=o.bounds,t.miny})),maxx:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.bounds,t.maxx})),maxy:Math.max.apply(Math,this.metricses.map(function(o){var t;return t=o.bounds,t.maxy}))}},this.boundingBoxWidth=Math.ceil(this.metrics.width)}return e.prototype.draw=function(l,t,e){var n,p,d,c,g,u;for(l.textBaseline="top",l.font=this.font,n=0,g=this.lines,u=[],p=0,d=g.length;d>p;p++){c=g[p],l.fillText(c,t,e+n*this.metrics.leading),u.push(n+=1)}return u},e.prototype.getWidth=function(e){return null==e&&(e=!1),this.forcedWidth?this.forcedWidth:e?this.metrics.bounds.maxx+this.caratWidth:this.metrics.bounds.maxx},e.prototype.getHeight=function(){return this.forcedHeight||this.metrics.leading*this.lines.length},e}(),t.exports=e},{"./fontmetrics.js":11}],7:[function(o,t){var e,a;a=function(){function e(o,t,e){this.lc=o,this.oldShapes=t,this.newShapes=e}return e.prototype["do"]=function(){return this.lc.shapes=this.newShapes,this.lc.repaintLayer("main")},e.prototype.undo=function(){return this.lc.shapes=this.oldShapes,this.lc.repaintLayer("main")},e}(),e=function(){function e(o,t,e){this.lc=o,this.shape=t,this.previousShapeId=null!=e?e:null}return e.prototype["do"]=function(){var a,s,l,p,d,c;if(this.lc.shapes.length&&this.lc.shapes[this.lc.shapes.length-1].id!==this.previousShapeId&&null!==this.previousShapeId){for(p=[],a=!1,d=this.lc.shapes,s=0,l=d.length;l>s;s++){c=d[s],p.push(c),c.id===this.previousShapeId&&(p.push(this.shape),a=!0)}a||p.push(this.shape),this.lc.shapes=p}else this.lc.shapes.push(this.shape);return this.lc.repaintLayer("main")},e.prototype.undo=function(){var o,a,s,l,p;if(this.lc.shapes[this.lc.shapes.length-1].id===this.shape.id)this.lc.shapes.pop();else{for(s=[],l=this.lc.shapes,o=0,a=l.length;a>o;o++){p=l[o],p.id!==this.shape.id&&s.push(p)}lc.shapes=s}return this.lc.repaintLayer("main")},e}(),t.exports={ClearAction:a,AddShapeAction:e}},{}],8:[function(a,t){var e,n,p,l;p=function(o,t){var e,a,s;return a=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY,e=o.getBoundingClientRect(),[a-e.left,s-e.top]},l=function(o,t){var e;return e=o.getBoundingClientRect(),{left:t.clientX-e.left,top:t.clientY-e.top}},n=function(e){return null!=e.buttons?1===e.buttons:0<e.which},t.exports=e=function(s,t,e){var o,d,h,g,u,m;return null==e&&(e=!1),m=[],d=function(){return function(e){var o;return e.preventDefault(),o=l(t,e),s.pointerMove(o.left,o.top)}}(this),h=function(){return function(e){var o;return e.preventDefault(),t.onselectstart=function(){return!0},o=l(t,e),s.pointerUp(o.left,o.top),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",h),t.addEventListener("mousemove",d)}}(this),t.addEventListener("mousedown",function(){return function(e){var a,n;if("canvas"===e.target.tagName.toLowerCase())return a=!0,e.preventDefault(),t.onselectstart=function(){return!1},n=l(t,e),s.pointerDown(n.left,n.top),t.removeEventListener("mousemove",d),document.addEventListener("mousemove",d),document.addEventListener("mouseup",h)}}(this)),u=function(e){return e.preventDefault(),s.pointerMove.apply(s,p(t,e))},g=function h(e){return e.preventDefault(),s.pointerUp.apply(s,p(t,e)),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",g),document.removeEventListener("touchcancel",g)},t.addEventListener("touchstart",function(e){return"canvas"===e.target.tagName.toLowerCase()?(e.preventDefault(),1===e.touches.length?(s.pointerDown.apply(s,p(t,e)),document.addEventListener("touchmove",u),document.addEventListener("touchend",g),document.addEventListener("touchcancel",g)):s.pointerMove.apply(s,p(t,e))):void 0}),e&&(console.warn("Keyboard panning is deprecated."),o=function(t){switch(t.keyCode){case 37:s.pan(-10,0);break;case 38:s.pan(0,-10);break;case 39:s.pan(10,0);break;case 40:s.pan(0,10);}return s.repaintAllLayers()},document.addEventListener("keydown",o),m.push(function(){return document.removeEventListener(o)})),function(){var o,a,r,s;for(s=[],a=0,r=m.length;r>a;a++){o=m[a],s.push(o())}return s}}},{}],9:[function(n,t){var g,e,m,y,S,f,x,k,b,C,w;x=n("./lineEndCapShapes"),w={},e=function(o,t,e){return w[o]={drawFunc:t,drawLatestFunc:e}},k=function(){},C=function(o,t,e){var a;if(null==e&&(e={}),null==e.shouldIgnoreUnsupportedShapes&&(e.shouldIgnoreUnsupportedShapes=!1),null==e.retryCallback&&(e.retryCallback=k),null==e.shouldOnlyDrawLatest&&(e.shouldOnlyDrawLatest=!1),null==e.bufferCtx&&(e.bufferCtx=null),a=e.bufferCtx,w[t.className])return e.shouldOnlyDrawLatest&&w[t.className].drawLatestFunc?w[t.className].drawLatestFunc(o,a,t,e.retryCallback):w[t.className].drawFunc(o,t,e.retryCallback);if(e.shouldIgnoreUnsupportedShapes)return console.warn("Can't render shape of type "+t.className+" to canvas");throw"Can't render shape of type "+t.className+" to canvas"},b=function(o,t,e){return C(o.getContext("2d"),t,e)},e("Rectangle",function(o,t){var e,a;return e=t.x,a=t.y,0!=t.strokeWidth%2&&(e+=.5,a+=.5),o.fillStyle=t.fillColor,o.fillRect(e,a,t.width,t.height),o.lineWidth=t.strokeWidth,o.strokeStyle=t.strokeColor,o.strokeRect(e,a,t.width,t.height)}),e("Ellipse",function(a,t){var e,s,l,p;return a.save(),p=Math.floor(t.width/2),l=Math.floor(t.height/2),e=t.x+p,s=t.y+l,a.translate(e,s),a.scale(1,Math.abs(t.height/t.width)),a.beginPath(),a.arc(0,0,Math.abs(p),0,2*Math.PI),a.closePath(),a.restore(),a.fillStyle=t.fillColor,a.fill(),a.lineWidth=t.strokeWidth,a.strokeStyle=t.strokeColor,a.stroke()}),e("SelectionBox",function(){var o;return o=function(t,o,e){var a,n;return a=o.x,n=o.y,0!==e?(t.fillStyle="#fff",t.fillRect(a,n,e,e),t.strokeStyle="#000",t.strokeRect(a,n,e,e)):void 0},function(t,e){return o(t,e.getTopLeftHandleRect(),e.handleSize),o(t,e.getTopRightHandleRect(),e.handleSize),o(t,e.getBottomLeftHandleRect(),e.handleSize),o(t,e.getBottomRightHandleRect(),e.handleSize),e.backgroundColor&&(t.fillStyle=e.backgroundColor,t.fillRect(e._br.x-e.margin,e._br.y-e.margin,e._br.width+2*e.margin,e._br.height+2*e.margin)),t.lineWidth=1,t.strokeStyle="#000",t.setLineDash([2,4]),t.strokeRect(e._br.x-e.margin,e._br.y-e.margin,e._br.width+2*e.margin,e._br.height+2*e.margin),t.setLineDash([])}}()),e("Image",function(o,t,e){return t.image.width?1===t.scale?o.drawImage(t.image,t.x,t.y):o.drawImage(t.image,t.x,t.y,t.image.width*t.scale,t.image.height*t.scale):e?t.image.onload=e:void 0}),e("Line",function(a,t){var e,l,p,d,c;if(t.x1!==t.x2||t.y1!==t.y2)return l=t.x1,p=t.x2,d=t.y1,c=t.y2,0!=t.strokeWidth%2&&(l+=.5,p+=.5,d+=.5,c+=.5),a.lineWidth=t.strokeWidth,a.strokeStyle=t.color,a.lineCap=t.capStyle,t.dash&&a.setLineDash(t.dash),a.beginPath(),a.moveTo(l,d),a.lineTo(p,c),a.stroke(),t.dash&&a.setLineDash([]),e=Math.max(2.2*t.strokeWidth,5),t.endCapShapes[0]&&x[t.endCapShapes[0]].drawToCanvas(a,l,d,Math.atan2(d-c,l-p),e,t.color),t.endCapShapes[1]?x[t.endCapShapes[1]].drawToCanvas(a,p,c,Math.atan2(c-d,p-l),e,t.color):void 0}),g=function(i,t,e,l){var p,d,c,h;if(null==e&&(e=!1),null==l&&(l="round"),t.length){for(i.lineCap=l,i.strokeStyle=t[0].color,i.lineWidth=t[0].size,i.beginPath(),0==t[0].size%2?i.moveTo(t[0].x,t[0].y):i.moveTo(t[0].x+.5,t[0].y+.5),h=t.slice(1),p=0,d=h.length;d>p;p++){c=h[p],0==t[0].size%2?i.lineTo(c.x,c.y):i.lineTo(c.x+.5,c.y+.5)}return e?i.closePath():void 0}},S=function(o,t){return g(o,t.smoothedPoints),o.stroke()},f=function(a,t,e){var n,i,l;return e.tail?(l=e.smoothedPoints.length-e.segmentSize*e.tailSize,i=l<2*e.segmentSize?0:l,n=l+e.segmentSize+1,g(t,e.smoothedPoints.slice(i,n)),t.stroke()):(g(t,e.smoothedPoints),t.stroke())},e("LinePath",S,f),m=function(o,t){return o.save(),o.globalCompositeOperation="destination-out",S(o,t),o.restore()},y=function(o,t,e){return o.save(),o.globalCompositeOperation="destination-out",t.save(),t.globalCompositeOperation="destination-out",f(o,t,e),o.restore(),t.restore()},e("ErasedLinePath",m,y),e("Text",function(o,t){return t.renderer||t._makeRenderer(o),o.fillStyle=t.color,t.renderer.draw(o,t.x,t.y)}),e("Polygon",function(o,t){return o.fillStyle=t.fillColor,g(o,t.points,t.isClosed,"butt"),o.fill(),o.stroke()}),t.exports={defineCanvasRenderer:e,renderShapeToCanvas:b,renderShapeToContext:C}},{"./lineEndCapShapes":12}],10:[function(o,t){"use strict";t.exports={imageURLPrefix:"lib/img",primaryColor:"hsla(0, 0%, 0%, 1)",secondaryColor:"hsla(0, 0%, 100%, 1)",backgroundColor:"transparent",strokeWidths:[1,2,5,10,20,30],defaultStrokeWidth:5,toolbarPosition:"top",keyboardShortcuts:!1,imageSize:{width:"infinite",height:"infinite"},backgroundShapes:[],watermarkImage:null,watermarkScale:1,zoomMin:.2,zoomMax:4,zoomStep:.2,snapshot:null,onInit:function onInit(){},tools:[o("../tools/Pencil"),o("../tools/Eraser"),o("../tools/Line"),o("../tools/Rectangle"),o("../tools/Ellipse"),o("../tools/Text"),o("../tools/Polygon"),o("../tools/Pan"),o("../tools/Eyedropper")]}},{"../tools/Ellipse":43,"../tools/Eraser":44,"../tools/Eyedropper":45,"../tools/Line":46,"../tools/Pan":47,"../tools/Pencil":48,"../tools/Polygon":49,"../tools/Rectangle":50,"../tools/Text":52}],11:[function(){"use strict";!function(){if(!document.defaultView.getComputedStyle)throw"ERROR: 'document.defaultView.getComputedStyle' not found. This library only works in browsers that can report computed CSS values.";CanvasRenderingContext2D.prototype.measureTextWidth=CanvasRenderingContext2D.prototype.measureText;var l=function(t,o){return document.defaultView.getComputedStyle(t,null).getPropertyValue(o)};CanvasRenderingContext2D.prototype.measureText2=function(t,e,n){var i=this.measureTextWidth(t),r=!/\S/.test(t);i.fontsize=e;var o=document.createElement("div");o.style.position="absolute",o.style.opacity=0,o.style.font=n,o.innerHTML=t+"<br/>"+t,document.body.appendChild(o),i.leading=1.2*e;var s=l(o,"height");if(s=s.replace("px",""),s>=2*e&&(i.leading=0|s/2),document.body.removeChild(o),r)i.ascent=0,i.descent=0,i.bounds={minx:0,maxx:i.width,miny:0,maxy:0},i.height=0;else{var b=document.createElement("canvas");b.width=i.width+100,b.height=3*e,b.style.opacity=1,b.style.font=n;var h=b.getContext("2d");h.font=n;var c=b.width,u=b.height,p=u/2;h.fillStyle="white",h.fillRect(-1,-1,c+2,u+2),h.fillStyle="black",h.fillText(t,50,p);for(var d=h.getImageData(0,0,c,u).data,f=0,C=4*c,m=d.length;++f<m&&255===d[f];){}var y=0|f/C;for(f=m-1;0<--f&&255===d[f];){}var S=0|f/C;for(f=0;m>f&&255===d[f];){f+=C,f>=m&&(f=f-m+4)}var v=0|f%C/4,x=1;for(f=m-3;0<=f&&255===d[f];){f-=C,0>f&&(f=m-3-4*x++)}var P=0|f%C/4+1;i.ascent=p-y,i.descent=S-p,i.bounds={minx:v-50,maxx:P-50,miny:0,maxy:S-y},i.height=1+(S-y)}return i}}()},{}],12:[function(o,t){t.exports={arrow:function(){var l;return l=function(t,o,e,a,n){return[{x:t+Math.cos(e+Math.PI/2)*a/2,y:o+Math.sin(e+Math.PI/2)*a/2},{x:t+Math.cos(e)*n,y:o+Math.sin(e)*n},{x:t+Math.cos(e-Math.PI/2)*a/2,y:o+Math.sin(e-Math.PI/2)*a/2}]},{drawToCanvas:function drawToCanvas(t,e,n,i,r,o,s){var p;return null==s&&(s=0),s=s||r,t.fillStyle=o,t.lineWidth=0,t.strokeStyle="transparent",t.beginPath(),p=l(e,n,i,r,s),t.moveTo(p[0].x,p[0].y),t.lineTo(p[1].x,p[1].y),t.lineTo(p[2].x,p[2].y),t.fill()},svg:function svg(t,e,n,i,r,o){var p;return null==o&&(o=0),o=o||i,p=l(t,e,n,i,o),"<polygon fill='"+r+"' stroke='none' points='"+p.map(function(e){return e.x+","+e.y})+"' />"}}}()}},{}],13:[function(a,t){var e,n,s;s={},n=function(e){return s=e},e=function(o){var t;return t=s[o],t||o},t.exports={localize:n,_:e}},{}],14:[function(n,t){var e,r,l,p,d,c;e=n("./shapes").Point,c=n("./util"),l={},l.toPoly=function(s){var t,d,c,g,u,m,y;for(m=[],y=[],d=0,t=0,c=s.length;c>t;t++){u=s[t],g=p(u,r(s,d)),m=m.concat([g[0]]),y=[g[1]].concat(y),d+=1}return m.concat(y)},r=function r(o,t){var e;return 3>o.length&&(e={x:0,y:0}),e=0===t?r(o,t+1):t===o.length-1?r(o,t-1):l.diff(o[t-1],o[t+1])},l.diff=function(o,t){return{x:t.x-o.x,y:t.y-o.y}},d=function(o){var t;return t=l.len(o),{x:o.x/t,y:o.y/t}},p=function(o,t){return t=d(t),t.x=t.x*o.size/2,t.y=t.y*o.size/2,[{x:o.x-t.y,y:o.y+t.x,color:o.color},{x:o.x+t.y,y:o.y-t.x,color:o.color}]},l.len=function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},l.scalePositionScalar=function(a,t,e,n){var i,s;return s=t*e,i=t*n,a+(s-i)/2},t.exports=l},{"./shapes":17,"./util":19}],15:[function(a,t){var g,n,m,y;y=a("./util"),n=a("./shapes").JSONToShape,g="infinite",m=function(o,t,e){return t.width?(o.save(),o.translate(o.canvas.width/2,o.canvas.height/2),o.scale(e,e),o.drawImage(t,-t.width/2,-t.height/2),o.restore()):void 0},t.exports=function(r,t){var o,i,s,S,f,x,k,b;return null==t&&(t={}),null==t.scale&&(t.scale=1),x=function(){var t,a,s,l;for(s=r.shapes,l=[],t=0,a=s.length;a>t;t++){f=s[t],l.push(n(f))}return l}(),i=[],r.backgroundShapes&&(i=function(){var t,a,s,l;for(s=r.backgroundShapes,l=[],t=0,a=s.length;a>t;t++){f=s[t],l.push(n(f))}return l}()),null==t.margin&&(t.margin={top:0,right:0,bottom:0,left:0}),S=r.imageSize||{width:g,height:g},s=r.colors||{background:"transparent"},o=x.concat(i),k=document.createElement("canvas"),b=k.getContext("2d"),t.rect?(t.rect.x-=t.margin.left,t.rect.y-=t.margin.top,t.rect.width+=t.margin.left+t.margin.right,t.rect.height+=t.margin.top+t.margin.bottom):t.rect=y.getDefaultImageRect(function(){var a,n,r;for(r=[],a=0,n=o.length;n>a;a++){f=o[a],r.push(f.getBoundingRect(b))}return r}(),S,t.margin),k.width=t.rect.width*t.scale,k.height=t.rect.height*t.scale,b.fillStyle=s.background,b.fillRect(0,0,k.width,k.height),t.rect.width&&t.rect.height?(t.watermarkImage&&m(b,t.watermarkImage,t.watermarkScale),y.combineCanvases(k,y.renderShapes(i,t.rect,t.scale),y.renderShapes(x,t.rect,t.scale))):null}},{"./shapes":17,"./util":19}],16:[function(a,t){var d,n,g;g=a("./util"),n=a("./shapes").JSONToShape,d="infinite",t.exports=function(r,t){var o,i,m,y,S,f,x,k;return null==t&&(t={}),k=function(){var t,a,s,l;for(s=r.shapes,l=[],t=0,a=s.length;a>t;t++){x=s[t],l.push(n(x))}return l}(),i=[],r.backgroundShapes&&(i=function(){var t,a,s,l;for(s=r.backgroundShapes,l=[],t=0,a=s.length;a>t;t++){x=s[t],l.push(n(x))}return l}()),null==t.margin&&(t.margin={top:0,right:0,bottom:0,left:0}),f=r.imageSize||{width:d,height:d},m=r.colors||{background:"transparent"},o=k.concat(i),S=document.createElement("canvas"),y=S.getContext("2d"),t.rect?(t.rect.x-=t.margin.left,t.rect.y-=t.margin.top,t.rect.width+=t.margin.left+t.margin.right,t.rect.height+=t.margin.top+t.margin.bottom):t.rect=g.getDefaultImageRect(function(){var a,n,r;for(r=[],a=0,n=o.length;n>a;a++){x=o[a],r.push(x.getBoundingRect(y))}return r}(),f,t.margin),LC.renderShapesToSVG(i.concat(k),t.rect,m.background)}},{"./shapes":17,"./util":19}],17:[function(n,t){var u,e,P,R,_,E,I,T,L,z,O,N,B,W,D,U,A,M,F,G,H,J;J=n("./util"),P=n("./TextRenderer"),W=n("./lineEndCapShapes"),U=n("./canvasRenderer"),O=U.defineCanvasRenderer,M=U.renderShapeToContext,A=n("./svgRenderer"),N=A.defineSVGRenderer,F=A.renderShapeToSVG,H={},B=function(p,y){var e,t,d,c,g,u,m,S;e=function(e,t,n,i,r,o,s,a,h,l,c,u,p,d,S,g){return y.constructor.call(this,e,t,n,i,r,o,s,a,h,l,c,u,p,d,S,g),this},e.prototype.className=p,e.fromJSON=y.fromJSON,y.draw&&(g=y.draw,u=y.draw||function(o,t,e){return this.draw(o,t,e)},t=function(o,t,e){return g.call(t,o,e)},d=function(o,t,e,a){return u.call(e,o,t,a)},delete y.draw,y.drawLatest&&delete y.drawLatest,O(p,t,d)),y.toSVG&&(m=y.toSVG,S=function(e){return m.call(e)},delete y.toSVG,N(p,S)),e.prototype.draw=function(o,t){return M(o,this,{retryCallback:t})},e.prototype.drawLatest=function(o,t,e){return M(o,this,{retryCallback:e,bufferCtx:t,shouldOnlyDrawLatest:!0})},e.prototype.toSVG=function(){return F(this)};for(c in y){"fromJSON"!==c&&(e.prototype[c]=y[c])}return H[p]=e,e},z=function(p,t,e,n,i,r,o,s,a,h,l,c,u,S,d,f,g){var m;return m=new H[p](t,e,n,i,r,o,s,a,h,l,c,u,S,d,f,g),m.id=J.getGUID(),m},u=function(o){var t,a,s,l;return t=o.className,a=o.data,s=o.id,t in H?(l=H[t].fromJSON(a),l?(s&&(l.id=s),l):(console.log("Unreadable shape:",t,a),null)):(console.log("Unknown shape:",t,a),null)},G=function(e){return{className:e.className,data:e.toJSON(),id:e.id}},L=function u(o,t){return t?L(E(E(T(o))),t-1):o},T=function(a){var s,l,p,d,c;for(a=[a[0]].concat(a).concat(J.last(a)),c=[],s=0,d=0,l=a.length;l>d;d++){p=a[d],c[2*s]=p,a[s+1]&&(c[2*s+1]=I(p,a[s+1])),s+=1}return c},E=function(a){var t,s,l,p,d;for(t=[],s=0,d=0,l=a.length;l>d;d++){p=a[d],a[s+1]&&(t[s]=I(p,a[s+1])),s+=1}return t},I=function(o,t){return z("Point",{x:o.x+(t.x-o.x)/2,y:o.y+(t.y-o.y)/2,size:o.size+(t.size-o.size)/2,color:o.color})},B("Image",{constructor:function constructor(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.scale=e.scale||1,this.image=e.image||null},getBoundingRect:function getBoundingRect(){return{x:this.x,y:this.y,width:this.image.width*this.scale,height:this.image.height*this.scale}},toJSON:function toJSON(){return{x:this.x,y:this.y,imageSrc:this.image.src,imageObject:this.image,scale:this.scale}},fromJSON:function fromJSON(o){var t,a;return t=null,(null!=(a=o.imageObject)?a.width:void 0)?t=o.imageObject:(t=new Image,t.src=o.imageSrc),z("Image",{x:o.x,y:o.y,image:t,scale:o.scale})},move:function move(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function setUpperLeft(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),B("Rectangle",{constructor:function constructor(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.width=e.width||0,this.height=e.height||0,this.strokeWidth=e.strokeWidth||1,this.strokeColor=e.strokeColor||"black",this.fillColor=e.fillColor||"transparent"},getBoundingRect:function getBoundingRect(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function fromJSON(e){return z("Rectangle",e)},move:function move(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function setUpperLeft(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),B("Ellipse",{constructor:function constructor(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.width=e.width||0,this.height=e.height||0,this.strokeWidth=e.strokeWidth||1,this.strokeColor=e.strokeColor||"black",this.fillColor=e.fillColor||"transparent"},getBoundingRect:function getBoundingRect(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function toJSON(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function fromJSON(e){return z("Ellipse",e)},move:function move(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function setUpperLeft(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),B("Line",{constructor:function constructor(e){return null==e&&(e={}),this.x1=e.x1||0,this.y1=e.y1||0,this.x2=e.x2||0,this.y2=e.y2||0,this.strokeWidth=e.strokeWidth||1,this.color=e.color||"black",this.capStyle=e.capStyle||"round",this.endCapShapes=e.endCapShapes||[null,null],this.dash=e.dash||null},getBoundingRect:function getBoundingRect(){return{x:Math.min(this.x1,this.x2)-this.strokeWidth/2,y:Math.min(this.y1,this.y2)-this.strokeWidth/2,width:Math.abs(this.x2-this.x1)+this.strokeWidth/2,height:Math.abs(this.y2-this.y1)+this.strokeWidth/2}},toJSON:function toJSON(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,strokeWidth:this.strokeWidth,color:this.color,capStyle:this.capStyle,dash:this.dash,endCapShapes:this.endCapShapes}},fromJSON:function fromJSON(e){return z("Line",e)},move:function move(e){return null==e&&(e={}),this.x1=this.x1-e.xDiff,this.y1=this.y1-e.yDiff,this.x2=this.x2-e.xDiff,this.y2=this.y2-e.yDiff},setUpperLeft:function setUpperLeft(o){var a,r,s;return null==o&&(o={}),a=this.getBoundingRect(),r=a.x-o.x,s=a.y-o.y,this.move({xDiff:r,yDiff:s})}}),_=function(a){var t,s,l,p,d;if(!a.length)return!1;for(d=a[0].size,t=a[0].color,p=0,s=a.length;s>p;p++){if(l=a[p],l.size===d&&l.color===t||console.log(d,t,l.size,l.color),l.size!==d||l.color!==t)return!1}return!0},R=function(i,l){var e,t,p,d,c;return t=null,l.points?t=function(){var a,n,i,p;for(i=l.points,p=[],n=0,a=i.length;a>n;n++){e=i[n],p.push(u(e))}return p}():l.pointCoordinatePairs&&(t=function(){var e,a,i,s,p;for(i=l.pointCoordinatePairs,p=[],a=0,e=i.length;e>a;a++){s=i[a],d=s[0],c=s[1],p.push(u({className:"Point",data:{x:d,y:c,size:l.pointSize,color:l.pointColor,smooth:l.smooth}}))}return p}()),p=null,l.smoothedPointCoordinatePairs&&(p=function(){var e,a,i,s,p;for(i=l.smoothedPointCoordinatePairs,p=[],a=0,e=i.length;e>a;a++){s=i[a],d=s[0],c=s[1],p.push(u({className:"Point",data:{x:d,y:c,size:l.pointSize,color:l.pointColor,smooth:l.smooth}}))}return p}()),t[0]?z(i,{points:t,smoothedPoints:p,order:l.order,tailSize:l.tailSize,smooth:l.smooth}):null},D={constructor:function constructor(a){var s,l,p,d,c;if(null==a&&(a={}),p=a.points||[],this.order=a.order||3,this.tailSize=a.tailSize||3,this.smooth="smooth"in a?a.smooth:!0,this.segmentSize=Math.pow(2,this.order),this.sampleSize=this.tailSize+1,a.smoothedPoints)return this.points=a.points,this.smoothedPoints=a.smoothedPoints;for(this.points=[],c=[],d=0,s=p.length;s>d;d++){l=p[d],c.push(this.addPoint(l))}return c},getBoundingRect:function getBoundingRect(){return J.getBoundingRect(this.points.map(function(e){return{x:e.x-e.size/2,y:e.y-e.size/2,width:e.size,height:e.size}}))},toJSON:function toJSON(){var o,a;return _(this.points)?{order:this.order,tailSize:this.tailSize,smooth:this.smooth,pointCoordinatePairs:function(){var e,o,s,l;for(s=this.points,l=[],o=0,e=s.length;e>o;o++){a=s[o],l.push([a.x,a.y])}return l}.call(this),smoothedPointCoordinatePairs:function(){var e,o,s,l;for(s=this.smoothedPoints,l=[],o=0,e=s.length;e>o;o++){a=s[o],l.push([a.x,a.y])}return l}.call(this),pointSize:this.points[0].size,pointColor:this.points[0].color}:{order:this.order,tailSize:this.tailSize,smooth:this.smooth,points:function(){var t,a,s,l;for(s=this.points,l=[],a=0,t=s.length;t>a;a++){o=s[a],l.push(G(o))}return l}.call(this)}},fromJSON:function fromJSON(e){return R("LinePath",e)},addPoint:function addPoint(e){return this.points.push(e),this.smooth?!this.smoothedPoints||this.points.length<this.sampleSize?this.smoothedPoints=L(this.points,this.order):(this.tail=J.last(L(J.last(this.points,this.sampleSize),this.order),this.segmentSize*this.tailSize),this.smoothedPoints=this.smoothedPoints.slice(0,this.smoothedPoints.length-this.segmentSize*(this.tailSize-1)).concat(this.tail)):void(this.smoothedPoints=this.points)},move:function move(o){var a,s,l,p;for(null==o&&(o={}),l=this.smooth?this.smoothedPoints:this.points,p=0,a=l.length;a>p;p++){s=l[p],s.move(o)}return this.points=this.smoothedPoints},setUpperLeft:function setUpperLeft(o){var a,r,s;return null==o&&(o={}),a=this.getBoundingRect(),r=a.x-o.x,s=a.y-o.y,this.move({xDiff:r,yDiff:s})}},e=B("LinePath",D),B("ErasedLinePath",{constructor:D.constructor,toJSON:D.toJSON,addPoint:D.addPoint,getBoundingRect:D.getBoundingRect,fromJSON:function fromJSON(e){return R("ErasedLinePath",e)}}),B("Point",{constructor:function constructor(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.size=e.size||0,this.color=e.color||""},getBoundingRect:function getBoundingRect(){return{x:this.x-this.size/2,y:this.y-this.size/2,width:this.size,height:this.size}},toJSON:function toJSON(){return{x:this.x,y:this.y,size:this.size,color:this.color}},fromJSON:function fromJSON(e){return z("Point",e)},move:function move(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function setUpperLeft(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),B("Polygon",{constructor:function constructor(a){var s,l,p,d,c;for(null==a&&(a={}),this.points=a.points,this.fillColor=a.fillColor||"white",this.strokeColor=a.strokeColor||"black",this.strokeWidth=a.strokeWidth,this.dash=a.dash||null,null==a.isClosed&&(a.isClosed=!0),this.isClosed=a.isClosed,d=this.points,c=[],p=0,s=d.length;s>p;p++){l=d[p],l.color=this.strokeColor,c.push(l.size=this.strokeWidth)}return c},addPoint:function addPoint(o,t){return this.points.push(LC.createShape("Point",{x:o,y:t}))},getBoundingRect:function getBoundingRect(){return J.getBoundingRect(this.points.map(function(e){return e.getBoundingRect()}))},toJSON:function toJSON(){return{strokeWidth:this.strokeWidth,fillColor:this.fillColor,strokeColor:this.strokeColor,dash:this.dash,isClosed:this.isClosed,pointCoordinatePairs:this.points.map(function(e){return[e.x,e.y]})}},fromJSON:function fromJSON(o){return o.points=o.pointCoordinatePairs.map(function(t){var e,a;return e=t[0],a=t[1],z("Point",{x:e,y:a,size:o.strokeWidth,color:o.strokeColor})}),z("Polygon",o)},move:function move(a){var s,l,p,d,c;for(null==a&&(a={}),d=this.points,c=[],p=0,s=d.length;s>p;p++){l=d[p],c.push(l.move(a))}return c},setUpperLeft:function setUpperLeft(o){var a,r,s;return null==o&&(o={}),a=this.getBoundingRect(),r=a.x-o.x,s=a.y-o.y,this.move({xDiff:r,yDiff:s})}}),B("Text",{constructor:function constructor(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.v=e.v||0,this.text=e.text||"",this.color=e.color||"black",this.font=e.font||"18px sans-serif",this.forcedWidth=e.forcedWidth||null,this.forcedHeight=e.forcedHeight||null},_makeRenderer:function _makeRenderer(e){return e.lineHeight=1.2,this.renderer=new P(e,this.text,this.font,this.forcedWidth,this.forcedHeight),1>this.v?(console.log("repairing baseline"),this.v=1,this.x-=this.renderer.metrics.bounds.minx,this.y-=this.renderer.metrics.leading-this.renderer.metrics.descent):void 0},setText:function setText(e){return this.text=e,this.renderer=null},setFont:function setFont(e){return this.font=e,this.renderer=null},setPosition:function setPosition(o,t){return this.x=o,this.y=t},setSize:function setSize(o,t){return this.forcedWidth=Math.max(o,0),this.forcedHeight=Math.max(t,0),this.renderer=null},enforceMaxBoundingRect:function enforceMaxBoundingRect(o){var t,a,r;return t=this.getBoundingRect(o.ctx),r={x:-o.position.x/o.scale,y:-o.position.y/o.scale,width:o.canvas.width/o.scale,height:o.canvas.height/o.scale},t.x+t.width>r.x+r.width?(a=t.x-r.x,this.forcedWidth=r.width-a-10,this.renderer=null):void 0},getBoundingRect:function getBoundingRect(o,t){if(null==t&&(t=!1),!this.renderer){if(!o)throw"Must pass ctx if text hasn't been rendered yet";this._makeRenderer(o)}return{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.ceil(this.renderer.getWidth(!0)),height:Math.ceil(this.renderer.getHeight())}},toJSON:function toJSON(){return{x:this.x,y:this.y,text:this.text,color:this.color,font:this.font,forcedWidth:this.forcedWidth,forcedHeight:this.forcedHeight,v:this.v}},fromJSON:function fromJSON(e){return z("Text",e)},move:function move(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function setUpperLeft(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),B("SelectionBox",{constructor:function constructor(e){return null==e&&(e={}),this.shape=e.shape,null!=e.handleSize?this.handleSize=e.handleSize:this.handleSize=10,this.margin=4,this.backgroundColor=e.backgroundColor||null,this._br=this.shape.getBoundingRect(e.ctx)},toJSON:function toJSON(){return{shape:G(this.shape),backgroundColor:this.backgroundColor}},fromJSON:function fromJSON(a){var t,i,s,l;return l=a.shape,i=a.handleSize,s=a.margin,t=a.backgroundColor,z("SelectionBox",{shape:u(l),backgroundColor:t})},getTopLeftHandleRect:function getTopLeftHandleRect(){return{x:this._br.x-this.handleSize-this.margin,y:this._br.y-this.handleSize-this.margin,width:this.handleSize,height:this.handleSize}},getBottomLeftHandleRect:function getBottomLeftHandleRect(){return{x:this._br.x-this.handleSize-this.margin,y:this._br.y+this._br.height+this.margin,width:this.handleSize,height:this.handleSize}},getTopRightHandleRect:function getTopRightHandleRect(){return{x:this._br.x+this._br.width+this.margin,y:this._br.y-this.handleSize-this.margin,width:this.handleSize,height:this.handleSize}},getBottomRightHandleRect:function getBottomRightHandleRect(){return{x:this._br.x+this._br.width+this.margin,y:this._br.y+this._br.height+this.margin,width:this.handleSize,height:this.handleSize}},getBoundingRect:function getBoundingRect(){return{x:this._br.x-this.margin,y:this._br.y-this.margin,width:this._br.width+2*this.margin,height:this._br.height+2*this.margin}}}),t.exports={defineShape:B,createShape:z,JSONToShape:u,shapeToJSON:G}},{"./TextRenderer":6,"./canvasRenderer":9,"./lineEndCapShapes":12,"./svgRenderer":18,"./util":19}],18:[function(a,t){var e,l,n,p;l=a("./lineEndCapShapes"),p={},e=function(o,t){return p[o]=t},n=function(o,t){if(null==t&&(t={}),null==t.shouldIgnoreUnsupportedShapes&&(t.shouldIgnoreUnsupportedShapes=!1),p[o.className])return p[o.className](o);if(t.shouldIgnoreUnsupportedShapes)return console.warn("Can't render shape of type "+o.className+" to SVG"),"";throw"Can't render shape of type "+o.className+" to SVG"},e("Rectangle",function(l){var t,p,d,c,g,u,m,y;return c=l.x,m=l.y,g=l.x+l.width,y=l.y+l.height,d=Math.min(c,g),u=Math.min(m,y),p=Math.max(c,g)-d,t=Math.max(m,y)-u,0!=l.strokeWidth%2&&(d+=.5,u+=.5),"<rect x='"+d+"' y='"+u+"' width='"+p+"' height='"+t+"' stroke='"+l.strokeColor+"' fill='"+l.fillColor+"' stroke-width='"+l.strokeWidth+"' />"}),e("SelectionBox",function(){return""}),e("Ellipse",function(o){var t,a,s,l;return l=Math.floor(o.width/2),s=Math.floor(o.height/2),t=o.x+l,a=o.y+s,"<ellipse cx='"+t+"' cy='"+a+"' rx='"+Math.abs(l)+"' ry='"+Math.abs(s)+"' stroke='"+o.strokeColor+"' fill='"+o.fillColor+"' stroke-width='"+o.strokeWidth+"' />"}),e("Image",function(e){return"<image x='"+e.x+"' y='"+e.y+"' width='"+e.image.naturalWidth*e.scale+"' height='"+e.image.naturalHeight*e.scale+"' xlink:href='"+e.image.src+"' />"}),e("Line",function(r){var t,p,d,c,g,u,m;return d=r.dash?"stroke-dasharray='"+r.dash.join(", ")+"'":"",p="",t=Math.max(2.2*r.strokeWidth,5),c=r.x1,g=r.x2,u=r.y1,m=r.y2,0!=r.strokeWidth%2&&(c+=.5,g+=.5,u+=.5,m+=.5),r.endCapShapes[0]&&(p+=l[r.endCapShapes[0]].svg(c,u,Math.atan2(u-m,c-g),t,r.color)),r.endCapShapes[1]&&(p+=l[r.endCapShapes[1]].svg(g,m,Math.atan2(m-u,g-c),t,r.color)),"<g> <line x1='"+c+"' y1='"+u+"' x2='"+g+"' y2='"+m+"' "+d+" stroke-linecap='"+r.capStyle+"' stroke='"+r.color+" 'stroke-width='"+r.strokeWidth+"' /> "+p+" </g>"}),e("LinePath",function(e){return"<polyline fill='none' points='"+e.smoothedPoints.map(function(o){var t;return t=0==o.strokeWidth%2?0:.5,o.x+t+","+(o.y+t)}).join(" ")+"' stroke='"+e.points[0].color+"' stroke-linecap='round' stroke-width='"+e.points[0].size+"' />"}),e("ErasedLinePath",function(){return""}),e("Polygon",function(e){return e.isClosed?"<polygon fill='"+e.fillColor+"' points='"+e.points.map(function(o){var t;return t=0==o.strokeWidth%2?0:.5,o.x+t+","+(o.y+t)}).join(" ")+"' stroke='"+e.strokeColor+"' stroke-width='"+e.strokeWidth+"' />":"<polyline fill='"+e.fillColor+"' points='"+e.points.map(function(o){var t;return t=0==o.strokeWidth%2?0:.5,o.x+t+","+(o.y+t)}).join(" ")+"' stroke='none' /> <polyline fill='none' points='"+e.points.map(function(o){var t;return t=0==o.strokeWidth%2?0:.5,o.x+t+","+(o.y+t)}).join(" ")+"' stroke='"+e.strokeColor+"' stroke-width='"+e.strokeWidth+"' />"}),e("Text",function(o){var t,a,r;return r=o.forcedWidth?"width='"+o.forcedWidth+"px'":"",t=o.forcedHeight?"height='"+o.forcedHeight+"px'":"",a=o.text.split(/\r\n|\r|\n/g),o.renderer&&(a=o.renderer.lines),"<text x='"+o.x+"' y='"+o.y+"' "+r+" "+t+" fill='"+o.color+"' style='font: "+o.font+";'> "+a.map(function(){return function(t,e){var a;return a=0===e?0:"1.2em","<tspan x='"+o.x+"' dy='"+a+"' alignment-baseline='text-before-edge'> "+t+" </tspan>"}}(this)).join("")+" </text>"}),t.exports={defineSVGRenderer:e,renderShapeToSVG:n}},{"./lineEndCapShapes":12}],19:[function(n,t){var e,l,p,d,c,h=[].slice;d=Array.prototype.slice,l=n("./canvasRenderer").renderShapeToContext,p=n("./svgRenderer").renderShapeToSVG,c=(e={addImageOnload:function addImageOnload(o,t){var e;return e=o.onload,o.onload=function(){return"function"==typeof e&&e(),t()},o},last:function last(o,t){return null==t&&(t=null),t?d.call(o,Math.max(o.length-t,0)):o[o.length-1]},classSet:function classSet(o){var t,a;t=[];for(a in o){o[a]&&t.push(a)}return t.join(" ")},matchElementSize:function matchElementSize(a,t,e,n){var o;return null==n&&(n=function(){}),o=function(){return function(){var i,l,p;for(l=0,p=t.length;p>l;l++){i=t[l],i.style.width=a.offsetWidth+"px",i.style.height=a.offsetHeight+"px",null!=i.width&&(i.setAttribute("width",i.offsetWidth*e),i.setAttribute("height",i.offsetHeight*e))}return n()}}(this),a.addEventListener("resize",o),window.addEventListener("resize",o),window.addEventListener("orientationchange",o),o(),o},combineCanvases:function combineCanvases(){var a,l,p,d,c,g,u,m;for(p=1<=arguments.length?h.call(arguments,0):[],a=document.createElement("canvas"),a.width=p[0].width,a.height=p[0].height,c=0,u=p.length;u>c;c++){l=p[c],a.width=Math.max(l.width,a.width),a.height=Math.max(l.height,a.height)}for(d=a.getContext("2d"),g=0,m=p.length;m>g;g++){l=p[g],d.drawImage(l,0,0)}return a},renderShapes:function renderShapes(i,t,e,p){var d,c,g,u;for(null==e&&(e=1),null==p&&(p=null),p=p||document.createElement("canvas"),p.width=t.width*e,p.height=t.height*e,d=p.getContext("2d"),d.translate(-t.x*e,-t.y*e),d.scale(e,e),c=0,g=i.length;g>c;c++){u=i[c],l(d,u)}return p},renderShapesToSVG:function renderShapesToSVG(r,t,e){var n,l,d,c;return d=t.x,c=t.y,l=t.width,n=t.height,("<svg xmlns='http://www.w3.org/2000/svg' width='"+l+"' height='"+n+"' viewBox='0 0 "+l+" "+n+"'> <rect width='"+l+"' height='"+n+"' x='0' y='0' fill='"+e+"' /> <g transform='translate("+-d+", "+-c+")'> "+r.map(p).join("")+" </g> </svg>").replace(/(\r\n|\n|\r)/gm,"")},getBoundingRect:function getBoundingRect(p,t,e){var n,d,c,g,u,m,y;if(!p.length)return{x:0,y:0,width:t,height:e};for(u=p[0].x,m=p[0].y,c=p[0].x+p[0].width,g=p[0].y+p[0].height,n=0,d=p.length;d>n;n++){y=p[n],u=Math.floor(Math.min(y.x,u)),m=Math.floor(Math.min(y.y,m)),c=Math.ceil(Math.max(c,y.x+y.width)),g=Math.ceil(Math.max(g,y.y+y.height))}return u=t?0:u,m=e?0:m,c=t||c,g=e||g,{x:u,y:m,width:c-u,height:g-m}},getDefaultImageRect:function getDefaultImageRect(a,t,s){var l,p,d;return null==t&&(t={width:0,height:0}),null==s&&(s={top:0,right:0,bottom:0,left:0}),d=t.width,l=t.height,p=c.getBoundingRect(a,"infinite"===d?0:d,"infinite"===l?0:l),p.x-=s.left,p.y-=s.top,p.width+=s.left+s.right,p.height+=s.top+s.bottom,p},getBackingScale:function getBackingScale(){return null==window.devicePixelRatio?1:1<window.devicePixelRatio?window.devicePixelRatio:1},requestAnimationFrame:(window.requestAnimationFrame||window.setTimeout).bind(window),getGUID:function(){var e;return e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},function(){return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}()},_defineProperty(e,"requestAnimationFrame",function requestAnimationFrame(e){return window.requestAnimationFrame?window.requestAnimationFrame(e):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(e):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(e):setTimeout(e,0)}),_defineProperty(e,"cancelAnimationFrame",function cancelAnimationFrame(e){return window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(e):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(e):window.mozCancelAnimationFrame?window.mozCancelAnimationFrame(e):clearTimeout(e)}),e),t.exports=c},{"./canvasRenderer":9,"./svgRenderer":18}],20:[function(){"use strict";!function(){function e(o,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(o,t.bubbles,t.cancelable,t.detail),a}e.prototype=window.CustomEvent.prototype,window.CustomEvent=e}()},{}],21:[function(o,t){"use strict";var e=!1;CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(){e||(console.warn("context2D.setLineDash is a no-op in this browser."),e=!0)}),t.exports=null},{}],22:[function(C,t){var P,e,n,R,_,E,I,T,L,z,O,N,B,W,D,U,A,M,F,G,H;C("./ie_customevent"),C("./ie_setLineDash"),P=C("./core/LiterallyCanvas"),I=C("./core/defaultOptions"),R=C("./core/canvasRenderer"),F=C("./core/svgRenderer"),M=C("./core/shapes"),H=C("./core/util"),D=C("./core/renderSnapshotToImage"),U=C("./core/renderSnapshotToSVG"),B=C("./core/localization").localize,e=C("./reactGUI/LiterallyCanvas"),O=C("./reactGUI/initDOM"),C("./optionsStyles/font"),C("./optionsStyles/stroke-width"),C("./optionsStyles/line-options-and-stroke-width"),C("./optionsStyles/polygon-and-stroke-width"),C("./optionsStyles/stroke-or-fill"),C("./optionsStyles/null"),L=C("./optionsStyles/optionsStyles").defineOptionsStyle,_={snapshotToShapes:function snapshotToShapes(a){var t,s,l,p,d;for(l=a.shapes,p=[],t=0,s=l.length;s>t;t++){d=l[t],p.push(M.JSONToShape(d))}return p},snapshotJSONToShapes:function snapshotJSONToShapes(e){return _.snapshotToShapes(JSON.parse(e))}},n=C("./tools/base"),G={Pencil:C("./tools/Pencil"),Eraser:C("./tools/Eraser"),Line:C("./tools/Line"),Rectangle:C("./tools/Rectangle"),Ellipse:C("./tools/Ellipse"),Text:C("./tools/Text"),Polygon:C("./tools/Polygon"),Pan:C("./tools/Pan"),Eyedropper:C("./tools/Eyedropper"),SelectShape:C("./tools/SelectShape"),Tool:n.Tool,ToolWithStroke:n.ToolWithStroke},T=I.tools,E=I.imageURLPrefix,A=function(e){return E=e,I.imageURLPrefix=e},z=function(t,e){var l,p,d,c,h;null==e&&(e={});for(c in I){c in e||(e[c]=I[c])}for(h=t.children,p=0,d=h.length;d>p;p++){l=h[p],t.removeChild(l)}return C("./reactGUI/initDOM")(t,e)},N=function(a,t){var e,l,p;return p=a.className,-1===[" "," "].join(a.className).indexOf(" literally ")&&(a.className=a.className+" literally"),a.className=a.className+" toolbar-hidden",e=document.createElement("div"),e.className="lc-drawing",a.appendChild(e),l=new P(e,t),l.teardown=function(){var t,o,r,d;for(l._teardown(),d=a.children,o=0,r=d.length;r>o;o++){t=d[o],a.removeChild(t)}return a.className=p},"onInit"in t&&t.onInit(l),l},W=function(e){return e.fn.literallycanvas=function(o){return null==o&&(o={}),this.each(function(){return function(t,e){return e.literallycanvas=z(e,o)}}(this)),this}},"undefined"!=typeof window&&(window.LC={init:z},window.$&&W(window.$)),t.exports={init:z,registerJQueryPlugin:W,util:H,tools:G,setDefaultImageURLPrefix:A,defaultTools:T,defineOptionsStyle:L,LiterallyCanvasReactComponent:e,defineShape:M.defineShape,createShape:M.createShape,JSONToShape:M.JSONToShape,shapeToJSON:M.shapeToJSON,defineCanvasRenderer:R.defineCanvasRenderer,renderShapeToContext:R.renderShapeToContext,renderShapeToCanvas:R.renderShapeToCanvas,renderShapesToCanvas:H.renderShapes,defineSVGRenderer:F.defineSVGRenderer,renderShapeToSVG:F.renderShapeToSVG,renderShapesToSVG:H.renderShapesToSVG,snapshotToShapes:_.snapshotToShapes,snapshotJSONToShapes:_.snapshotJSONToShapes,renderSnapshotToImage:D,renderSnapshotToSVG:U,localize:B}},{"./core/LiterallyCanvas":5,"./core/canvasRenderer":9,"./core/defaultOptions":10,"./core/localization":13,"./core/renderSnapshotToImage":15,"./core/renderSnapshotToSVG":16,"./core/shapes":17,"./core/svgRenderer":18,"./core/util":19,"./ie_customevent":20,"./ie_setLineDash":21,"./optionsStyles/font":23,"./optionsStyles/line-options-and-stroke-width":24,"./optionsStyles/null":25,"./optionsStyles/optionsStyles":26,"./optionsStyles/polygon-and-stroke-width":27,"./optionsStyles/stroke-or-fill":28,"./optionsStyles/stroke-width":29,"./reactGUI/LiterallyCanvas":32,"./reactGUI/initDOM":42,"./tools/Ellipse":43,"./tools/Eraser":44,"./tools/Eyedropper":45,"./tools/Line":46,"./tools/Pan":47,"./tools/Pencil":48,"./tools/Polygon":49,"./tools/Rectangle":50,"./tools/SelectShape":51,"./tools/Text":52,"./tools/base":53}],23:[function(n,t){var R,_,e,E,I,T,L,z,O,N,B,W,D,U,A,M,F,G,H,J,V,q,j;for(I=n("../reactGUI/React-shim"),O=n("./optionsStyles").defineOptionsStyle,z=n("../core/localization")._,T=[["Arial","Arial,\"Helvetica Neue\",Helvetica,sans-serif"],["Arial Black","\"Arial Black\",\"Arial Bold\",Gadget,sans-serif"],["Arial Narrow","\"Arial Narrow\",Arial,sans-serif"],["Gill Sans","\"Gill Sans\",\"Gill Sans MT\",Calibri,sans-serif"],["Helvetica","\"Helvetica Neue\",Helvetica,Arial,sans-serif"],["Impact","Impact,Haettenschweiler,\"Franklin Gothic Bold\",Charcoal,\"Helvetica Inserat\",\"Bitstream Vera Sans Bold\",\"Arial Black\",sans-serif"],["Tahoma","Tahoma,Verdana,Segoe,sans-serif"],["Trebuchet MS","\"Trebuchet MS\",\"Lucida Grande\",\"Lucida Sans Unicode\",\"Lucida Sans\",Tahoma,sans-serif"],["Verdana","Verdana,Geneva,sans-serif"]].map(function(o){var t,a;return t=o[0],a=o[1],{name:z(t),value:a}}),L=[["Baskerville","Baskerville,\"Baskerville Old Face\",\"Hoefler Text\",Garamond,\"Times New Roman\",serif"],["Garamond","Garamond,Baskerville,\"Baskerville Old Face\",\"Hoefler Text\",\"Times New Roman\",serif"],["Georgia","Georgia,Times,\"Times New Roman\",serif"],["Hoefler Text","\"Hoefler Text\",\"Baskerville Old Face\",Garamond,\"Times New Roman\",serif"],["Lucida Bright","\"Lucida Bright\",Georgia,serif"],["Palatino","Palatino,\"Palatino Linotype\",\"Palatino LT STD\",\"Book Antiqua\",Georgia,serif"],["Times New Roman","TimesNewRoman,\"Times New Roman\",Times,Baskerville,Georgia,serif"]].map(function(o){var t,a;return t=o[0],a=o[1],{name:z(t),value:a}}),e=[["Consolas/Monaco","Consolas,monaco,\"Lucida Console\",monospace"],["Courier New","\"Courier New\",Courier,\"Lucida Sans Typewriter\",\"Lucida Typewriter\",monospace"],["Lucida Sans Typewriter","\"Lucida Sans Typewriter\",\"Lucida Console\",monaco,\"Bitstream Vera Sans Mono\",monospace"]].map(function(o){var t,a;return t=o[0],a=o[1],{name:z(t),value:a}}),E=[["Copperplate","Copperplate,\"Copperplate Gothic Light\",fantasy"],["Papyrus","Papyrus,fantasy"],["Script","\"Brush Script MT\",cursive"]].map(function(o){var t,a;return t=o[0],a=o[1],{name:z(t),value:a}}),R=[[z("Sans Serif"),T],[z("Serif"),L],[z("Monospace"),e],[z("Other"),E]],_={},N=0,D=T.length;D>N;N++){H=T[N],G=H.name,j=H.value,_[G]=j}for(B=0,U=L.length;U>B;B++){J=L[B],G=J.name,j=J.value,_[G]=j}for(W=0,A=e.length;A>W;W++){V=e[W],G=V.name,j=V.value,_[G]=j}for(F=0,M=E.length;M>F;F++){q=E[F],G=q.name,j=q.value,_[G]=j}O("font",I.createClass({displayName:"FontOptions",getInitialState:function getInitialState(){return{isItalic:!1,isBold:!1,fontName:"Helvetica",fontSizeIndex:4}},getFontSizes:function getFontSizes(){return[9,10,12,14,18,24,36,48,64,72,96,144,288]},updateTool:function updateTool(o){var a,r,s;null==o&&(o={});for(s in this.state){s in o||(o[s]=this.state[s])}return a=this.getFontSizes()[o.fontSizeIndex],r=[],o.isItalic&&r.push("italic"),o.isBold&&r.push("bold"),r.push(a+"px"),r.push(_[o.fontName]),this.props.lc.tool.font=r.join(" "),this.props.lc.trigger("setFont",r.join(" "))},handleFontSize:function handleFontSize(o){var t;return t={fontSizeIndex:o.target.value},this.setState(t),this.updateTool(t)},handleFontFamily:function handleFontFamily(o){var t;return t={fontName:o.target.selectedOptions[0].innerHTML},this.setState(t),this.updateTool(t)},handleItalic:function handleItalic(){var t;return t={isItalic:!this.state.isItalic},this.setState(t),this.updateTool(t)},handleBold:function handleBold(){var t;return t={isBold:!this.state.isBold},this.setState(t),this.updateTool(t)},componentDidMount:function componentDidMount(){return this.updateTool()},render:function render(){var a,i,d,c,g,m,y,S,f,x;return g=this.props.lc,S=I.DOM,i=S.div,d=S.input,f=S.select,y=S.option,a=S.br,c=S.label,x=S.span,m=S.optgroup,i({className:"lc-font-settings"},f({value:this.state.fontSizeIndex,onChange:this.handleFontSize},this.getFontSizes().map(function(){return function(o,t){return y({value:t,key:t},o+"px")}}(this))),f({value:this.state.fontName,onChange:this.handleFontFamily},R.map(function(){return function(o){var t,a;return a=o[0],t=o[1],m({key:a,label:a},t.map(function(o,t){return y({value:o.name,key:t},o.name)}))}}(this))),x({},c({htmlFor:"italic"},z("italic")),d({type:"checkbox",id:"italic",checked:this.state.isItalic,onChange:this.handleItalic})),x({},c({htmlFor:"bold"},z("bold")),d({type:"checkbox",id:"bold",checked:this.state.isBold,onChange:this.handleBold})))}})),t.exports={}},{"../core/localization":13,"../reactGUI/React-shim":35,"./optionsStyles":26}],24:[function(n,t){var d,g,m,e,l;d=n("../reactGUI/React-shim"),l=n("./optionsStyles").defineOptionsStyle,g=d.createFactory(n("../reactGUI/StrokeWidthPicker")),e=n("../reactGUI/createSetStateOnEventMixin"),m=n("../core/util").classSet,l("line-options-and-stroke-width",d.createClass({displayName:"LineOptionsAndStrokeWidth",getState:function getState(){return{strokeWidth:this.props.tool.strokeWidth,isDashed:this.props.tool.isDashed,hasEndArrow:this.props.tool.hasEndArrow}},getInitialState:function getInitialState(){return this.getState()},mixins:[e("toolChange")],render:function render(){var o,r,i,y,S,f,x,k,b,C;return f=d.DOM,i=f.div,C=f.ul,S=f.li,y=f.img,k=function(e){return function(){return e.props.tool.isDashed=!e.props.tool.isDashed,e.setState(e.getState())}}(this),b=function(e){return function(){return e.props.tool.hasEndArrow=!e.props.tool.hasEndArrow,e.setState(e.getState())}}(this),r=m({"square-toolbar-button":!0,selected:this.state.isDashed}),o=m({"square-toolbar-button":!0,selected:this.state.hasEndArrow}),x={float:"left",margin:1},i({},i({className:r,onClick:k,style:x},y({src:this.props.imageURLPrefix+"/dashed-line.png"})),i({className:o,onClick:b,style:x},y({src:this.props.imageURLPrefix+"/line-with-arrow.png"})),g({tool:this.props.tool,lc:this.props.lc}))}})),t.exports={}},{"../core/util":19,"../reactGUI/React-shim":35,"../reactGUI/StrokeWidthPicker":37,"../reactGUI/createSetStateOnEventMixin":40,"./optionsStyles":26}],25:[function(o,t){var e,a;e=o("../reactGUI/React-shim"),a=o("./optionsStyles").defineOptionsStyle,a("null",e.createClass({displayName:"NoOptions",render:function render(){return e.DOM.div()}})),t.exports={}},{"../reactGUI/React-shim":35,"./optionsStyles":26}],26:[function(a,t){var n,e,s;n=a("../reactGUI/React-shim"),s={},e=function(o,t){return s[o]=n.createFactory(t)},t.exports={optionsStyles:s,defineOptionsStyle:e}},{"../reactGUI/React-shim":35}],27:[function(a,t){var p,d,e,n;p=a("../reactGUI/React-shim"),n=a("./optionsStyles").defineOptionsStyle,d=p.createFactory(a("../reactGUI/StrokeWidthPicker")),e=a("../reactGUI/createSetStateOnEventMixin"),n("polygon-and-stroke-width",p.createClass({displayName:"PolygonAndStrokeWidth",getState:function getState(){return{strokeWidth:this.props.tool.strokeWidth,inProgress:!1}},getInitialState:function getInitialState(){return this.getState()},mixins:[e("toolChange")],componentDidMount:function componentDidMount(){var o,a,s;return s=[],this.unsubscribe=function(){return function(){var o,a,n,l;for(l=[],a=0,n=s.length;n>a;a++){o=s[a],l.push(o())}return l}}(this),a=function(e){return function(){return e.state.inProgress?void 0:e.setState({inProgress:!0})}}(this),o=function(e){return function(){return e.setState({inProgress:!1})}}(this),s.push(this.props.lc.on("lc-polygon-started",a)),s.push(this.props.lc.on("lc-polygon-stopped",o))},componentWillUnmount:function componentWillUnmount(){return this.unsubscribe()},render:function render(){var r,i,c,g,u,m,y,S;return c=this.props.lc,S=p.DOM,r=S.div,i=S.img,m=function(){return function(){return c.trigger("lc-polygon-finishopen")}}(this),u=function(){return function(){return c.trigger("lc-polygon-finishclosed")}}(this),g=function(){return function(){return c.trigger("lc-polygon-cancel")}}(this),y={},this.state.inProgress||(y={display:"none"}),r({},r({className:"polygon-toolbar horz-toolbar",style:y},r({className:"square-toolbar-button",onClick:m},i({src:this.props.imageURLPrefix+"/polygon-open.png"})),r({className:"square-toolbar-button",onClick:u},i({src:this.props.imageURLPrefix+"/polygon-closed.png"})),r({className:"square-toolbar-button",onClick:g},i({src:this.props.imageURLPrefix+"/polygon-cancel.png"}))),r({},d({tool:this.props.tool,lc:this.props.lc})))}})),t.exports={}},{"../reactGUI/React-shim":35,"../reactGUI/StrokeWidthPicker":37,"../reactGUI/createSetStateOnEventMixin":40,"./optionsStyles":26}],28:[function(n,t){"use strict";var e=n("../reactGUI/React-shim"),i=n("./optionsStyles"),r=i.defineOptionsStyle,o=n("../reactGUI/createSetStateOnEventMixin"),s=n("../core/localization")._;r("stroke-or-fill",e.createClass({displayName:"StrokeOrFillPicker",getState:function getState(){return{strokeOrFill:"stroke"}},getInitialState:function getInitialState(){return this.getState()},mixins:[o("toolChange")],onChange:function onChange(e){"stroke-or-fill-stroke"==e.target.id?this.props.lc.tool.strokeOrFill="stroke":this.props.lc.tool.strokeOrFill="fill",this.setState(this.getState())},render:function render(){var o=this.props.lc;return e.createElement("form",null,e.createElement("span",null," ",s("Color to change:")," "),e.createElement("span",null,e.createElement("input",{type:"radio",name:"stroke-or-fill",value:"stroke",id:"stroke-or-fill-stroke",onChange:this.onChange,checked:"stroke"==o.tool.strokeOrFill}),e.createElement("label",{htmlFor:"stroke-or-fill-stroke",className:"label"}," ",s("stroke"))),e.createElement("span",null,e.createElement("input",{type:"radio",name:"stroke-or-fill",value:"fill",id:"stroke-or-fill-fill",onChange:this.onChange,checked:"fill"==o.tool.strokeOrFill}),e.createElement("label",{htmlFor:"stroke-or-fill-fill",className:"label"}," ",s("fill"))))}})),t.exports={}},{"../core/localization":13,"../reactGUI/React-shim":35,"../reactGUI/createSetStateOnEventMixin":40,"./optionsStyles":26}],29:[function(o,t){var e,a;a=o("./optionsStyles").defineOptionsStyle,e=o("../reactGUI/StrokeWidthPicker"),a("stroke-width",e),t.exports={}},{"../reactGUI/StrokeWidthPicker":37,"./optionsStyles":26}],30:[function(n,t){var e,l,p,d,c;l=n("./React-shim"),c=n("./createSetStateOnEventMixin"),p=n("../core/localization")._,d=n("../core/util").classSet,e=l.createClass({displayName:"ClearButton",getState:function getState(){return{isEnabled:this.props.lc.canUndo()}},getInitialState:function getInitialState(){return this.getState()},mixins:[c("drawingChange")],render:function render(){var o,a,r,s;return a=l.DOM.div,r=this.props.lc,o=d({"lc-clear":!0,"toolbar-button":!0,"fat-button":!0,disabled:!this.state.isEnabled}),s=r.canUndo()?function(){return function(){return r.clear()}}(this):function(){},a({className:o,onClick:s},p("Clear"))}}),t.exports=e},{"../core/localization":13,"../core/util":19,"./React-shim":35,"./createSetStateOnEventMixin":40}],31:[function(n,t){var m,e,g,y,S,x,k,b,C,w,v,P;y=n("./React-shim"),g=n("react-addons-pure-render-mixin"),v=n("../core/util"),k=v.classSet,P=v.requestAnimationFrame,x=v.cancelAnimationFrame,S=n("../core/localization")._,w=function(a){var o,s,l,p;return"transparent"===a?{hue:0,sat:0,light:0,alpha:0}:"hsla"!==(null!=a?a.substring(0,4):void 0)?null:(s=a.indexOf("("),p=a.indexOf(")"),l=a.substring(s+1,p-s+4),o=function(){var t,i,s,p;for(s=l.split(","),p=[],t=0,i=s.length;i>t;t++){a=s[t],p.push(a.trim())}return p}(),{hue:parseInt(o[0],10),sat:parseInt(o[1].substring(0,o[1].length-1),10),light:parseInt(o[2].substring(0,o[2].length-1),10),alpha:parseFloat(o[3])})},b=function(o){var t,a,s,l;return a=o.hue,l=o.sat,s=o.light,t=o.alpha,"hsla("+a+", "+l+"%, "+s+"%, "+t+")"},C=function(o){var t,a,r;return t=o.hue,r=o.sat,a=o.light,"hsl("+t+", "+r+"%, "+a+"%)"},m=y.createFactory(y.createClass({displayName:"ColorGrid",mixins:[g],render:function render(){var l;return(l=y.DOM.div)({},this.props.rows.map(function(c){return function(e,t){return l({className:"color-row",key:t,style:{width:20*e.length}},e.map(function(e,t){var n,i,g,m,y,S,f,x;return y=e.hue,f=e.sat,S=e.light,n=e.alpha,g=b(e),m="hsl("+y+", "+f+"%, "+S+"%)",i=k({"color-cell":!0,selected:c.props.selectedColor===g}),x=function(o){return c.props.onChange(e,g),o.stopPropagation(),o.preventDefault()},l({className:i,onTouchStart:x,onTouchMove:x,onClick:x,style:{backgroundColor:m},key:t})}))}}(this)))}})),e=y.createClass({displayName:"ColorWell",mixins:[g],getInitialState:function getInitialState(){var o,a;return o=this.props.lc.colors[this.props.colorName],a=w(o),null==a&&(a={}),null==a.alpha&&(a.alpha=1),null==a.sat&&(a.sat=100),null==a.hue&&(a.hue=0),null==a.light&&(a.light=50),{colorString:o,alpha:a.alpha,sat:0===a.sat?100:a.sat,isPickerVisible:!1,hsla:a}},componentDidMount:function componentDidMount(){return this.unsubscribe=this.props.lc.on(this.props.colorName+"ColorChange",function(o){return function(){var t;return t=o.props.lc.colors[o.props.colorName],o.setState({colorString:t}),o.setHSLAFromColorString(t)}}(this))},componentWillUnmount:function componentWillUnmount(){return this.unsubscribe()},setHSLAFromColorString:function setHSLAFromColorString(o){var t;return t=w(o),t?this.setState({hsla:t,alpha:t.alpha,sat:t.sat}):this.setState({hsla:null,alpha:1,sat:100})},closePicker:function closePicker(){return this.setState({isPickerVisible:!1})},togglePicker:function togglePicker(){var o,a;return o=!this.state.isPickerVisible,a=o&&0===this.state.sat,this.setHSLAFromColorString(this.state.colorString),this.setState({isPickerVisible:o,sat:a?100:this.state.sat})},setColor:function setColor(e){return this.setState({colorString:e}),this.setHSLAFromColorString(e),this.props.lc.setColor(this.props.colorName,e)},setAlpha:function setAlpha(o){var t;return this.setState({alpha:o}),this.state.hsla?(t=this.state.hsla,t.alpha=o,this.setState({hsla:t}),this.setColor(b(t))):void 0},setSat:function setSat(o){var t;if(this.setState({sat:o}),isNaN(o))throw"SAT";return this.state.hsla?(t=this.state.hsla,t.sat=o,this.setState({hsla:t}),this.setColor(b(t))):void 0},render:function render(){var o,a,r,s;return s=y.DOM,a=s.div,r=s.label,o=s.br,a({className:k({"color-well":!0,open:this.state.isPickerVisible}),onMouseLeave:this.closePicker,style:{float:"left",textAlign:"center"}},r({float:"left"},this.props.label),o({}),a({className:k({"color-well-color-container":!0,selected:this.state.isPickerVisible}),style:{backgroundColor:"white"},onClick:this.togglePicker},a({className:"color-well-checker color-well-checker-top-left"}),a({className:"color-well-checker color-well-checker-bottom-right",style:{left:"50%",top:"50%"}}),a({className:"color-well-color",style:{backgroundColor:this.state.colorString}}," ")),this.renderPicker())},renderPicker:function renderPicker(){var a,i,s,x,k,b,C,w,v,P,R,_,E,I;if(P=y.DOM,i=P.div,C=P.label,k=P.input,!this.state.isPickerVisible)return null;for(E=function(){return function(t){return i({className:"color-row label",key:t,style:{lineHeight:"20px",height:16}},t)}}(this),_=function(t){return function(){var e;return e=t.props.lc.opts.imageURLPrefix+"/checkerboard-8x8.png",i({className:"color-row",key:"color",style:{position:"relative",backgroundImage:"url("+e+")",backgroundRepeat:"repeat",height:24}},i({style:{position:"absolute",top:0,right:0,bottom:0,left:0,backgroundColor:t.state.colorString}}))}}(this),I=[],I.push(function(){var o,a;for(a=[],x=o=0;100>=o;x=o+=10){a.push({hue:0,sat:0,light:x,alpha:this.state.alpha})}return a}.call(this)),R=[0,30,60,90,120,150,180,210,240,270,300,330],b=0,w=R.length;w>b;b++){s=R[b],I.push(function(){var e,o;for(o=[],x=e=10;90>=e;x=e+=8){o.push({hue:s,sat:this.state.sat,light:x,alpha:this.state.alpha})}return o}.call(this))}return v=function(o){return function(t,e){return o.setColor(e)}}(this),i({className:"color-picker-popup"},_(),E(S("alpha")),k({type:"range",min:0,max:1,step:.01,value:this.state.alpha,onChange:function(o){return function(t){return o.setAlpha(parseFloat(t.target.value))}}(this)}),E(S("saturation")),k((a={type:"range",min:0,max:100,value:this.state.sat},_defineProperty(a,"max",100),_defineProperty(a,"onChange",function(o){return function(t){return o.setSat(parseInt(t.target.value,10))}}(this)),a)),m({rows:I,selectedColor:this.state.colorString,onChange:v}))}}),t.exports=e},{"../core/localization":13,"../core/util":19,"./React-shim":35,"react-addons-pure-render-mixin":2}],32:[function(n,t){"use strict";var g=n("../reactGUI/React-shim"),e=n("../reactGUI/ReactDOM-shim"),r=e.findDOMNode,o=n("../core/util"),i=o.classSet,a=n("./Picker"),h=n("./Options"),s=n("./createToolButton"),l=n("../core/LiterallyCanvas"),c=n("../core/defaultOptions");n("../optionsStyles/font"),n("../optionsStyles/stroke-width"),n("../optionsStyles/line-options-and-stroke-width"),n("../optionsStyles/polygon-and-stroke-width"),n("../optionsStyles/null");var p=g.createClass({displayName:"CanvasContainer",shouldComponentUpdate:function shouldComponentUpdate(){return!1},render:function render(){return g.createElement("div",{key:"literallycanvas",className:"lc-drawing with-gui"})}}),d=g.createClass({displayName:"LiterallyCanvas",getDefaultProps:function getDefaultProps(){return c},bindToModel:function bindToModel(){var e=r(this.canvas);this.props;this.lc.bindToElement(e),"function"==typeof this.lc.opts.onInit&&this.lc.opts.onInit(this.lc)},componentWillMount:function componentWillMount(){var o=this;this.lc||(this.props.lc?this.lc=this.props.lc:this.lc=new l(this.props),this.toolButtonComponents=this.lc.opts.tools.map(function(t){return s(new t(o.lc))}))},componentDidMount:function componentDidMount(){this.lc.isBound||this.bindToModel()},componentWillUnmount:function componentWillUnmount(){this.lc&&this.lc._teardown()},render:function render(){var l=this,t=this.lc,e=this.toolButtonComponents,n=(this.props,this.lc.opts),r=n.imageURLPrefix,o=n.toolbarPosition,s=i({"toolbar-at-top":"top"===o,"toolbar-at-bottom":"bottom"===o,"toolbar-hidden":"hidden"===o});return g.createElement("div",{className:"literally "+s},g.createElement(p,{ref:function ref(t){return l.canvas=t}}),g.createElement(a,{lc:t,toolButtonComponents:e,imageURLPrefix:r}),g.createElement(h,{lc:t,imageURLPrefix:r}))}});t.exports=d},{"../core/LiterallyCanvas":5,"../core/defaultOptions":10,"../core/util":19,"../optionsStyles/font":23,"../optionsStyles/line-options-and-stroke-width":24,"../optionsStyles/null":25,"../optionsStyles/polygon-and-stroke-width":27,"../optionsStyles/stroke-width":29,"../reactGUI/React-shim":35,"../reactGUI/ReactDOM-shim":36,"./Options":33,"./Picker":34,"./createToolButton":41}],33:[function(a,t){var e,n,l,p;n=a("./React-shim"),l=a("./createSetStateOnEventMixin"),p=a("../optionsStyles/optionsStyles").optionsStyles,e=n.createClass({displayName:"Options",getState:function getState(){var e;return{style:null!=(e=this.props.lc.tool)?e.optionsStyle:void 0,tool:this.props.lc.tool}},getInitialState:function getInitialState(){return this.getState()},mixins:[l("toolChange")],renderBody:function renderBody(){var e;return e=""+this.state.style,p[e]&&p[e]({lc:this.props.lc,tool:this.state.tool,imageURLPrefix:this.props.imageURLPrefix})},render:function render(){var e;return(e=n.DOM.div)({className:"lc-options horz-toolbar"},this.renderBody())}}),t.exports=e},{"../optionsStyles/optionsStyles":26,"./React-shim":35,"./createSetStateOnEventMixin":40}],34:[function(n,t){var p,d,g,e,u,m,y,S;u=n("./React-shim"),p=u.createFactory(n("./ClearButton")),m=u.createFactory(n("./UndoRedoButtons")),y=u.createFactory(n("./ZoomButtons")),S=n("../core/localization")._,g=u.createFactory(n("./ColorWell")),d=u.createFactory(u.createClass({displayName:"ColorPickers",render:function render(){var o,a;return a=this.props.lc,(o=u.DOM.div)({className:"lc-color-pickers"},g({lc:a,colorName:"primary",label:S("stroke")}),g({lc:a,colorName:"secondary",label:S("fill")}),g({lc:a,colorName:"background",label:S("bg")}))}})),e=u.createClass({displayName:"Picker",getInitialState:function getInitialState(){return{selectedToolIndex:0}},renderBody:function renderBody(){var a,l,c,r,i;return a=u.DOM.div,r=this.props,i=r.toolButtonComponents,c=r.lc,l=r.imageURLPrefix,a({className:"lc-picker-contents"},i.map(function(o){return function(e,t){return e({lc:c,imageURLPrefix:l,key:t,isSelected:t===o.state.selectedToolIndex,onSelect:function onSelect(a){return c.setTool(a),o.setState({selectedToolIndex:t})}})}}(this)),0!=i.length%2?a({className:"toolbar-button thin-button disabled"}):void 0,a({style:{position:"absolute",bottom:0,left:0,right:0}},d({lc:this.props.lc}),m({lc:c,imageURLPrefix:l}),y({lc:c,imageURLPrefix:l}),p({lc:c})))},render:function render(){var e;return(e=u.DOM.div)({className:"lc-picker"},this.renderBody())}}),t.exports=e},{"../core/localization":13,"./ClearButton":30,"./ColorWell":31,"./React-shim":35,"./UndoRedoButtons":38,"./ZoomButtons":39}],35:[function(o,t){var e;try{e=o("react")}catch(t){e=window.React}if(null==e)throw"Can't find React";t.exports=e},{react:"react"}],36:[function(o,t){var e;try{e=o("react-dom")}catch(t){e=window.ReactDOM}if(null==e)try{e=o("react")}catch(t){e=window.React}if(null==e)throw"Can't find ReactDOM";t.exports=e},{react:"react","react-dom":"react-dom"}],37:[function(a,t){var l,p,e;l=a("./React-shim"),e=a("../reactGUI/createSetStateOnEventMixin"),p=a("../core/util").classSet,t.exports=l.createClass({displayName:"StrokeWidthPicker",getState:function getState(e){return null==e&&(e=this.props.tool),{strokeWidth:e.strokeWidth}},getInitialState:function getInitialState(){return this.getState()},mixins:[e("toolDidUpdateOptions")],componentWillReceiveProps:function componentWillReceiveProps(e){return this.setState(this.getState(e.tool))},render:function render(){var r,d,i,c,g,u,m;return c=l.DOM,m=c.ul,i=c.li,u=c.svg,r=c.circle,d=c.div,g=this.props.lc.opts.strokeWidths,d({},g.map(function(e){return function(t){var o,a;return o=p({"square-toolbar-button":!0,selected:t===e.state.strokeWidth}),a=28,d({key:t},d({className:o,onClick:function onClick(){return e.props.lc.trigger("setStrokeWidth",t)}},u({width:a-2,height:a-2,viewPort:"0 0 "+t+" "+t,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r({cx:Math.ceil(a/2-1),cy:Math.ceil(a/2-1),r:t/2}))))}}(this)))}})},{"../core/util":19,"../reactGUI/createSetStateOnEventMixin":40,"./React-shim":35}],38:[function(n,t){var g,e,p,d,m,c,u;g=n("./React-shim"),c=n("./createSetStateOnEventMixin"),m=n("../core/util").classSet,u=function(a){return g.createClass({displayName:"undo"===a?"UndoButton":"RedoButton",getState:function getState(){return{isEnabled:function(){switch(!1){case"undo"!==a:return this.props.lc.canUndo();case"redo"!==a:return this.props.lc.canRedo();}}.call(this)}},getInitialState:function getInitialState(){return this.getState()},mixins:[c("drawingChange")],render:function render(){var t,i,y,S,f,x,k,b,C,w,v;return k=g.DOM,i=k.div,S=k.img,b=this.props,f=b.lc,y=b.imageURLPrefix,v="undo"===a?"Undo":"Redo",t="lc-"+a+" "+m({"toolbar-button":!0,"thin-button":!0,disabled:!this.state.isEnabled}),x=function(){switch(!1){case!!this.state.isEnabled:return function(){};case"undo"!==a:return function(){return f.undo()};case"redo"!==a:return function(){return f.redo()};}}.call(this),C=y+"/"+a+".png",w={backgroundImage:"url("+C+")"},i({className:t,onClick:x,title:v,style:w})}})},p=g.createFactory(u("undo")),e=g.createFactory(u("redo")),d=g.createClass({displayName:"UndoRedoButtons",render:function render(){var o;return(o=g.DOM.div)({className:"lc-undo-redo"},p(this.props),e(this.props))}}),t.exports=d},{"../core/util":19,"./React-shim":35,"./createSetStateOnEventMixin":40}],39:[function(n,t){var g,e,p,d,m,c,u;g=n("./React-shim"),c=n("./createSetStateOnEventMixin"),m=n("../core/util").classSet,u=function(a){return g.createClass({displayName:"in"===a?"ZoomInButton":"ZoomOutButton",getState:function getState(){return{isEnabled:function(){switch(!1){case"in"!==a:return this.props.lc.scale<this.props.lc.config.zoomMax;case"out"!==a:return this.props.lc.scale>this.props.lc.config.zoomMin;}}.call(this)}},getInitialState:function getInitialState(){return this.getState()},mixins:[c("zoom")],render:function render(){var t,i,y,S,f,x,k,b,C,w,v;return k=g.DOM,i=k.div,S=k.img,b=this.props,f=b.lc,y=b.imageURLPrefix,v="in"===a?"Zoom in":"Zoom out",t="lc-zoom-"+a+" "+m({"toolbar-button":!0,"thin-button":!0,disabled:!this.state.isEnabled}),x=function(){switch(!1){case!!this.state.isEnabled:return function(){};case"in"!==a:return function(){return f.zoom(f.config.zoomStep)};case"out"!==a:return function(){return f.zoom(-f.config.zoomStep)};}}.call(this),C=y+"/zoom-"+a+".png",w={backgroundImage:"url("+C+")"},i({className:t,onClick:x,title:v,style:w})}})},d=g.createFactory(u("out")),p=g.createFactory(u("in")),e=g.createClass({displayName:"ZoomButtons",render:function render(){var e;return(e=g.DOM.div)({className:"lc-zoom"},d(this.props),p(this.props))}}),t.exports=e},{"../core/util":19,"./React-shim":35,"./createSetStateOnEventMixin":40}],40:[function(o,t){var e,a;e=o("./React-shim"),t.exports=a=function(e){return{componentDidMount:function componentDidMount(){return this.unsubscribe=this.props.lc.on(e,function(e){return function(){return e.setState(e.getState())}}(this))},componentWillUnmount:function componentWillUnmount(){return this.unsubscribe()}}}},{"./React-shim":35}],41:[function(a,t){var g,m,y,e;g=a("./React-shim"),y=a("../core/util").classSet,m=a("../core/localization")._,e=function(o){var t,r;return t=o.name,r=o.iconName,g.createFactory(g.createClass({displayName:t,getDefaultProps:function getDefaultProps(){return{isSelected:!1,lc:null}},componentWillMount:function componentWillMount(){return this.props.isSelected?this.props.lc.setTool(o):void 0},render:function render(){var e,n,i,S,x,k,b,C,w;return b=g.DOM,n=b.div,S=b.img,C=this.props,i=C.imageURLPrefix,x=C.isSelected,k=C.onSelect,e=y({"lc-pick-tool":!0,"toolbar-button":!0,"thin-button":!0,selected:x}),w=i+"/"+r+".png",n({className:e,style:{backgroundImage:"url("+w+")"},onClick:function onClick(){return k(o)},title:m(t)})}}))},t.exports=e},{"../core/localization":13,"../core/util":19,"./React-shim":35}],42:[function(n,t){"use strict";function e(a,t){var p=a.className,n=new o(t);return r.render(l.createElement(s,{lc:n}),a),n.teardown=function(){n._teardown();for(var t=0;t<a.children.length;t++){a.removeChild(a.children[t])}a.className=p},n}var l=n("./React-shim"),r=n("./ReactDOM-shim"),o=n("../core/LiterallyCanvas"),s=n("./LiterallyCanvas");t.exports=e},{"../core/LiterallyCanvas":5,"./LiterallyCanvas":32,"./React-shim":35,"./ReactDOM-shim":36}],43:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").ToolWithStroke,p=n("../core/shapes").createShape,t.exports=e=function(o){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,o),t.prototype.name="Ellipse",t.prototype.iconName="ellipse",t.prototype.begin=function(o,t,e){return this.currentShape=p("Ellipse",{x:o,y:t,strokeWidth:this.strokeWidth,strokeColor:e.getColor("primary"),fillColor:e.getColor("secondary")})},t.prototype["continue"]=function(o,t,e){return this.currentShape.width=o-this.currentShape.x,this.currentShape.height=t-this.currentShape.y,e.drawShapeInProgress(this.currentShape)},t.prototype.end=function(o,t,e){return e.saveShape(this.currentShape)},t}(l)},{"../core/shapes":17,"./base":53}],44:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./Pencil"),p=n("../core/shapes").createShape,t.exports=e=function(o){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,o),t.prototype.name="Eraser",t.prototype.iconName="eraser",t.prototype.makePoint=function(o,t){return p("Point",{x:o,y:t,size:this.strokeWidth,color:"#000"})},t.prototype.makeShape=function(){return p("ErasedLinePath")},t}(l)},{"../core/shapes":17,"./Pencil":48}],45:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").Tool,p=function(o,t){var e,a,s;return a=t.x,s=t.y,e=o.getImageData(a,s,1,1).data,e[3]?"rgb("+e[0]+", "+e[1]+", "+e[2]+")":null},t.exports=e=function(o){function a(e){a.__super__.constructor.call(this,e),this.strokeOrFill="stroke"}return d(a,o),a.prototype.name="Eyedropper",a.prototype.iconName="eyedropper",a.prototype.optionsStyle="stroke-or-fill",a.prototype.readColor=function(o,t,e){var n,l,d,c;return c=e.getDefaultImageRect(),n=e.getImage(),d=p(n.getContext("2d"),{x:o-c.x,y:t-c.y}),l=d||e.getColor("background"),"stroke"===this.strokeOrFill?e.setColor("primary",d):e.setColor("secondary",d)},a.prototype.begin=function(o,t,e){return this.readColor(o,t,e)},a.prototype["continue"]=function(o,t,e){return this.readColor(o,t,e)},a}(l)},{"./base":53}],46:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").ToolWithStroke,p=n("../core/shapes").createShape,t.exports=e=function(o){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,o),t.prototype.name="Line",t.prototype.iconName="line",t.prototype.optionsStyle="line-options-and-stroke-width",t.prototype.begin=function(o,t,e){return this.currentShape=p("Line",{x1:o,y1:t,x2:o,y2:t,strokeWidth:this.strokeWidth,dash:function(){switch(!1){case!this.isDashed:return[2*this.strokeWidth,4*this.strokeWidth];default:return null;}}.call(this),endCapShapes:this.hasEndArrow?[null,"arrow"]:null,color:e.getColor("primary")})},t.prototype["continue"]=function(o,t,e){return this.currentShape.x2=o,this.currentShape.y2=t,e.drawShapeInProgress(this.currentShape)},t.prototype.end=function(o,t,e){return e.saveShape(this.currentShape)},t}(l)},{"../core/shapes":17,"./base":53}],47:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").Tool,p=n("../core/shapes").createShape,t.exports=e=function(o){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,o),t.prototype.name="Pan",t.prototype.iconName="pan",t.prototype.usesSimpleAPI=!1,t.prototype.didBecomeActive=function(a){var o;return o=[],this.unsubscribe=function(){return function(){var e,a,s,l;for(l=[],a=0,s=o.length;s>a;a++){e=o[a],l.push(e())}return l}}(this),o.push(a.on("lc-pointerdown",function(t){return function(e){var o,n;return o=e.rawX,n=e.rawY,t.oldPosition=a.position,t.pointerStart={x:o,y:n}}}(this))),o.push(a.on("lc-pointerdrag",function(t){return function(e){var n,s,l;return s=e.rawX,l=e.rawY,n={x:(s-t.pointerStart.x)*a.backingScale,y:(l-t.pointerStart.y)*a.backingScale},a.setPan(t.oldPosition.x+n.x,t.oldPosition.y+n.y)}}(this)))},t.prototype.willBecomeInactive=function(){return this.unsubscribe()},t}(l)},{"../core/shapes":17,"./base":53}],48:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").ToolWithStroke,p=n("../core/shapes").createShape,t.exports=e=function(o){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,o),t.prototype.name="Pencil",t.prototype.iconName="pencil",t.prototype.eventTimeThreshold=10,t.prototype.begin=function(o,t,e){return this.color=e.getColor("primary"),this.currentShape=this.makeShape(),this.currentShape.addPoint(this.makePoint(o,t,e)),this.lastEventTime=Date.now()},t.prototype["continue"]=function(o,t,e){var a;return a=Date.now()-this.lastEventTime,a>this.eventTimeThreshold?(this.lastEventTime+=a,this.currentShape.addPoint(this.makePoint(o,t,e)),e.drawShapeInProgress(this.currentShape)):void 0},t.prototype.end=function(o,t,e){return e.saveShape(this.currentShape),this.currentShape=void 0},t.prototype.makePoint=function(o,t){return p("Point",{x:o,y:t,size:this.strokeWidth,color:this.color})},t.prototype.makeShape=function(){return p("LinePath")},t}(l)},{"../core/shapes":17,"./base":53}],49:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").ToolWithStroke,p=n("../core/shapes").createShape,t.exports=e=function(o){function l(){return l.__super__.constructor.apply(this,arguments)}return d(l,o),l.prototype.name="Polygon",l.prototype.iconName="polygon",l.prototype.usesSimpleAPI=!1,l.prototype.didBecomeActive=function(p){var e,t,d,c,g,u,m;return l.__super__.didBecomeActive.call(this,p),m=[],this.polygonUnsubscribe=function(){return function(){var o,a,r,s;for(s=[],a=0,r=m.length;r>a;a++){o=m[a],s.push(o())}return s}}(this),this.points=null,this.maybePoint=null,d=function(t){return function(){return t._getWillFinish()?t._close(p):(p.trigger("lc-polygon-started"),t.points?t.points.push(t.maybePoint):t.points=[t.maybePoint],t.maybePoint={x:t.maybePoint.x,y:t.maybePoint.y},p.setShapesInProgress(t._getShapes(p)),p.repaintLayer("main"))}}(this),t=function(t){return function(e){var o,a;return o=e.x,a=e.y,t.maybePoint?(t.maybePoint.x=o,t.maybePoint.y=a,p.setShapesInProgress(t._getShapes(p)),p.repaintLayer("main")):void 0}}(this),e=function(t){return function(e){var o,a;return o=e.x,a=e.y,t.maybePoint={x:o,y:a},p.setShapesInProgress(t._getShapes(p)),p.repaintLayer("main")}}(this),u=function(t){return function(){return t.maybePoint={x:1/0,y:1/0},t._close(p)}}(this),g=function(t){return function(){return t.maybePoint=t.points[0],t._close(p)}}(this),c=function(t){return function(){return t._cancel(p)}}(this),m.push(p.on("drawingChange",function(t){return function(){return t._cancel(p)}}(this))),m.push(p.on("lc-pointerdown",e)),m.push(p.on("lc-pointerdrag",t)),m.push(p.on("lc-pointermove",t)),m.push(p.on("lc-pointerup",d)),m.push(p.on("lc-polygon-finishopen",u)),m.push(p.on("lc-polygon-finishclosed",g)),m.push(p.on("lc-polygon-cancel",c))},l.prototype.willBecomeInactive=function(e){return l.__super__.willBecomeInactive.call(this,e),(this.points||this.maybePoint)&&this._cancel(e),this.polygonUnsubscribe()},l.prototype._getArePointsClose=function(o,t){return 10>Math.abs(o.x-t.x)+Math.abs(o.y-t.y)},l.prototype._getWillClose=function(){return this.points&&1<this.points.length&&this.maybePoint?this._getArePointsClose(this.points[0],this.maybePoint):!1},l.prototype._getWillFinish=function(){return this.points&&1<this.points.length&&this.maybePoint?this._getArePointsClose(this.points[0],this.maybePoint)||this._getArePointsClose(this.points[this.points.length-1],this.maybePoint):!1},l.prototype._cancel=function(e){return e.trigger("lc-polygon-stopped"),this.maybePoint=null,this.points=null,e.setShapesInProgress([]),e.repaintLayer("main")},l.prototype._close=function(e){return e.trigger("lc-polygon-stopped"),e.setShapesInProgress([]),2<this.points.length&&e.saveShape(this._getShape(e,!1)),this.maybePoint=null,this.points=null},l.prototype._getShapes=function(o,t){var a;return null==t&&(t=!0),a=this._getShape(o,t),a?[a]:[]},l.prototype._getShape=function(o,t){var a;return null==t&&(t=!0),a=[],this.points&&(a=a.concat(this.points)),!t&&3>a.length?null:(t&&this.maybePoint&&a.push(this.maybePoint),1<a.length?p("Polygon",{isClosed:this._getWillClose(),strokeColor:o.getColor("primary"),fillColor:o.getColor("secondary"),strokeWidth:this.strokeWidth,points:a.map(function(e){return p("Point",e)})}):null)},l.prototype.optionsStyle="polygon-and-stroke-width",l}(l)},{"../core/shapes":17,"./base":53}],50:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").ToolWithStroke,p=n("../core/shapes").createShape,t.exports=e=function(o){function t(){return t.__super__.constructor.apply(this,arguments)}return d(t,o),t.prototype.name="Rectangle",t.prototype.iconName="rectangle",t.prototype.begin=function(o,t,e){return this.currentShape=p("Rectangle",{x:o,y:t,strokeWidth:this.strokeWidth,strokeColor:e.getColor("primary"),fillColor:e.getColor("secondary")})},t.prototype["continue"]=function(o,t,e){return this.currentShape.width=o-this.currentShape.x,this.currentShape.height=t-this.currentShape.y,e.drawShapeInProgress(this.currentShape)},t.prototype.end=function(o,t,e){return e.saveShape(this.currentShape)},t}(l)},{"../core/shapes":17,"./base":53}],51:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;l=n("./base").Tool,p=n("../core/shapes").createShape,t.exports=e=function(o){function t(){this.selectCanvas=document.createElement("canvas"),this.selectCanvas.style["background-color"]="transparent",this.selectCtx=this.selectCanvas.getContext("2d")}return d(t,o),t.prototype.name="SelectShape",t.prototype.usesSimpleAPI=!1,t.prototype.didBecomeActive=function(o){var t,a,s,l;return l=[],this._selectShapeUnsubscribe=function(){return function(){var o,a,r,s;for(s=[],a=0,r=l.length;r>a;a++){o=l[a],s.push(o())}return s}}(this),t=function(t){return function(e){var n,l,d,c;return d=e.x,c=e.y,t.didDrag=!1,l=t._getPixel(d,c,o,t.selectCtx),t.selectedShape=o.shapes[l],null!=t.selectedShape?(o.trigger("shapeSelected",{selectedShape:t.selectedShape}),o.setShapesInProgress([t.selectedShape,p("SelectionBox",{shape:t.selectedShape,handleSize:0})]),o.repaintLayer("main"),n=t.selectedShape.getBoundingRect(),t.dragOffset={x:d-n.x,y:c-n.y}):void 0}}(this),a=function(t){return function(e){var a,n;return a=e.x,n=e.y,null!=t.selectedShape?(t.didDrag=!0,t.selectedShape.setUpperLeft({x:a-t.dragOffset.x,y:n-t.dragOffset.y}),o.setShapesInProgress([t.selectedShape,p("SelectionBox",{shape:t.selectedShape,handleSize:0})]),o.repaintLayer("main")):void 0}}(this),s=function(t){return function(e){var a,n;return a=e.x,n=e.y,t.didDrag?(t.didDrag=!1,o.trigger("shapeMoved",{shape:t.selectedShape}),o.trigger("drawingChange",{}),o.repaintLayer("main"),t._drawSelectCanvas(o)):void 0}}(this),l.push(o.on("lc-pointerdown",t)),l.push(o.on("lc-pointerdrag",a)),l.push(o.on("lc-pointerup",s)),this._drawSelectCanvas(o)},t.prototype.willBecomeInactive=function(e){return this._selectShapeUnsubscribe(),e.setShapesInProgress([])},t.prototype._drawSelectCanvas=function(o){var t;return this.selectCanvas.width=o.canvas.width,this.selectCanvas.height=o.canvas.height,this.selectCtx.clearRect(0,0,this.selectCanvas.width,this.selectCanvas.height),t=o.shapes.map(function(o){return function(t,e){return p("SelectionBox",{shape:t,handleSize:0,backgroundColor:"#"+o._intToHex(e)})}}(this)),o.draw(t,this.selectCtx)},t.prototype._intToHex=function(e){return("000000"+e.toString(16)).slice(-6)},t.prototype._getPixel=function(a,t,e,n){var i,s;return i=e.drawingCoordsToClientCoords(a,t),s=n.getImageData(i.x,i.y,1,1).data,s[3]?parseInt(this._rgbToHex(s[0],s[1],s[2]),16):null},t.prototype._componentToHex=function(o){var t;return t=o.toString(16),("0"+t).slice(-2)},t.prototype._rgbToHex=function(o,t,e){return""+this._componentToHex(o)+this._componentToHex(t)+this._componentToHex(e)},t}(l)},{"../core/shapes":17,"./base":53}],52:[function(n,t){var e,l,p,d,c=function(o,t){function e(){this.constructor=o}for(var n in t){a.call(t,n)&&(o[n]=t[n])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},a={}.hasOwnProperty;l=n("./base").Tool,p=n("../core/shapes").createShape,d=function(o,t){return o.x<t.x?!1:o.y<t.y?!1:o.x>t.x+t.width?!1:!(o.y>t.y+t.height)},t.exports=e=function(o){function t(){this.text="",this.font="bold 18px sans-serif",this.currentShape=null,this.currentShapeState=null,this.initialShapeBoundingRect=null,this.dragAction=null,this.didDrag=!1}return c(t,o),t.prototype.name="Text",t.prototype.iconName="text",t.prototype.didBecomeActive=function(o){var t,a,r;return a=[],this.unsubscribe=function(){return function(){var o,n,s,l;for(l=[],n=0,s=a.length;s>n;n++){o=a[n],l.push(o())}return l}}(this),t=function(t){return function(){return t._ensureNotEditing(o),t._clearCurrentShape(o),o.repaintLayer("main")}}(this),r=function(t){return function(){return t._updateInputEl(o)}}(this),a.push(o.on("drawingChange",t)),a.push(o.on("zoom",r)),a.push(o.on("imageSizeChange",r)),a.push(o.on("snapshotLoad",function(t){return function(){return t._clearCurrentShape(o),o.repaintLayer("main")}}(this))),a.push(o.on("primaryColorChange",function(t){return function(e){return t.currentShape?(t.currentShape.color=e,t._updateInputEl(o),o.repaintLayer("main")):void 0}}(this))),a.push(o.on("setFont",function(t){return function(e){return t.currentShape?(t.font=e,t.currentShape.setFont(e),t._setShapesInProgress(o),t._updateInputEl(o),o.repaintLayer("main")):void 0}}(this)))},t.prototype.willBecomeInactive=function(e){return this.currentShape&&(this._ensureNotEditing(e),this.commit(e)),this.unsubscribe()},t.prototype.setText=function(e){return this.text=e},t.prototype._ensureNotEditing=function(e){return"editing"===this.currentShapeState?this._exitEditingState(e):void 0},t.prototype._clearCurrentShape=function(e){return this.currentShape=null,this.initialShapeBoundingRect=null,this.currentShapeState=null,e.setShapesInProgress([])},t.prototype.commit=function(e){return this.currentShape.text&&e.saveShape(this.currentShape),this._clearCurrentShape(e),e.repaintLayer("main")},t.prototype._getSelectionShape=function(o,t){return null==t&&(t=null),p("SelectionBox",{shape:this.currentShape,ctx:o,backgroundColor:t})},t.prototype._setShapesInProgress=function(e){switch(this.currentShapeState){case"selected":return e.setShapesInProgress([this._getSelectionShape(e.ctx),this.currentShape]);case"editing":return e.setShapesInProgress([this._getSelectionShape(e.ctx,"#fff")]);default:return e.setShapesInProgress([this.currentShape]);}},t.prototype.begin=function(o,t,e){var n,s,l,c;return this.dragAction="none",this.didDrag=!1,"selected"===this.currentShapeState||"editing"===this.currentShapeState?(n=this.currentShape.getBoundingRect(e.ctx),c=this._getSelectionShape(e.ctx),l=c.getBoundingRect(),s={x:o,y:t},d(s,n)&&(this.dragAction="move"),d(s,c.getBottomRightHandleRect())&&(this.dragAction="resizeBottomRight"),d(s,c.getTopLeftHandleRect())&&(this.dragAction="resizeTopLeft"),d(s,c.getBottomLeftHandleRect())&&(this.dragAction="resizeBottomLeft"),d(s,c.getTopRightHandleRect())&&(this.dragAction="resizeTopRight"),"none"===this.dragAction&&"editing"===this.currentShapeState&&(this.dragAction="stop-editing",this._exitEditingState(e))):(this.color=e.getColor("primary"),this.currentShape=p("Text",{x:o,y:t,text:this.text,color:this.color,font:this.font,v:1}),this.dragAction="place",this.currentShapeState="selected"),"none"===this.dragAction?void this.commit(e):(this.initialShapeBoundingRect=this.currentShape.getBoundingRect(e.ctx),this.dragOffset={x:o-this.initialShapeBoundingRect.x,y:t-this.initialShapeBoundingRect.y},this._setShapesInProgress(e),e.repaintLayer("main"))},t.prototype["continue"]=function(a,t,e){var n,s,l;if("none"!==this.dragAction){switch(n=this.initialShapeBoundingRect,l=n.x+n.width,s=n.y+n.height,this.dragAction){case"place":this.currentShape.x=a,this.currentShape.y=t,this.didDrag=!0;break;case"move":this.currentShape.x=a-this.dragOffset.x,this.currentShape.y=t-this.dragOffset.y,this.didDrag=!0;break;case"resizeBottomRight":this.currentShape.setSize(a-(this.dragOffset.x-this.initialShapeBoundingRect.width)-n.x,t-(this.dragOffset.y-this.initialShapeBoundingRect.height)-n.y);break;case"resizeTopLeft":this.currentShape.setSize(l-a+this.dragOffset.x,s-t+this.dragOffset.y),this.currentShape.setPosition(a-this.dragOffset.x,t-this.dragOffset.y);break;case"resizeBottomLeft":this.currentShape.setSize(l-a+this.dragOffset.x,t-(this.dragOffset.y-this.initialShapeBoundingRect.height)-n.y),this.currentShape.setPosition(a-this.dragOffset.x,this.currentShape.y);break;case"resizeTopRight":this.currentShape.setSize(a-(this.dragOffset.x-this.initialShapeBoundingRect.width)-n.x,s-t+this.dragOffset.y),this.currentShape.setPosition(this.currentShape.x,t-this.dragOffset.y);}return this._setShapesInProgress(e),e.repaintLayer("main"),this._updateInputEl(e)}},t.prototype.end=function(o,t,e){return this.currentShape?(this.currentShape.setSize(this.currentShape.forcedWidth,0),"selected"===this.currentShapeState&&("place"===this.dragAction||"move"===this.dragAction&&!this.didDrag)&&this._enterEditingState(e),this._setShapesInProgress(e),e.repaintLayer("main"),this._updateInputEl(e)):void 0},t.prototype._enterEditingState=function(o){var t;if(this.currentShapeState="editing",this.inputEl)throw"State error";return this.inputEl=document.createElement("textarea"),this.inputEl.className="text-tool-input",this.inputEl.style.position="absolute",this.inputEl.style.transformOrigin="0px 0px",this.inputEl.style.backgroundColor="transparent",this.inputEl.style.border="none",this.inputEl.style.outline="none",this.inputEl.style.margin="0",this.inputEl.style.padding="4px",this.inputEl.style.zIndex="1000",this.inputEl.style.overflow="hidden",this.inputEl.style.resize="none",this.inputEl.value=this.currentShape.text,this.inputEl.addEventListener("mousedown",function(e){return e.stopPropagation()}),this.inputEl.addEventListener("touchstart",function(e){return e.stopPropagation()}),t=function(t){return function(e){return t.currentShape.setText(e.target.value),t.currentShape.enforceMaxBoundingRect(o),t._setShapesInProgress(o),o.repaintLayer("main"),t._updateInputEl(o),e.stopPropagation()}}(this),this.inputEl.addEventListener("keydown",function(t){return function(){return t._updateInputEl(o,!0)}}(this)),this.inputEl.addEventListener("keyup",t),this.inputEl.addEventListener("change",t),this._updateInputEl(o),o.containerEl.appendChild(this.inputEl),this.inputEl.focus(),this._setShapesInProgress(o)},t.prototype._exitEditingState=function(e){return this.currentShapeState="selected",e.containerEl.removeChild(this.inputEl),this.inputEl=null,this._setShapesInProgress(e),e.repaintLayer("main")},t.prototype._updateInputEl=function(o,t){var a,r;return null==t&&(t=!1),this.inputEl?(a=this.currentShape.getBoundingRect(o.ctx,!0),this.inputEl.style.font=this.currentShape.font,this.inputEl.style.color=this.currentShape.color,this.inputEl.style.left=o.position.x/o.backingScale+a.x*o.scale-4+"px",this.inputEl.style.top=o.position.y/o.backingScale+a.y*o.scale-4+"px",t&&!this.currentShape.forcedWidth?this.inputEl.style.width=a.width+10+this.currentShape.renderer.emDashWidth+"px":this.inputEl.style.width=a.width+12+"px",t?this.inputEl.style.height=a.height+10+this.currentShape.renderer.metrics.leading+"px":this.inputEl.style.height=a.height+10+"px",r="scale("+o.scale+")",this.inputEl.style.transform=r,this.inputEl.style.webkitTransform=r,this.inputEl.style.MozTransform=r,this.inputEl.style.msTransform=r,this.inputEl.style.OTransform=r):void 0},t.prototype.optionsStyle="font",t}(l)},{"../core/shapes":17,"./base":53}],53:[function(n,t){var e,l,p,d=function(o,t){function e(){this.constructor=o}for(var a in t){s.call(t,a)&&(o[a]=t[a])}return e.prototype=t.prototype,o.prototype=new e,o.__super__=t.prototype,o},s={}.hasOwnProperty;p={},p.Tool=e=function(){function e(){}return e.prototype.name=null,e.prototype.iconName=null,e.prototype.usesSimpleAPI=!0,e.prototype.begin=function(){},e.prototype["continue"]=function(){},e.prototype.end=function(){},e.prototype.optionsStyle=null,e.prototype.didBecomeActive=function(){},e.prototype.willBecomeInactive=function(){},e}(),p.ToolWithStroke=l=function(o){function t(e){this.strokeWidth=e.opts.defaultStrokeWidth}return d(t,o),t.prototype.optionsStyle="stroke-width",t.prototype.didBecomeActive=function(o){var a;return a=[],this.unsubscribe=function(){return function(){var e,o,s,l;for(l=[],o=0,s=a.length;s>o;o++){e=a[o],l.push(e())}return l}}(this),a.push(o.on("setStrokeWidth",function(t){return function(e){return t.strokeWidth=e,o.trigger("toolDidUpdateOptions")}}(this)))},t.prototype.willBecomeInactive=function(){return this.unsubscribe()},t}(e),t.exports=p},{}]},{},[22])(22)});
//# sourceMappingURL=literallycanvas.min.js.map

define ("filter_poodll/modal_dialogue",["jquery","core/log","filter_poodll/dlg_devicesettings"],function(a,b,c){"use strict";b.debug("Modal Progress: initialising");return{init:function init(){},fetch_icon:function fetch_icon(a){return"<div class=\"setting\" id=\"setting_"+a+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>"},test:function test(){console.log(c.init())},fetch_dialogue_box:function fetch_dialogue_box(a){return"<div class=\"poodll_dialogue_box "+a+"\"><div class=\"poodll_close_modal\"><i class=\"fa fa-window-close\" aria-hidden=\"true\"></div></i><div class=\"poodll_dialogue_content\"><p>Poodll Dialogue box</p></div></div>"}}});
//# sourceMappingURL=modal_dialogue.min.js.map

define ("filter_poodll/poodll_onetwothreemediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/anim_progress_bar","filter_poodll/speech_poodll","filter_poodll/dlg_devicesettings","filter_poodll/upskin_bar"],function(a,b,c,d,e,f,g,h){"use strict";c.debug("PoodLL One Two Three Skin: initialising");return{instanceprops:null,pmr:null,stage:"none",uploaded:!1,devsettings:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=g.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"audio_preview_123 poodll_preview_"+a+"\" style=\"display: none;\" width=\"100%\" height=\"100%\" controls playsinline=\"playsinline\" muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"video_preview_123 poodll_preview_"+a+"\" width=\"100%\" height=\"300px\" playsinline=\"playsinline\" muted></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" playsinline=\"playsinline\"></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" playsinline=\"playsinline\"></video>"},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(a),d=h.clone();d.init(c.config,b,c.controlbar.progresscanvas,c.controlbar.timer);return d},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);b.uploader.Output("");this.set_visual_mode("recordmode",a);b.timer.reset();b.timer.start();this.update_status(a);this.stage="recorded"},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.uploader.Output("");this.set_visual_mode("recordmode",a);b.timer.reset();b.timer.start();this.update_status(a);b.controlbar.preview.attr("src",null);this.stage="recorded"},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stoprecbutton.click()}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},set_visual_mode:function set_visual_mode(b,c){var d=this,e=this.fetch_instanceprops(c);switch(b){case"recordmode":e.controlbar.progress.hide();e.controlbar.preview.addClass("poodll_recording");e.controlbar.status.addClass("poodll_recording");if("audio"==e.config.mediatype){e.controlbar.preview.addClass("hide")}e.controlbar.status.removeClass("hide");d.disable_button(this);d.disable_button(e.controlbar.playbutton);e.controlbar.playbutton.show();d.disable_button(e.controlbar.stopbutton);e.controlbar.stopbutton.hide();d.disable_button(e.controlbar.savebutton);e.controlbar.savebutton.show();d.enable_button(e.controlbar.stoprecbutton);e.controlbar.stoprecbutton.show();e.controlbar.startbutton.hide();break;case"previewmode":e.controlbar.playbutton.hide();d.enable_button(e.controlbar.stopbutton);e.controlbar.stopbutton.show();d.disable_button(e.controlbar.startbutton);e.controlbar.startbutton.show();d.disable_button(e.controlbar.resumebutton);e.controlbar.resumebutton.hide();d.disable_button(e.controlbar.playbutton);e.controlbar.preview.removeClass("poodll_recording");e.controlbar.status.removeClass("poodll_recording");if("audio"==e.config.mediatype){e.controlbar.preview.removeClass("hide")}else{e.controlbar.status.removeClass("hide")}e.controlbar.status.addClass("hide");if(e.controlbar.progresscanvas.hasClass("hide")){e.controlbar.progresscanvas.removeClass("hide");e.controlbar.progresscanvas.show()}if(!a(this).hasClass("played")){a(this).addClass("played");e.controlbar.steptwo.empty();e.controlbar.steptwo.append("<i class=\"fa fa-check\" aria-hidden=\"true\"></i>").hide().fadeIn(1e3)}break;case"pausedmode":d.enable_button(e.controlbar.startbutton);e.controlbar.startbutton.show();d.enable_button(e.controlbar.playbutton);e.controlbar.playbutton.show();d.disable_button(e.controlbar.savebutton);e.controlbar.savebutton.show();e.controlbar.preview.removeClass("poodll_recording");e.controlbar.status.removeClass("poodll_recording");e.controlbar.stoprecbutton.hide();e.controlbar.timer.html("00:00:00");e.controlbar.status.addClass("hide");e.controlbar.progress.show();e.controlbar.stepone.empty();e.controlbar.stepone.append("<i class=\"fa fa-check\" aria-hidden=\"true\"></i>").hide().fadeIn(1e3);d.disable_button(e.controlbar.stoprecbutton);break;case"stopplayingmode":if(!d.uploaded){d.enable_button(e.controlbar.savebutton);d.enable_button(e.controlbar.startbutton)}if(!e.controlbar.progresscanvas.hasClass("hide")){e.controlbar.timer.html("00:00:00");e.controlbar.progresscanvas.addClass("hide");e.controlbar.progresscanvas.hide()}e.controlbar.stopbutton.hide();e.controlbar.playbutton.show();e.controlbar.startbutton.show();d.enable_button(e.controlbar.playbutton);d.disable_button(e.controlbar.stopbutton);break;case"uploadmode":d.disable_button(e.controlbar.startbutton);e.controlbar.progresscanvas.removeClass("hide");e.controlbar.progresscanvas.show();break;case"savemode":d.disable_button(e.controlbar.savebutton);e.controlbar.stepthree.empty();e.controlbar.stepthree.append("<i class=\"fa fa-check\" aria-hidden=\"true\"></i>").hide().fadeIn(1e3);break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",j="poodll_mediarecorder_size_auto";switch(g.config.size){case"small":j="poodll_mediarecorder_size_small";break;case"big":j="poodll_mediarecorder_size_big";break;case"auto":j="poodll_mediarecorder_size_auto";}var k=this.pmr.fetch_strings(),l="<div class=\"one-two-three-main-wrapper poodll_mediarecorderholder_onetwothree "+i+" "+j+"\" id=\"holder_"+c+"\">";l+="<div class=\"modal-box poodll_mediarecorderbox_onetwothree one-two-three-wrap\" id=\""+c+"\">";l+="<div class=\"style-holder "+h+"\">";var m=this.fetch_status_bar("onetwothree");l+=m,l+="<div class=\"hp_slide\" id=\"slide_"+c+"\">";l+="<div class=\"hp_timer\"></div><canvas class=\"hp_range\"></canvas></div>";l+=d,l+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_onetwothree poodll_start-recording_onetwothree\"><i class=\"fa fa-microphone\" aria-hidden=\"true\"></i></button> ";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_onetwothree poodll_stop-recording_onetwothree pmr_disabled\" style=\"display: none;\" disabled><i class=\"fa fa-stop\" aria-hidden=\"true\"></i></button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_onetwothree poodll_pause-recording_onetwothree pmr_disabled\" style=\"display: none;\" disabled><i class=\"fa fa-pause\" aria-hidden=\"true\"></i></button>";l+=" <button type=\"button\" class=\"poodll_mediarecorder_button_onetwothree poodll_resume-recording_onetwothree pmr_disabled\" style=\"display: none;\" disabled><i class=\"fa fa-microphone\" aria-hidden=\"true\"></i></button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_onetwothree poodll_play-recording_onetwothree pmr_disabled\" disabled><i class=\"fa fa-play\" aria-hidden=\"true\"></i></button> ";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_onetwothree poodll_stop-playing_onetwothree pmr_disabled\" style=\"display: none;\" disabled><i class=\"fa fa-stop\" aria-hidden=\"true\"></i></button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_onetwothree poodll_save-recording_onetwothree pmr_disabled\" disabled><i class=\"fa fa-upload\" aria-hidden=\"true\"></i></button>";l+="<div style=\"clear:both;\">";l+="<div class=\"task-helper\">";l+="<p class=\"step-1\">"+k.recui_record+"</p>";l+="<p class=\"step-2\">"+k.recui_play+"</p>";l+="<p class=\"step-3\">"+k.recui_save+"</p>";l+="</div>";l+="</div>";l+="</div>";l+=this.devsettings.fetch_dialogue_box();l+=g.downloaddialog.fetch_dialogue_box();l+=g.errordialog.fetch_dialogue_box();l+="</div>";a(b).prepend(l);var n={settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),stepone:a("#"+c+" .step-1"),steptwo:a("#"+c+" .step-2"),stepthree:a("#"+c+" .step-3"),progresscanvas:a("#"+c+" .hp_range"),progress:a("#"+c+" .hp_slide"),timer:a("#"+c+" .hp_timer"),status:a("#"+c+" .poodll_status_onetwothree"),preview:a("#"+c+" .poodll_preview_onetwothree"),startbutton:a("#"+c+" .poodll_start-recording_onetwothree"),stoprecbutton:a("#"+c+" .poodll_stop-recording_onetwothree"),stopbutton:a("#"+c+" .poodll_stop-playing_onetwothree"),pausebutton:a("#"+c+" .poodll_pause-recording_onetwothree"),resumebutton:a("#"+c+" .poodll_resume-recording_onetwothree"),playbutton:a("#"+c+" .poodll_play-recording_onetwothree"),savebutton:a("#"+c+" .poodll_save-recording_onetwothree")};g.downloaddialog.set_dialogue_box(n.downloaddialog);g.errordialog.set_dialogue_box(n.errorsdialog);this.devsettings.set_dialogue_box(n.settingsdialog);return n},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){var d=this,f=this.pmr,g=this.stage,h=this.fetch_instanceprops(b),i=e.clone();i.init(h.controlbar.progresscanvas);h.controlbar.settingsicon.click(function(){if(!d.uploaded){d.devsettings.open()}else{h.downloaddialog.open()}});h.controlbar.startbutton.click(function(){f.do_start_audio(h,a)});h.controlbar.stoprecbutton.click(function(){f.do_stop_audio(h);d.set_visual_mode("pausedmode",b);h.timer.stop();h.timer.reset();d.update_status(b)});h.controlbar.stopbutton.click(function(){d.set_visual_mode("stopplayingmode",b);var a=h.controlbar.preview.get(0);f.do_stopplay_audio(h,a);i.stop()});h.controlbar.playbutton.click(function(){var a=h.controlbar.preview.get(0);f.do_play_audio(h,a);h.controlbar.preview.on("timeupdate",function(){var a=this.currentTime;h.controlbar.timer.html(h.timer.fetch_display_time(a))});d.set_visual_mode("previewmode",b);g="played";i.clear();i.fetchCurrent=function(){var a=h.controlbar.preview.prop("currentTime"),b=h.controlbar.preview.prop("duration");if(!isFinite(b)){b=h.timer.finalseconds}return a/b};i.start()});h.controlbar.savebutton.click(function(){d.set_visual_mode("savemode",b);c.debug("save");if(h.blobs&&0<h.blobs.length){f.do_save_audio(h);d.uploaded=!0;d.set_visual_mode("uploadmode",b);g="saved"}else{h.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1});window.onbeforeunload=function(){d.enable_button(h.controlbar.startbutton);var a=h.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}}},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_onetwothreemediaskin.min.js.map

define ("filter_poodll/utils_amd",["jquery","core/log"],function(a,b){"use strict";b.debug("Filter PoodLL: utils initialising");return{timeouthandles:[],WhiteboardUploadHandler:function WhiteboardUploadHandler(b,c,d,e){var f=a("#"+b+"_btn_upload_whiteboard")[0];f.disabled=!0;clearTimeout(this.timeouthandles[b]);var g=this.getCvs(b,c,d);this.pokeVectorData(b,c,d);e.uploadFile(g.toDataURL(),"image")},getCvs:function getCvs(a,b){if(0==a.indexOf("drawingboard_")){var c=b.canvas}else{var c=b.canvasForExport()}return c},escapeColon:function escapeColon(a){return a.replace(/:/,"\\:")},pokeVectorData:function pokeVectorData(c,d,e){var f="";if(0==c.indexOf("drawingboard_")){f=JSON.stringify(d.history,null,2)}else{f=JSON.stringify(d.getSnapshot())}if("undefined"!=typeof e.vectorcontrol&&""!==e.vectorcontrol){a("#"+this.escapeColon(e.vectorcontrol)).val(f);b.debug("Vectorcontrol:"+e.vectorcontrol)}},_concatenateWavBlobs:function _concatenateWavBlobs(a,c){for(var d=this,e=[],f=0,g=0,h=a.length,j=0;j<h;j++){(function(d){var i=new FileReader;i.onload=function(){var a=this.result,i=a.slice(44);g+=i.byteLength;e[d]=i;f++;if(f==h){var j=a.slice(0,44),k=new DataView(j);k.setUint32(40,g,!0);e.unshift(j);var l=new Blob(e,{type:"audio/wav"});b.debug(g);b.debug(e);c(l)}};i.readAsArrayBuffer(a[j])})(j)}},_simpleConcatenateBlobs:function _simpleConcatenateBlobs(a,b){return new Blob(a,{type:b})},doConcatenateBlobs:function doConcatenateBlobs(a,b){switch(a[0].type){case"audio/wav":case"audio/pcm":this._concatenateWavBlobs(a,b);break;case"audio/ogg":case"audio/webm":case"video/webm":case"video/mp4":case"audio/mp4":case"audio/mp3":case"audio/m4a":default:var c=this._simpleConcatenateBlobs(a,a[0].type);b(c);break;}},bytesToSize:function bytesToSize(a){if(0===a){return"0 Bytes"}var b=parseInt(Math.floor(Math.log(a)/Math.log(1000)),10);return(a/Math.pow(1000,b)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][b]},getTimeLength:function getTimeLength(a){var b=new Date(a);return b.getUTCHours()+" hours, "+b.getUTCMinutes()+" minutes and "+b.getUTCSeconds()+" second(s)"},has_mediarecorder:function has_mediarecorder(){return"undefined"!=typeof MediaRecorder},can_html5_record:function can_html5_record(a){if(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){if("audio"==a){return!0}else{return this.has_mediarecorder()}}else{return!1}},is_edge:function is_edge(){return-1<navigator.userAgent.indexOf("Edge")},is_chrome:function is_chrome(){var a=window.chrome,b=window.navigator,c=b.vendor,d=-1<b.userAgent.indexOf("OPR"),e=-1<b.userAgent.indexOf("Edge"),f=b.userAgent.match("CriOS");if(f){return!0}else if(null!==a&&"undefined"!=typeof a&&"Google Inc."===c&&!1===d&&!1===e){return!0}else{return!1}},is_safari:function is_safari(){return /^((?!chrome|android).)*safari/i.test(navigator.userAgent)},is_ios:function is_ios(){return /iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},is_opera:function is_opera(){return"undefined"!=typeof opera&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("OPR/")},is_android:function is_android(){var a=window.navigator.userAgent,b=-1<a.indexOf("android")||-1<a.indexOf("Android");return b},is_ie:function is_ie(){var a=!1,b=window.navigator.userAgent,c=b.indexOf("MSIE "),d=b.indexOf("Trident/"),e=b.indexOf("Edge/");if(-1<c||-1<d||-1<e){a=!0}return a},parseQueryString:function parseQueryString(a){var b={};a.replace(/([^?=&]+)(=([^&]*))?/g,function(a,c,d,e){b[c]=e});return b}}});
//# sourceMappingURL=utils_amd.min.js.map

define ("filter_poodll/react_amd",["jquery","core/log","filter_poodll/react-with-addons"],function(a,b,c){"use strict";b.debug("Filter PoodLL: revealjs initialising");window.React=c;return{}});
//# sourceMappingURL=react_amd.min.js.map

define ("filter_poodll/anim_progress_bar_fresh",["jquery","core/log"],function(a,b){"use strict";b.debug("Bar Progress: initialising");return{waveroot:null,playcanvas:null,context:null,startx:null,starty:null,barwidth:null,barheight:null,enabled:!1,drawparams:{barColor:"#6DDC6F",textColor:"#fff",font:"12px Arial",textAlign:"center"},clone:function clone(){return a.extend(!0,{},this)},init:function init(a){this.playcanvas=a.get(0);this.startx=0;this.starty=0;this.barwidth=this.playcanvas.width;this.barheight=this.playcanvas.height;this.context=this.playcanvas.getContext("2d")},test:function test(a){var b=a,c=b.core.fftSize,d=new Uint8Array(c);console.log(b)},readyBars:function readyBars(){var b=a(".poodll_fresh_wave"),c=a("<div class=\"poodll_fresh_progress_bar\"><span></span></div>"),d=b.width()/4;d.toFixed();b.empty();for(var e=0;e<d;e++){var f=a("<div class=\"poodll_fresh_point\"><div class=\"poodll_fresh_stick\" style=\"height: 8px\"></div></div>");b.append(f)}b.append(c)},playBars:function playBars(b,c){var d=this,e=a(".poodll_fresh_wave"),f=a(".poodll_fresh_progress_bar"),g=e.width()/4;e.attr("data-ct",b).attr("data-duration",c);g.toFixed();var h=a(".poodll_fresh_point");a.each(h,function(a){if(h[a].children[0]){h[a].children[0].style.height="4px"}});var j=function(){var b=[];a.each(h,function(a){var c=Math.floor(50*Math.random()+4);b.push(c);var d=b[i]||4;h[a].children[0].style.height=d+"px"});f.css("left",100*d.fetchCurrent()+"%");var c=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;if(1>d.fetchCurrent()){console.log(d.fetchCurrent());c(j)}};j()},pauseBars:function pauseBars(){},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.context.clearRect(this.startx,this.starty,this.barwidth,this.barheight)},fetchCurrent:function fetchCurrent(){return 0},stop:function stop(){this.enabled=!1;this.clear()},stopthere:function stopthere(){this.enabled=!1},start:function start(){this.clear();this.enabled=!0;var a=this;this.context.textAlign=this.drawparams.textAlign;this.context.font=this.drawparams.font;var b=this.drawparams.textColor,c=function(){if(!a.enabled){return}a.clear();a.context.fillStyle=a.drawparams.barColor;a.context.fillRect(a.startx,a.starty,a.fetchCurrent()*a.barwidth,a.barheight);var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;b(c)};c()}}});
//# sourceMappingURL=anim_progress_bar_fresh.min.js.map

define ("filter_poodll/anim_hwave_timer",["jquery","core/log"],function(a,b){"use strict";b.debug("anim_horizontal_wave_ra: initialising");return{analyser:null,cvs:null,cvsctx:null,sounddetected:!1,displaytime:"00:00:00",drawparams:{wavColor:"#CCCCCC",textColor:"#000000",lineWidth:2,font:"30px Georgia",textAlign:"center"},clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.cvs=b;this.cvsctx=b.getContext("2d");this.cvsctx.textAlign=this.drawparams.textAlign;this.analyser=a},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height);this.cvsctx.lineWidth=2;this.cvsctx.strokeStyle=this.drawparams.textColor;this.cvsctx.beginPath();this.drawTime(this.cvsctx,this.displaytime,this.cvs.width,this.cvs.height);this.cvsctx.stroke()},drawTime:function drawTime(a,b,c,d){a.fillStyle=this.drawparams.textColor;a.font=this.drawparams.font;a.fillText(b,c/2,3*(d/4))},start:function start(){this.analyser.core.fftSize=2048;var a=this.analyser.core.fftSize,b=new Uint8Array(a),c=this.cvs.width,d=this.cvs.height,e=this.cvsctx,f=this.analyser,g=this;this.clear();var h=function(){requestAnimationFrame(h);if(!f.theinterval){return}f.core.getByteTimeDomainData(b);e.clearRect(0,0,c,d);e.lineWidth=g.drawparams.lineWidth;e.strokeStyle=g.drawparams.wavColor;e.beginPath();var j=3*(d/4),k=0;if(0<a){var l=b[a-1];if(128!=l){g.sounddetected=!0}}for(var m=0;m<a;m++){var n=b[m]/128,o=n*j/2;if(0==m){e.moveTo(k,o)}else{e.lineTo(k,o)}k+=2*c/a}e.lineTo(c,j/2);g.drawTime(e,g.displaytime,c,d);e.stroke()};h()}}});
//# sourceMappingURL=anim_hwave_timer.min.js.map

function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(b){var e;function c(){var a=Error.apply(this,arguments);a.name=this.name="FlashError";this.stack=a.stack;this.message=a.message}function d(){var a=Error.apply(this,arguments);a.name=this.name="WebcamError";this.stack=a.stack;this.message=a.message}IntermediateInheritor=function IntermediateInheritor(){};IntermediateInheritor.prototype=Error.prototype;c.prototype=new IntermediateInheritor;d.prototype=new IntermediateInheritor;var f={version:"1.0.15",protocol:location.protocol.match(/https/i)?"https":"http",loaded:!1,live:!1,userMedia:!0,params:{width:0,height:0,dest_width:0,dest_height:0,image_format:"jpeg",jpeg_quality:90,enable_flash:!0,force_flash:!1,flip_horiz:!1,fps:30,upload_name:"webcam",constraints:null,swfURL:"",flashNotDetectedText:"ERROR: No Adobe Flash Player detected.  Webcam.js relies on Flash for browsers that do not support getUserMedia (like yours).",noInterfaceFoundText:"No supported webcam interface found.",unfreeze_snap:!0},errors:{FlashError:c,WebcamError:d},hooks:{},init:function init(){var a=this;this.mediaDevices=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices:navigator.mozGetUserMedia||navigator.webkitGetUserMedia?{getUserMedia:function getUserMedia(b){return new Promise(function(c,d){(navigator.mozGetUserMedia||navigator.webkitGetUserMedia).call(navigator,b,c,d)})}}:null;b.URL=b.URL||b.webkitURL||b.mozURL||b.msURL;this.userMedia=this.userMedia&&!!this.mediaDevices&&!!b.URL;if(navigator.userAgent.match(/Firefox\D+(\d+)/)){if(21>parseInt(RegExp.$1,10))this.userMedia=null}if(this.userMedia){b.addEventListener("beforeunload",function(){a.reset()})}},attach:function attach(g){if("string"==typeof g){g=document.getElementById(g)||document.querySelector(g)}if(!g){return this.dispatch("error",new d("Could not locate DOM element to attach to."))}this.container=g;g.innerHTML="";var j=document.createElement("div");g.appendChild(j);this.peg=j;if(!this.params.width)this.params.width=g.offsetWidth;if(!this.params.height)this.params.height=g.offsetHeight;if(!this.params.width||!this.params.height){return this.dispatch("error",new d("No width and/or height for webcam.  Please call set() first, or attach to a visible element."))}if(!this.params.dest_width)this.params.dest_width=this.params.width;if(!this.params.dest_height)this.params.dest_height=this.params.height;this.userMedia=e===void 0?this.userMedia:e;if(this.params.force_flash){e=this.userMedia;this.userMedia=null}if("number"!=typeof this.params.fps)this.params.fps=30;var i=this.params.width/this.params.dest_width,k=this.params.height/this.params.dest_height;if(this.userMedia){var o=document.createElement("video");o.setAttribute("autoplay","autoplay");o.style.width=""+this.params.dest_width+"px";o.style.height=""+this.params.dest_height+"px";if(1!=i||1!=k){g.style.overflow="hidden";o.style.webkitTransformOrigin="0px 0px";o.style.mozTransformOrigin="0px 0px";o.style.msTransformOrigin="0px 0px";o.style.oTransformOrigin="0px 0px";o.style.transformOrigin="0px 0px";o.style.webkitTransform="scaleX("+i+") scaleY("+k+")";o.style.mozTransform="scaleX("+i+") scaleY("+k+")";o.style.msTransform="scaleX("+i+") scaleY("+k+")";o.style.oTransform="scaleX("+i+") scaleY("+k+")";o.style.transform="scaleX("+i+") scaleY("+k+")"}g.appendChild(o);this.video=o;var n=this;this.mediaDevices.getUserMedia({audio:!1,video:this.params.constraints||{mandatory:{minWidth:this.params.dest_width,minHeight:this.params.dest_height}}}).then(function(a){o.onloadedmetadata=function(){n.stream=a;n.loaded=!0;n.live=!0;n.dispatch("load");n.dispatch("live");n.flip()};o.srcObject=a||a}).catch(function(a){if(n.params.enable_flash&&n.detectFlash()){setTimeout(function(){n.params.force_flash=1;n.attach(g)},1)}else{n.dispatch("error",a)}})}else if(this.params.enable_flash&&this.detectFlash()){b.Webcam=f;var h=document.createElement("div");h.innerHTML=this.getSWFHTML();g.appendChild(h)}else{this.dispatch("error",new d(this.params.noInterfaceFoundText))}if(this.params.crop_width&&this.params.crop_height){var l=Math.floor(this.params.crop_width*i),c=Math.floor(this.params.crop_height*k);g.style.width=""+l+"px";g.style.height=""+c+"px";g.style.overflow="hidden";g.scrollLeft=Math.floor(this.params.width/2-l/2);g.scrollTop=Math.floor(this.params.height/2-c/2)}else{g.style.width=""+this.params.width+"px";g.style.height=""+this.params.height+"px"}},reset:function reset(){if(this.preview_active)this.unfreeze();this.unflip();if(this.userMedia){if(this.stream){if(this.stream.getVideoTracks){var a=this.stream.getVideoTracks();if(a&&a[0]&&a[0].stop)a[0].stop()}else if(this.stream.stop){this.stream.stop()}}delete this.stream;delete this.video}if(!0!==this.userMedia){this.getMovie()._releaseCamera()}if(this.container){this.container.innerHTML="";delete this.container}this.loaded=!1;this.live=!1},set:function set(){if(1==arguments.length){for(var a in arguments[0]){this.params[a]=arguments[0][a]}}else{this.params[arguments[0]]=arguments[1]}},on:function on(a,b){a=a.replace(/^on/i,"").toLowerCase();if(!this.hooks[a])this.hooks[a]=[];this.hooks[a].push(b)},off:function off(b,c){b=b.replace(/^on/i,"").toLowerCase();if(this.hooks[b]){if(c){var d=this.hooks[b].indexOf(c);if(-1<d)this.hooks[b].splice(d,1)}else{this.hooks[b]=[]}}},dispatch:function dispatch(){var a=arguments[0].replace(/^on/i,"").toLowerCase(),e=Array.prototype.slice.call(arguments,1);if(this.hooks[a]&&this.hooks[a].length){for(var f=0,g=this.hooks[a].length,h;f<g;f++){h=this.hooks[a][f];if("function"==typeof h){h.apply(this,e)}else if("object"==_typeof(h)&&2==h.length){h[0][h[1]].apply(h[0],e)}else if(b[h]){b[h].apply(b,e)}}return!0}else if("error"==a){if(e[0]instanceof c||e[0]instanceof d){message=e[0].message}else{message="Could not access webcam: "+e[0].name+": "+e[0].message+" "+e[0].toString()}alert("Webcam.js Error: "+message)}return!1},setSWFLocation:function setSWFLocation(a){this.set("swfURL",a)},detectFlash:function detectFlash(){var a=b,c=navigator,d=!1;if("undefined"!=typeof c.plugins&&"object"===_typeof(c.plugins["Shockwave Flash"])){var e=c.plugins["Shockwave Flash"].description;if(e&&"undefined"!=typeof c.mimeTypes&&c.mimeTypes["application/x-shockwave-flash"]&&c.mimeTypes["application/x-shockwave-flash"].enabledPlugin){d=!0}}else if("undefined"!=typeof a.ActiveXObject){try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(f){var g=f.GetVariable("$version");if(g)d=!0}}catch(a){}}return d},getSWFHTML:function getSWFHTML(){var a="",d=this.params.swfURL;if(location.protocol.match(/file/)){this.dispatch("error",new c("Flash does not work from local disk.  Please run from a web server."));return"<h3 style=\"color:red\">ERROR: the Webcam.js Flash fallback does not work from local disk.  Please run it from a web server.</h3>"}if(!this.detectFlash()){this.dispatch("error",new c("Adobe Flash Player not found.  Please install from get.adobe.com/flashplayer and try again."));return"<h3 style=\"color:red\">"+this.params.flashNotDetectedText+"</h3>"}if(!d){for(var e="",f=document.getElementsByTagName("script"),g=0,j=f.length,k;g<j;g++){k=f[g].getAttribute("src");if(k&&k.match(/\/webcam(\.min)?\.js/)){e=k.replace(/\/webcam(\.min)?\.js.*$/,"");g=j}}if(e)d=e+"/webcam.swf";else d="webcam.swf"}if(b.localStorage&&!localStorage.getItem("visited")){this.params.new_user=1;localStorage.setItem("visited",1)}var m="";for(var n in this.params){if(m)m+="&";m+=n+"="+escape(this.params[n])}a+="<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" type=\"application/x-shockwave-flash\" codebase=\""+this.protocol+"://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0\" width=\""+this.params.width+"\" height=\""+this.params.height+"\" id=\"webcam_movie_obj\" align=\"middle\"><param name=\"wmode\" value=\"opaque\" /><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"allowFullScreen\" value=\"false\" /><param name=\"movie\" value=\""+d+"\" /><param name=\"loop\" value=\"false\" /><param name=\"menu\" value=\"false\" /><param name=\"quality\" value=\"best\" /><param name=\"bgcolor\" value=\"#ffffff\" /><param name=\"flashvars\" value=\""+m+"\"/><embed id=\"webcam_movie_embed\" src=\""+d+"\" wmode=\"opaque\" loop=\"false\" menu=\"false\" quality=\"best\" bgcolor=\"#ffffff\" width=\""+this.params.width+"\" height=\""+this.params.height+"\" name=\"webcam_movie_embed\" align=\"middle\" allowScriptAccess=\"always\" allowFullScreen=\"false\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" flashvars=\""+m+"\"></embed></object>";return a},getMovie:function getMovie(){if(!this.loaded)return this.dispatch("error",new c("Flash Movie is not loaded yet"));var a=document.getElementById("webcam_movie_obj");if(!a||!a._snap)a=document.getElementById("webcam_movie_embed");if(!a)this.dispatch("error",new c("Cannot locate Flash movie in DOM"));return a},freeze:function freeze(){var b=this,c=this.params;if(this.preview_active)this.unfreeze();var d=this.params.width/this.params.dest_width,a=this.params.height/this.params.dest_height;this.unflip();var e=c.crop_width||c.dest_width,f=c.crop_height||c.dest_height,g=document.createElement("canvas");g.width=e;g.height=f;var h=g.getContext("2d");this.preview_canvas=g;this.preview_context=h;if(1!=d||1!=a){g.style.webkitTransformOrigin="0px 0px";g.style.mozTransformOrigin="0px 0px";g.style.msTransformOrigin="0px 0px";g.style.oTransformOrigin="0px 0px";g.style.transformOrigin="0px 0px";g.style.webkitTransform="scaleX("+d+") scaleY("+a+")";g.style.mozTransform="scaleX("+d+") scaleY("+a+")";g.style.msTransform="scaleX("+d+") scaleY("+a+")";g.style.oTransform="scaleX("+d+") scaleY("+a+")";g.style.transform="scaleX("+d+") scaleY("+a+")"}this.snap(function(){g.style.position="relative";g.style.left=""+b.container.scrollLeft+"px";g.style.top=""+b.container.scrollTop+"px";b.container.insertBefore(g,b.peg);b.container.style.overflow="hidden";b.preview_active=!0},g)},unfreeze:function unfreeze(){if(this.preview_active){this.container.removeChild(this.preview_canvas);delete this.preview_context;delete this.preview_canvas;this.preview_active=!1;this.flip()}},flip:function flip(){if(this.params.flip_horiz){var a=this.container.style;a.webkitTransform="scaleX(-1)";a.mozTransform="scaleX(-1)";a.msTransform="scaleX(-1)";a.oTransform="scaleX(-1)";a.transform="scaleX(-1)";a.filter="FlipH";a.msFilter="FlipH"}},unflip:function unflip(){if(this.params.flip_horiz){var a=this.container.style;a.webkitTransform="scaleX(1)";a.mozTransform="scaleX(1)";a.msTransform="scaleX(1)";a.oTransform="scaleX(1)";a.transform="scaleX(1)";a.filter="";a.msFilter=""}},savePreview:function savePreview(b,c){var d=this.params,a=this.preview_canvas,e=this.preview_context;if(c){var f=c.getContext("2d");f.drawImage(a,0,0)}b(c?null:a.toDataURL("image/"+d.image_format,d.jpeg_quality/100),a,e);if(this.params.unfreeze_snap)this.unfreeze()},snap:function snap(b,c){var e=this,f=this.params;if(!this.loaded)return this.dispatch("error",new d("Webcam is not loaded yet"));if(!b)return this.dispatch("error",new d("Please provide a callback function or canvas to snap()"));if(this.preview_active){this.savePreview(b,c);return null}var g=document.createElement("canvas");g.width=this.params.dest_width;g.height=this.params.dest_height;var i=g.getContext("2d");if(this.params.flip_horiz){i.translate(f.dest_width,0);i.scale(-1,1)}var a=function(){if(this.src&&this.width&&this.height){i.drawImage(this,0,0,f.dest_width,f.dest_height)}if(f.crop_width&&f.crop_height){var d=document.createElement("canvas");d.width=f.crop_width;d.height=f.crop_height;var a=d.getContext("2d");a.drawImage(g,Math.floor(f.dest_width/2-f.crop_width/2),Math.floor(f.dest_height/2-f.crop_height/2),f.crop_width,f.crop_height,0,0,f.crop_width,f.crop_height);i=a;g=d}if(c){var e=c.getContext("2d");e.drawImage(g,0,0)}b(c?null:g.toDataURL("image/"+f.image_format,f.jpeg_quality/100),g,i)};if(this.userMedia){i.drawImage(this.video,0,0,this.params.dest_width,this.params.dest_height);a()}else{var j=this.getMovie()._snap(),h=new Image;h.onload=a;h.src="data:image/"+this.params.image_format+";base64,"+j}return null},configure:function configure(a){if(!a)a="camera";this.getMovie()._configure(a)},flashNotify:function flashNotify(a,b){switch(a){case"flashLoadComplete":this.loaded=!0;this.dispatch("load");break;case"cameraLive":this.live=!0;this.dispatch("live");break;case"error":this.dispatch("error",new c(b));break;default:break;}},b64ToUint6:function b64ToUint6(a){return 64<a&&91>a?a-65:96<a&&123>a?a-71:47<a&&58>a?a+4:43===a?62:47===a?63:0},base64DecToArr:function base64DecToArr(b,d){for(var e=b.replace(/[^A-Za-z0-9\+\/]/g,""),a=e.length,f=d?Math.ceil((3*a+1>>2)/d)*d:3*a+1>>2,g=new Uint8Array(f),i,j,k=0,m=0,p=0;p<a;p++){j=3&p;k|=this.b64ToUint6(e.charCodeAt(p))<<18-6*j;if(3===j||1==a-p){for(i=0;3>i&&m<f;i++,m++){g[m]=255&k>>>(24&16>>>i)}k=0}}return g},upload:function upload(b,c,d){var a=this.params.upload_name||"webcam",e="";if(b.match(/^data\:image\/(\w+)/))e=RegExp.$1;else throw"Cannot locate image format in Data URI";var g=b.replace(/^data\:image\/\w+\;base64\,/,""),j=new XMLHttpRequest;j.open("POST",c,!0);if(j.upload&&j.upload.addEventListener){j.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;f.dispatch("uploadProgress",b,a)}},!1)}var k=this;j.onload=function(){if(d)d.apply(k,[j.status,j.responseText,j.statusText]);f.dispatch("uploadComplete",j.status,j.responseText,j.statusText)};var m=new Blob([this.base64DecToArr(g)],{type:"image/"+e}),h=new FormData;h.append(a,m,a+"."+e.replace(/e/,""));j.send(h)}};f.init();if("function"==typeof define&&define.amd){define ("filter_poodll/webcam",function(){return f})}else if("object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports){module.exports=f}else{b.Webcam=f}})(window);
//# sourceMappingURL=webcam.min.js.map

define ("filter_poodll/poodll_splitmediaskin",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/upskin_bar"],function(a,b,c,d){"use strict";b.debug("PoodLL split Skin: initialising");return{instanceprops:null,pmr:null,uploaded:!1,recorded:!1,played:!1,mustResetResourcePlayer:!1,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\"></div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_checkplayer_"+a+" hide\" controls></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_checkplayer_"+a+"\" width=\"320\" height=\"240\" playsinline=\"playsinline\"></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+" hide\" src=\"@@RESOURCEURL@@\" playsinline controls></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+" hide\" src=\"@@RESOURCEURL@@\" playsinline=\"playsinline\"></video>"},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(a),e=d.clone();e.init(c.config,b,c.controlbar.split_progresscanvas,c.controlbar.status);return e},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);b.controlbar.stopbutton.attr("disabled",!1);b.controlbar.savebutton.attr("disabled",!1)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.checkplayer.attr("src",null);b.controlbar.stopbutton.attr("disabled",!1);b.controlbar.savebutton.attr("disabled",!1)},handle_timer_update:function handle_timer_update(a){if(!this.played&&!this.recorded){return}var b=this.fetch_instanceprops(a),c=M.util.get_string("recui_recording","filter_poodll");this.update_status(a,c+b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(a,b){var c=this.fetch_instanceprops(a);c.controlbar.status.html(b)},set_visual_mode:function set_visual_mode(a,b){var c=this;switch(a){case"recordingmode":c.disable_button(b.controlbar.resourceplaybutton);b.controlbar.resourceplaybutton.empty();b.controlbar.resourceplaybutton.html("<span class=\"fa fa-microphone fa-3x\"></span>");b.controlbar.resourceplaybutton.addClass("poodll_mediarecorderholder_split_recordcolor");b.controlbar.status.addClass("poodll_mediarecorderholder_split_recordcolor");c.handle_timer_update(b.controlbarid);c.enable_button(b.controlbar.stopbutton);break;case"resourceplayingmode":c.disable_button(b.controlbar.resourceplaybutton);c.disable_button(b.controlbar.stopbutton);break;case"neverrecordedmode":b.controlbar.resourceplaybutton.empty();b.controlbar.resourceplaybutton.html("<p style=\"margin-bottom: 0px; font-size: 24px;\">Start</p>");c.enable_button(b.controlbar.resourceplaybutton);c.disable_button(b.controlbar.stopbutton);this.update_status(b.controlbarid,M.util.get_string("recui_ready","filter_poodll"));break;case"allstoppedmode":c.disable_button(b.controlbar.resourceplaybutton);c.disable_button(b.controlbar.stopbutton);b.controlbar.resourceplaybutton.empty();b.controlbar.resourceplaybutton.html("<span class=\"fa fa-check fa-3x\"></span>");b.controlbar.resourceplaybutton.removeClass("poodll_mediarecorderholder_split_recordcolor");b.controlbar.status.removeClass("poodll_mediarecorderholder_split_recordcolor");this.update_status(b.controlbarid,M.util.get_string("recui_finished","filter_poodll"));break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio";e=e.replace("@@RESOURCEURL@@",g.config.resource);var j=this.pmr.fetch_strings(),k="<div class=\"poodll_mediarecorderholder_split "+i+"\" id=\"holder_"+c+"\">";k+="<div class=\"poodll_mediarecorderbox_split\" id=\""+c+"\">";k+="<div class=\"style-holder "+h+"\">";k+=d,k+=e,k+="<button type=\"button\" class=\"poodll_mediarecorder_button_split poodll_start-recording_split hide\"><span class=\"fa fa-microphone fa-3x\"></span></button>";k+=" <button type=\"button\" class=\"poodll_mediarecorder_button_split poodll_playback-recording_split hide\"><span class=\"fa fa-play-circle fa-3x\"></span></button>";k+=" <button type=\"button\" class=\"poodll_mediarecorder_button_split poodll_stopplayback-recording_split hide\"><span class=\"fa fa-stop-circle fa-3x\"></span></button>";k+="<button type=\"button\" class=\"poodll_save-recording_split pmr_disabled hide\">"+j.recui_save+"</button></div>";k+="<div class=\"poodll_mediarecorderholder_split\"><button type=\"button\" class=\"poodll_mediarecorder_button_split poodll_stop-recording_split pmr_disabled\" disabled><p style=\"margin-bottom: 0px;font-size: 24px;\">Submit</p></button></div>";k+="<div class=\"poodll_statusholder_split\" >";k+="<canvas class=\"split_range\"></canvas>";var l=this.fetch_status_bar("split");k+=l;k+="</div>";k+="</div></div></div>";a(b).append(k);a(".qtext").prepend("<hr />");a(".qtext").prepend("<div class=\"poodll_mediarecorderholder_split poodll_mediarecorder_split_topsplit\"><button type=\"button\" class=\"poodll_mediarecorder_button_split poodll_play-resource_split\"><p style=\"margin-bottom: 0px; font-size: 24px;\">Start</p></button></div>");var m={split_progresscanvas:a("#"+c+" .split_range"),marker:a("#"+c+"  .marker"),resourceplayer:a("#"+c+"  .poodll_resourceplayer_split"),checkplayer:a("#"+c+"  .poodll_checkplayer_split"),stopbutton:a("#"+c+"  .poodll_stop-recording_split"),resourcestopbutton:a("#"+c+"  .poodll_stop-resource_split"),startbutton:a("#"+c+"  .poodll_start-recording_split"),playbackbutton:a("#"+c+"  .poodll_playback-recording_split"),stopplaybackbutton:a("#"+c+"  .poodll_stopplayback-recording_split"),savebutton:a("#"+c+"  .poodll_save-recording_split"),resourceplaybutton:a(".poodll_mediarecorder_button_split.poodll_play-resource_split"),status:a(".poodll_status_split")};return m},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},do_callback:function do_callback(b){switch(b[1]){case"filesubmitted":var c=document.getElementById(b[3]);if(null==c){c=parent.document.getElementById(b[3])}if(c){c.value=b[2]}a("#responseform input[name=next]").attr("disabled",!1);}},register_controlbar_events_audio:function register_controlbar_events_audio(b,c){var d=this,e=this.pmr,f=this.fetch_instanceprops(c);this.set_visual_mode("neverrecordedmode",f);f.config.callbackjs=d.do_callback;a("#responseform input[name=next]").attr("disabled",!0);f.controlbar.startbutton.click(function(){e.do_start_audio(f,b);d.recorded=!0;f.timer.reset();f.timer.start();d.set_visual_mode("recordingmode",f)});f.controlbar.stopbutton.click(function(){d.do_stop_resource(f);e.do_stop_audio(f);d.disable_button(this);setTimeout(function(){f.controlbar.savebutton.click()},100);f.timer.stop();d.set_visual_mode("allstoppedmode",f)});f.controlbar.resourceplaybutton.click(function(){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(){f.controlbar.startbutton.trigger("click");d.played=!0;if(""!=f.config.resource){d.do_play_resource(f)}}).catch(function(a){alert(a)})});f.controlbar.resourcestopbutton.click(function(){d.do_stop_resource(f);if(d.recorded){d.set_visual_mode("allstoppedmode",f)}else{d.set_visual_mode("neverrecordedmode",f)}});f.controlbar.savebutton.click(function(){d.disable_button(this);if(f.blobs&&0<f.blobs.length){e.do_save_audio(f);d.uploaded=!0;d.disable_button(f.controlbar.startbutton)}else{f.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1})},set_completion:function set_completion(a,b){var c=b.controlbar.completioncheck},do_stop_resource:function do_stop_resource(a){console.log("stopped the resource");var b=a.controlbar.resourceplayer.get(0);b.pause();b.currentTime=0;if(a.mustResetResourcePlayer){a.mustResetResourcePlayer=!1;b.src=a.config.resource;b.load()}},do_play_resource:function do_play_resource(a){var b=a.controlbar.resourceplayer.get(0);b.play();b.currentTime=0},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_splitmediaskin.min.js.map

define('filter_poodll/msr_whammy', ["jquery","core/log","filter_poodll/msr_helper_whammy"],function(a,b,c){"use strict";return b.debug("PoodLL MSR Whammy: initialising"),{timeout:0,mediaRecorder:null,mediaStream:null,msr:null,audioctx:null,mediaType:"video",clone:function(){return a.extend(!0,{},this)},init:function(a,b,c,d){this.msr=a,this.mediaStream=b,this.audioctx=c,this.mediaType=d},start:function(a,b){a=a||1e3;var d=this;this.mediaRecorder=c.clone(),this.mediaRecorder.init(this.msr,this.mediaStream,this.audioctx),this.mediaRecorder.record(),this.timeout=setInterval(function(){d.mediaRecorder.requestData()},a)},stop:function(){this.mediaRecorder&&(this.mediaRecorder.stop(),clearTimeout(this.timeout))},clearOldRecordedFrames:function(){this.mediaRecorder&&this.mediaRecorder.clearOldRecordedFrames()},pause:function(){this.mediaRecorder&&this.mediaRecorder.pause()},resume:function(){this.mediaRecorder&&this.mediaRecorder.resume()},ondataavailable:function(a){b.debug("ondataavailable:"+a)},onstop:function(a){b.debug(a)}}});
define ("filter_poodll/poodll_basemediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/dlg_devicesettings","filter_poodll/anim_progress_bar","filter_poodll/upskin_bar"],function(a,b,c,d,e,f,g){"use strict";c.debug("PoodLL Base Skin: initialising");return{instanceprops:null,pmr:null,uploaded:!1,devsettings:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=e.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" width=\"100%\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+"\"  playsinline muted style=\"display: none;\" controls></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_preview_"+a+"\" playsinline muted ></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" ></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" playsinline=\"playsinline\"></video>"},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(a),d=g.clone();d.init(c.config,b,c.controlbar.progresscanvas,c.controlbar.timer);return d},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);b.uploader.Output("");this.set_visual_mode("recordmode",a);b.controlbar.preview.attr("src",null);b.timer.reset();b.timer.start();this.update_status(a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.uploader.Output("");this.set_visual_mode("recordmode",a);b.timer.reset();b.timer.start();this.update_status(a)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},set_visual_mode:function set_visual_mode(a,b){var c=this,d=this.fetch_instanceprops(b);switch(a){case"recordmode":d.controlbar.progress.hide();c.disable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.playbutton);d.controlbar.resumebutton.hide();c.enable_button(d.controlbar.stopbutton);c.disable_button(d.controlbar.savebutton);d.controlbar.pausebutton.show();c.enable_button(d.controlbar.pausebutton);d.controlbar.preview.addClass("poodll_recording");d.controlbar.status.addClass("poodll_recording");if("audio"==d.config.mediatype){d.controlbar.preview.hide()}d.controlbar.status.show();break;case"playingmode":c.disable_button(d.controlbar.playbutton);c.enable_button(d.controlbar.stopbutton);c.disable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.savebutton);d.controlbar.progresscanvas.show();break;case"previewmode":c.enable_button(d.controlbar.playbutton);c.disable_button(d.controlbar.pausebutton);c.disable_button(d.controlbar.stopbutton);if(!c.uploaded){c.enable_button(d.controlbar.startbutton);c.enable_button(d.controlbar.savebutton)}d.controlbar.resumebutton.hide();d.controlbar.pausebutton.show();d.controlbar.preview.removeClass("poodll_recording");d.controlbar.status.removeClass("poodll_recording");d.controlbar.timer.html("00:00:00");d.controlbar.progress.show();d.controlbar.progresscanvas.hide();d.controlbar.status.hide();break;case"pausedmode":c.enable_button(d.controlbar.resumebutton);c.enable_button(d.controlbar.savebutton);d.controlbar.preview.removeClass("poodll_recording");d.controlbar.status.removeClass("poodll_recording");break;case"uploadingmode":c.disable_button(d.controlbar.startbutton);d.controlbar.progresscanvas.show();break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",j="poodll_mediarecorder_size_auto";switch(g.config.size){case"small":j="poodll_mediarecorder_size_small";break;case"big":j="poodll_mediarecorder_size_big";break;case"auto":j="poodll_mediarecorder_size_auto";}var k=this.pmr.fetch_strings(),l=g.showupload?"inline-block":"none",m="<div class=\"poodll_mediarecorderholder_standard "+i+" "+j+"\" id=\"holder_"+c+"\">";m+="<div class=\"poodll_mediarecorderbox_standard\" id=\""+c+"\">";m+=this.devsettings.fetch_dialogue_box();m+=g.downloaddialog.fetch_dialogue_box();m+=g.errordialog.fetch_dialogue_box();m+="<div class=\"style-holder "+h+"\">";var n=this.fetch_status_bar("standard");m+=n;m+="<div class=\"hp_slide\" id=\"slide_"+c+"\">";m+="<div class=\"hp_timer\"></div>";m+="<canvas class=\"hp_range\"></canvas>";m+="</div>";m+=d,m+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";m+="<button type=\"button\" class=\"poodll_mediarecorder_button_standard poodll_start-recording_standard\">"+k.recui_record+"</button>";m+="<button type=\"button\" class=\"poodll_mediarecorder_button_standard poodll_stop-recording_standard pmr_disabled\" disabled>"+k.recui_stop+"</button>";m+="<button type=\"button\" class=\"poodll_mediarecorder_button_standard poodll_pause-recording_standard pmr_disabled\" disabled>"+k.recui_pause+"</button>";m+=" <button type=\"button\" class=\"poodll_mediarecorder_button_standard poodll_resume-recording_standard pmr_disabled\" style=\"display: none;\" disabled>"+k.recui_continue+"</button>";m+=" <button type=\"button\" class=\"poodll_mediarecorder_button_standard poodll_play-recording_standard pmr_disabled\" disabled>"+k.recui_play+"</button>";m+="<button type=\"button\" class=\"poodll_save-recording_standard pmr_disabled\" style=\"display: "+l+";\" disabled>"+k.recui_save+"</button>";m+="</div>";m+="</div>";m+="</div>";a(b).prepend(m);var o={settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),progresscanvas:a("#"+c+" .hp_range"),progress:a("#"+c+" .hp_slide"),timer:a("#"+c+" .hp_timer"),status:a("#"+c+"  .poodll_status_standard"),preview:a("#"+c+"  .poodll_preview_standard"),startbutton:a("#"+c+"  .poodll_start-recording_standard"),stopbutton:a("#"+c+"  .poodll_stop-recording_standard"),pausebutton:a("#"+c+"  .poodll_pause-recording_standard"),resumebutton:a("#"+c+"  .poodll_resume-recording_standard"),playbutton:a("#"+c+"  .poodll_play-recording_standard"),savebutton:a("#"+c+"  .poodll_save-recording_standard")};g.downloaddialog.set_dialogue_box(o.downloaddialog);g.errordialog.set_dialogue_box(o.errorsdialog);this.devsettings.set_dialogue_box(o.settingsdialog);return o},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(b,c){var d=this,e=this.pmr,g=this.fetch_instanceprops(c),h=f.clone();h.init(g.controlbar.progresscanvas);g.controlbar.settingsicon.click(function(){if(!d.uploaded){d.devsettings.open()}else{g.downloaddialog.open()}});g.controlbar.startbutton.click(function(){e.do_start_audio(g,b)});g.controlbar.stopbutton.click(function(){var a=g.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}e.do_stop_audio(g);g.timer.stop();g.timer.reset();d.update_status(c);h.stop();d.set_visual_mode("previewmode",c)});g.controlbar.pausebutton.click(function(){this.disabled=!0;a(this).hide();g.controlbar.resumebutton.show();e.do_pause_audio(g);g.timer.pause();d.update_status(c);d.set_visual_mode("pausedmode",c)});g.controlbar.resumebutton.click(function(){e.do_resume_audio(g);g.timer.resume();d.update_status(c);d.set_visual_mode("recordmode",c)});g.controlbar.playbutton.click(function(){var a=g.controlbar.preview.get(0);e.do_play_audio(g,a);g.controlbar.preview.on("timeupdate",function(){if(!this.paused){var a=this.currentTime;g.controlbar.timer.html(g.timer.fetch_display_time(a))}});d.set_visual_mode("playingmode",c);h.clear();h.fetchCurrent=function(){var a=g.controlbar.preview.prop("currentTime"),b=g.controlbar.preview.prop("duration");if(!isFinite(b)){b=g.timer.finalseconds}return a/b};h.start()});g.controlbar.savebutton.click(function(){d.disable_button(this);if(g.blobs&&0<g.blobs.length){e.do_save_audio(g);d.uploaded=!0;d.set_visual_mode("uploadingmode",c)}else{g.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1});window.onbeforeunload=function(){d.enable_button(g.controlbar.startbutton);var a=g.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}}},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_basemediaskin.min.js.map

define ("filter_poodll/poodll_uploadmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/upskin_radial","filter_poodll/util_dragdrop"],function(a,b,c,d,e,f){"use strict";c.debug("PoodLL Upload Media skin: initialising");return{instanceprops:null,pmr:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b},fetch_status_bar:function fetch_status_bar(){return""},fetch_preview_audio:function fetch_preview_audio(){return""},fetch_preview_video:function fetch_preview_video(){return""},fetch_resource_audio:function fetch_resource_audio(){return""},fetch_resource_video:function fetch_resource_video(){return""},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instance_props(),d=e.clone();d.init(c.config,b,c.controlbar.uploadcanvas,c.controlbar.uploadmessages);d.setDrawParam("lineWidth",2);d.setDrawParam("font","14px Arial");return d},handle_timer_update:function handle_timer_update(){},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},onMediaSuccess_video:function onMediaSuccess_video(){},onMediaSuccess_audio:function onMediaSuccess_audio(){},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_events(b)},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){return this.register_events(b)},fetch_instance_props:function fetch_instance_props(){return this.instanceprops},prepare_controlbar:function prepare_controlbar(b,c,e,f,g){var h=this.fetch_instance_props(),i="";switch(g){case"video":i="video/webm,video/ogg,video/mp4,video/x-m4v,video/*";break;case"snapshot":case"image":i="image/*";case"audio":var j=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(j){i="video/*"}else{i="audio/*"}default:i="";}if(d.is_ios()||d.is_android()){var k=M.util.get_string("recui_recordorchoose","filter_poodll")}else{var k=M.util.get_string("recui_choosefile","filter_poodll")}var l=h.config.media_skin_style,m="video"==g?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",n="<div class=\"poodll_mediarecorderholder_upload "+m+"\" id=\"holder_"+c+"\">";n+="<div class=\"poodll_mediarecorderbox_upload\" id=\""+c+"\">";n+=h.errordialog.fetch_dialogue_box();n+="<div class=\"style-holder "+l+"\">";if("audio"==g){var o=250,p=50}else{var o=130,p=210}n+="<div class=\"poodll_mediarecorder_uploadcanvas_cont_upload\"><canvas id=\""+c+"_uploadcanvas\" width=\""+o+"\" height=\""+p+"\" class=\"poodll_mediarecorder_uploadcanvas_upload\"></canvas></div>";n+="<div class=\"p_btn_wrapper\">";n+="<input type=\"file\" id=\""+c+"_poodllfileselect\" name=\"poodllfileselect[]\" accept=\""+i+"\"/>";n+="<button type=\"button\" id=\""+c+"_p_btn\" class=\"p_btn\">"+k+"</button>";n+="</div>";n+="<div class=\"poodll_uploadmessages_once\"></div>";n+="</div></div></div>";a(b).prepend(n);var q={errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),filebutton:a("#"+c+"_poodllfileselect"),startbutton:a("#"+c+"_p_btn"),uploadcanvas:a("#"+c+"_uploadcanvas"),uploadmessages:a("#"+c+" .poodll_uploadmessages_once")};h.errordialog.set_dialogue_box(q.errorsdialog);return q},register_events:function register_events(){var a=this,b=this.pmr,c=this.fetch_instance_props();c.config.hermes.enable();c.controlbar.filebutton.on("change",function(b){var d=b.target.files||b.dataTransfer.files;a.FileSelectHandler(d,c.uploader);f.turnoff_dragdrop();c.controlbar.filebutton.off("change");c.controlbar.filebutton.attr("disabled",!0)});f.init(c.controlbar.uploadcanvas,this.FileSelectHandler,c)},FileSelectHandler:function FileSelectHandler(a,b){for(var d=0,e;e=a[d];d++){c.debug("filetype:"+e.type);b.uploadBlob(e,e.type)}}}});
//# sourceMappingURL=poodll_uploadmediaskin.min.js.map

define ("filter_poodll/poodll_snapshotrecorder",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/webcam"],function(a,b,c,d,e){"use strict";b.debug("PoodLL Snapshot Recorder: initialising");return{instanceprops:[],fetch_instance_props:function fetch_instance_props(a){return this.instanceprops[a]},init_instance_props:function init_instance_props(a){this.instanceprops[a]={imagefile:!1,htmlthings:"",config:null,uploader:null}},supports_current_browser:function supports_current_browser(a){var d=c.is_ios();if(d){return!1}else{if("snapshot"!=a.mediatype){return!1}b.debug("PoodLL Snapshot Recorder: supports this browser");return!0}},embed:function embed(a,b){this.init_instance_props(b.widgetid);var c=this.fetch_instance_props(b.widgetid);c.config=b;c.uploader=d.clone();c.uploader.init(a,b);this.insert_controls(a,b.widgetid);this.register_events(b.widgetid)},insert_controls:function insert_controls(b,c){var d=this.fetch_instance_props(c),e=d.config,f={camera:e.widgetid+"_poodll_snapshot_camera",preview:e.widgetid+"_poodll_snapshot_preview",snapbutton:e.widgetid+"_poodll_take-snapshot",savebutton:e.widgetid+"_poodll_save-snapshot",cancelbutton:e.widgetid+"_poodll_cancel-snapshot"};d.htmlthings=f;var g="<div id=\""+f.camera+"\" style=\"width:320px; height:240px;\"></div>";g+="<div id=\""+f.preview+"\" class=\"hide\" style=\"width:320px; height:240px;\"></div>";g+="<button type=\"button\" class=\"poodll_take-snapshot\" id=\""+f.snapbutton+"\">"+M.util.get_string("recui_takesnapshot","filter_poodll")+"</button>";g+="<button type=\"button\" class=\"poodll_cancel-snapshot\" id=\""+f.cancelbutton+"\">"+M.util.get_string("recui_cancelsnapshot","filter_poodll")+"</button>";g+="<button type=\"button\" class=\"poodll_save-recording\" id=\""+f.savebutton+"\">"+M.util.get_string("recui_save","filter_poodll")+"</button>";a(b).prepend(g)},register_events:function register_events(b){var c=this.fetch_instance_props(b),d=c.config;e.set("swfURL",M.cfg.wwwroot+"/filter/poodll/3rdparty/webcam/webcam.swf");e.attach("#"+c.htmlthings.camera);a("#"+c.htmlthings.savebutton).on("click",function(){if(c.imagefile){var a=c.uploader.dataURItoBlob(c.imagefile,"image/jpeg");c.uploader.uploadFile(a,"image/jpeg")}else{c.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}});a("#"+c.htmlthings.cancelbutton).on("click",function(){c.imagefile=!1;a("#"+c.htmlthings.preview).addClass("hide").html("");a("#"+c.htmlthings.camera).removeClass("hide")});a("#"+c.htmlthings.snapbutton).on("click",function(){e.snap(function(b){c.imagefile=b;a("#"+c.htmlthings.preview).html("<img src=\""+b+"\"/>").removeClass("hide");a("#"+c.htmlthings.camera).addClass("hide")})})}}});
//# sourceMappingURL=poodll_snapshotrecorder.min.js.map

define ("filter_poodll/poodll_qrscanner",["jquery","core/log"],function(e,t){"use strict";t.debug("poodll_qrscanner is now loaded");var P={checkAndNudgePoints:function(e,t){for(var i=I.width,o=I.height,r=!0,a=0;a<t.length&&r;a+=2){var n=Math.floor(t[a]),d=Math.floor(t[a+1]);if(-1>n||n>i||-1>d||d>o){throw"Error.checkAndNudgePoints "}r=!1;if(-1==n){t[a]=0;r=!0}else if(n==i){t[a]=i-1;r=!0}if(-1==d){t[a+1]=0;r=!0}else if(d==o){t[a+1]=o-1;r=!0}}r=!0;for(var a=t.length-2;0<=a&&r;a-=2){var n=Math.floor(t[a]),d=Math.floor(t[a+1]);if(-1>n||n>i||-1>d||d>o){throw"Error.checkAndNudgePoints "}r=!1;if(-1==n){t[a]=0;r=!0}else if(n==i){t[a]=i-1;r=!0}if(-1==d){t[a+1]=0;r=!0}else if(d==o){t[a+1]=o-1;r=!0}}}};P.sampleGrid3=function(e,t,i){for(var o=new c(t),r=Array(t<<1),a=0;a<t;a++){for(var n=r.length,d=a+.5,s=0;s<n;s+=2){r[s]=(s>>1)+.5;r[s+1]=d}i.transformPoints1(r);P.checkAndNudgePoints(e,r);try{for(var s=0,l;s<n;s+=2){l=e[Math.floor(r[s])+I.width*Math.floor(r[s+1])];if(l)o.set_Renamed(s>>1,a)}}catch(e){throw"Error.checkAndNudgePoints"}}return o};P.sampleGridx=function(e,t,i,o,r,n,d,s,l,c,f,g,u,h,m,b,C,_){var p=a.quadrilateralToQuadrilateral(i,o,r,n,d,s,l,c,f,g,u,h,m,b,C,_);return P.sampleGrid3(e,t,p)};function i(e,t){this.count=e;this.dataCodewords=t;this.__defineGetter__("Count",function(){return this.count});this.__defineGetter__("DataCodewords",function(){return this.dataCodewords})}function o(e,t,i){this.ecCodewordsPerBlock=e;if(i)this.ecBlocks=[t,i];else this.ecBlocks=Array(t);this.__defineGetter__("ECCodewordsPerBlock",function(){return this.ecCodewordsPerBlock});this.__defineGetter__("TotalECCodewords",function(){return this.ecCodewordsPerBlock*this.NumBlocks});this.__defineGetter__("NumBlocks",function(){for(var e=0,t=0;t<this.ecBlocks.length;t++){e+=this.ecBlocks[t].length}return e});this.getECBlocks=function(){return this.ecBlocks}}function r(e,t,o,r,a,n){this.versionNumber=e;this.alignmentPatternCenters=t;this.ecBlocks=[o,r,a,n];for(var d=0,s=o.ECCodewordsPerBlock,l=o.getECBlocks(),f=0,g;f<l.length;f++){g=l[f];d+=g.Count*(g.DataCodewords+s)}this.totalCodewords=d;this.__defineGetter__("VersionNumber",function(){return this.versionNumber});this.__defineGetter__("AlignmentPatternCenters",function(){return this.alignmentPatternCenters});this.__defineGetter__("TotalCodewords",function(){return this.totalCodewords});this.__defineGetter__("DimensionForVersion",function(){return 17+4*this.versionNumber});this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new c(e);t.setRegion(0,0,9,9);t.setRegion(e-8,0,8,9);t.setRegion(0,e-8,9,8);for(var o=this.alignmentPatternCenters.length,r=0,a;r<o;r++){a=this.alignmentPatternCenters[r]-2;for(var n=0;n<o;n++){if(0==r&&(0==n||n==o-1)||r==o-1&&0==n){continue}t.setRegion(this.alignmentPatternCenters[n]-2,a,5,5)}}t.setRegion(6,9,1,e-17);t.setRegion(9,6,e-17,1);if(6<this.versionNumber){t.setRegion(e-11,0,3,6);t.setRegion(0,e-11,6,3)}return t};this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}r.VERSION_DECODE_INFO=[31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017];r.VERSIONS=function(){return[new r(1,[],new o(7,new i(1,19)),new o(10,new i(1,16)),new o(13,new i(1,13)),new o(17,new i(1,9))),new r(2,[6,18],new o(10,new i(1,34)),new o(16,new i(1,28)),new o(22,new i(1,22)),new o(28,new i(1,16))),new r(3,[6,22],new o(15,new i(1,55)),new o(26,new i(1,44)),new o(18,new i(2,17)),new o(22,new i(2,13))),new r(4,[6,26],new o(20,new i(1,80)),new o(18,new i(2,32)),new o(26,new i(2,24)),new o(16,new i(4,9))),new r(5,[6,30],new o(26,new i(1,108)),new o(24,new i(2,43)),new o(18,new i(2,15),new i(2,16)),new o(22,new i(2,11),new i(2,12))),new r(6,[6,34],new o(18,new i(2,68)),new o(16,new i(4,27)),new o(24,new i(4,19)),new o(28,new i(4,15))),new r(7,[6,22,38],new o(20,new i(2,78)),new o(18,new i(4,31)),new o(18,new i(2,14),new i(4,15)),new o(26,new i(4,13),new i(1,14))),new r(8,[6,24,42],new o(24,new i(2,97)),new o(22,new i(2,38),new i(2,39)),new o(22,new i(4,18),new i(2,19)),new o(26,new i(4,14),new i(2,15))),new r(9,[6,26,46],new o(30,new i(2,116)),new o(22,new i(3,36),new i(2,37)),new o(20,new i(4,16),new i(4,17)),new o(24,new i(4,12),new i(4,13))),new r(10,[6,28,50],new o(18,new i(2,68),new i(2,69)),new o(26,new i(4,43),new i(1,44)),new o(24,new i(6,19),new i(2,20)),new o(28,new i(6,15),new i(2,16))),new r(11,[6,30,54],new o(20,new i(4,81)),new o(30,new i(1,50),new i(4,51)),new o(28,new i(4,22),new i(4,23)),new o(24,new i(3,12),new i(8,13))),new r(12,[6,32,58],new o(24,new i(2,92),new i(2,93)),new o(22,new i(6,36),new i(2,37)),new o(26,new i(4,20),new i(6,21)),new o(28,new i(7,14),new i(4,15))),new r(13,[6,34,62],new o(26,new i(4,107)),new o(22,new i(8,37),new i(1,38)),new o(24,new i(8,20),new i(4,21)),new o(22,new i(12,11),new i(4,12))),new r(14,[6,26,46,66],new o(30,new i(3,115),new i(1,116)),new o(24,new i(4,40),new i(5,41)),new o(20,new i(11,16),new i(5,17)),new o(24,new i(11,12),new i(5,13))),new r(15,[6,26,48,70],new o(22,new i(5,87),new i(1,88)),new o(24,new i(5,41),new i(5,42)),new o(30,new i(5,24),new i(7,25)),new o(24,new i(11,12),new i(7,13))),new r(16,[6,26,50,74],new o(24,new i(5,98),new i(1,99)),new o(28,new i(7,45),new i(3,46)),new o(24,new i(15,19),new i(2,20)),new o(30,new i(3,15),new i(13,16))),new r(17,[6,30,54,78],new o(28,new i(1,107),new i(5,108)),new o(28,new i(10,46),new i(1,47)),new o(28,new i(1,22),new i(15,23)),new o(28,new i(2,14),new i(17,15))),new r(18,[6,30,56,82],new o(30,new i(5,120),new i(1,121)),new o(26,new i(9,43),new i(4,44)),new o(28,new i(17,22),new i(1,23)),new o(28,new i(2,14),new i(19,15))),new r(19,[6,30,58,86],new o(28,new i(3,113),new i(4,114)),new o(26,new i(3,44),new i(11,45)),new o(26,new i(17,21),new i(4,22)),new o(26,new i(9,13),new i(16,14))),new r(20,[6,34,62,90],new o(28,new i(3,107),new i(5,108)),new o(26,new i(3,41),new i(13,42)),new o(30,new i(15,24),new i(5,25)),new o(28,new i(15,15),new i(10,16))),new r(21,[6,28,50,72,94],new o(28,new i(4,116),new i(4,117)),new o(26,new i(17,42)),new o(28,new i(17,22),new i(6,23)),new o(30,new i(19,16),new i(6,17))),new r(22,[6,26,50,74,98],new o(28,new i(2,111),new i(7,112)),new o(28,new i(17,46)),new o(30,new i(7,24),new i(16,25)),new o(24,new i(34,13))),new r(23,[6,30,54,74,102],new o(30,new i(4,121),new i(5,122)),new o(28,new i(4,47),new i(14,48)),new o(30,new i(11,24),new i(14,25)),new o(30,new i(16,15),new i(14,16))),new r(24,[6,28,54,80,106],new o(30,new i(6,117),new i(4,118)),new o(28,new i(6,45),new i(14,46)),new o(30,new i(11,24),new i(16,25)),new o(30,new i(30,16),new i(2,17))),new r(25,[6,32,58,84,110],new o(26,new i(8,106),new i(4,107)),new o(28,new i(8,47),new i(13,48)),new o(30,new i(7,24),new i(22,25)),new o(30,new i(22,15),new i(13,16))),new r(26,[6,30,58,86,114],new o(28,new i(10,114),new i(2,115)),new o(28,new i(19,46),new i(4,47)),new o(28,new i(28,22),new i(6,23)),new o(30,new i(33,16),new i(4,17))),new r(27,[6,34,62,90,118],new o(30,new i(8,122),new i(4,123)),new o(28,new i(22,45),new i(3,46)),new o(30,new i(8,23),new i(26,24)),new o(30,new i(12,15),new i(28,16))),new r(28,[6,26,50,74,98,122],new o(30,new i(3,117),new i(10,118)),new o(28,new i(3,45),new i(23,46)),new o(30,new i(4,24),new i(31,25)),new o(30,new i(11,15),new i(31,16))),new r(29,[6,30,54,78,102,126],new o(30,new i(7,116),new i(7,117)),new o(28,new i(21,45),new i(7,46)),new o(30,new i(1,23),new i(37,24)),new o(30,new i(19,15),new i(26,16))),new r(30,[6,26,52,78,104,130],new o(30,new i(5,115),new i(10,116)),new o(28,new i(19,47),new i(10,48)),new o(30,new i(15,24),new i(25,25)),new o(30,new i(23,15),new i(25,16))),new r(31,[6,30,56,82,108,134],new o(30,new i(13,115),new i(3,116)),new o(28,new i(2,46),new i(29,47)),new o(30,new i(42,24),new i(1,25)),new o(30,new i(23,15),new i(28,16))),new r(32,[6,34,60,86,112,138],new o(30,new i(17,115)),new o(28,new i(10,46),new i(23,47)),new o(30,new i(10,24),new i(35,25)),new o(30,new i(19,15),new i(35,16))),new r(33,[6,30,58,86,114,142],new o(30,new i(17,115),new i(1,116)),new o(28,new i(14,46),new i(21,47)),new o(30,new i(29,24),new i(19,25)),new o(30,new i(11,15),new i(46,16))),new r(34,[6,34,62,90,118,146],new o(30,new i(13,115),new i(6,116)),new o(28,new i(14,46),new i(23,47)),new o(30,new i(44,24),new i(7,25)),new o(30,new i(59,16),new i(1,17))),new r(35,[6,30,54,78,102,126,150],new o(30,new i(12,121),new i(7,122)),new o(28,new i(12,47),new i(26,48)),new o(30,new i(39,24),new i(14,25)),new o(30,new i(22,15),new i(41,16))),new r(36,[6,24,50,76,102,128,154],new o(30,new i(6,121),new i(14,122)),new o(28,new i(6,47),new i(34,48)),new o(30,new i(46,24),new i(10,25)),new o(30,new i(2,15),new i(64,16))),new r(37,[6,28,54,80,106,132,158],new o(30,new i(17,122),new i(4,123)),new o(28,new i(29,46),new i(14,47)),new o(30,new i(49,24),new i(10,25)),new o(30,new i(24,15),new i(46,16))),new r(38,[6,32,58,84,110,136,162],new o(30,new i(4,122),new i(18,123)),new o(28,new i(13,46),new i(32,47)),new o(30,new i(48,24),new i(14,25)),new o(30,new i(42,15),new i(32,16))),new r(39,[6,26,54,82,110,138,166],new o(30,new i(20,117),new i(4,118)),new o(28,new i(40,47),new i(7,48)),new o(30,new i(43,24),new i(22,25)),new o(30,new i(10,15),new i(67,16))),new r(40,[6,30,58,86,114,142,170],new o(30,new i(19,118),new i(6,119)),new o(28,new i(18,47),new i(31,48)),new o(30,new i(34,24),new i(34,25)),new o(30,new i(20,15),new i(61,16)))]}();r.getVersionForNumber=function(e){if(1>e||40<e){throw"ArgumentException"}return r.VERSIONS[e-1]};r.getProvisionalVersionForDimension=function(e){if(1!=e%4){throw"Error getProvisionalVersionForDimension"}try{return r.getVersionForNumber(e-17>>2)}catch(e){throw"Error getVersionForNumber"}};r.decodeVersionInformation=function(e){for(var t=4294967295,o=0,a=0,n;a<r.VERSION_DECODE_INFO.length;a++){n=r.VERSION_DECODE_INFO[a];if(n==e){return this.getVersionForNumber(a+7)}var d=s.numBitsDiffering(e,n);if(d<t){o=a+7;t=d}}if(3>=t){return this.getVersionForNumber(o)}return null};function a(e,t,i,o,r,n,d,s,l){this.a11=e;this.a12=o;this.a13=d;this.a21=t;this.a22=r;this.a23=s;this.a31=i;this.a32=n;this.a33=l;this.transformPoints1=function(e){for(var t=e.length,o=this.a11,r=this.a12,a=this.a13,n=this.a21,d=this.a22,s=this.a23,l=this.a31,c=this.a32,f=this.a33,g=0;g<t;g+=2){var u=e[g],h=e[g+1],m=a*u+s*h+f;e[g]=(o*u+n*h+l)/m;e[g+1]=(r*u+d*h+c)/m}};this.transformPoints2=function(e,t){for(var o=e.length,r=0;r<o;r++){var a=e[r],n=t[r],d=this.a13*a+this.a23*n+this.a33;e[r]=(this.a11*a+this.a21*n+this.a31)/d;t[r]=(this.a12*a+this.a22*n+this.a32)/d}};this.buildAdjoint=function(){return new a(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)};this.times=function(e){return new a(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}a.quadrilateralToQuadrilateral=function(e,t,i,o,r,a,n,d,s,l,c,f,g,u,h,m){var b=this.quadrilateralToSquare(e,t,i,o,r,a,n,d),C=this.squareToQuadrilateral(s,l,c,f,g,u,h,m);return C.times(b)};a.squareToQuadrilateral=function(e,t,i,o,r,n,d,s){var l=s-n,c=t-o+n-s;if(0==l&&0==c){return new a(i-e,r-i,e,o-t,n-o,t,0,0,1)}else{var f=i-r,g=d-r,u=e-i+r-d,h=o-n,m=f*l-g*h,b=(u*l-g*c)/m,C=(f*c-u*h)/m;return new a(i-e+b*i,d-e+C*d,e,o-t+b*o,s-t+C*s,t,b,C,1)}};a.quadrilateralToSquare=function(e,t,i,o,r,a,n,d){return this.squareToQuadrilateral(e,t,i,o,r,a,n,d).buildAdjoint()};function n(e,t){this.bits=e;this.points=t}function d(e){this.image=e;this.resultPointCallback=null;this.sizeOfBlackWhiteBlackRun=function(e,t,i,o){var r=Math.abs(o-t)>Math.abs(i-e);if(r){var a=e;e=t;t=a;a=i;i=o;o=a}for(var n=Math.abs(i-e),d=Math.abs(o-t),s=-n>>1,l=t<o?1:-1,c=e<i?1:-1,f=0,g=e,u=t;g!=i;g+=c){var h=r?u:g,m=r?g:u;if(1==f){if(this.image[h+m*I.width]){f++}}else{if(!this.image[h+m*I.width]){f++}}if(3==f){var b=g-e,C=u-t;return Math.sqrt(b*b+C*C)}s+=d;if(0<s){if(u==o){break}u+=l;s-=n}}var _=i-e,p=o-t;return Math.sqrt(_*_+p*p)};this.sizeOfBlackWhiteBlackRunBothWays=function(e,t,i,o){var r=this.sizeOfBlackWhiteBlackRun(e,t,i,o),a=1,n=e-(i-e);if(0>n){a=e/(e-n);n=0}else if(n>=I.width){a=(I.width-1-e)/(n-e);n=I.width-1}var d=Math.floor(t-(o-t)*a);a=1;if(0>d){a=t/(t-d);d=0}else if(d>=I.height){a=(I.height-1-t)/(d-t);d=I.height-1}n=Math.floor(e+(n-e)*a);r+=this.sizeOfBlackWhiteBlackRun(e,t,n,d);return r-1};this.calculateModuleSizeOneWay=function(e,t){var i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));if(isNaN(i)){return o/7}if(isNaN(o)){return i/7}return(i+o)/14};this.calculateModuleSize=function(e,t,i){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,i))/2};this.distance=function(e,t){var i=e.X-t.X,o=e.Y-t.Y;return Math.sqrt(i*i+o*o)};this.computeDimension=function(e,t,i,o){var r=Math.round(this.distance(e,t)/o),a=Math.round(this.distance(e,i)/o),n=(r+a>>1)+7;switch(3&n){case 0:n++;break;case 2:n--;break;case 3:throw"Error";}return n};this.findAlignmentInRegion=function(e,t,i,o){var r=Math.floor(o*e),a=Math.max(0,t-r),n=Math.min(I.width-1,t+r);if(n-a<3*e){throw"Error"}var d=Math.max(0,i-r),s=Math.min(I.height-1,i+r),l=new k(this.image,a,d,n-a,s-d,e,this.resultPointCallback);return l.find()};this.createTransform=function(e,t,i,o,r){var n=r-3.5,d,s,l,c;if(null!=o){d=o.X;s=o.Y;l=c=n-3}else{d=t.X-e.X+i.X;s=t.Y-e.Y+i.Y;l=c=n}var f=a.quadrilateralToQuadrilateral(3.5,3.5,n,3.5,l,c,3.5,n,e.X,e.Y,t.X,t.Y,d,s,i.X,i.Y);return f};this.sampleGrid=function(e,t,i){return P.sampleGrid3(e,i,t)};this.processFinderPatternInfo=function(e){var t=e.TopLeft,o=e.TopRight,a=e.BottomLeft,d=this.calculateModuleSize(t,o,a);if(1>d){throw"Error"}var s=this.computeDimension(t,o,a,d),l=r.getProvisionalVersionForDimension(s),c=l.DimensionForVersion-7,f=null;if(0<l.AlignmentPatternCenters.length){for(var g=o.X-t.X+a.X,u=o.Y-t.Y+a.Y,h=1-3/c,m=Math.floor(t.X+h*(g-t.X)),b=Math.floor(t.Y+h*(u-t.Y)),C=4;16>=C;C<<=1){f=this.findAlignmentInRegion(d,m,b,C);break}}var _=this.createTransform(t,o,a,f,s),p=this.sampleGrid(this.image,_,s),k;if(null==f){k=[a,t,o]}else{k=[a,t,o,f]}return new n(p,k)};this.detect=function(){var e=new _().findFinderPattern(this.image);return this.processFinderPatternInfo(e)}}var S=[[21522,0],[20773,1],[24188,2],[23371,3],[17913,4],[16590,5],[20375,6],[19104,7],[30660,8],[29427,9],[32170,10],[30877,11],[26159,12],[25368,13],[27713,14],[26998,15],[5769,16],[5054,17],[7399,18],[6608,19],[1890,20],[597,21],[3340,22],[2107,23],[13663,24],[12392,25],[16177,26],[14854,27],[9396,28],[8579,29],[11994,30],[11245,31]],B=[0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4];function s(e){this.errorCorrectionLevel=l.forBits(3&e>>3);this.dataMask=7&e;this.__defineGetter__("ErrorCorrectionLevel",function(){return this.errorCorrectionLevel});this.__defineGetter__("DataMask",function(){return this.dataMask});this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|this.dataMask};this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask}}s.numBitsDiffering=function(e,t){e^=t;return B[15&e]+B[15&m(e,4)]+B[15&m(e,8)]+B[15&m(e,12)]+B[15&m(e,16)]+B[15&m(e,20)]+B[15&m(e,24)]+B[15&m(e,28)]};s.decodeFormatInformation=function(e){var t=s.doDecodeFormatInformation(e);if(null!=t){return t}return s.doDecodeFormatInformation(e^21522)};s.doDecodeFormatInformation=function(e){for(var t=4294967295,o=0,r=0;r<S.length;r++){var a=S[r],n=a[0];if(n==e){return new s(a[1])}var d=this.numBitsDiffering(e,n);if(d<t){o=a[1];t=d}}if(3>=t){return new s(o)}return null};function l(e,t,i){this.ordinal_Renamed_Field=e;this.bits=t;this.name=i;this.__defineGetter__("Bits",function(){return this.bits});this.__defineGetter__("Name",function(){return this.name});this.ordinal=function(){return this.ordinal_Renamed_Field}}l.forBits=function(e){if(0>e||e>=D.length){throw"ArgumentException"}return D[e]};var E=new l(0,1,"L"),x=new l(1,0,"M"),M=new l(2,3,"Q"),y=new l(3,2,"H"),D=[x,E,y,M];function c(e,t){if(!t)t=e;if(1>e||1>t){throw"Both dimensions must be greater than 0"}this.width=e;this.height=t;var o=e>>5;if(0!=(31&e)){o++}this.rowSize=o;this.bits=Array(o*t);for(var r=0;r<this.bits.length;r++){this.bits[r]=0}this.__defineGetter__("Width",function(){return this.width});this.__defineGetter__("Height",function(){return this.height});this.__defineGetter__("Dimension",function(){if(this.width!=this.height){throw"Can't call getDimension() on a non-square matrix"}return this.width});this.get_Renamed=function(e,t){var i=t*this.rowSize+(e>>5);return 0!=(1&m(this.bits[i],31&e))};this.set_Renamed=function(e,t){var i=t*this.rowSize+(e>>5);this.bits[i]|=1<<(31&e)};this.flip=function(e,t){var i=t*this.rowSize+(e>>5);this.bits[i]^=1<<(31&e)};this.clear=function(){for(var e=this.bits.length,t=0;t<e;t++){this.bits[t]=0}};this.setRegion=function(e,t,i,o){if(0>t||0>e){throw"Left and top must be nonnegative"}if(1>o||1>i){throw"Height and width must be at least 1"}var r=e+i,a=t+o;if(a>this.height||r>this.width){throw"The region must fit inside the matrix"}for(var n=t,d;n<a;n++){d=n*this.rowSize;for(var s=e;s<r;s++){this.bits[d+(s>>5)]|=1<<(31&s)}}}}function f(e,t){this.numDataCodewords=e;this.codewords=t;this.__defineGetter__("NumDataCodewords",function(){return this.numDataCodewords});this.__defineGetter__("Codewords",function(){return this.codewords})}f.getDataBlocks=function(e,t,o){if(e.length!=t.TotalCodewords){throw"ArgumentException"}for(var r=t.getECBlocksForLevel(o),a=0,n=r.getECBlocks(),d=0;d<n.length;d++){a+=n[d].Count}for(var s=Array(a),l=0,c=0,g;c<n.length;c++){g=n[c];for(var d=0;d<g.Count;d++){var u=g.DataCodewords,h=r.ECCodewordsPerBlock+u;s[l++]=new f(u,Array(h))}}var m=s[0].codewords.length,b=s.length-1;while(0<=b){var C=s[b].codewords.length;if(C==m){break}b--}b++;for(var _=m-r.ECCodewordsPerBlock,p=0,d=0;d<_;d++){for(var c=0;c<l;c++){s[c].codewords[d]=e[p++]}}for(var c=b;c<l;c++){s[c].codewords[_]=e[p++]}for(var k=s[0].codewords.length,d=_;d<k;d++){for(var c=0,w;c<l;c++){w=c<b?d:d+1;s[c].codewords[w]=e[p++]}}return s};function g(e){var t=e.Dimension;if(21>t||1!=(3&t)){throw"Error BitMatrixParser"}this.bitMatrix=e;this.parsedVersion=null;this.parsedFormatInfo=null;this.copyBit=function(e,t,i){return this.bitMatrix.get_Renamed(e,t)?1|i<<1:i<<1};this.readFormatInformation=function(){if(null!=this.parsedFormatInfo){return this.parsedFormatInfo}for(var e=0,t=0;6>t;t++){e=this.copyBit(t,8,e)}e=this.copyBit(7,8,e);e=this.copyBit(8,8,e);e=this.copyBit(8,7,e);for(var o=5;0<=o;o--){e=this.copyBit(8,o,e)}this.parsedFormatInfo=s.decodeFormatInformation(e);if(null!=this.parsedFormatInfo){return this.parsedFormatInfo}var r=this.bitMatrix.Dimension;e=0;for(var t=r-1;t>=r-8;t--){e=this.copyBit(t,8,e)}for(var o=r-7;o<r;o++){e=this.copyBit(8,o,e)}this.parsedFormatInfo=s.decodeFormatInformation(e);if(null!=this.parsedFormatInfo){return this.parsedFormatInfo}throw"Error readFormatInformation"};this.readVersion=function(){if(null!=this.parsedVersion){return this.parsedVersion}var e=this.bitMatrix.Dimension,t=e-17>>2;if(6>=t){return r.getVersionForNumber(t)}for(var o=0,a=e-11,n=5;0<=n;n--){for(var d=e-9;d>=a;d--){o=this.copyBit(d,n,o)}}this.parsedVersion=r.decodeVersionInformation(o);if(null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e){return this.parsedVersion}o=0;for(var d=5;0<=d;d--){for(var n=e-9;n>=a;n--){o=this.copyBit(d,n,o)}}this.parsedVersion=r.decodeVersionInformation(o);if(null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e){return this.parsedVersion}throw"Error readVersion"};this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),o=v.forReference(e.DataMask),r=this.bitMatrix.Dimension;o.unmaskBitMatrix(this.bitMatrix,r);for(var a=t.buildFunctionPattern(),n=!0,d=Array(t.TotalCodewords),s=0,l=0,c=0,f=r-1;0<f;f-=2){if(6==f){f--}for(var g=0,u;g<r;g++){u=n?r-1-g:g;for(var h=0;2>h;h++){if(!a.get_Renamed(f-h,u)){c++;l<<=1;if(this.bitMatrix.get_Renamed(f-h,u)){l|=1}if(8==c){d[s++]=l;c=0;l=0}}}}n^=!0}if(s!=t.TotalCodewords){throw"Error readCodewords"}return d}}var v={};v.forReference=function(e){if(0>e||7<e){throw"System.ArgumentException"}return v.DATA_MASKS[e]};v.DATA_MASKS=[new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e,t){return 0==(1&e+t)}},new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e){return 0==(1&e)}},new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e,t){return 0==t%3}},new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e,t){return 0==(e+t)%3}},new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e,t){return 0==(1&m(e,1)+t/3)}},new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e,t){var i=e*t;return 0==(1&i)+i%3}},new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e,t){var i=e*t;return 0==(1&(1&i)+i%3)}},new function(){this.unmaskBitMatrix=function(e,t){for(var o=0;o<t;o++){for(var r=0;r<t;r++){if(this.isMasked(o,r)){e.flip(r,o)}}}};this.isMasked=function(e,t){return 0==(1&(1&e+t)+e*t%3)}}];function u(e,t){if(null==t||0==t.length){throw"System.ArgumentException"}this.field=e;var o=t.length;if(1<o&&0==t[0]){var r=1;while(r<o&&0==t[r]){r++}if(r==o){this.coefficients=e.Zero.coefficients}else{this.coefficients=Array(o-r);for(var a=0;a<this.coefficients.length;a++){this.coefficients[a]=0}for(var n=0;n<this.coefficients.length;n++){this.coefficients[n]=t[r+n]}}}else{this.coefficients=t}this.__defineGetter__("Zero",function(){return 0==this.coefficients[0]});this.__defineGetter__("Degree",function(){return this.coefficients.length-1});this.__defineGetter__("Coefficients",function(){return this.coefficients});this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]};this.evaluateAt=function(e){if(0==e){return this.getCoefficient(0)}var t=this.coefficients.length;if(1==e){for(var o=0,r=0;r<t;r++){o=h.addOrSubtract(o,this.coefficients[r])}return o}for(var a=this.coefficients[0],r=1;r<t;r++){a=h.addOrSubtract(this.field.multiply(e,a),this.coefficients[r])}return a};this.addOrSubtract=function(t){if(this.field!=t.field){throw"GF256Polys do not have same GF256 field"}if(this.Zero){return t}if(t.Zero){return this}var o=this.coefficients,r=t.coefficients;if(o.length>r.length){var a=o;o=r;r=a}for(var n=Array(r.length),d=r.length-o.length,s=0;s<d;s++){n[s]=r[s]}for(var l=d;l<r.length;l++){n[l]=h.addOrSubtract(o[l-d],r[l])}return new u(e,n)};this.multiply1=function(e){if(this.field!=e.field){throw"GF256Polys do not have same GF256 field"}if(this.Zero||e.Zero){return this.field.Zero}for(var t=this.coefficients,o=t.length,r=e.coefficients,a=r.length,n=Array(o+a-1),d=0,s;d<o;d++){s=t[d];for(var l=0;l<a;l++){n[d+l]=h.addOrSubtract(n[d+l],this.field.multiply(s,r[l]))}}return new u(this.field,n)};this.multiply2=function(e){if(0==e){return this.field.Zero}if(1==e){return this}for(var t=this.coefficients.length,o=Array(t),r=0;r<t;r++){o[r]=this.field.multiply(this.coefficients[r],e)}return new u(this.field,o)};this.multiplyByMonomial=function(e,t){if(0>e){throw"System.ArgumentException"}if(0==t){return this.field.Zero}for(var o=this.coefficients.length,r=Array(o+e),a=0;a<r.length;a++){r[a]=0}for(var a=0;a<o;a++){r[a]=this.field.multiply(this.coefficients[a],t)}return new u(this.field,r)};this.divide=function(e){if(this.field!=e.field){throw"GF256Polys do not have same GF256 field"}if(e.Zero){throw"Divide by 0"}var t=this.field.Zero,i=this,o=e.getCoefficient(e.Degree),r=this.field.inverse(o);while(i.Degree>=e.Degree&&!i.Zero){var a=i.Degree-e.Degree,n=this.field.multiply(i.getCoefficient(i.Degree),r),d=e.multiplyByMonomial(a,n),s=this.field.buildMonomial(a,n);t=t.addOrSubtract(s);i=i.addOrSubtract(d)}return[t,i]}}function h(e){this.expTable=Array(256);this.logTable=Array(256);for(var t=1,o=0;256>o;o++){this.expTable[o]=t;t<<=1;if(256<=t){t^=e}}for(var o=0;255>o;o++){this.logTable[this.expTable[o]]=o}var r=[,];r[0]=0;this.zero=new u(this,Array(r));var a=[,];a[0]=1;this.one=new u(this,Array(a));this.__defineGetter__("Zero",function(){return this.zero});this.__defineGetter__("One",function(){return this.one});this.buildMonomial=function(e,t){if(0>e){throw"System.ArgumentException"}if(0==t){return this.zero}for(var o=Array(e+1),r=0;r<o.length;r++){o[r]=0}o[0]=t;return new u(this,o)};this.exp=function(e){return this.expTable[e]};this.log=function(e){if(0==e){throw"System.ArgumentException"}return this.logTable[e]};this.inverse=function(e){if(0==e){throw"System.ArithmeticException"}return this.expTable[255-this.logTable[e]]};this.multiply=function(e,t){if(0==e||0==t){return 0}if(1==e){return t}if(1==t){return e}return this.expTable[(this.logTable[e]+this.logTable[t])%255]}}h.QR_CODE_FIELD=new h(285);h.DATA_MATRIX_FIELD=new h(301);h.addOrSubtract=function(e,t){return e^t};var F={rsDecoder:new function(e){this.field=e;this.decode=function(e,t){for(var o=new u(this.field,e),r=Array(t),a=0;a<r.length;a++){r[a]=0}for(var n=!1,d=!0,a=0,s;a<t;a++){s=o.evaluateAt(this.field.exp(n?a+1:a));r[r.length-1-a]=s;if(0!=s){d=!1}}if(d){return}for(var l=new u(this.field,r),c=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),l,t),f=c[0],g=c[1],m=this.findErrorLocations(f),b=this.findErrorMagnitudes(g,m,n),a=0,C;a<m.length;a++){C=e.length-1-this.field.log(m[a]);if(0>C){throw"ReedSolomonException Bad error location"}e[C]=h.addOrSubtract(e[C],b[a])}};this.runEuclideanAlgorithm=function(e,i,o){if(e.Degree<i.Degree){var n=e;e=i;i=n}var d=e,l=i,c=this.field.One,f=this.field.Zero,g=this.field.Zero,u=this.field.One;while(l.Degree>=Math.floor(o/2)){var h=d,m=c,C=g;d=l;c=f;g=u;if(d.Zero){throw"r_{i-1} was zero"}l=h;var _=this.field.Zero,p=d.getCoefficient(d.Degree),k=this.field.inverse(p);while(l.Degree>=d.Degree&&!l.Zero){var w=l.Degree-d.Degree,P=this.field.multiply(l.getCoefficient(l.Degree),k);_=_.addOrSubtract(this.field.buildMonomial(w,P));l=l.addOrSubtract(d.multiplyByMonomial(w,P))}f=_.multiply1(c).addOrSubtract(m);u=_.multiply1(g).addOrSubtract(C)}var S=u.getCoefficient(0);if(0==S){throw"ReedSolomonException sigmaTilde(0) was zero"}var B=this.field.inverse(S),M=u.multiply2(B),E=l.multiply2(B);return[M,E]};this.findErrorLocations=function(t){var o=t.Degree;if(1==o){return Array(t.getCoefficient(1))}for(var r=Array(o),a=0,n=1;256>n&&a<o;n++){if(0==t.evaluateAt(n)){r[a]=this.field.inverse(n);a++}}if(a!=o){throw"Error locator degree does not match number of roots"}return r};this.findErrorMagnitudes=function(e,t,o){for(var r=t.length,a=Array(r),n=0;n<r;n++){for(var d=this.field.inverse(t[n]),s=1,l=0;l<r;l++){if(n!=l){s=this.field.multiply(s,h.addOrSubtract(1,this.field.multiply(t[l],d)))}}a[n]=this.field.multiply(e.evaluateAt(d),this.field.inverse(s));if(o){a[n]=this.field.multiply(a[n],d)}}return a}}(h.QR_CODE_FIELD)};F.correctErrors=function(e,t){for(var o=e.length,r=Array(o),a=0;a<o;a++){r[a]=255&e[a]}var n=e.length-t;try{F.rsDecoder.decode(r,n)}catch(e){throw e}for(var a=0;a<t;a++){e[a]=r[a]}};F.decode=function(e){for(var t=new g(e),o=t.readVersion(),r=t.readFormatInformation().ErrorCorrectionLevel,a=t.readCodewords(),n=f.getDataBlocks(a,o,r),d=0,s=0;s<n.length;s++){d+=n[s].NumDataCodewords}for(var l=Array(d),c=0,u=0;u<n.length;u++){var h=n[u],m=h.Codewords,b=h.NumDataCodewords;F.correctErrors(m,b);for(var s=0;s<b;s++){l[c++]=m[s]}}var C=new w(l,o.VersionNumber,r.Bits);return C};var I={imagedata:null,video:!1,width:0,height:0,qrCodeSymbol:null,debug:!1,maxImgSize:1048576,interval:500,sizeOfDataLengthInfo:[[10,9,8,8],[12,11,16,10],[14,13,16,12]],callback:null};I.startWebCam=function(e){I.videoId=e;I.video=document.getElementById(I.videoId);var t=I.video.play();if(t!==void 0){t.then(function(){}).catch(function(){})}if(navigator.getUserMedia){navigator.getUserMedia({audio:!1,video:{facingMode:"environment"}},I.webCamSuccess,I.webCamError)}};I.stopWebCam=function(){I.video.pause()};I.webCamSuccess=function(e){I.localstream=e;I.video.srcObject=e;I.video.controls=!1;I.video.volume=0};I.webCamError=function(){I.stopScan()};I.startScan=function(e){I.canvasid="qr-canvas"+e;var i=document.getElementById(e);I.canvas_qr2=document.createElement("canvas");I.canvas_qr2.id=I.canvasid;I.qrcontext2=I.canvas_qr2.getContext("2d");I.canvas_qr2.width=I.video.videoWidth;I.canvas_qr2.height=I.video.videoHeight;I.gUM=!0;var o=function(){if(I.gUM){try{if(0==i.videoWidth){setTimeout(o,I.interval);return}else{I.canvas_qr2.width=i.videoWidth;I.canvas_qr2.height=i.videoHeight}I.qrcontext2.drawImage(i,0,0);try{I.decode()}catch(i){t.debug(i);setTimeout(o,I.interval)}}catch(i){t.debug(i);setTimeout(o,I.interval)}}};o()};I.stopScan=function(){I.gUM=!1};I.decode=function(e){if(e){var t=e,i=I.canvas_qr2.getContext("2d")}else{var t=I.canvas_qr2,i=I.qrcontext2}I.width=t.width;I.height=t.height;I.imagedata=i.getImageData(0,0,I.width,I.height);I.result=I.process(i);if(null!=I.callback)I.callback(I.result);return I.result};I.isUrl=function(e){return /(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)};I.decode_url=function(i){var o="";try{o=escape(i)}catch(r){t.debug(r);o=i}var r="";try{r=decodeURIComponent(o)}catch(i){t.debug(i);r=o}return r};I.decode_utf8=function(e){if(I.isUrl(e))return I.decode_url(e);else return e};I.process=function(e){var o=new Date().getTime(),r=I.grayScaleToBitmap(I.grayscale());if(I.debug){for(var a=0;a<I.height;a++){for(var n=0,s;n<I.width;n++){s=4*n+4*(a*I.width);I.imagedata.data[s]=r[n+a*I.width]?0:0;I.imagedata.data[s+1]=r[n+a*I.width]?0:0;I.imagedata.data[s+2]=r[n+a*I.width]?255:0}}e.putImageData(I.imagedata,0,0)}var l=new d(r),c=l.detect();if(I.debug){for(var a=0;a<c.bits.Height;a++){for(var n=0,s;n<c.bits.Width;n++){s=2*(4*n)+4*(2*a*I.width);I.imagedata.data[s]=c.bits.get_Renamed(n,a)?0:0;I.imagedata.data[s+1]=c.bits.get_Renamed(n,a)?0:0;I.imagedata.data[s+2]=c.bits.get_Renamed(n,a)?255:0}}e.putImageData(I.imagedata,0,0)}for(var f=F.decode(c.bits),g=f.DataByte,u="",h=0;h<g.length;h++){for(var m=0;m<g[h].length;m++){u+=String.fromCharCode(g[h][m])}}var b=new Date().getTime();t.debug(b-o);return I.decode_utf8(u)};I.getPixel=function(e,t){if(I.width<e){throw"point error"}if(I.height<t){throw"point error"}var i=4*e+4*(t*I.width),o=(33*I.imagedata.data[i]+34*I.imagedata.data[i+1]+33*I.imagedata.data[i+2])/100;return o};I.binarize=function(e){for(var t=Array(I.width*I.height),i=0;i<I.height;i++){for(var o=0,r;o<I.width;o++){r=I.getPixel(o,i);t[o+i*I.width]=r<=e?!0:!1}}return t};I.getMiddleBrightnessPerArea=function(e){for(var t=4,o=Math.floor(I.width/t),r=Math.floor(I.height/t),a=Array(t),n=0;n<t;n++){a[n]=Array(t);for(var d=0;d<t;d++){a[n][d]=[0,0]}}for(var s=0;s<t;s++){for(var l=0;l<t;l++){a[l][s][0]=255;for(var c=0;c<r;c++){for(var f=0,g;f<o;f++){g=e[o*l+f+(r*s+c)*I.width];if(g<a[l][s][0])a[l][s][0]=g;if(g>a[l][s][1])a[l][s][1]=g}}}}for(var u=Array(t),h=0;h<t;h++){u[h]=Array(t)}for(var s=0;s<t;s++){for(var l=0;l<t;l++){u[l][s]=Math.floor((a[l][s][0]+a[l][s][1])/2)}}return u};I.grayScaleToBitmap=function(e){for(var t=I.getMiddleBrightnessPerArea(e),i=t.length,o=Math.floor(I.width/i),r=Math.floor(I.height/i),a=new ArrayBuffer(I.width*I.height),n=new Uint8Array(a),d=0;d<i;d++){for(var s=0;s<i;s++){for(var l=0;l<r;l++){for(var c=0;c<o;c++){n[o*s+c+(r*d+l)*I.width]=e[o*s+c+(r*d+l)*I.width]<t[s][d]?!0:!1}}}}return n};I.grayscale=function(){for(var e=new ArrayBuffer(I.width*I.height),t=new Uint8Array(e),i=0;i<I.height;i++){for(var o=0,r;o<I.width;o++){r=I.getPixel(o,i);t[o+i*I.width]=r}}return t};function m(e,t){if(0<=e)return e>>t;else return(e>>t)+(2<<~t)}var R=8,G=2;I.orderBestPatterns=function(e){function t(e,t){var i=e.X-t.X,o=e.Y-t.Y;return Math.sqrt(i*i+o*o)}function i(e,t,i){var o=t.x,r=t.y;return(i.x-o)*(e.y-r)-(i.y-r)*(e.x-o)}var o=t(e[0],e[1]),r=t(e[1],e[2]),a=t(e[0],e[2]),n,d,s;if(r>=o&&r>=a){d=e[0];n=e[1];s=e[2]}else if(a>=r&&a>=o){d=e[1];n=e[0];s=e[2]}else{d=e[2];n=e[0];s=e[1]}if(0>i(n,d,s)){var l=n;n=s;s=l}e[0]=n;e[1]=d;e[2]=s};function b(e,t,i){this.x=e;this.y=t;this.count=1;this.estimatedModuleSize=i;this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize});this.__defineGetter__("Count",function(){return this.count});this.__defineGetter__("X",function(){return this.x});this.__defineGetter__("Y",function(){return this.y});this.incrementCount=function(){this.count++};this.aboutEquals=function(e,t,i){if(Math.abs(t-this.y)<=e&&Math.abs(i-this.x)<=e){var o=Math.abs(e-this.estimatedModuleSize);return 1>=o||1>=o/this.estimatedModuleSize}return!1}}function C(e){this.bottomLeft=e[0];this.topLeft=e[1];this.topRight=e[2];this.__defineGetter__("BottomLeft",function(){return this.bottomLeft});this.__defineGetter__("TopLeft",function(){return this.topLeft});this.__defineGetter__("TopRight",function(){return this.topRight})}function _(){this.image=null;this.possibleCenters=[];this.hasSkipped=!1;this.crossCheckStateCount=[0,0,0,0,0];this.resultPointCallback=null;this.__defineGetter__("CrossCheckStateCount",function(){this.crossCheckStateCount[0]=0;this.crossCheckStateCount[1]=0;this.crossCheckStateCount[2]=0;this.crossCheckStateCount[3]=0;this.crossCheckStateCount[4]=0;return this.crossCheckStateCount});this.foundPatternCross=function(e){for(var t=0,o=0,r;5>o;o++){r=e[o];if(0==r){return!1}t+=r}if(7>t){return!1}var a=Math.floor((t<<R)/7),n=Math.floor(a/2);return Math.abs(a-(e[0]<<R))<n&&Math.abs(a-(e[1]<<R))<n&&Math.abs(3*a-(e[2]<<R))<3*n&&Math.abs(a-(e[3]<<R))<n&&Math.abs(a-(e[4]<<R))<n};this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2};this.crossCheckVertical=function(e,t,o,r){var a=this.image,n=I.height,d=this.CrossCheckStateCount,s=e;while(0<=s&&a[t+s*I.width]){d[2]++;s--}if(0>s){return NaN}while(0<=s&&!a[t+s*I.width]&&d[1]<=o){d[1]++;s--}if(0>s||d[1]>o){return NaN}while(0<=s&&a[t+s*I.width]&&d[0]<=o){d[0]++;s--}if(d[0]>o){return NaN}s=e+1;while(s<n&&a[t+s*I.width]){d[2]++;s++}if(s==n){return NaN}while(s<n&&!a[t+s*I.width]&&d[3]<o){d[3]++;s++}if(s==n||d[3]>=o){return NaN}while(s<n&&a[t+s*I.width]&&d[4]<o){d[4]++;s++}if(d[4]>=o){return NaN}var l=d[0]+d[1]+d[2]+d[3]+d[4];if(5*Math.abs(l-r)>=2*r){return NaN}return this.foundPatternCross(d)?this.centerFromEnd(d,s):NaN};this.crossCheckHorizontal=function(e,t,i,o){var r=this.image,a=I.width,n=this.CrossCheckStateCount,d=e;while(0<=d&&r[d+t*I.width]){n[2]++;d--}if(0>d){return NaN}while(0<=d&&!r[d+t*I.width]&&n[1]<=i){n[1]++;d--}if(0>d||n[1]>i){return NaN}while(0<=d&&r[d+t*I.width]&&n[0]<=i){n[0]++;d--}if(n[0]>i){return NaN}d=e+1;while(d<a&&r[d+t*I.width]){n[2]++;d++}if(d==a){return NaN}while(d<a&&!r[d+t*I.width]&&n[3]<i){n[3]++;d++}if(d==a||n[3]>=i){return NaN}while(d<a&&r[d+t*I.width]&&n[4]<i){n[4]++;d++}if(n[4]>=i){return NaN}var s=n[0]+n[1]+n[2]+n[3]+n[4];if(5*Math.abs(s-o)>=o){return NaN}return this.foundPatternCross(n)?this.centerFromEnd(n,d):NaN};this.handlePossibleCenter=function(e,t,i){var o=e[0]+e[1]+e[2]+e[3]+e[4],r=this.centerFromEnd(e,i),a=this.crossCheckVertical(t,Math.floor(r),e[2],o);if(!isNaN(a)){r=this.crossCheckHorizontal(Math.floor(r),Math.floor(a),e[2],o);if(!isNaN(r)){for(var n=o/7,d=!1,s=this.possibleCenters.length,l=0,c;l<s;l++){c=this.possibleCenters[l];if(c.aboutEquals(n,a,r)){c.incrementCount();d=!0;break}}if(!d){var f=new b(r,a,n);this.possibleCenters.push(f);if(null!=this.resultPointCallback){this.resultPointCallback.foundPossibleResultPoint(f)}}return!0}}return!1};this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(3>e){throw"Couldn't find enough finder patterns (found "+e+")"}if(3<e){for(var t=0,o=0,r=0,a;r<e;r++){a=this.possibleCenters[r].EstimatedModuleSize;t+=a;o+=a*a}var n=t/e;this.possibleCenters.sort(function(e,t){var i=Math.abs(t.EstimatedModuleSize-n),o=Math.abs(e.EstimatedModuleSize-n);if(i<o){return-1}else if(i==o){return 0}else{return 1}});for(var d=Math.sqrt(o/e-n*n),s=Math.max(.2*n,d),r=this.possibleCenters.length-1,l;0<=r;r--){l=this.possibleCenters[r];if(Math.abs(l.EstimatedModuleSize-n)>s){this.possibleCenters.splice(r,1)}}}if(3<this.possibleCenters.length){this.possibleCenters.sort(function(e,t){if(e.count>t.count){return-1}if(e.count<t.count){return 1}return 0})}return[this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2]]};this.findRowSkip=function(){var e=this.possibleCenters.length;if(1>=e){return 0}for(var t=null,o=0,r;o<e;o++){r=this.possibleCenters[o];if(r.Count>=G){if(null==t){t=r}else{this.hasSkipped=!0;return Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2)}}}return 0};this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,o=this.possibleCenters.length,r=0,a;r<o;r++){a=this.possibleCenters[r];if(a.Count>=G){e++;t+=a.EstimatedModuleSize}}if(3>e){return!1}for(var n=t/o,d=0,r=0;r<o;r++){a=this.possibleCenters[r];d+=Math.abs(a.EstimatedModuleSize-n)}return d<=.05*t};this.findFinderPattern=function(e){this.image=e;var t=I.height,o=I.width,r=Math.floor(3*t/(4*57));if(r<3||!1){r=3}for(var a=!1,n=[,,,,,],d=r-1;d<t&&!a;d+=r){n[0]=0;n[1]=0;n[2]=0;n[3]=0;n[4]=0;for(var s=0,l=0;l<o;l++){if(e[l+d*I.width]){if(1==(1&s)){s++}n[s]++}else{if(0==(1&s)){if(4==s){if(this.foundPatternCross(n)){var c=this.handlePossibleCenter(n,d,l);if(c){r=2;if(this.hasSkipped){a=this.haveMultiplyConfirmedCenters()}else{var f=this.findRowSkip();if(f>n[2]){d+=f-n[2]-r;l=o-1}}}else{do{l++}while(l<o&&!e[l+d*I.width]);l--}s=0;n[0]=0;n[1]=0;n[2]=0;n[3]=0;n[4]=0}else{n[0]=n[2];n[1]=n[3];n[2]=n[4];n[3]=1;n[4]=0;s=3}}else{n[++s]++}}else{n[s]++}}}if(this.foundPatternCross(n)){var c=this.handlePossibleCenter(n,d,o);if(c){r=n[0];if(this.hasSkipped){a=this.haveMultiplyConfirmedCenters()}}}}var g=this.selectBestPatterns();I.orderBestPatterns(g);return new C(g)}}function p(e,t,i){this.x=e;this.y=t;this.count=1;this.estimatedModuleSize=i;this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize});this.__defineGetter__("Count",function(){return this.count});this.__defineGetter__("X",function(){return Math.floor(this.x)});this.__defineGetter__("Y",function(){return Math.floor(this.y)});this.incrementCount=function(){this.count++};this.aboutEquals=function(e,t,i){if(Math.abs(t-this.y)<=e&&Math.abs(i-this.x)<=e){var o=Math.abs(e-this.estimatedModuleSize);return 1>=o||1>=o/this.estimatedModuleSize}return!1}}function k(e,t,o,r,a,n,d){this.image=e;this.possibleCenters=[];this.startX=t;this.startY=o;this.width=r;this.height=a;this.moduleSize=n;this.crossCheckStateCount=[0,0,0];this.resultPointCallback=d;this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2};this.foundPatternCross=function(e){for(var t=this.moduleSize,o=0;3>o;o++){if(Math.abs(t-e[o])>=t/2){return!1}}return!0};this.crossCheckVertical=function(e,t,o,r){var a=this.image,n=I.height,d=this.crossCheckStateCount;d[0]=0;d[1]=0;d[2]=0;var s=e;while(0<=s&&a[t+s*I.width]&&d[1]<=o){d[1]++;s--}if(0>s||d[1]>o){return NaN}while(0<=s&&!a[t+s*I.width]&&d[0]<=o){d[0]++;s--}if(d[0]>o){return NaN}s=e+1;while(s<n&&a[t+s*I.width]&&d[1]<=o){d[1]++;s++}if(s==n||d[1]>o){return NaN}while(s<n&&!a[t+s*I.width]&&d[2]<=o){d[2]++;s++}if(d[2]>o){return NaN}var l=d[0]+d[1]+d[2];if(5*Math.abs(l-r)>=2*r){return NaN}return this.foundPatternCross(d)?this.centerFromEnd(d,s):NaN};this.handlePossibleCenter=function(e,t,i){var o=e[0]+e[1]+e[2],r=this.centerFromEnd(e,i),a=this.crossCheckVertical(t,Math.floor(r),2*e[1],o);if(!isNaN(a)){for(var n=(e[0]+e[1]+e[2])/3,d=this.possibleCenters.length,s=0,l;s<d;s++){l=this.possibleCenters[s];if(l.aboutEquals(n,a,r)){return new p(r,a,n)}}var c=new p(r,a,n);this.possibleCenters.push(c);if(null!=this.resultPointCallback){this.resultPointCallback.foundPossibleResultPoint(c)}}return null};this.find=function(){for(var t=this.startX,a=this.height,n=t+r,d=[0,0,0],s=0,l;s<a;s++){l=o+(a>>1)+(0==(1&s)?s+1>>1:-(s+1>>1));d[0]=0;d[1]=0;d[2]=0;var c=t;while(c<n&&!e[c+I.width*l]){c++}var f=0;while(c<n){if(e[c+l*I.width]){if(1==f){d[f]++}else{if(2==f){if(this.foundPatternCross(d)){var g=this.handlePossibleCenter(d,l,c);if(null!=g){return g}}d[0]=d[2];d[1]=1;d[2]=0;f=1}else{d[++f]++}}}else{if(1==f){f++}d[f]++}c++}if(this.foundPatternCross(d)){var g=this.handlePossibleCenter(d,l,n);if(null!=g){return g}}}if(!(0==this.possibleCenters.length)){return this.possibleCenters[0]}throw"Couldn't find enough alignment patterns"}}function w(e,t,i){this.blockPointer=0;this.bitPointer=7;this.dataLength=0;this.blocks=e;this.numErrorCorrectionCode=i;if(9>=t)this.dataLengthMode=0;else if(10<=t&&26>=t)this.dataLengthMode=1;else if(27<=t&&40>=t)this.dataLengthMode=2;this.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var o=0,r=0;r<e;r++){o+=1<<r}o<<=this.bitPointer-e+1;t=(this.blocks[this.blockPointer]&o)>>this.bitPointer-e+1;this.bitPointer-=e;return t}else if(e<this.bitPointer+1+8){for(var a=0,r=0;r<this.bitPointer+1;r++){a+=1<<r}t=(this.blocks[this.blockPointer]&a)<<e-(this.bitPointer+1);this.blockPointer++;t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1));this.bitPointer=this.bitPointer-e%8;if(0>this.bitPointer){this.bitPointer=8+this.bitPointer}return t}else if(e<this.bitPointer+1+16){for(var a=0,n=0,r=0;r<this.bitPointer+1;r++){a+=1<<r}var d=(this.blocks[this.blockPointer]&a)<<e-(this.bitPointer+1);this.blockPointer++;var s=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);this.blockPointer++;for(var r=0;r<e-(this.bitPointer+1+8);r++){n+=1<<r}n<<=8-(e-(this.bitPointer+1+8));var l=(this.blocks[this.blockPointer]&n)>>8-(e-(this.bitPointer+1+8));t=d+s+l;this.bitPointer=this.bitPointer-(e-8)%8;if(0>this.bitPointer){this.bitPointer=8+this.bitPointer}return t}else{return 0}};this.NextMode=function(){if(this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2)return 0;else return this.getNextBits(4)};this.getDataLength=function(e){var t=0;while(!0){if(1==e>>t)break;t++}return this.getNextBits(I.sizeOfDataLengthInfo[this.dataLengthMode][t])};this.getRomanAndFigureString=function(e){var t=e,i=0,o="",r=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];do{if(1<t){i=this.getNextBits(11);var a=Math.floor(i/45),n=i%45;o+=r[a];o+=r[n];t-=2}else if(1==t){i=this.getNextBits(6);o+=r[i];t-=1}}while(0<t);return o};this.getFigureString=function(e){var t=e,i=0,o="";do{if(3<=t){i=this.getNextBits(10);if(100>i)o+="0";if(10>i)o+="0";t-=3}else if(2==t){i=this.getNextBits(7);if(10>i)o+="0";t-=2}else if(1==t){i=this.getNextBits(4);t-=1}o+=i}while(0<t);return o};this.get8bitByteArray=function(e){var t=e,i=0,o=[];do{i=this.getNextBits(8);o.push(i);t--}while(0<t);return o};this.getKanjiString=function(e){var t=e,i=0,o="";do{i=this.getNextBits(13);var r=i%192,a=i/192,n=(a<<8)+r,d=0;if(40956>=n+33088){d=n+33088}else{d=n+49472}o+=String.fromCharCode(d);t--}while(0<t);return o};this.parseECIValue=function(){var e=0,t=this.getNextBits(8);if(0==(128&t)){e=127&t}if(128==(192&t)){var i=this.getNextBits(8);e=(63&t)<<8|i}if(192==(224&t)){var o=this.getNextBits(8);e=(31&t)<<16|o}return e};this.__defineGetter__("DataByte",function(){var e=[],t=1,i=2,o=4,r=7,a=8;do{var n=this.NextMode();if(0==n){if(0<e.length)break;else throw"Empty data block"}if(n!=t&&n!=i&&n!=o&&n!=a&&n!=r){throw"Invalid mode: "+n+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")"}if(n==r){var d=this.parseECIValue()}else{var s=this.getDataLength(n);if(1>s)throw"Invalid data length: "+s;switch(n){case t:for(var l=this.getFigureString(s),c=Array(l.length),f=0;f<l.length;f++){c[f]=l.charCodeAt(f)}e.push(c);break;case i:for(var l=this.getRomanAndFigureString(s),c=Array(l.length),f=0;f<l.length;f++){c[f]=l.charCodeAt(f)}e.push(c);break;case o:var d=this.get8bitByteArray(s);e.push(d);break;case a:var l=this.getKanjiString(s);e.push(l);break;}}}while(!0);return e})}return{startWebCam:function startWebCam(e){I.startWebCam(e)},stopWebCam:function stopWebCam(){I.stopWebCam()},startScan:function startScan(e){I.startScan(e)},stopScan:function stopScan(){I.stopScan()},setCallback:function setCallback(e){I.callback=e},decode:function decode(e){I.decode(e)}}});
//# sourceMappingURL=poodll_qrscanner.min.js.map

define ("filter_poodll/anim_fbars",["jquery","core/log"],function(a,b){"use strict";b.debug("anim_freq bars: initialising");return{analyser:null,cvs:null,cvsctx:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.cvs=b;this.cvsctx=b.getContext("2d");this.analyser=a},clear:function clear(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height)},start:function start(){this.analyser.core.fftSize=256;var a=this.analyser.core.frequencyBinCount,b=new Uint8Array(a),c=this.cvs.width,d=this.cvs.height,e=this.cvsctx,f=this.analyser;this.clear();var g=function(){requestAnimationFrame(g);if(!f.theinterval){return}f.core.getByteFrequencyData(b);e.clearRect(0,0,c,d);for(var h=2.5*(c/a),j,k=0,l=0;l<a;l++){j=b[l];e.fillStyle="rgb("+(j+100)+",50,50)";e.fillRect(k,d-j/2,h,j/2);k+=h+1}};g()}}});
//# sourceMappingURL=anim_fbars.min.js.map

define ("filter_poodll/upskin_radial",["jquery","core/log","filter_poodll/anim_progress_radial"],function(a,b,c){"use strict";b.debug("upskin_bar: initialising");return{element:null,cvs:null,percent:0,progressradial:null,messagearea:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,d,e){this.config=a;this.element=b;this.cvs=d;this.progressradial=c.clone();this.messagearea=e},setDrawParam:function setDrawParam(a,b){this.progressradial.setDrawParam(a,b)},initControls:function initControls(){var a=this;this.progressradial.init(this.cvs,"#93c47d",!0);this.progressradial.fetchCurrent=function(){return a.percent}},initProgressSession:function initProgressSession(a){var b=this;b.percent=0;var c=M.util.get_string("recui_uploading","filter_poodll");a.upload.addEventListener("progress",function(a){if(a.lengthComputable){b.percent=a.loaded/a.total;b.showMessage(c+"("+Math.floor(100*b.percent)+"%)")}});this.progressradial.start()},deactivateProgressSession:function deactivateProgressSession(){this.progressradial.stop();b.debug("deactivating session")},showMessage:function showMessage(a,b){switch(b){case"recui_awaitingconversion":break;default:this.messagearea.html(a);}}}});
//# sourceMappingURL=upskin_radial.min.js.map

define ("filter_poodll/poodll_burntrosemediaskin",["jquery","core/log","filter_poodll/utils_amd"],function(a,b){"use strict";b.debug("PoodLL Burnt Rose Skin: initialising");return{instanceprops:null,pmr:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(c){b.debug("from poodllmediarecorder: uploadsuccess");var d="filter_poodll_controlbar_"+c;a("#"+d+" > .poodll_save-recording").hide();a("#"+d+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){b.debug("from poodllmediarecorder: uploadfailure")},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" width=\"320\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+" hide\" controls playsinline=\"playsinline\" muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_preview_"+a+"\" width=\"320\" height=\"240\" playsinline=\"playsinline\" muted></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+" hide\" playsinline=\"playsinline\" ></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+" hide\" playsinline=\"playsinline\"></video>"},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);b.controlbar.stopbutton.attr("disabled",!1);b.controlbar.pausebutton.attr("disabled",!1);b.controlbar.savebutton.attr("disabled",!1)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.preview.attr("src",null);b.controlbar.stopbutton.attr("disabled",!1);b.controlbar.pausebutton.attr("disabled",!1);b.controlbar.savebutton.attr("disabled",!1)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},set_visual_mode:function set_visual_mode(a,b){var c=this,d=this.fetch_instanceprops(b);switch(a){case"recordmode":d.controlbar.preview.addClass("poodll_recording");d.controlbar.status.addClass("poodll_recording");if("audio"==d.config.mediatype){d.controlbar.preview.addClass("hide")}d.controlbar.status.removeClass("hide");break;case"previewmode":d.controlbar.preview.removeClass("poodll_recording");d.controlbar.status.removeClass("poodll_recording");break;case"pausedmode":d.controlbar.preview.removeClass("poodll_recording");d.controlbar.status.removeClass("poodll_recording");break;}},insert_controlbar_audio:function insert_controlbar_audio(b,c,d){var e=this.fetch_instanceprops(c),f=e.config.media_skin_style,g="poodll_mediarecorder_size_auto";switch(e.config.size){case"small":g="poodll_mediarecorder_size_small";break;case"big":g="poodll_mediarecorder_size_big";break;case"auto":g="poodll_mediarecorder_size_auto";}var h="<div class=\"poodll_mediarecorderbox_burntrose "+f+" "+g+"\" id=\""+c+"\">",i=this.fetch_status_bar("burntrose");h+=i,h+=d,h+="<span class=\"poodll_start-recording\" title=\""+M.util.get_string("recui_record","filter_poodll")+"\"></span>";h+="<span class=\"poodll_stop-recording hide\" title=\""+M.util.get_string("recui_stop","filter_poodll")+"\"></span>";h+="<span class=\"poodll_pause-recording hide\" title=\""+M.util.get_string("recui_pause","filter_poodll")+"\"></span>";h+=" <span class=\"poodll_resume-recording hide\"title=\""+M.util.get_string("recui_continue","filter_poodll")+"\" ></span>";h+=" <span class=\"poodll_play-recording\" ></span>";h+=" <span class=\"poodll_playsave hide\" title=\""+M.util.get_string("recui_play","filter_poodll")+"\" ></span>";h+=" <span class=\"poodll_mic\" ></span>";h+=" <span class=\"poodll_recmic hide\" ></span>";h+=" <span class=\"poodll_resume_mic hide\" ></span>";h+="<span class=\"poodll_savebtn\" ></span>";h+="<span class=\"poodll_save-recording_burntrose hide\" title=\""+M.util.get_string("recui_save","filter_poodll")+"\" ></span>";h+="<span class=\"poodll_savedsuccessfully hide\"></span>";h+="</div>";a(b).prepend(h);var j={status:a("#"+c+" .poodll_status_burntrose"),preview:a("#"+c+" .poodll_preview_burntrose"),startbutton:a("#"+c+" .poodll_start-recording"),stopbutton:a("#"+c+"  .poodll_stop-recording"),pausebutton:a("#"+c+" .poodll_pause-recording"),resumebutton:a("#"+c+" .poodll_resume-recording"),play1:a("#"+c+" .poodll_play-recording"),playbutton:a("#"+c+" > .poodll_playsave"),save1:a("#"+c+" .poodll_savebtn"),savebutton:a("#"+c+" .poodll_save-recording_burntrose"),savesuccess:a("#"+c+" .poodll_savedsuccessfully"),playermic:a("#"+c+" .poodll_mic"),recordmic:a("#"+c+" .poodll_recmic"),resumemic:a("#"+c+" .poodll_resume_mic")};return j},insert_controlbar_video:function insert_controlbar_video(b,c,d){var e=this.fetch_instanceprops(c),f=e.config.media_skin_style,g="poodll_mediarecorder_size_auto";switch(e.config.size){case"small":g="poodll_mediarecorder_size_small";break;case"big":g="poodll_mediarecorder_size_big";break;case"auto":g="poodll_mediarecorder_size_auto";}var h="<div class=\"poodll_mediavideobox "+f+" "+g+"\" id=\""+c+"\">",i=this.fetch_status_bar("burntrose");h+=i,h+=d,h+="<div class=\"poodll_mediavideobox2\" id=\""+c+"\">";h+="<span class=\"poodll_start-recording\" title=\""+M.util.get_string("recui_record","filter_poodll")+"\"></span>";h+="<span class=\"poodll_stop-recording hide\" title=\""+M.util.get_string("recui_stop","filter_poodll")+"\"></span>";h+="<span class=\"poodll_pause-recording hide\" title=\""+M.util.get_string("recui_pause","filter_poodll")+"\" ></span>";h+=" <span class=\"poodll_resume-recording hide\" title=\""+M.util.get_string("recui_continue","filter_poodll")+"\"></span>";h+=" <span class=\"poodll_play-recording\" ></span>";h+=" <span class=\"poodll_playsave hide\" title=\""+M.util.get_string("recui_play","filter_poodll")+"\"></span>";h+=" <span class=\"poodll_mic hide\" ></span>";h+=" <span class=\"poodll_recmic hide\" ></span>";h+=" <span class=\"poodll_resume_mic hide\" ></span>";h+="<span class=\"poodll_savebtn \"title=\""+M.util.get_string("recui_save","filter_poodll")+"\" ></span>";h+="<span class=\"poodll_save-recording_burntrose hide \"title=\""+M.util.get_string("recui_save","filter_poodll")+"\" ></span>";h+="<span class=\"poodll_savedsuccessfully hide\" ></span>";h+="</div>";h+="</div>";a(b).prepend(h);var j={status:a("#"+c+" > .poodll_status_burntrose"),preview:a("#"+c+" > .poodll_preview_burntrose"),startbutton:a("#"+c+" > .poodll_start-recording"),stopbutton:a("#"+c+" > .poodll_stop-recording"),pausebutton:a("#"+c+" > .poodll_pause-recording"),resumebutton:a("#"+c+" > .poodll_resume-recording"),play1:a("#"+c+" > .poodll_play-recording"),playbutton:a("#"+c+" > .poodll_playsave"),save1:a("#"+c+" > .poodll_savebtn"),savebutton:a("#"+c+" > .poodll_save-recording_burntrose"),savesuccess:a("#"+c+" > .poodll_savedsuccessfully"),playermic:a("#"+c+"> .poodll_mic"),recordmic:a("#"+c+"> .poodll_recmic"),resumemic:a("#"+c+"> .poodll_resume_mic")};return j},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(b,c){var d=this,e=this.pmr,f=this.fetch_instanceprops(c);f.controlbar.startbutton.click(function(){this.disabled=!1;a("#"+f.config.widgetid+"_messages").text("");e.do_start_audio(f,b);f.controlbar.playermic.hide();f.controlbar.recordmic.show();f.controlbar.playbutton.hide();f.controlbar.play1.hide();f.controlbar.pausebutton.show();f.controlbar.pausebutton.attr("disabled",!1);f.controlbar.startbutton.hide();f.controlbar.stopbutton.show();f.controlbar.stopbutton.attr("disabled",!1);f.controlbar.savebutton.hide();f.controlbar.savesuccess.hide();f.controlbar.save1.show();d.set_visual_mode("recordmode",c);f.timer.reset();f.timer.start();d.update_status(c)});f.controlbar.stopbutton.click(function(){this.disabled=!1;f.controlbar.stopbutton.hide();f.controlbar.startbutton.show();f.controlbar.startbutton.attr("disabled",!1);f.controlbar.resumebutton.hide();f.controlbar.pausebutton.hide();f.controlbar.play1.hide();f.controlbar.playbutton.show();f.controlbar.save1.hide();f.controlbar.savesuccess.hide();f.controlbar.savebutton.show();f.controlbar.resumemic.hide();f.controlbar.recordmic.hide();f.controlbar.playermic.show();e.do_stop_audio(f);var a=f.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}d.set_visual_mode("previewmode",c);f.timer.stop();d.update_status(c);if(!f.uploaded){f.controlbar.startbutton.attr("disabled",!1)}});f.controlbar.pausebutton.click(function(){this.disabled=!0;a(this).hide();f.controlbar.resumebutton.show();e.do_pause_audio(f);f.controlbar.resumebutton.attr("disabled",!1);d.set_visual_mode("pausedmode",c);f.timer.pause();d.update_status(c);f.controlbar.recordmic.hide();f.controlbar.resumemic.show()});f.controlbar.resumebutton.click(function(){this.disabled=!0;a(this).hide();f.controlbar.pausebutton.show();e.do_resume_audio(f);f.controlbar.pausebutton.attr("disabled",!1);d.set_visual_mode("recordmode",c);f.timer.resume();d.update_status(c);f.controlbar.resumemic.hide();f.controlbar.recordmic.show()});f.controlbar.playbutton.click(function(){this.disabled=!1;var a=f.controlbar.preview.get(0);if(0<a.currentTime&&!a.paused){a.pause();a.currentTime=0;return}e.do_play_audio(f,a);f.controlbar.startbutton.show()});f.controlbar.savebutton.click(function(){this.disabled=!1;if(f.blobs&&0<f.blobs.length){e.do_save_audio(f);f.uploaded=!0;f.controlbar.startbutton.attr("disabled",!0)}else{f.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1});window.onbeforeunload=function(){f.controlbar.startbutton.attr("disabled",!1);var a=f.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}}}}});
//# sourceMappingURL=poodll_burntrosemediaskin.min.js.map

define ("filter_poodll/lzloader",[],function(){var $dhtml=!0,$as3=!1,$js1=!0,$swf7=!1,$swf8=!1,$svg=!1,$as2=!1,$swf9=!1,$profile=!1,$runtime="dhtml",$swf10=!1,$debug=!1,$j2me=!1;try{if(lz){}}catch(t){lz={}}lz.embed={options:{},swf:function swf(e,t){if(null==t){t=8}var n=e.url,a=this.__getqueryurl(n);if(e.accessible&&"false"!=e.accessible){a.flashvars+="&accessible=true"}if(e.history){a.flashvars+="&history=true"}if(null!=e.bgcolor){a.flashvars+="&bgcolor="+escape(e.bgcolor)}a.flashvars+="&width="+escape(e.width);a.flashvars+="&height="+escape(e.height);a.flashvars+="&__lzurl="+escape(n);a.flashvars+="&__lzminimumversion="+escape(t);a.flashvars+="&id="+escape(e.id);var n=a.url+"?"+a.query,r=lz.embed._getAppendDiv(e.id,e.appenddivid),s={width:"100%",height:"100%",id:e.id,bgcolor:e.bgcolor,wmode:e.wmode,flashvars:a.flashvars,allowfullscreen:e.allowfullscreen,flash8:n,appenddiv:r};if(lz.embed[e.id]){alert("Warning: an app with the id: "+e.id+" already exists.")}var i=lz.embed[e.id]=lz.embed.applications[e.id]={runtime:"swf",_id:e.id,appenddiv:r,setCanvasAttribute:lz.embed._setCanvasAttributeSWF,getCanvasAttribute:lz.embed._getCanvasAttributeSWF,callMethod:lz.embed._callMethodSWF,_ready:lz.embed._ready,_onload:[],_getSWFDiv:lz.embed._getSWFDiv,loaded:!1,_sendMouseWheel:lz.embed._sendMouseWheel,_sendAllKeysUp:lz.embed._sendAllKeysUpSWF,_setCanvasAttributeDequeue:lz.embed._setCanvasAttributeDequeue,_sendPercLoad:lz.embed._sendPercLoad};if(!1==e.history){lz.embed.history.active=!1}lz.embed.dojo.addLoadedListener(lz.embed._loaded,i);lz.embed.dojo.setSwf(s,t);r.style.height=lz.embed.CSSDimension(e.height);r.style.width=lz.embed.CSSDimension(e.width);if(!0!=e.cancelmousewheel&&("Mac"==lz.embed.browser.OS||("transparent"==s.wmode||"opaque"==s.wmode)&&"Windows"==lz.embed.browser.OS&&(lz.embed.browser.isOpera||lz.embed.browser.isFirefox))){if(lz.embed.mousewheel){lz.embed.mousewheel.setCallback(i,"_sendMouseWheel")}}if(("transparent"==s.wmode||"opaque"==s.wmode)&&"Windows"==lz.embed.browser.OS&&(lz.embed.browser.isOpera||lz.embed.browser.isFirefox)){var o=s.appenddiv;o.onmouseout=function(){o.mouseisoutside=!0};o.onmouseover=function(){o.mouseisoutside=!1};o._gotmouseup=document.onmouseup=function(){if(o.mouseisoutside){i.callMethod("LzMouseKernel.__mouseUpOutsideHandler()")}}}},__swfSetAppAppendDivStyle:function __swfSetAppAppendDivStyle(e,t,n){var a=lz.embed.applications[e].appenddiv;return a.style[t]=n},lfc:function lfc(e,t){if(""==t){t="."}else{if(!t||"string"!=typeof t){alert("WARNING: lz.embed.lfc() requires a valid serverroot to be specified.");return}}lz.embed.options.serverroot=t;if(lz.embed.browser.isIE){var n=t+"lps/includes/excanvas.js";this.__dhtmlLoadScript(n)}this.__dhtmlLoadScript(e)},dhtml:function dhtml(e){var t=this.__getqueryurl(e.url,!0),n=t.url+"?lzt=object&"+t.query,a=lz.embed._getAppendDiv(e.id,e.appenddivid);a.style.height=lz.embed.CSSDimension(e.height);a.style.width=lz.embed.CSSDimension(e.width);lz.embed.__propcache={bgcolor:e.bgcolor,width:e.width,height:e.height,id:e.id,appenddiv:lz.embed._getAppendDiv(e.id,e.appenddivid),url:n,cancelkeyboardcontrol:e.cancelkeyboardcontrol,serverroot:e.serverroot,approot:null!=e.approot?e.approot:""};if(lz.embed[e.id]){alert("Warning: an app with the id: "+e.id+" already exists.")}lz.embed[e.id]=lz.embed.applications[e.id]={runtime:"dhtml",_id:e.id,_ready:lz.embed._ready,_onload:[],loaded:!1,setCanvasAttribute:lz.embed._setCanvasAttributeDHTML,getCanvasAttribute:lz.embed._getCanvasAttributeDHTML,_sendAllKeysUp:lz.embed._sendAllKeysUpDHTML};if(!1==e.history){lz.embed.history.active=!1}this.__dhtmlLoadScript(n);if("Windows"==lz.embed.browser.OS&&lz.embed.browser.isFirefox){window.focus()}},applications:{},__dhtmlLoadScript:function __dhtmlLoadScript(e){var t="<script type=\"text/javascript\" language=\"JavaScript1.5\" src=\""+e+"\"></script>";document.writeln(t);return t},__dhtmlLoadLibrary:function __dhtmlLoadLibrary(e){var t=document.createElement("script");this.__setAttr(t,"type","text/javascript");this.__setAttr(t,"src",e);document.getElementsByTagName("head")[0].appendChild(t);return t},__getqueryurl:function __getqueryurl(e,t){var n=e.split("?");e=n[0];if(1==n.length){return{url:e,flashvars:"",query:""}}var a=this.__parseQuery(n[1]),r="",s="";for(var i in a){if(""==i||null==i){continue}var o=a[i];if("lzr"==i||"lzt"==i||"debug"==i||"profile"==i||"lzbacktrace"==i||"lzconsoledebug"==i||"lzdebug"==i||"lzkrank"==i||"lzprofile"==i||"lzcopyresources"==i||"fb"==i||"sourcelocators"==i||"_canvas_debug"==i||"lzsourceannotations"==i){r+=i+"="+o+"&"}if(t){if(null==window[i]){window[i]=unescape(o.replace(/\+/g," "))}}s+=i+"="+o+"&"}r=r.substr(0,r.length-1);s=s.substr(0,s.length-1);return{url:e,flashvars:s,query:r}},__parseQuery:function __parseQuery(e){if(-1==e.indexOf("=")){return}for(var t=e.split("&"),n={},a=0,r;a<t.length;a++){r=t[a].split("=");if(1==r.length){continue}var s=r[0],i=r[1];n[s]=i}return n},__setAttr:function __setAttr(e,t,n){e.setAttribute(t,n)},_setCanvasAttributeSWF:function _setCanvasAttributeSWF(e,t,n){if(this.loaded&&lz.embed.dojo.comm[this._id]&&lz.embed.dojo.comm[this._id].callMethod){if(n){lz.embed.history._store(e,t)}else{lz.embed.dojo.comm[this._id].setCanvasAttribute(e,t+"")}}else{if(null==this._setCanvasAttributeQ){this._setCanvasAttributeQ=[[e,t,n]]}else{this._setCanvasAttributeQ.push([e,t,n])}}},_setCanvasAttributeDHTML:function _setCanvasAttributeDHTML(e,t,n){if(n){lz.embed.history._store(e,t)}else{if(canvas){if(!canvas.__LZdeleted){var a="$lzc$set_"+e;if(Function.$lzsc$isa?Function.$lzsc$isa(canvas[a]):canvas[a]instanceof Function){canvas[a](t)}else{canvas[e]=t;var r=canvas["on"+e];if(LzEvent.$lzsc$isa?LzEvent.$lzsc$isa(r):r instanceof LzEvent){if(r.ready){r.sendEvent(t)}}}}}}},_loaded:function _loaded(e){if(lz.embed[e].loaded){return}if(8==lz.embed.dojo.info.commVersion){setTimeout("lz.embed[\""+e+"\"]._ready.call(lz.embed[\""+e+"\"])",100)}else{lz.embed[e]._ready.call(lz.embed[e])}},_setCanvasAttributeDequeue:function _setCanvasAttributeDequeue(){while(0<this._setCanvasAttributeQ.length){var e=this._setCanvasAttributeQ.pop();this.setCanvasAttribute(e[0],e[1],e[2])}},_ready:function _ready(e){this.loaded=!0;if(this._callmethod){for(var t=0;t<this._callmethod.length;t++){this.callMethod(this._callmethod[t])}this._callmethod=null}if(this._setCanvasAttributeQ){this._setCanvasAttributeDequeue()}if(e){this.canvas=e}for(var t=0,n;t<this._onload.length;t++){n=this._onload[t];if("function"==typeof n){n(this)}}if(this.onload&&"function"==typeof this.onload){this.onload(this)}},_getCanvasAttributeSWF:function _getCanvasAttributeSWF(e){if(this.loaded){return lz.embed.dojo.comm[this._id].getCanvasAttribute(e)}else{alert("Flash is not ready: getCanvasAttribute"+e)}},_getCanvasAttributeDHTML:function _getCanvasAttributeDHTML(e){return canvas[e]},browser:{init:function init(){if(this.initted){return}this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.osversion=this.searchOSVersion(navigator.userAgent)||"an unknown osversion";this.subversion=this.searchSubVersion(navigator.userAgent);this.OS=this.searchString(this.dataOS)||"an unknown OS";this.initted=!0;this.isNetscape=this.isSafari=this.isOpera=this.isFirefox=this.isIE=this.isIphone=!1;if("Netscape"==this.browser){this.isNetscape=!0}else{if("Safari"==this.browser){this.isSafari=!0}else{if("Opera"==this.browser){this.isOpera=!0}else{if("Firefox"==this.browser){this.isFirefox=!0}else{if("Explorer"==this.browser){this.isIE=!0}else{if("iPhone"==this.browser){this.isSafari=!0;this.isIphone=!0}}}}}}},searchString:function searchString(e){for(var t=0;t<e.length;t++){var n=e[t].string,a=e[t].prop;this.versionSearchString=e[t].versionSearch||e[t].identity;this.osversionSearchString=e[t].osversionSearch||"";if(n){if(-1!=n.indexOf(e[t].subString)){return e[t].identity}}else{if(a){return e[t].identity}}}},searchVersion:function searchVersion(e){var t=e.indexOf(this.versionSearchString);if(-1==t){return}return parseFloat(e.substring(t+this.versionSearchString.length+1))},searchSubVersion:function searchSubVersion(e){var t=new RegExp(this.versionSearchString+".\\d+\\.\\d+\\.([\\d.]+)"),n=t.exec(e);if(n&&1<n.length){return parseFloat(n[1])}},searchOSVersion:function searchOSVersion(e){var t=e.indexOf(this.osversionSearchString);if(-1==t){return}return parseFloat(e.substring(t+this.osversionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"iPhone",identity:"iPhone",versionSearch:"WebKit"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"WebKit"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"Iceweasel",versionSearch:"Iceweasel",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE",osversionSearch:"Windows NT"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]},_callMethodSWF:function _callMethodSWF(e){if(this.loaded){return lz.embed.dojo.comm[this._id].callMethod(e)}else{if(!this._callmethod){this._callmethod=[]}this._callmethod.push(e)}},_broadcastMethod:function _broadcastMethod(e){var t=[].slice.call(arguments,1);for(var n in lz.embed.applications){var a=lz.embed.applications[n];if(a[e]){a[e].apply(a,t)}}},setCanvasAttribute:function setCanvasAttribute(e,t,n){lz.embed._broadcastMethod("setCanvasAttribute",e,t,n)},callMethod:function callMethod(e){lz.embed._broadcastMethod("callMethod",e)},_getAppendDiv:function _getAppendDiv(e,t){var n=t?t:e+"Container",a=document.getElementById(n);if(!a){document.writeln("<div id=\""+n+"\"></div>");a=document.getElementById(n)}return a},_getSWFDiv:function _getSWFDiv(){return lz.embed.dojo.obj[this._id].get()},_sendMouseWheel:function _sendMouseWheel(e){if(null!=e){this.callMethod("lz.Keys.__mousewheelEvent("+e+")")}},_gotFocus:function _gotFocus(){lz.embed._broadcastMethod("_sendAllKeysUp")},_sendAllKeysUpSWF:function _sendAllKeysUpSWF(){this.callMethod("lz.Keys.__allKeysUp()")},_sendAllKeysUpDHTML:function _sendAllKeysUpDHTML(){if(lz.Keys&&lz.Keys.__allKeysUp){lz.Keys.__allKeysUp()}},_sendPercLoad:function _sendPercLoad(e){if(this.onloadstatus&&"function"==typeof this.onloadstatus){this.onloadstatus(e)}},attachEventHandler:function attachEventHandler(e,t,n,a,r){if(!(n&&a&&"function"==typeof n[a])){return}var s=e+t+n+a,i=this._handlers[s];if(null!=i){if(i instanceof Array){for(var o=i.length-1;0<=o;--o){if(i[o].$e===e&&i[o].$c===n){return}}}else{if(i.$e===e&&i.$c===n){return}}}var d=function(){var e=window.event?[window.event]:[].slice.call(arguments,0);if(r){e.push(r)}n[a].apply(n,e)};d.$e=e;d.$c=n;if(null!=i){if(i instanceof Array){i.push(d)}else{i=[i,d]}}else{i=d}this._handlers[s]=i;if(e.addEventListener){e.addEventListener(t,d,!1);return!0}else{if(e.attachEvent){return e.attachEvent("on"+t,d)}}},removeEventHandler:function removeEventHandler(e,t,n,a){var r=e+t+n+a,s,i=this._handlers[r];if(null!=i){if(i instanceof Array){for(var o=i.length-1;0<=o;--o){if(i[o].$e===e&&i[o].$c===n){s=i[o];i.splice(o,1);if(0==i.length){delete this._handlers[r]}}}}else{if(i.$e===e&&i.$c===n){s=i;delete this._handlers[r]}}}if(!s){return}if(e.removeEventListener){e.removeEventListener(t,s,!1);return!0}else{if(e.detachEvent){return e.detachEvent("on"+t,s)}}},_handlers:{},_cleanupHandlers:function _cleanupHandlers(){lz.embed._handlers={}},getAbsolutePosition:function getAbsolutePosition(e){var t=null,n={},a;if(!(lz.embed.browser.isFirefox&&e==document.body)&&e.getBoundingClientRect){a=e.getBoundingClientRect();var r=document.documentElement.scrollTop||document.body.scrollTop,s=document.documentElement.scrollLeft||document.body.scrollLeft;return{x:Math.floor(a.left+s),y:Math.floor(a.top+r)}}else{if(document.getBoxObjectFor){a=document.getBoxObjectFor(e);n={x:a.x,y:a.y}}else{n={x:e.offsetLeft,y:e.offsetTop};t=e.offsetParent;if(t!=e){while(t){n.x+=t.offsetLeft;n.y+=t.offsetTop;t=t.offsetParent}}if(lz.embed.browser.isSafari&&document.defaultView&&document.defaultView.getComputedStyle){var i=document.defaultView.getComputedStyle(e,"")}if(lz.embed.browser.isOpera||lz.embed.browser.isSafari&&i&&"absolute"==i.position){n.y-=document.body.offsetTop}}}if(e.parentNode){t=e.parentNode}else{return n}while(t&&"BODY"!=t.tagName&&"HTML"!=t.tagName){n.x-=t.scrollLeft;n.y-=t.scrollTop;if(t.parentNode){t=t.parentNode}else{return n}}return n},CSSDimension:function CSSDimension(e,t){var n=e;if(isNaN(e)){if(e.indexOf("%")==e.length-1&&!isNaN(e.substring(0,e.length-1))){return e}else{n=0}}else{if(e===1/0){n=2147483647}else{if(e===-Infinity){n=-2147483648}}}return n+(t?t:"px")}};lz.embed.browser.init();lz.embed.attachEventHandler(window,"beforeunload",lz.embed,"_cleanupHandlers");lz.embed.attachEventHandler(window,"focus",lz.embed,"_gotFocus");if(lz.embed.browser.isIE){lz.embed.attachEventHandler(window,"activate",lz.embed,"_gotFocus")}try{if(lzOptions){if(lzOptions.dhtmlKeyboardControl){alert("WARNING: this page uses lzOptions.dhtmlKeyboardControl.  Please use the cancelkeyboardcontrol embed argument for lz.embed.dhtml() instead.")}if(lzOptions.ServerRoot){alert("WARNING: this page uses lzOptions.ServerRoot.  Please use the second argument of lz.embed.lfc() instead.")}}}catch(t){}lz.embed.dojo=function(){};lz.embed.dojo={defaults:{flash8:null,ready:!1,visible:!0,width:500,height:400,bgcolor:"#ffffff",allowfullscreen:!1,wmode:"window",flashvars:"",minimumVersion:8,id:"flashObject",appenddiv:null},obj:{},comm:{},_loadedListeners:[],_loadedListenerScopes:[],_installingListeners:[],_installingListenerScopes:[],setSwf:function setSwf(e,t){if(null==e){return}var n={};for(var a in this.defaults){var r=e[a];if(null!=r){n[a]=r}else{n[a]=this.defaults[a]}}if(null!=t){this.minimumVersion=t}this._initialize(n)},addLoadedListener:function addLoadedListener(e,t){this._loadedListeners.push(e);this._loadedListenerScopes.push(t)},addInstallingListener:function addInstallingListener(e,t){this._installingListeners.push(e);this._installingListenerScopes.push(t)},loaded:function loaded(e){var t=lz.embed.dojo;if(t._isinstaller){top.location=top.location+""}t.info.installing=!1;t.ready=!0;if(0<t._loadedListeners.length){for(var n=0,a;n<t._loadedListeners.length;n++){a=t._loadedListenerScopes[n];if(e!=a._id){continue}lz.embed.dojo._loadedListeners[n].apply(a,[a._id])}}},installing:function installing(){var e=lz.embed.dojo;if(0<e._installingListeners.length){for(var t=0,n;t<e._installingListeners.length;t++){n=e._installingListenerScopes[t];e._installingListeners[t].apply(n,[n._id])}}},_initialize:function _initialize(e){var t=lz.embed.dojo,n=new t.Install(e.id);t.installer=n;var a=new t.Embed(e);t.obj[e.id]=a;if(!0==n.needed()){n.install()}else{a.write(t.info.commVersion);t.comm[e.id]=new t.Communicator(e.id)}}};lz.embed.dojo.Info=function(){if(lz.embed.browser.isIE){document.writeln("<script language=\"VBScript\" type=\"text/vbscript\">");document.writeln("Function VBGetSwfVer(i)");document.writeln("  on error resume next");document.writeln("  Dim swControl, swVersion");document.writeln("  swVersion = 0");document.writeln("  set swControl = CreateObject(\"ShockwaveFlash.ShockwaveFlash.\" + CStr(i))");document.writeln("  if (IsObject(swControl)) then");document.writeln("    swVersion = swControl.GetVariable(\"$version\")");document.writeln("  end if");document.writeln("  VBGetSwfVer = swVersion");document.writeln("End Function");document.writeln("</script>")}this._detectVersion();this._detectCommunicationVersion()};lz.embed.dojo.Info.prototype={version:-1,versionMajor:-1,versionMinor:-1,versionRevision:-1,capable:!1,commVersion:8,installing:!1,isVersionOrAbove:function isVersionOrAbove(e,t,n){n=parseFloat("."+n);if(this.versionMajor>=e&&this.versionMinor>=t&&this.versionRevision>=n){return!0}else{return!1}},_detectVersion:function _detectVersion(){for(var e,t=lz.embed.browser.isIE,n=25;0<n;n--){if(t){e=VBGetSwfVer(n)}else{e=this._JSFlashInfo(n)}if(-1==e){this.capable=!1;return}else{if(0!=e){var a;if(t){var r=e.split(" "),s=r[1];a=s.split(",")}else{a=e.split(".")}this.versionMajor=a[0];this.versionMinor=a[1];this.versionRevision=a[2];var i=this.versionMajor+"."+this.versionRevision;this.version=parseFloat(i);this.capable=!0;break}}}},_JSFlashInfo:function _JSFlashInfo(){if(null!=navigator.plugins&&0<navigator.plugins.length){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var e=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"",t=navigator.plugins["Shockwave Flash"+e].description,n=t.split(" "),a=n[2].split("."),r=a[0],s=a[1];if(""!=n[3]){var i=n[3].split("r")}else{var i=n[4].split("r")}var o=0<i[1]?i[1]:0;return r+"."+s+"."+o}}return-1},_detectCommunicationVersion:function _detectCommunicationVersion(){if(!1==this.capable){this.commVersion=null}}};lz.embed.dojo.Embed=function(e){this.properties=e;if(!this.properties.width){this.properties.width="100%"}if(!this.properties.height){this.properties.height="100%"}if(!this.properties.bgcolor){this.properties.bgcolor="#ffffff"}if(!this.properties.visible){this.properties.visible=!0}};lz.embed.dojo.Embed.prototype={protocol:function protocol(){switch(window.location.protocol){case"https:":return"https";break;default:return"http";break;}},__getCSSValue:function __getCSSValue(e){if(e&&e.length&&-1!=e.indexOf("%")){return"100%"}else{return e+"px"}},write:function write(e,t){var n="";n+="width: "+this.__getCSSValue(this.properties.width)+";";n+="height: "+this.__getCSSValue(this.properties.height)+";";if(!1==this.properties.visible){n+="position: absolute; ";n+="z-index: 10000; ";n+="top: -1000px; ";n+="left: -1000px; "}var a,r,s=lz.embed;if(e>s.dojo.version){t=!0}r=this.properties.flash8;var i=this.properties.flashvars,o=this.properties.flashvars;if(t){var d=escape(window.location);document.title=document.title.slice(0,47)+" - Flash Player Installation";var l=escape(document.title);i+="&MMredirectURL="+d+"&MMplayerType=ActiveX&MMdoctitle="+l;o+="&MMredirectURL="+d+"&MMplayerType=PlugIn"}if(s.browser.isIE){a="<object classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" codebase=\""+this.protocol()+"://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0\" width=\""+this.properties.width+"\" height=\""+this.properties.height+"\" id=\""+this.properties.id+"\" align=\"middle\"> <param name=\"allowScriptAccess\" value=\"sameDomain\" /> <param name=\"movie\" value=\""+r+"\" /> <param name=\"quality\" value=\"high\" /> <param name=\"FlashVars\" value=\""+i+"\" /> <param name=\"bgcolor\" value=\""+this.properties.bgcolor+"\" /> <param name=\"wmode\" value=\""+this.properties.wmode+"\" /> <param name=\"allowFullScreen\" value=\""+this.properties.allowfullscreen+"\" /> </object>"}else{a="<embed src=\""+r+"\" quality=\"high\" bgcolor=\""+this.properties.bgcolor+"\" wmode=\""+this.properties.wmode+"\" allowFullScreen=\""+this.properties.allowfullscreen+"\" width=\""+this.properties.width+"\" height=\""+this.properties.height+"\" id=\""+this.properties.id+"\" name=\""+this.properties.id+"\" FlashVars=\""+o+"\" swLiveConnect=\"true\" align=\"middle\" allowScriptAccess=\"sameDomain\" type=\"application/x-shockwave-flash\" pluginspage=\""+this.protocol()+"://www.macromedia.com/go/getflashplayer\" />"}var m=this.properties.id+"Container",c=this.properties.appenddiv;if(c){c.innerHTML=a;c.setAttribute("style",n)}else{a="<div id=\""+m+"\" style=\""+n+"\"> "+a+"</div>";document.writeln(a)}},get:function get(){try{var e=document.getElementById(this.properties.id+"")}catch(t){}return e},setVisible:function setVisible(e){var t=document.getElementById(this.properties.id+"Container");if(!0==e){t.style.visibility="visible"}else{t.style.position="absolute";t.style.x="-1000px";t.style.y="-1000px";t.style.visibility="hidden"}},center:function center(){var e=this.properties.width,t=this.properties.height,n=document.getElementById(this.properties.id+"Container");n.style.top=0+"px";n.style.left=0+"px"}};lz.embed.dojo.Communicator=function(e){this._id=e};lz.embed.dojo.Communicator.prototype={_addExternalInterfaceCallback:function _addExternalInterfaceCallback(e,t){var n=lz.embed.dojo;n.comm[t][e]=function(){for(var a=[],r=0;r<arguments.length;r++){a[r]=arguments[r]}a.length=arguments.length;return n.comm[t]._execFlash(e,a,t)}},_encodeData:function _encodeData(e){e=e.replace(/\&([^;]*)\;/g,"&amp;$1;");e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");e=e.replace("\\","&custom_backslash;&custom_backslash;");e=e.replace(/\n/g,"\\n");e=e.replace(/\r/g,"\\r");e=e.replace(/\f/g,"\\f");e=e.replace(/\0/g,"\\0");e=e.replace(/\'/g,"\\'");e=e.replace(/\"/g,"\\\"");return e},_decodeData:function _decodeData($1){if(null==$1||"undefined"==typeof $1){return $1}$1=$1.replace(/\&custom_lt\;/g,"<");$1=$1.replace(/\&custom_gt\;/g,">");$1=eval("\""+$1+"\"");return $1},_chunkArgumentData:function _chunkArgumentData(e,t,n){for(var a=lz.embed.dojo.obj[n].get(),r=Math.ceil(e.length/1024),s=0;s<r;s++){var i=1024*s,o=1024*s+1024;if(s==r-1){o=1024*s+e.length}var d=e.substring(i,o);d=this._encodeData(d);a.CallFunction("<invoke name=\"chunkArgumentData\" returntype=\"javascript\"><arguments><string>"+d+"</string><number>"+t+"</number></arguments></invoke>")}},_chunkReturnData:function _chunkReturnData(e){for(var t=lz.embed.dojo.obj[e].get(),n=t.getReturnLength(),a=[],r=0,s;r<n;r++){s=t.CallFunction("<invoke name=\"chunkReturnData\" returntype=\"javascript\"><arguments><number>"+r+"</number></arguments></invoke>");if("\"\""==s||"''"==s){s=""}else{s=s.substring(1,s.length-1)}a.push(s)}var i=a.join("");return i},_execFlash:function _execFlash(e,t,n){var a=lz.embed.dojo.obj[n].get();a.startExec();a.setNumberArguments(t.length);for(var r=0;r<t.length;r++){this._chunkArgumentData(t[r],r,n)}a.exec(e);var s=this._chunkReturnData(n);s=this._decodeData(s);a.endExec();return s}};lz.embed.dojo.Install=function(e){this._id=e};lz.embed.dojo.Install.prototype={needed:function needed(){var e=lz.embed.dojo;if(!1==e.info.capable){return!0}if(!0==lz.embed.browser.isSafari&&!e.info.isVersionOrAbove(8,0,0)){return!0}if(e.minimumVersion>e.info.versionMajor){return!0}if(!e.info.isVersionOrAbove(8,0,0)){return!0}return!1},install:function install(){var e=lz.embed.dojo;e.info.installing=!0;e.installing();var t=e.obj[this._id].properties,n=t.flash8,a=n.indexOf("swf7");if(-1!=a){e._tempurl=n;n=n.substring(0,a+3)+"8"+n.substring(a+4,n.length);t.flash8=n}var a=n.indexOf("swf9");if(-1!=a){e._tempurl=n;n=n.substring(0,a+3)+"8"+n.substring(a+4,n.length);t.flash8=n}e.ready=!1;if(!1==e.info.capable){e._isinstaller=!0;var r=new e.Embed(t);r.write(e.minimumVersion)}else{if(e.info.isVersionOrAbove(6,0,65)){var r=new e.Embed(t);r.write(e.minimumVersion,!0);r.setVisible(!0);r.center()}else{alert("This content requires a more recent version of the Macromedia  Flash Player.");window.location="http://www.macromedia.com/go/getflashplayer"}}},_onInstallStatus:function _onInstallStatus(e){if("Download.Complete"==e){if(lz.embed.browser.isIE){top.location=top.location+""}}else{if("Download.Cancelled"==e){alert("This content requires a more recent version of the Macromedia  Flash Player.");window.location="http://www.macromedia.com/go/getflashplayer"}else{if("Download.Failed"==e){alert("There was an error downloading the Flash Player update. Please try again later, or visit macromedia.com to download the latest version of the Flash plugin.");window.location="http://www.macromedia.com/go/getflashplayer"}}}}};lz.embed.dojo.info=new lz.embed.dojo.Info;lz.embed.iframemanager={__counter:0,__frames:{},__namebyid:{},__loading:{},__callqueue:{},__calljsqueue:{},__sendmouseevents:{},__hidenativecontextmenu:{},__selectionbookmarks:{},create:function create(e,t,n,a,r,s){var i="__lz"+lz.embed.iframemanager.__counter++,o="javascript:\"\"",d="lz.embed.iframemanager.__gotload(\""+i+"\")";if(null==t||"null"==t||""==t){t=i}lz.embed.iframemanager.__namebyid[i]=t;if(null==a||"undefined"==a){a=document.body}if(document.all){var l="<iframe name='"+t+"' id='"+i+"' src='"+o+"' onload='"+d+"' frameBorder='0'";if(!0!=n){l+=" scrolling='no'"}l+="></iframe>";var m=document.createElement("div");lz.embed.__setAttr(m,"id",i+"Container");a.appendChild(m);m.innerHTML=l;var c=document.getElementById(i)}else{var c=document.createElement("iframe");lz.embed.__setAttr(c,"name",t);lz.embed.__setAttr(c,"src",o);lz.embed.__setAttr(c,"id",i);lz.embed.__setAttr(c,"onload",d);if(!0!=n){lz.embed.__setAttr(c,"scrolling","no")}this.appendTo(c,a)}if(c){this.__finishCreate(i,e,t,n,a,r,s)}else{this.__callqueue[i]=[["__finishCreate",i,e,t,n,a,r,s]];setTimeout("lz.embed.iframemanager.__checkiframe(\""+i+"\")",10)}return i+""},__checkiframe:function __checkiframe(e){var t=document.getElementById(e);if(t){var n=lz.embed.iframemanager.__callqueue[e];delete lz.embed.iframemanager.__callqueue[e];lz.embed.iframemanager.__playQueue(n)}else{setTimeout("lz.embed.iframemanager.__checkiframe(\""+e+"\")",10)}},__playQueue:function __playQueue(e){for(var t=lz.embed.iframemanager,n=0;n<e.length;n++){var a=e[n],r=a.splice(0,1);t[r].apply(t,a)}},__finishCreate:function __finishCreate(e,t,n,a,r,s){var i=document.getElementById(e);if("string"==typeof t){i.appcontainer=lz.embed.applications[t]._getSWFDiv()}i.owner=t;lz.embed.iframemanager.__frames[e]=i;this.__namebyid[e]=n;var o=lz.embed.iframemanager.getFrame(e);o.__gotload=lz.embed.iframemanager.__gotload;o._defaultz=s?s:99900;this.setZ(e,o._defaultz);lz.embed.iframemanager.__topiframe=e;if(document.getElementById&&!document.all){o.style.border="0"}else{if(document.all){lz.embed.__setAttr(o,"allowtransparency","true");var d=lz.embed[o.owner];if(d&&"swf"==d.runtime){var l=d._getSWFDiv();l.onfocus=lz.embed.iframemanager.__refresh}}}o.style.position="absolute"},appendTo:function appendTo(e,t){if(t.__appended==t){return}if(e.__appended){old=e.__appended.removeChild(e);t.appendChild(old)}else{t.appendChild(e)}e.__appended=t},getFrame:function getFrame(e){return lz.embed.iframemanager.__frames[e]},getFrameWindow:function getFrameWindow(e){if(!this.framesColl){if(document.frames){this.framesColl=document.frames}else{this.framesColl=window.frames}}return this.framesColl[e]},setSrc:function setSrc(e,t,n){if(this.__callqueue[e]){this.__callqueue[e].push(["setSrc",e,t,n]);return}this.__setSendMouseEvents(e,!1);if(n){var a=lz.embed.iframemanager.getFrame(e);if(!a){return}lz.embed.__setAttr(a,"src",t)}else{var e=lz.embed.iframemanager.__namebyid[e],a=window[e];if(!a){return}a.location.replace(t)}this.__loading[e]=!0},setPosition:function setPosition(e,t,n,a,r,s,i){if(this.__callqueue[e]){this.__callqueue[e].push(["setPosition",e,t,n,a,r,s,i]);return}var o=lz.embed.iframemanager.getFrame(e);if(!o){return}if(o.appcontainer){var d=lz.embed.getAbsolutePosition(o.appcontainer)}else{var d={x:0,y:0}}if(null!=t&&!isNaN(t)){o.style.left=t+d.x+"px"}if(null!=n&&!isNaN(n)){o.style.top=n+d.y+"px"}if(null!=a&&!isNaN(a)){o.style.width=a+"px"}if(null!=r&&!isNaN(r)){o.style.height=r+"px"}if(null!=s){if("string"==typeof s){s="true"==s}o.style.display=s?"block":"none"}if(null!=i){this.setZ(e,i+o._defaultz)}},setVisible:function setVisible(e,t){if(this.__callqueue[e]){this.__callqueue[e].push(["setVisible",e,t]);return}if("string"==typeof t){t="true"==t}var n=lz.embed.iframemanager.getFrame(e);if(!n){return}n.style.display=t?"block":"none"},bringToFront:function bringToFront(e){if(this.__callqueue[e]){this.__callqueue[e].push(["bringToFront",e]);return}var t=lz.embed.iframemanager.getFrame(e);if(!t){return}t._defaultz=1e5;this.setZ(e,t._defaultz);lz.embed.iframemanager.__topiframe=e},sendToBack:function sendToBack(e){if(this.__callqueue[e]){this.__callqueue[e].push(["sendToBack",e]);return}var t=lz.embed.iframemanager.getFrame(e);if(!t){return}t._defaultz=99900;this.setZ(e,t._defaultz)},__gotload:function __gotload(e){var t=lz.embed.iframemanager.getFrame(e);if(!t){return}if(t.owner&&t.owner.__gotload){t.owner.__gotload()}else{lz.embed[t.owner].callMethod("lz.embed.iframemanager.__gotload('"+e+"')")}this.__loading[e]=!1;if(this.__sendmouseevents[e]){this.__setSendMouseEvents(e,!0)}if(this.__calljsqueue[e]){this.__playQueue(this.__calljsqueue[e]);delete this.__calljsqueue[e]}},__refresh:function __refresh(){if(lz.embed.iframemanager.__topiframe){var e=lz.embed.iframemanager.getFrame(lz.embed.iframemanager.__topiframe);if("block"==e.style.display){e.style.display="none";e.style.display="block"}}},setZ:function setZ(e,t){if(this.__callqueue[e]){this.__callqueue[e].push(["setZ",e,t]);return}var n=lz.embed.iframemanager.getFrame(e);if(!n){return}n.style.zIndex=t},scrollBy:function scrollBy(e,t,n){if(this.__callqueue[e]){this.__callqueue[e].push(["scrollBy",e,t,n]);return}var e=lz.embed.iframemanager.__namebyid[e],a=window.frames[e];if(!a){return}a.scrollBy(t,n)},__destroy:function __destroy(e){if(this.__callqueue[e]){this.__callqueue[e].push(["__destroy",e]);return}var t=lz.embed.iframemanager.__frames[e];if(t){this.__setSendMouseEvents(e,!1);t.owner=null;t.appcontainer=null;LzSprite.prototype.__discardElement(t);delete lz.embed.iframemanager.__frames[e];delete lz.embed.iframemanager.__namebyid[e]}},callJavascript:function callJavascript(e,t,n,a){if(this.__callqueue[e]){this.__callqueue[e].push(["callJavascript",e,t,n,a]);return}if(this.__loading[e]){if(!this.__calljsqueue[e]){this.__calljsqueue[e]=[]}this.__calljsqueue[e].push(["callJavascript",e,t,n,a]);return}var r=lz.embed.iframemanager.getFrameWindow(e);if(!a){a=[]}try{var s=r.eval(t);if(s){var i=s.apply(r,a);if(n){n.execute(i)}return i}}catch(t){}},__globalMouseover:function __globalMouseover(e,t){var n=lz.embed.iframemanager.getFrame(t);if(!n){return}e=window.event;if(n.owner&&n.owner.sprite){if(e.toElement&&"IFRAME"!=e.toElement.nodeName){LzMouseKernel.__resetMouse()}}},__mouseEvent:function __mouseEvent(e,t){var n=lz.embed,a=n.iframemanager.getFrame(t);if(!a){return}if(!e){e=window.event}var r="on"+e.type;if(a.owner&&a.owner.sprite&&a.owner.sprite.__mouseEvent){if("oncontextmenu"==r){if(!n.iframemanager.__hidenativecontextmenu[t]){return}else{var s=n.getAbsolutePosition(a);LzMouseKernel.__sendMouseMove(e,s.x,s.y);return LzMouseKernel.__showContextMenu(e)}}a.owner.sprite.__mouseEvent(e);if("onmouseup"==r){if(LzMouseKernel.__lastMouseDown==a.owner.sprite){LzMouseKernel.__lastMouseDown=null}}}else{if("onmouseleave"==r){r="onmouseout"}else{if("onmouseenter"==r){r="onmouseover"}else{if("oncontextmenu"==r){return}}}n[a.owner].callMethod("lz.embed.iframemanager.__gotMouseEvent('"+t+"','"+r+"')")}},setSendMouseEvents:function setSendMouseEvents(e,t){if(this.__callqueue[e]){this.__callqueue[e].push(["setSendMouseEvents",e,t]);return}this.__sendmouseevents[e]=t},__setSendMouseEvents:function __setSendMouseEvents(e,t){var n=lz.embed.iframemanager.getFrameWindow(e);if(!n){return}if(t){if(lz.embed.browser.isIE){lz.embed.attachEventHandler(document,"mouseover",lz.embed.iframemanager,"__globalMouseover",e)}try{lz.embed.attachEventHandler(n.document,"mousedown",lz.embed.iframemanager,"__mouseEvent",e);lz.embed.attachEventHandler(n.document,"mouseup",lz.embed.iframemanager,"__mouseEvent",e);lz.embed.attachEventHandler(n.document,"click",lz.embed.iframemanager,"__mouseEvent",e);n.document.oncontextmenu=function(t){if(!t){t=n.event}return lz.embed.iframemanager.__mouseEvent(t,e)};if(lz.embed.browser.isIE){lz.embed.attachEventHandler(n.document,"mouseenter",lz.embed.iframemanager,"__mouseEvent",e);lz.embed.attachEventHandler(n.document,"mouseleave",lz.embed.iframemanager,"__mouseEvent",e)}else{lz.embed.attachEventHandler(n.document,"mouseover",lz.embed.iframemanager,"__mouseEvent",e);lz.embed.attachEventHandler(n.document,"mouseout",lz.embed.iframemanager,"__mouseEvent",e)}}catch(t){}}else{if(lz.embed.browser.isIE){lz.embed.removeEventHandler(document,"mouseover",lz.embed.iframemanager,"__globalMouseover")}try{lz.embed.removeEventHandler(n.document,"mousedown",lz.embed.iframemanager,"__mouseEvent");lz.embed.removeEventHandler(n.document,"mouseup",lz.embed.iframemanager,"__mouseEvent");lz.embed.removeEventHandler(n.document,"click",lz.embed.iframemanager,"__mouseEvent");n.document.oncontextmenu=null;if(lz.embed.browser.isIE){lz.embed.removeEventHandler(n.document,"mouseenter",lz.embed.iframemanager,"__mouseEvent");lz.embed.removeEventHandler(n.document,"mouseleave",lz.embed.iframemanager,"__mouseEvent")}else{lz.embed.removeEventHandler(n.document,"mouseover",lz.embed.iframemanager,"__mouseEvent");lz.embed.removeEventHandler(n.document,"mouseout",lz.embed.iframemanager,"__mouseEvent")}}catch(t){}}},setShowNativeContextMenu:function setShowNativeContextMenu(e,t){this.__hidenativecontextmenu[e]=!t},storeSelection:function storeSelection(e){var t=lz.embed.iframemanager,n=t.getFrameWindow(e);if(n&&n.document&&n.document.selection&&"Text"==n.document.selection.type){t.__selectionbookmarks[e]=n.document.selection.createRange().getBookmark()}},restoreSelection:function restoreSelection(e){var t=lz.embed.iframemanager,n=t.getFrameWindow(e);if(t.__selectionbookmarks[e]&&n){var a=t.__selectionbookmarks[e],r=n.document.body.createTextRange();r.moveToBookmark(a);r.select()}}};lz.embed.mousewheel={__mousewheelEvent:function __mousewheelEvent(e){if(!e){e=window.event}var t=0;if(e.wheelDelta){t=e.wheelDelta/120;if(lz.embed.browser.isOpera){t=-t}}else{if(e.detail){t=-e.detail/3}}if(e.preventDefault){e.preventDefault()}e.returnValue=!1;var n=lz.embed.mousewheel.__callbacks.length;if(null!=t&&0<n){for(var a=0;a<n;a+=2){var r=lz.embed.mousewheel.__callbacks[a],s=lz.embed.mousewheel.__callbacks[a+1];if(r&&r[s]){r[s](t)}}}},__callbacks:[],setCallback:function setCallback(e,t){var n=lz&&lz.embed&&lz.embed.options&&!0!=lz.embed.options.cancelkeyboardcontrol||!0;if(0==lz.embed.mousewheel.__callbacks.length&&n){if(window.addEventListener){lz.embed.attachEventHandler(window,"DOMMouseScroll",lz.embed.mousewheel,"__mousewheelEvent")}lz.embed.attachEventHandler(document,"mousewheel",lz.embed.mousewheel,"__mousewheelEvent")}lz.embed.mousewheel.__callbacks.push(e,t)}};lz.embed.history={active:null,_currentstate:null,_apps:[],_intervalID:null,_registeredapps:{},intervaltime:200,init:function init(){var e=lz.embed.history;if(e.active||!1==e.active){return}e.active=!0;e._title=top.document.title;var t=e.get();if(lz.embed.browser.isSafari){e._historylength=history.length;e._history=[];for(var n=1;n<e._historylength;n++){e._history.push("")}e._history.push(t);var a=document.createElement("form");a.method="get";document.body.appendChild(a);e._form=a;if(!top.document.location.lzaddr){top.document.location.lzaddr={}}if(top.document.location.lzaddr.history){e._history=top.document.location.lzaddr.history.split(",")}if(""!=t){e.set(t)}}else{if(lz.embed.browser.isIE){var t=top.location.hash;if(t){t=t.substring(1)}var n=document.createElement("iframe");lz.embed.__setAttr(n,"id","lzHistory");lz.embed.__setAttr(n,"frameborder","no");lz.embed.__setAttr(n,"scrolling","no");lz.embed.__setAttr(n,"width","0");lz.embed.__setAttr(n,"height","0");lz.embed.__setAttr(n,"src","javascript:\"\"");document.body.appendChild(n);n=document.getElementById("lzHistory");e._iframe=n;n.style.display="none";n.style.position="absolute";n.style.left="-999px";var r=n.contentDocument||n.contentWindow.document;r.open();r.close();if(""!=t){r.location.hash="#"+t;e._parse(t)}}else{if(""!=t){e._parse(t);e._currentstate=t}}}if(null!=e._intervalID){clearInterval(e._intervalID)}if(0<e.intervaltime){e._intervalID=setInterval("lz.embed.history._checklocationhash()",e.intervaltime)}},listen:function listen(e){if("string"==typeof e){e=lz.embed.applications[e];if(!e||!e.runtime){return}}if(!e){return}var t=lz.embed.history;if(t._registeredapps[e._id]){return}t._registeredapps[e.id]=!0;t._apps.push(e);t.init()},_checklocationhash:function _checklocationhash(){if(lz.embed.dojo&&lz.embed.dojo.info&&lz.embed.dojo.info.installing){return}if(lz.embed.browser.isSafari){var e=this._history[this._historylength-1];if(""==e||"#"==e){e="#0"}if(!this._skip&&this._historylength!=history.length){this._historylength=history.length;if("undefined"!=typeof e){e=e.substring(1);this._currentstate=e;this._parse(e)}}else{this._parse(e.substring(1))}}else{var e=lz.embed.history.get();if(""==e){e="0"}if(lz.embed.browser.isIE){if(e!=this._currentstate){top.location.hash="0"==e?"":"#"+e;this._currentstate=e;this._parse(e)}if(top.document.title!=this._title){top.document.title=this._title}}else{this._currentstate=e;this._parse(e)}}},set:function set(e){if(!1==lz.embed.history.active){return}if(null==e){e=""}if(lz.embed.history._currentstate==e){return}lz.embed.history._currentstate=e;var t="#"+e;if(lz.embed.browser.isIE){top.location.hash="#0"==t?"":t;var n=lz.embed.history._iframe.contentDocument||lz.embed.history._iframe.contentWindow.document;n.open();n.close();n.location.hash=t;lz.embed.history._parse(e+"")}else{if(lz.embed.browser.isSafari){lz.embed.history._history[history.length]=t;lz.embed.history._historylength=history.length+1;if(412>lz.embed.browser.version){if(""==top.location.search){lz.embed.history._form.action=t;top.document.location.lzaddr.history=lz.embed.history._history.toString();lz.embed.history._skip=!0;lz.embed.history._form.submit();lz.embed.history._skip=!1}}else{var a=document.createEvent("MouseEvents");a.initEvent("click",!0,!0);var r=document.createElement("a");r.href=t;r.dispatchEvent(a)}}else{top.location.hash=t;lz.embed.history._parse(e+"")}}return!0},get:function get(){var e="";if(lz.embed.browser.isIE){if(lz.embed.history._iframe){var t=lz.embed.history._iframe.contentDocument||lz.embed.history._iframe.contentWindow.document;e=t.location.hash}}else{e=top.location.href}var n=e.indexOf("#");if(-1!=n){return e.substring(n+1)}return""},_parse:function _parse(e){var t=lz.embed.history;if(0==e.length){return}for(var n=0,a=lz.embed.history._apps.length,r;n<a;n++){r=lz.embed.history._apps[n];if(!r.loaded||r._lasthash==e){continue}r._lasthash=e;if(-1!=e.indexOf("_lz")){e=e.substring(3);for(var s=e.split(","),i=0;i<s.length;i++){var o=s[i],d=o.indexOf("="),l=unescape(o.substring(0,d)),m=unescape(o.substring(d+1));lz.embed.setCanvasAttribute(l,m);if(window.canvas){canvas.setAttribute(l,m)}}}else{if("swf"==r.runtime){t.__setFlash(e,r._id)}else{if(window.lz&&lz.History&&lz.History.isReady&&lz.History.receiveHistory){lz.History.receiveHistory(e)}}}}},_store:function _store(e,t){if(e instanceof Object){var n="";for(var a in e){if(""!=n){n+=","}n+=escape(a)+"="+escape(e[a])}}else{var n=escape(e)+"="+escape(t)}this.set("_lz"+n)},__setFlash:function __setFlash(e,t){var n=lz.embed[t];if(n&&n.loaded&&"swf"==n.runtime){var a=n._getSWFDiv();if(a){n.callMethod("lz.History.receiveHistory("+e+")");n._lasthash=e}}}};if(lz.embed.browser.isFirefox){window.onunload=function(){}}lz.embed.regex={cache:{},create:function create(e,t,n){try{var a=lz.embed.regex;a.cache[e]=new RegExp(a.unmask(t),a.unmask(n));return!0}catch(t){return t.name+": "+t.message}},test:function test(e,t,n){var a=lz.embed.regex,r=a.cache[e];r.lastIndex=n;return[r.test(a.unmask(t)),r.lastIndex]},exec:function exec(e,t,n){var a=lz.embed.regex,r=a.cache[e];r.lastIndex=n;var s=r.exec(a.unmask(t));if(s){(s=a.maskArr(s)).push(s.index,r.lastIndex);return s}else{return null}},match:function match(e,t){var n=lz.embed.regex,a=n.unmask(t).match(n.cache[e]);return a?n.maskArr(a):null},replace:function replace(e,t,n){var a=lz.embed.regex;return a.mask(a.unmask(t).replace(a.cache[e],a.unmask(n)))},search:function search(e,t){var n=lz.embed.regex;return n.unmask(t).search(n.cache[e])},split:function split(e,t,n){var a=lz.embed.regex;return a.maskArr(a.unmask(t).split(a.cache[e],n))},remove:function remove(e){delete lz.embed.regex.cache[e]},mask:function mask(e){return null==e||!/^\s*$/.test(e)?e:"__#lznull"+e.replace(/\s/g,function(e){switch(e){case" ":return"w";case"\f":return"f";case"\n":return"n";case"\r":return"r";case"\t":return"t";case"\xA0":return"s";case"\u2028":return"l";case"\u2029":return"p";}})},unmask:function unmask(e){return"__#lznull"==e?"":e},maskArr:function maskArr(e){for(var t=lz.embed.regex,n=0;n<e.length;++n){e[n]=t.mask(e[n])}return e}};return lz});
//# sourceMappingURL=lzloader.min.js.map

define ("filter_poodll/upskin_text",["jquery","core/log"],function(a,b){"use strict";b.debug("upskin_text: initialising");return{element:null,cvs:null,cvsctx:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c,d){this.config=a;this.element=b;this.cvs=c;this.messagearea=d},initControls:function initControls(){},initProgressSession:function initProgressSession(a){var b=this;b.percent=0;var c=M.util.get_string("recui_uploading","filter_poodll");a.upload.addEventListener("progress",function(a){if(a.lengthComputable){b.percent=a.loaded/a.total;b.showMessage(c+"("+Math.floor(100*b.percent)+"%)")}})},deactivateProgressSession:function deactivateProgressSession(){b.debug("deactivating session")},showMessage:function showMessage(a){this.messagearea.html(a)}}});
//# sourceMappingURL=upskin_text.min.js.map

define ("filter_poodll/template_presets_amd",["jquery","core/log"],function(a,b){"use strict";b.debug("Filter Poodll Presets initialising");return{presetdata:!1,dataitems:["name","key","version","instructions","showatto","showplayers","requirecss","requirejs","shim","defaults","amd","body","bodyend","script","style","dataset","datasetvars","alternate","alternateend"],fetchcontrols:function fetchcontrols(a){var b={name:document.getElementById("id_s_filter_poodll_templatename_"+a),key:document.getElementById("id_s_filter_poodll_templatekey_"+a),version:document.getElementById("id_s_filter_poodll_templateversion_"+a),instructions:document.getElementById("id_s_filter_poodll_templateinstructions_"+a),showatto:document.getElementById("id_s_filter_poodll_template_showatto_"+a),showplayers:document.getElementById("id_s_filter_poodll_template_showplayers_"+a),requirecss:document.getElementById("id_s_filter_poodll_templaterequire_css_"+a),requirejs:document.getElementById("id_s_filter_poodll_templaterequire_js_"+a),shim:document.getElementById("id_s_filter_poodll_templaterequire_js_shim_"+a),defaults:document.getElementById("id_s_filter_poodll_templatedefaults_"+a),amd:document.getElementById("id_s_filter_poodll_template_amd_"+a),body:document.getElementById("id_s_filter_poodll_template_"+a),bodyend:document.getElementById("id_s_filter_poodll_templateend_"+a),script:document.getElementById("id_s_filter_poodll_templatescript_"+a),style:document.getElementById("id_s_filter_poodll_templatestyle_"+a),dataset:document.getElementById("id_s_filter_poodll_dataset_"+a),datasetvars:document.getElementById("id_s_filter_poodll_datasetvars_"+a),alternate:document.getElementById("id_s_filter_poodll_templatealternate_"+a),alternateend:document.getElementById("id_s_filter_poodll_templatealternate_end_"+a),presetdata:document.getElementById("id_s_filter_poodll_presetdata_"+a)};return b},fetchjsonbundle:function fetchjsonbundle(b,c){var d={};a.each(this.dataitems,function(a,b){d[b]=c[b].value});var e=JSON.stringify(d);return e},exportbundle:function exportbundle(a){var b=this.fetchcontrols(a);if(""==b.key.value){return}var c=this.fetchjsonbundle(a,b),d=document.createElement("a");d.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(c));d.setAttribute("download",b.key.value+".txt");if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0);d.dispatchEvent(e)}else{d.click()}},populateform:function populateform(b,c,d){var e=this.fetchcontrols(b);if(!c&&!d){return}if(!(0==c&&d)){d=this.presetdata}a.each(this.dataitems,function(a,b){if(d[c].hasOwnProperty(b)){if("cleartemplate"==d[c].key&&("key"==b||"name"==b)){var f=""}else{var f=d[c][b]}e[b].value=f}else{switch(b){case"amd":case"showplayers":case"showatto":e[b].value=0;break;default:e[b].value="";}}})},dopopulate:function dopopulate(a,b){this.populateform(a,0,Array(b))},init:function init(b){if(!this.presetdata){var c="#id_s_filter_poodll_presetdata_"+b.templateindex,d=a(c).get(0);this.presetdata=JSON.parse(d.value);a(c).remove()}var e=this;a("select[name='filter_poodll/presets']").change(function(){debugger;e.populateform(b.templateindex,a(this).val())});var f="#id_s_filter_poodll_dragdropsquare_"+b.templateindex;a(f).on("click",function(){e.exportbundle(b.templateindex)});a(f).on("dragover",function(b){b.preventDefault();b.stopPropagation();a(this).addClass("filter_poodll_dragging")});a(f).on("dragleave",function(b){b.preventDefault();b.stopPropagation();a(this).removeClass("filter_poodll_dragging")});a(f).on("drop",function(c){c.preventDefault();var d=c.originalEvent.dataTransfer.files;if(d.length){var g=d[0];if(g){var f=new FileReader;f.onload=function(a){var c=a.target.result,d=JSON.parse(c);if(d.key){e.dopopulate(b.templateindex,d)}};f.readAsText(g)}else{alert("Failed to load file")}}a(this).removeClass("filter_poodll_dragging")})}}});
//# sourceMappingURL=template_presets_amd.min.js.map

define ("filter_poodll/dlg_errordisplay",["jquery","core/log","filter_poodll/dlg_poodll"],function(a,b,c){b.debug("Error display dialog: initialising");return{dlg:null,instanceprops:null,dlgbox:null,init:function init(a){this.dlg=c.clone();this.dlg.setHeader("Error");this.instanceprops=a},clone:function clone(){return a.extend(!0,{},this)},fetch_dialogue_box:function fetch_dialogue_box(){return this.dlg.fetch_dialogue_box("errors")},set_dialogue_box:function set_dialogue_box(a){this.dlgbox=a;this.dlg.set_dialogue_box(a)},open:function open(a){var b=this,c=this.instanceprops,d="<div class=\"filter_poodll_errordisplay\">",e=a;if(a.name){e=M.util.get_string("recui_media"+a.name.toLowerCase(),"filter_poodll")}d+="<span>"+e+"</span>";d+="</div>";b.dlg.setContent(d);b.registerEvents();b.dlg.open()},registerEvents:function registerEvents(){}}});
//# sourceMappingURL=dlg_errordisplay.min.js.map

function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("filter_poodll/drawingboard",[],function(){var a={};a.Board=function(b,c){this.opts=$.extend({},a.Board.defaultOpts,c);this.ev=new a.Utils.MicroEvent;this.id=b;this.$el=$(document.getElementById(b));if(!this.$el.length)return!1;var d="<div class=\"drawing-board-canvas-wrapper\"></canvas><canvas class=\"drawing-board-canvas\"></canvas><div class=\"drawing-board-cursor drawing-board-utils-hidden\"></div></div>";if(-1<this.opts.controlsPosition.indexOf("bottom"))d+="<div class=\"drawing-board-controls\"></div>";else d="<div class=\"drawing-board-controls\"></div>"+d;this.$el.addClass("drawing-board").append(d);this.dom={$canvasWrapper:this.$el.find(".drawing-board-canvas-wrapper"),$canvas:this.$el.find(".drawing-board-canvas"),$cursor:this.$el.find(".drawing-board-cursor"),$controls:this.$el.find(".drawing-board-controls")};$.each(["left","right","center"],$.proxy(function(a,b){if(-1<this.opts.controlsPosition.indexOf(b)){this.dom.$controls.attr("data-align",b);return!1}},this));this.canvas=this.dom.$canvas.get(0);this.ctx=this.canvas&&this.canvas.getContext&&this.canvas.getContext("2d")?this.canvas.getContext("2d"):null;this.color=this.opts.color;if(!this.ctx){if(this.opts.errorMessage)this.$el.html(this.opts.errorMessage);return!1}this.storage=this._getStorage();this.initHistory();this.reset({webStorage:!1,history:!1,background:!1});this.initControls();this.resize();this.reset({webStorage:!1,history:!0,background:!0});this.restoreWebStorage();this.initDropEvents();this.initDrawEvents()};a.Board.defaultOpts={controls:["Color","DrawingMode","Size","Navigation"],controlsPosition:"top left",color:"#000000",size:1,background:"#fff",eraserColor:"background",webStorage:"session",droppable:!1,enlargeYourContainer:!1,errorMessage:"<p>It seems you use an obsolete browser. <a href=\"http://browsehappy.com/\" target=\"_blank\">Update it</a> to start drawing.</p>"};a.Board.prototype={reset:function reset(a){a=$.extend({color:this.opts.color,size:this.opts.size,webStorage:!0,history:!0,background:!1},a);this.setMode("pencil");if(a.background)this.resetBackground(this.opts.background,!1);if(a.color)this.setColor(a.color);if(a.size)this.ctx.lineWidth=a.size;this.ctx.lineCap="round";this.ctx.lineJoin="round";if(a.webStorage)this.saveWebStorage();if(a.history)this.saveHistory();this.blankCanvas=this.getImg();this.ev.trigger("board:reset",a)},resetBackground:function resetBackground(b,c){b=b||this.opts.background;c="undefined"!=typeof c?c:!0;var d=a.Utils.isColor(b),e=this.getMode();this.setMode("pencil");this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.width);if(d){this.ctx.fillStyle=b;this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}else if(b)this.setImg(b);this.setMode(e);if(c)this.saveHistory()},resize:function resize(){this.dom.$controls.toggleClass("drawing-board-controls-hidden",!this.controls||!this.controls.length);var b,c,d=[this.$el.width(),a.Utils.boxBorderWidth(this.$el),a.Utils.boxBorderWidth(this.dom.$canvasWrapper,!0,!0)],e=[this.$el.height(),a.Utils.boxBorderHeight(this.$el),this.dom.$controls.height(),a.Utils.boxBorderHeight(this.dom.$controls,!1,!0),a.Utils.boxBorderHeight(this.dom.$canvasWrapper,!0,!0)],f=this,g=function(a,b){b=b||1;for(var c=a[0],d=1;d<a.length;d++){c=c+a[d]*b}return c},h=function(a){return g(a,-1)};if(this.opts.enlargeYourContainer){b=this.$el.width();c=this.$el.height();this.$el.width(g(d));this.$el.height(g(e))}else{b=h(d);c=h(e)}this.dom.$canvasWrapper.css("width",b+"px");this.dom.$canvasWrapper.css("height",c+"px");this.dom.$canvas.css("width",b+"px");this.dom.$canvas.css("height",c+"px");this.canvas.width=b;this.canvas.height=c},initControls:function initControls(){this.controls=[];if(!this.opts.controls.length||!a.Control)return!1;for(var b=0,d;b<this.opts.controls.length;b++){d=null;if("string"==typeof this.opts.controls[b])d=new window.DrawingBoard.Control[this.opts.controls[b]](this);else if("object"==_typeof(this.opts.controls[b])){for(var e in this.opts.controls[b]){break}d=new window.DrawingBoard.Control[e](this,this.opts.controls[b][e])}if(d){this.addControl(d)}}},addControl:function addControl(b,c,d){if("string"!=typeof b&&("object"!==_typeof(b)||!b instanceof a.Control))return!1;var e="object"==_typeof(c)?c:{};d=d?1*d:"number"==typeof c?c:null;if("string"==typeof b)b=new window.DrawingBoard.Control[b](this,e);if(d)this.dom.$controls.children().eq(d).before(b.$el);else this.dom.$controls.append(b.$el);if(!this.controls)this.controls=[];this.controls.push(b);this.dom.$controls.removeClass("drawing-board-controls-hidden")},initHistory:function initHistory(){this.history={values:[],position:0}},saveHistory:function saveHistory(){while(30<this.history.values.length){this.history.values.shift();this.history.position--}if(0!==this.history.position&&this.history.position<this.history.values.length){this.history.values=this.history.values.slice(0,this.history.position);this.history.position++}else{this.history.position=this.history.values.length+1}this.history.values.push(this.getImg());this.ev.trigger("historyNavigation",this.history.position)},_goThroughHistory:function _goThroughHistory(a){if(a&&this.history.position==this.history.values.length||!a&&1==this.history.position)return;var b=a?this.history.position+1:this.history.position-1;if(this.history.values.length&&this.history.values[b-1]!==void 0){this.history.position=b;this.setImg(this.history.values[b-1])}this.ev.trigger("historyNavigation",b);this.saveWebStorage()},goBackInHistory:function goBackInHistory(){this._goThroughHistory(!1)},goForthInHistory:function goForthInHistory(){this._goThroughHistory(!0)},setImg:function setImg(a){var b=this.ctx,c=new Image,d=b.globalCompositeOperation;c.onload=function(){b.globalCompositeOperation="source-over";b.clearRect(0,0,b.canvas.width,b.canvas.width);b.drawImage(c,0,0);b.globalCompositeOperation=d};c.src=a},getImg:function getImg(){return this.canvas.toDataURL("image/png")},downloadImg:function downloadImg(){var a=this.getImg();a=a.replace("image/png","image/octet-stream");window.location.href=a},saveWebStorage:function saveWebStorage(){if(window[this.storage]){window[this.storage].setItem("drawing-board-"+this.id,this.getImg());this.ev.trigger("board:save"+this.storage.charAt(0).toUpperCase()+this.storage.slice(1),this.getImg())}},restoreWebStorage:function restoreWebStorage(){if(window[this.storage]&&null!==window[this.storage].getItem("drawing-board-"+this.id)){this.setImg(window[this.storage].getItem("drawing-board-"+this.id));this.ev.trigger("board:restore"+this.storage.charAt(0).toUpperCase()+this.storage.slice(1),window[this.storage].getItem("drawing-board-"+this.id))}},clearWebStorage:function clearWebStorage(){if(window[this.storage]&&null!==window[this.storage].getItem("drawing-board-"+this.id)){window[this.storage].removeItem("drawing-board-"+this.id);this.ev.trigger("board:clear"+this.storage.charAt(0).toUpperCase()+this.storage.slice(1))}},_getStorage:function _getStorage(){if(!this.opts.webStorage||!("session"===this.opts.webStorage||"local"===this.opts.webStorage))return!1;return this.opts.webStorage+"Storage"},initDropEvents:function initDropEvents(){if(!this.opts.droppable)return!1;this.dom.$canvas.on("dragover dragenter drop",function(a){a.stopPropagation();a.preventDefault()});this.dom.$canvas.on("drop",$.proxy(this._onCanvasDrop,this))},_onCanvasDrop:function _onCanvasDrop(a){a=a.originalEvent?a.originalEvent:a;var b=a.dataTransfer.files;if(!b||!b.length||-1==b[0].type.indexOf("image")||!window.FileReader)return!1;var c=new FileReader;c.readAsDataURL(b[0]);c.onload=$.proxy(function(a){this.setImg(a.target.result);this.ev.trigger("board:imageDropped",a.target.result);this.ev.trigger("board:userAction");this.saveHistory()},this)},setMode:function setMode(b,c){c=c||!1;b=b||"pencil";this.ev.unbind("board:startDrawing",$.proxy(this.fill,this));if("transparent"===this.opts.eraserColor)this.ctx.globalCompositeOperation="eraser"===b?"destination-out":"source-over";else{if("eraser"===b){if("background"===this.opts.eraserColor&&a.Utils.isColor(this.opts.background))this.ctx.strokeStyle=this.opts.background;else if(a.Utils.isColor(this.opts.eraserColor))this.ctx.strokeStyle=this.opts.eraserColor}else if(!this.mode||"eraser"===this.mode){this.ctx.strokeStyle=this.color}if("filler"===b)this.ev.bind("board:startDrawing",$.proxy(this.fill,this))}this.mode=b;if(!c)this.ev.trigger("board:mode",this.mode)},getMode:function getMode(){return this.mode||"pencil"},setColor:function setColor(b){var c=this;b=b||this.color;if(!a.Utils.isColor(b))return!1;this.color=b;if("transparent"!==this.opts.eraserColor&&"eraser"===this.mode){var d=function(a){if("eraser"!==a)c.strokeStyle=c.color;c.ev.unbind("board:mode",d)};this.ev.bind("board:mode",d)}else this.ctx.strokeStyle=this.color},fill:function fill(c){if(this.getImg()===this.blankCanvas){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.width);this.ctx.fillStyle=this.color;this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);return}var d=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),e=0,f=1,h=2,i=3,j=this.ctx.strokeStyle,k=parseInt(j.substr(1,2),16),l=parseInt(j.substr(3,2),16),g=parseInt(j.substr(5,2),16),b=a.Utils.pixelAt(d,parseInt(c.coords.x,10),parseInt(c.coords.y,10));if(b[i]===a.Utils.RGBToInt(k,l,g))return;var m=[b],n,o=d.width-1,p=d.height-1;while(n=m.pop()){if(n[i]===b[i]){d.data[n[e]]=k;d.data[n[e]+1]=l;d.data[n[e]+2]=g;if(0<n[f])m.push(a.Utils.pixelAt(d,n[f]-1,n[h]));if(n[f]<o)m.push(a.Utils.pixelAt(d,n[f]+1,n[h]));if(0<n[h])m.push(a.Utils.pixelAt(d,n[f],n[h]-1));if(n[h]<p)m.push(a.Utils.pixelAt(d,n[f],n[h]+1))}}this.ctx.putImageData(d,0,0)},initDrawEvents:function initDrawEvents(){this.isDrawing=!1;this.isMouseHovering=!1;this.coords={};this.coords.old=this.coords.current=this.coords.oldMid={x:0,y:0};this.dom.$canvas.on("mousedown touchstart",$.proxy(function(a){this._onInputStart(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mousemove touchmove",$.proxy(function(a){this._onInputMove(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mousemove",$.proxy(function(){},this));this.dom.$canvas.on("mouseup touchend",$.proxy(function(a){this._onInputStop(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mouseover",$.proxy(function(a){this._onMouseOver(a,this._getInputCoords(a))},this));this.dom.$canvas.on("mouseout",$.proxy(function(a){this._onMouseOut(a,this._getInputCoords(a))},this));$("body").on("mouseup touchend",$.proxy(function(){this.isDrawing=!1},this));if(window.requestAnimationFrame)requestAnimationFrame($.proxy(this.draw,this))},draw:function draw(){if(window.requestAnimationFrame&&10<this.ctx.lineWidth&&this.isMouseHovering){this.dom.$cursor.css({width:this.ctx.lineWidth+"px",height:this.ctx.lineWidth+"px"});var b=a.Utils.tpl("translateX({{x}}px) translateY({{y}}px)",{x:this.coords.current.x-this.ctx.lineWidth/2,y:this.coords.current.y-this.ctx.lineWidth/2});this.dom.$cursor.css({transform:b,"-webkit-transform":b,"-ms-transform":b});this.dom.$cursor.removeClass("drawing-board-utils-hidden")}else{this.dom.$cursor.addClass("drawing-board-utils-hidden")}if(this.isDrawing){var c=this._getMidInputCoords(this.coords.current);this.ctx.beginPath();this.ctx.moveTo(c.x,c.y);this.ctx.quadraticCurveTo(this.coords.old.x,this.coords.old.y,this.coords.oldMid.x,this.coords.oldMid.y);this.ctx.stroke();this.coords.old=this.coords.current;this.coords.oldMid=c}if(window.requestAnimationFrame)requestAnimationFrame($.proxy(function(){this.draw()},this))},_onInputStart:function _onInputStart(a,b){this.coords.current=this.coords.old=b;this.coords.oldMid=this._getMidInputCoords(b);this.isDrawing=!0;if(!window.requestAnimationFrame)this.draw();this.ev.trigger("board:startDrawing",{e:a,coords:b});a.preventDefault()},_onInputMove:function _onInputMove(a,b){this.coords.current=b;this.ev.trigger("board:drawing",{e:a,coords:b});if(!window.requestAnimationFrame)this.draw();a.preventDefault()},_onInputStop:function _onInputStop(a,b){if(this.isDrawing&&(!a.touches||0===a.touches.length)){this.isDrawing=!1;this.saveWebStorage();this.saveHistory();this.ev.trigger("board:stopDrawing",{e:a,coords:b});this.ev.trigger("board:userAction");a.preventDefault()}},_onMouseOver:function _onMouseOver(a,b){this.isMouseHovering=!0;this.coords.old=this._getInputCoords(a);this.coords.oldMid=this._getMidInputCoords(this.coords.old);this.ev.trigger("board:mouseOver",{e:a,coords:b})},_onMouseOut:function _onMouseOut(a,b){this.isMouseHovering=!1;this.ev.trigger("board:mouseOut",{e:a,coords:b})},_getInputCoords:function _getInputCoords(a){a=a.originalEvent?a.originalEvent:a;var b,c;if(a.touches&&1==a.touches.length){b=a.touches[0].pageX;c=a.touches[0].pageY}else{b=a.pageX;c=a.pageY}return{x:b-this.dom.$canvas.offset().left,y:c-this.dom.$canvas.offset().top}},_getMidInputCoords:function _getMidInputCoords(a){return{x:this.coords.old.x+a.x>>1,y:this.coords.old.y+a.y>>1}}};a.Control=function(a,b){this.board=a;this.opts=$.extend({},this.defaults,b);this.$el=$(document.createElement("div")).addClass("drawing-board-control");if(this.name)this.$el.addClass("drawing-board-control-"+this.name);this.board.ev.bind("board:reset",$.proxy(this.onBoardReset,this));this.initialize.apply(this,arguments);return this};a.Control.prototype={name:"",defaults:{},initialize:function initialize(){},addToBoard:function addToBoard(){this.board.addControl(this)},onBoardReset:function onBoardReset(){}};a.Control.extend=function(a,b){var c=this,d;if(a&&a.hasOwnProperty("constructor")){d=a.constructor}else{d=function(){return c.apply(this,arguments)}}$.extend(d,c,b);var e=function(){this.constructor=d};e.prototype=c.prototype;d.prototype=new e;if(a)$.extend(d.prototype,a);d.__super__=c.prototype;return d};a.Control.Color=a.Control.extend({name:"colors",initialize:function initialize(){this.initTemplate();var a=this;this.$el.on("click",".drawing-board-control-colors-picker",function(b){var c=$(this).attr("data-color");a.board.setColor(c);a.$el.find(".drawing-board-control-colors-current").css("background-color",c).attr("data-color",c);a.board.ev.trigger("color:changed",c);a.$el.find(".drawing-board-control-colors-rainbows").addClass("drawing-board-utils-hidden");b.preventDefault()});this.$el.on("click",".drawing-board-control-colors-current",function(b){a.$el.find(".drawing-board-control-colors-rainbows").toggleClass("drawing-board-utils-hidden");b.preventDefault()});$("body").on("click",function(b){var c=$(b.target),d=c.hasClass("drawing-board-control-colors-current")?c:c.closest(".drawing-board-control-colors-current"),e=a.$el.find(".drawing-board-control-colors-current"),f=a.$el.find(".drawing-board-control-colors-rainbows");if((!d.length||d.get(0)!==e.get(0))&&!f.hasClass("drawing-board-utils-hidden"))f.addClass("drawing-board-utils-hidden")})},initTemplate:function initTemplate(){var b="<div class=\"drawing-board-control-colors-picker\" data-color=\"{{color}}\" style=\"background-color: {{color}}\"></div>",c="";$.each([.75,.5,.25],$.proxy(function(d,e){var f=0,g=null;c+="<div class=\"drawing-board-control-colors-rainbow\">";if(.25==e)g=this._rgba(0,0,0,1);if(.5==e)g=this._rgba(150,150,150,1);if(.75==e)g=this._rgba(255,255,255,1);c+=a.Utils.tpl(b,{color:g.toString()});while(330>=f){c+=a.Utils.tpl(b,{color:this._hsl2Rgba(this._hsl(f-60,1,e)).toString()});f+=30}c+="</div>"},this));this.$el.append($(a.Utils.tpl("<div class=\"drawing-board-control-inner\"><div class=\"drawing-board-control-colors-current\" style=\"background-color: {{color}}\" data-color=\"{{color}}\"></div><div class=\"drawing-board-control-colors-rainbows\">{{rainbows}}</div></div>",{color:this.board.color,rainbows:c})));this.$el.find(".drawing-board-control-colors-rainbows").addClass("drawing-board-utils-hidden")},onBoardReset:function onBoardReset(){this.board.setColor(this.$el.find(".drawing-board-control-colors-current").attr("data-color"))},_rgba:function _rgba(c,d,e,b){return{r:c,g:d,b:e,a:b,toString:function toString(){return"rgba("+c+", "+d+", "+e+", "+b+")"}}},_hsl:function _hsl(a,b,c){return{h:a,s:b,l:c,toString:function toString(){return"hsl("+a+", "+100*b+"%, "+100*c+"%)"}}},_hex2Rgba:function _hex2Rgba(a){var b=parseInt(a.substring(1),16);return this._rgba(b>>16,255&b>>8,255&b,1)},_hsl2Rgba:function _hsl2Rgba(a){var d=a.h/360,e=a.s,f=a.l,h,i,j;function c(a,b,c){if(0>c)c+=1;if(1<c)c-=1;if(c<1/6)return a+6*(b-a)*c;if(c<1/2)return b;if(c<2/3)return a+6*((b-a)*(2/3-c));return a}if(0===e){h=i=j=f}else{var k=.5>f?f*(1+e):f+e-f*e,l=2*f-k;h=Math.floor(255*c(l,k,d+1/3));i=Math.floor(255*c(l,k,d));j=Math.floor(255*c(l,k,d-1/3))}return this._rgba(h,i,j,1)}});a.Control.DrawingMode=a.Control.extend({name:"drawingmode",defaults:{pencil:!0,eraser:!0,filler:!0},initialize:function initialize(){this.prevMode=this.board.getMode();$.each(["pencil","eraser","filler"],$.proxy(function(a,b){if(this.opts[b]){this.$el.append("<button class=\"drawing-board-control-drawingmode-"+b+"-button\" data-mode=\""+b+"\"></button>")}},this));this.$el.on("click","button[data-mode]",$.proxy(function(a){var b=$(a.currentTarget).attr("data-mode"),c=this.board.getMode();if(c!==b)this.prevMode=c;var d=c===b?this.prevMode:b;this.board.setMode(d);a.preventDefault()},this));this.board.ev.bind("board:mode",$.proxy(function(a){this.toggleButtons(a)},this));this.toggleButtons(this.board.getMode())},toggleButtons:function toggleButtons(a){this.$el.find("button[data-mode]").each(function(b,c){var d=$(c);d.toggleClass("active",a===d.attr("data-mode"))})}});a.Control.Navigation=a.Control.extend({name:"navigation",defaults:{back:!0,forward:!0,reset:!0},initialize:function initialize(){var a="";if(this.opts.back)a+="<button class=\"drawing-board-control-navigation-back\">&larr;</button>";if(this.opts.forward)a+="<button class=\"drawing-board-control-navigation-forward\">&rarr;</button>";if(this.opts.reset)a+="<button class=\"drawing-board-control-navigation-reset\">&times;</button>";this.$el.append(a);if(this.opts.back){var b=this.$el.find(".drawing-board-control-navigation-back");this.board.ev.bind("historyNavigation",$.proxy(function(a){if(1===a)b.attr("disabled","disabled");else b.removeAttr("disabled")},this));this.$el.on("click",".drawing-board-control-navigation-back",$.proxy(function(a){this.board.goBackInHistory();a.preventDefault()},this))}if(this.opts.forward){var c=this.$el.find(".drawing-board-control-navigation-forward");this.board.ev.bind("historyNavigation",$.proxy(function(a){if(a===this.board.history.values.length)c.attr("disabled","disabled");else c.removeAttr("disabled")},this));this.$el.on("click",".drawing-board-control-navigation-forward",$.proxy(function(a){this.board.goForthInHistory();a.preventDefault()},this))}if(this.opts.reset){this.$el.on("click",".drawing-board-control-navigation-reset",$.proxy(function(a){this.board.reset({background:!0});a.preventDefault()},this))}}});a.Control.Size=a.Control.extend({name:"size",defaults:{type:"auto",dropdownValues:[1,3,6,10,20,30,40,50]},types:["dropdown","range"],initialize:function initialize(){if("auto"==this.opts.type)this.opts.type=this._iHasRangeInput()?"range":"dropdown";var a=-1<$.inArray(this.opts.type,this.types)?this["_"+this.opts.type+"Template"]():!1;if(!a)return!1;this.val=this.board.opts.size;this.$el.append($(a));this.$el.attr("data-drawing-board-type",this.opts.type);this.updateView();var b=this;if("range"==this.opts.type){this.$el.on("change",".drawing-board-control-size-range-input",function(a){b.val=$(this).val();b.updateView();b.board.ev.trigger("size:changed",b.val);a.preventDefault()})}if("dropdown"==this.opts.type){this.$el.on("click",".drawing-board-control-size-dropdown-current",$.proxy(function(){this.$el.find(".drawing-board-control-size-dropdown").toggleClass("drawing-board-utils-hidden")},this));this.$el.on("click","[data-size]",function(a){b.val=parseInt($(this).attr("data-size"),0);b.updateView();b.board.ev.trigger("size:changed",b.val);a.preventDefault()})}},_rangeTemplate:function _rangeTemplate(){return a.Utils.tpl("<div class=\"drawing-board-control-inner\" title=\"{{size}}\"><input type=\"range\" min=\"1\" max=\"50\" value=\"{{size}}\" step=\"1\" class=\"drawing-board-control-size-range-input\"><span class=\"drawing-board-control-size-range-current\"></span></div>",{size:this.board.opts.size})},_dropdownTemplate:function _dropdownTemplate(){var b="<div class=\"drawing-board-control-inner\" title=\"{{size}}\"><div class=\"drawing-board-control-size-dropdown-current\"><span></span></div><ul class=\"drawing-board-control-size-dropdown\">";$.each(this.opts.dropdownValues,function(c,d){b+=a.Utils.tpl("<li data-size=\"{{size}}\"><span style=\"width: {{size}}px; height: {{size}}px; border-radius: {{size}}px;\"></span></li>",{size:d})});b+="</ul></div>";return b},onBoardReset:function onBoardReset(){this.updateView()},updateView:function updateView(){var a=this.val;this.board.ctx.lineWidth=a;this.$el.find(".drawing-board-control-size-range-current, .drawing-board-control-size-dropdown-current span").css({width:a+"px",height:a+"px",borderRadius:a+"px",marginLeft:-1*a/2+"px",marginTop:-1*a/2+"px"});this.$el.find(".drawing-board-control-inner").attr("title",a);if("dropdown"==this.opts.type){var b=null;$.each(this.opts.dropdownValues,function(c,d){if(null===b||Math.abs(d-a)<Math.abs(b-a))b=d});this.$el.find(".drawing-board-control-size-dropdown").addClass("drawing-board-utils-hidden")}},_iHasRangeInput:function _iHasRangeInput(){var a=document.createElement("input"),b=document.documentElement,c;a.setAttribute("type","range");c="text"!==a.type;a.value=":)";a.style.cssText="position:absolute;visibility:hidden;";if(/^range$/.test("range")&&a.style.WebkitAppearance!==void 0){b.appendChild(a);defaultView=document.defaultView;c=defaultView.getComputedStyle&&"textfield"!==defaultView.getComputedStyle(a,null).WebkitAppearance&&0!==a.offsetHeight;b.removeChild(a)}return!!c}});a.Control.Download=a.Control.extend({name:"download",initialize:function initialize(){this.$el.append("<button class=\"drawing-board-control-download-button\"></button>");this.$el.on("click",".drawing-board-control-download-button",$.proxy(function(a){this.board.downloadImg();a.preventDefault()},this))}});a.Utils={};a.Utils.tpl=function(){"use strict";var a;return function(b,c){return b.replace(/{{\s*([a-z0-9_][\.a-z0-9_]*)\s*}}/gi,function(b,d){var e=d.split("."),f=e.length,g=c,h=0;for(;h<f;h++){g=g[e[h]];if(g===a){throw"tim: '"+e[h]+"' not found in "+b}if(h==f-1){return g}}})}}();a.Utils.MicroEvent=function(){};a.Utils.MicroEvent.prototype={bind:function bind(a,b){this._events=this._events||{};this._events[a]=this._events[a]||[];this._events[a].push(b)},unbind:function unbind(a,b){this._events=this._events||{};if(!1==a in this._events)return;this._events[a].splice(this._events[a].indexOf(b),1)},trigger:function trigger(a){this._events=this._events||{};if(!1==a in this._events)return;for(var b=0;b<this._events[a].length;b++){this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}}};a.Utils._boxBorderSize=function(a,b,c,d){b=!!b||!0;c=!!c||!1;var e=0,f;if("width"==d){f=["border-left-width","border-right-width"];if(b)f.push("padding-left","padding-right");if(c)f.push("margin-left","margin-right")}else{f=["border-top-width","border-bottom-width"];if(b)f.push("padding-top","padding-bottom");if(c)f.push("margin-top","margin-bottom")}for(var g=f.length-1;0<=g;g--){e+=parseInt(a.css(f[g]).replace("px",""),10)}return e};a.Utils.boxBorderWidth=function(b,c,d){return a.Utils._boxBorderSize(b,c,d,"width")};a.Utils.boxBorderHeight=function(b,c,d){return a.Utils._boxBorderSize(b,c,d,"height")};a.Utils.isColor=function(a){if(!a||!a.length)return!1;return /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)||-1!==$.inArray(a.substring(0,3),["rgb","hsl"])};a.Utils.RGBToInt=function(a,d,e){var b=0;b|=(255&a)<<16;b|=(255&d)<<8;b|=255&e;return b};a.Utils.pixelAt=function(b,d,e){var f=4*(e*b.width+d),g=a.Utils.RGBToInt(b.data[f],b.data[f+1],b.data[f+2]);return[f,d,e,g]};(function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;++b){window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"]}})();var b;if("undefined"!=typeof window){b=window}else if("undefined"!=typeof global){b=global}else if("undefined"!=typeof self){b=self}else{b=this}b.DrawingBoard=a;return a});
//# sourceMappingURL=drawingboard.min.js.map

define ("filter_poodll/util_dragdrop",["jquery","jqueryui","core/log"],function(a,b,c){"use strict";c.debug("Poodll util drag drop: initialising");return{theelement:!1,uploadfunction:!1,uploader:!1,started:!1,filebutton:!1,init:function init(a,b,d){this.theelement=a;this.uploadfunction=b;this.uploader=d.uploader;this.filebutton=d.controlbar.filebutton;if(this.supports_dragdrop(a)){c.debug("registering drag drop");this.register_dragdrop();this.do_visuals()}else{c.debug("drag drop not supported")}},clone:function clone(){return a.extend(!0,{},this)},supports_dragdrop:function supports_dragdrop(a){return"draggable"in a||"ondragstart"in a&&"ondrop"in a},do_visuals:function do_visuals(){this.theelement.addClass("poodll-can-do-drag-drop")},turnoff_dragdrop:function turnoff_dragdrop(){if(!this.theelement){return}this.theelement.removeClass("poodll-can-do-drag-drop");this.theelement.removeClass("is-poodll-drag-over");this.theelement.off("drag dragstart dragend dragover dragenter dragleave drop");this.theelement.on("drag dragstart dragend dragover dragenter dragleave drop",function(a){a.preventDefault();a.stopPropagation()})},register_dragdrop:function register_dragdrop(){var a=this;this.theelement.on("drag dragstart dragend dragover dragenter dragleave drop",function(b){b.preventDefault();b.stopPropagation();if(a.started){}}).on("dragover dragenter",function(){a.theelement.addClass("is-poodll-drag-over")}).on("dragleave dragend drop",function(){a.theelement.removeClass("is-poodll-drag-over")}).on("drop",function(b){if(a.started){return}var c=b.originalEvent.dataTransfer.files;a.uploadfunction(c,a.uploader);a.turnoff_dragdrop();a.filebutton.off("change");a.filebutton.attr("disabled",!0);a.started=!0})}}});
//# sourceMappingURL=util_dragdrop.min.js.map

define ("filter_poodll/poodll_freshmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/dlg_devicesettings","filter_poodll/anim_progress_bar_fresh","filter_poodll/anim_hwave_fresh","filter_poodll/anim_hwave_timer","filter_poodll/upskin_text"],function(a,b,c,d,e,f,g,h,i){"use strict";c.debug("PoodLL BMR Skin: initialising");return{instanceprops:null,pmr:null,uploaded:!1,devsettings:null,therecanim:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=e.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+"\" style=\"display: none;\" controls playsinline=\"playsinline\" muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_preview_"+a+"\" playsinline=\"playsinline\" muted></video>"},fetch_resource_audio:function fetch_resource_audio(){return""},fetch_resource_video:function fetch_resource_video(){return""},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(),d=i.clone();d.init(c.config,b,c.controlbar.bmr_progresscanvas,c.controlbar.status);return d},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops();b.uploader.Output("");this.set_visual_mode("recordmode",a);b.timer.reset();b.timer.start();this.update_status(a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops();b.uploader.Output("");b.controlbar.preview.attr("src",null);this.set_visual_mode("recordmode",a);this.therecanim.start();b.timer.reset();b.timer.start();this.update_status(a)},handle_timer_update:function handle_timer_update(){var a=this.fetch_instanceprops();a.controlbar.status.html(a.timer.fetch_display_time());if(0==a.timer.seconds&&0<a.timer.initseconds){if(a.controlbar.startbutton.hasClass("poodll_in_progress")){a.controlbar.startbutton.click()}}},update_status:function update_status(){var a=this.fetch_instanceprops();a.controlbar.status.html(a.timer.fetch_display_time())},set_visual_mode:function set_visual_mode(a){var b=this,c=this.fetch_instanceprops();this.visualmode=a;switch(a){case"initmode":c.controlbar.statusText.text("Ready to record");c.controlbar.status.html("00:00:00");c.controlbar.stoprecbutton.attr("class","poodll_stop-recording_fresh poodll_fresh_stop_btn bmr_disabled");c.controlbar.startbutton.attr("class","poodll_start-recording_fresh poodll_fresh_main_btn");c.controlbar.playbutton.attr("class","poodll_play-recording_fresh poodll_fresh_play_btn bmr_disabled");b.disable_button(c.controlbar.savebutton);b.disable_button(c.controlbar.recordAgain);break;case"recordmode":c.controlbar.statusText.text("Recording..");b.enable_button(c.controlbar.startbutton);b.show_element(c.controlbar.startbutton);b.hide_element(c.controlbar.bmr_progresscanvas);b.enable_button(c.controlbar.pausebutton);b.show_element(c.controlbar.pausebutton);b.disable_button(c.controlbar.playbutton);b.hide_element(c.controlbar.resumebutton);b.enable_button(c.controlbar.stoprecbutton);b.disable_button(c.controlbar.savebutton);b.disable_button(c.controlbar.recordAgain);c.controlbar.preview.addClass("poodll_recording");c.controlbar.status.addClass("poodll_recording");c.controlbar.preview.removeClass("poodll_playing");c.controlbar.status.removeClass("poodll_playing");c.controlbar.startbutton.addClass("poodll_in_progress").removeClass("poodll_resume_button");c.controlbar.playbutton.removeClass("poodll_play_special poodll_play_green");if("audio"==c.config.mediatype){b.hide_element(c.controlbar.preview)}c.controlbar.root.removeClass("poodll_controllbar_playmode");break;case"previewmode":c.controlbar.statusText.text("Ready to Play");b.disable_button(c.controlbar.stoprecbutton);b.disable_button(c.controlbar.startbutton);b.enable_button(c.controlbar.playbutton);b.disable_button(c.controlbar.pausebutton);c.controlbar.status.html(c.timer.fetch_display_time(c.timer.finalSeconds));b.show_element(c.controlbar.startbutton);b.disable_button(c.controlbar.resumebutton);b.hide_element(c.controlbar.resumebutton);b.hide_element(c.controlbar.bmr_progresscanvas);if(b.uploaded){b.disable_button(c.controlbar.savebutton);b.disable_button(c.controlbar.recordAgain)}else{b.enable_button(c.controlbar.savebutton);b.enable_button(c.controlbar.recordAgain)}b.show_element(c.controlbar.pausebutton);c.controlbar.preview.removeClass("poodll_recording");c.controlbar.status.removeClass("poodll_recording");c.controlbar.preview.removeClass("poodll_playing");c.controlbar.status.removeClass("poodll_playing");c.controlbar.startbutton.removeClass("poodll_in_progress");c.controlbar.playbutton.addClass("poodll_play_green").removeClass("poodll_play_special").removeClass("poodll_play_pause").removeClass("poodll_stop_green");if("audio"==c.config.mediatype){b.show_element(c.controlbar.preview)}b.enable_button(c.controlbar.playbutton);c.controlbar.root.removeClass("poodll_controllbar_playmode poodll_controllbar_pausemode");break;case"playmode":c.controlbar.statusText.text("Playing");c.controlbar.status.html("00:00:00");b.enable_button(c.controlbar.stoprecbutton);b.enable_button(c.controlbar.pausebutton);b.disable_button(c.controlbar.startbutton);b.disable_button(c.controlbar.resumebutton);b.disable_button(c.controlbar.savebutton);b.disable_button(c.controlbar.recordAgain);b.show_element(c.controlbar.bmr_progresscanvas);c.controlbar.playbutton.removeClass("poodll_play_green").removeClass("poodll_play_special").addClass("poodll_stop_green");c.controlbar.preview.addClass("poodll_playing");c.controlbar.status.addClass("poodll_playing");b.show_element(c.controlbar.startbutton);b.hide_element(c.controlbar.resumebutton);c.controlbar.root.addClass("poodll_controllbar_playmode").removeClass("poodll_controllbar_pausemode");break;case"pausedmode":c.controlbar.statusText.text("Paused");b.show_element(c.controlbar.resumebutton);b.enable_button(c.controlbar.resumebutton);b.enable_button(c.controlbar.savebutton);c.controlbar.preview.removeClass("poodll_recording");c.controlbar.status.removeClass("poodll_recording");c.controlbar.startbutton.removeClass("poodll_in_progress").addClass("poodll_resume_button");c.controlbar.playbutton.removeClass("poodll_play_green").removeClass("poodll_play_pause");c.controlbar.root.addClass("poodll_controllbar_pausemode");break;case"uploadmode":c.controlbar.statusText.text("Uploading");b.disable_button(c.controlbar.savebutton);b.disable_button(c.controlbar.recordAgain);b.disable_button(c.controlbar.startbutton);b.show_element(c.controlbar.bmr_progresscanvas);c.controlbar.root.removeClass("poodll_controllbar_playmode poodll_controllbar_pausemode");break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(),h=g.config.media_skin_style,i="poodll_mediarecorder_size_auto";switch(g.config.size){case"small":i="poodll_mediarecorder_size_small";break;case"big":i="poodll_mediarecorder_size_big";break;case"auto":i="poodll_mediarecorder_size_auto";}var j=this.pmr.fetch_strings(),k="video"==f?"fa-video-camera":"fa-microphone",l="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",m="<div class=\"poodll_mediarecorderholder_fresh poodll_videorecorderholder_fresh "+l+" "+i+"\" id=\"holder_"+c+"\">";m+="<div class=\"poodll_mediarecorderbox_fresh\" id=\""+c+"\">";m+="<audio style=\"display: none !important;\" class=\"poodll-alert-recording\" id=\""+c+"\"><source src=\"#\" type=\"audio/mpeg\"></audio>";m+="<div class=\"style-holder "+h+"\">";m+="<div class=\"poodll_statusholder_fresh\" >";var n=this.fetch_status_bar("fresh");m+=n;m+="</div>";m+="<div class=\"poodll_fresh_musik_line\"><canvas class=\"fresh_range\"></canvas><canvas id=\""+c+"_playcanvas\" class=\"poodll_fresh_playcanvas\" width=\"300\" height=\"50\"></canvas><div class=\"poodll_fresh_wave\"></div></div><div class=\"poodll_fresh_control\"><div class=\"poodll_fresh_txt_control\">"+j.recui_readytorecord+"</div><div class=\"poodll_fresh_settings_btn settingsicon\" data-toggle=\"modal\" data-target=\"#myModal id=\"settingsicon_"+c+"\"></div><div class=\"poodll_start-recording_fresh poodll_fresh_main_btn\"></div><div class=\"poodll_stop-playing-recording_fresh\" style=\"display: none;\"></div><div class=\"poodll_pause-recording_fresh poodll_fresh_pause_btn bmr_disabled\"></div><div class=\"poodll_play-recording_fresh poodll_fresh_play_btn bmr_disabled\"></div></div><div class=\"poodll_fresh_bottom_btns\"><a class=\"poodll_save-recording_fresh poodll_fresh_upload_btn bmr_disabled\" href=\"#\">"+j.recui_upload+"</a><a class=\"poodll_fresh_record_btn bmr_disabled\" href=\"#\">"+j.recui_recordagain+"</a></div>";m+=d;m+="</div>";m+=this.devsettings.fetch_dialogue_box();m+=g.downloaddialog.fetch_dialogue_box();m+=g.errordialog.fetch_dialogue_box();m+="</div>";m+="</div>";a(b).prepend(m);var o={poodll_recording_alert:a("#"+c+" .poodll-alert-recording"),bmr_progresscanvas:a("#"+c+" .fresh_range"),settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),status:a("#"+c+" .poodll_status_fresh"),statusText:a("#"+c+" .poodll_fresh_txt_control"),preview:a("#"+c+" .poodll_preview_fresh"),startbutton:a("#"+c+" .poodll_start-recording_fresh"),stoprecbutton:a("#"+c+" .poodll_stop-recording_fresh"),pausebutton:a("#"+c+" .poodll_pause-recording_fresh"),resumebutton:a("#"+c+" .poodll_resume-recording_fresh"),playbutton:a("#"+c+" .poodll_play-recording_fresh"),stopbutton:a("#"+c+" .poodll_stop-playing-recording_fresh"),savebutton:a("#"+c+" .poodll_save-recording_fresh"),recordAgain:a("#"+c+" .poodll_fresh_record_btn"),playcanvas:a("#"+c+"_playcanvas"),root:a("#"+c)};g.downloaddialog.set_dialogue_box(o.downloaddialog);g.errordialog.set_dialogue_box(o.errorsdialog);this.devsettings.set_dialogue_box(o.settingsdialog);return o},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(b,c){var d=this,e=this.pmr,h=this.fetch_instanceprops();h.controlbar.settingsicon.click(function(){if(!d.uploaded){d.devsettings.open()}else{h.downloaddialog.open()}});var i=f.clone();i.init(h.controlbar.bmr_progresscanvas);i.readyBars();var j=g.clone();j.init(h.audioanalyser,h.controlbar.playcanvas.get(0));h.controlbar.startbutton.click(function(){if(a(this).hasClass("poodll_in_progress")){e.do_stop_audio(h);var f=h.controlbar.preview;if(f&&f.get(0)){f.get(0).pause()}j.clear();h.timer.stop();d.update_status(c);d.set_visual_mode("previewmode",c)}else if(a(this).hasClass("poodll_resume_button")){e.do_resume_audio(h);h.timer.resume();d.update_status(c);d.set_visual_mode("recordmode",c)}else{d.therecanim=j;e.do_start_audio(h,b)}});h.controlbar.recordAgain.click(function(){e.do_stop_audio(h);d.update_status(c);d.set_visual_mode("initmode",c)});h.controlbar.stoprecbutton.click(function(){e.do_stop_audio(h);var a=h.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}j.clear();h.timer.stop();d.update_status(c);d.set_visual_mode("previewmode",c)});h.controlbar.pausebutton.click(function(){e.do_pause_audio(h);var a=h.controlbar.preview;if(a&&a.get(0)){a.get(0).pause();a.get(0).controls=!1}console.log("PAUSE");h.timer.pause();d.update_status(c);d.set_visual_mode("pausedmode",c)});h.controlbar.resumebutton.click(function(){e.do_resume_audio(h);h.timer.resume();d.update_status(c);d.set_visual_mode("recordmode",c)});h.controlbar.preview.on("timeupdate",function(){if("playmode"!=d.visualmode){return}var a=this.currentTime;h.controlbar.status.html(h.timer.fetch_display_time(a))});h.controlbar.stopbutton.click(function(){e.do_stop_audio(h);var a=h.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}j.clear();h.timer.stop();d.update_status(c);d.set_visual_mode("previewmode",c)});h.controlbar.playbutton.click(function(){if(a(this).hasClass("poodll_play_pause")){var b=h.controlbar.preview.get(0);e.do_stopplay_audio(h,b);e.do_stop_audio(h);h.timer.pause();d.update_status(c);d.set_visual_mode("pausedmode",c)}else if(a(this).hasClass("poodll_stop_green")){e.do_stop_audio(h);var b=h.controlbar.preview;if(b&&b.get(0)){b.get(0).pause()}j.clear();h.timer.stop();d.update_status(c);d.set_visual_mode("previewmode",c)}else{var b=h.controlbar.preview.get(0);e.do_play_audio(h,b);d.set_visual_mode("playmode",c);i.clear();i.fetchCurrent=function(){var a=h.controlbar.preview.prop("currentTime"),b=h.controlbar.preview.prop("duration");if(!isFinite(b)){b=h.timer.finalseconds}return a/b};i.start();var f=h.controlbar.preview.prop("currentTime"),g=h.controlbar.preview.prop("duration");i.playBars(f,g)}});h.controlbar.savebutton.click(function(){if(h.blobs&&0<h.blobs.length){d.set_visual_mode("uploadmode",c);e.do_save_audio(h);d.uploaded=!0}else{h.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1});window.onbeforeunload=function(){d.enable_button(h.controlbar.startbutton);var a=h.controlbar.preview;if(a&&a.get(0)){a.get(0).pause();a.get(0).controls=!1}}},show_element:function show_element(b){a(b).show()},hide_element:function hide_element(b){a(b).hide()},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("bmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("bmr_disabled")}}});
//# sourceMappingURL=poodll_freshmediaskin.min.js.map

(function(a,b){if("function"==typeof define&&define.amd){define ("filter_poodll/soundtouch",[],function(){return b(a)})}else{a.CloudPoodll=b(a)}})(this,function(){var k=[[124,186,248,310,372,434,496,558,620,682,744,806,868,930,992,1054,1116,1178,1240,1302,1364,1426,1488,0],[-100,-75,-50,-25,25,50,75,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-20,-15,-10,-5,5,10,15,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-4,-3,-2,-1,1,2,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],l=.5,m=2,n=125,o=50,p=(o-n)/(m-l),q=25,r=15,s=(r-q)/(m-l);function a(c,a){for(var b in a){var d=a.__lookupGetter__(b),e=a.__lookupSetter__(b);if(d||e){if(d){c.__defineGetter__(b,d)}if(e){c.__defineSetter__(b,e)}}else{c[b]=a[b]}}return c}function b(c,a){return 1e-10<(c>a?c-a:a-c)}function c(a){if(a){this.inputBuffer=new e;this.outputBuffer=new e}else{this.inputBuffer=this.outputBuffer=null}}c.prototype={get inputBuffer(){return this._inputBuffer},set inputBuffer(a){this._inputBuffer=a},get outputBuffer(){return this._outputBuffer},set outputBuffer(a){this._outputBuffer=a},clear:function clear(){this._inputBuffer.clear();this._outputBuffer.clear()}};function d(a){c.call(this,a);this._reset();this.rate=1}a(d.prototype,c.prototype);a(d.prototype,{set rate(a){this._rate=a},_reset:function _reset(){this.slopeCount=0;this.prevSampleL=0;this.prevSampleR=0},process:function process(){var a=this._inputBuffer.frameCount;this._outputBuffer.ensureAdditionalCapacity(a/this._rate+1);var b=this._transpose(a);this._inputBuffer.receive();this._outputBuffer.put(b)},_transpose:function _transpose(a){if(0===a){return 0}var b=this._inputBuffer.vector,c=this._inputBuffer.startIndex,d=this._outputBuffer.vector,e=this._outputBuffer.endIndex,f=0,g=0;while(1>this.slopeCount){d[e+2*g]=(1-this.slopeCount)*this.prevSampleL+this.slopeCount*b[c];d[e+2*g+1]=(1-this.slopeCount)*this.prevSampleR+this.slopeCount*b[c+1];g++;this.slopeCount+=this._rate}this.slopeCount-=1;if(1!=a){out:while(!0){while(1<this.slopeCount){this.slopeCount-=1;f++;if(f>=a-1){break out}}var h=c+2*f;d[e+2*g]=(1-this.slopeCount)*b[h]+this.slopeCount*b[h+2];d[e+2*g+1]=(1-this.slopeCount)*b[h+1]+this.slopeCount*b[h+3];g++;this.slopeCount+=this._rate}}this.prevSampleL=b[c+2*a-2];this.prevSampleR=b[c+2*a-1];return g}});function e(){this._vector=new Float32Array;this._position=0;this._frameCount=0}e.prototype={get vector(){return this._vector},get position(){return this._position},get startIndex(){return 2*this._position},get frameCount(){return this._frameCount},get endIndex(){return 2*(this._position+this._frameCount)},clear:function clear(a){this.receive(a);this.rewind()},put:function put(a){this._frameCount+=a},putSamples:function putSamples(a,b,c){b=b||0;var d=2*b;if(!(0<=c)){c=(a.length-d)/2}var e=2*c;this.ensureCapacity(c+this._frameCount);var f=this.endIndex;this._vector.set(a.subarray(d,d+e),f);this._frameCount+=c},putBuffer:function putBuffer(a,b,c){b=b||0;if(!(0<=c)){c=a.frameCount-b}this.putSamples(a.vector,a.position+b,c)},receive:function receive(a){if(!(0<=a)||a>this._frameCount){a=this._frameCount}this._frameCount-=a;this._position+=a},receiveSamples:function receiveSamples(a,b){var c=this.startIndex;a.set(this._vector.subarray(c,c+2*b));this.receive(b)},extract:function extract(a,b,c){var d=this.startIndex+2*b;a.set(this._vector.subarray(d,d+2*c))},ensureCapacity:function ensureCapacity(a){var b=2*a;if(this._vector.length<b){var c=new Float32Array(b);c.set(this._vector.subarray(this.startIndex,this.endIndex));this._vector=c;this._position=0}else{this.rewind()}},ensureAdditionalCapacity:function ensureAdditionalCapacity(a){this.ensureCapacity(this.frameCount+a)},rewind:function rewind(){if(0<this._position){this._vector.set(this._vector.subarray(this.startIndex,this.endIndex));this._position=0}}};function f(a,b){this._pipe=b;this.sourceSound=a;this.historyBufferSize=22050;this._sourcePosition=0;this.outputBufferPosition=0;this._position=0}f.prototype={get pipe(){return this._pipe},get position(){return this._position},set position(a){if(a>this._position){throw new RangeError("New position may not be greater than current position")}var b=this.outputBufferPosition-(this._position-a);if(0>b){throw new RangeError("New position falls outside of history buffer")}this.outputBufferPosition=b;this._position=a},get sourcePosition(){return this._sourcePosition},set sourcePosition(a){this.clear();this._sourcePosition=a},get inputBuffer(){return this._pipe.inputBuffer},get outputBuffer(){return this._pipe.outputBuffer},fillInputBuffer:function fillInputBuffer(a){var b=new Float32Array(2*a),c=this.sourceSound.extract(b,a,this._sourcePosition);this._sourcePosition+=c;this.inputBuffer.putSamples(b,0,c)},fillOutputBuffer:function fillOutputBuffer(a){while(this.outputBuffer.frameCount<a){var b=16384-this.inputBuffer.frameCount;this.fillInputBuffer(b);if(this.inputBuffer.frameCount<16384){break}this._pipe.process()}},extract:function extract(a,b){this.fillOutputBuffer(this.outputBufferPosition+b);var c=Math.min(b,this.outputBuffer.frameCount-this.outputBufferPosition);this.outputBuffer.extract(a,this.outputBufferPosition,c);var d=this.outputBufferPosition+c;this.outputBufferPosition=Math.min(this.historyBufferSize,d);this.outputBuffer.receive(Math.max(d-this.historyBufferSize,0));this._position+=c;return c},handleSampleData:function handleSampleData(a){this.extract(a.data,4096)},clear:function clear(){this._pipe.clear();this.outputBufferPosition=0}};function g(a,b){c.call(this,a);this.bQuickSeek=!0;this.bMidBufferDirty=!1;this.pMidBuffer=null;this.overlapLength=0;this.bAutoSeqSetting=!0;this.bAutoSeekSetting=!0;this._tempo=1;this.setParameters(b,0,0,8)}a(g.prototype,c.prototype);a(g.prototype,{clear:function clear(){c.prototype.clear.call(this);this._clearMidBuffer()},_clearMidBuffer:function _clearMidBuffer(){if(this.bMidBufferDirty){this.bMidBufferDirty=!1;this.pMidBuffer=null}},setParameters:function setParameters(a,b,c,d){if(0<a){this.sampleRate=a}if(0<d){this.overlapMs=d}if(0<b){this.sequenceMs=b;this.bAutoSeqSetting=!1}else{this.bAutoSeqSetting=!0}if(0<c){this.seekWindowMs=c;this.bAutoSeekSetting=!1}else{this.bAutoSeekSetting=!0}this.calcSeqParameters();this.calculateOverlapLength(this.overlapMs);this.tempo=this._tempo},set tempo(a){var b;this._tempo=a;this.calcSeqParameters();this.nominalSkip=this._tempo*(this.seekWindowLength-this.overlapLength);this.skipFract=0;b=Math.floor(this.nominalSkip+.5);this.sampleReq=Math.max(b+this.overlapLength,this.seekWindowLength)+this.seekLength},get inputChunkSize(){return this.sampleReq},get outputChunkSize(){return this.overlapLength+Math.max(0,this.seekWindowLength-2*this.overlapLength)},calculateOverlapLength:function calculateOverlapLength(a){var b=this.sampleRate*a/1e3;if(16>b)b=16;b-=b%8;this.overlapLength=b;this.pRefMidBuffer=new Float32Array(2*this.overlapLength);this.pMidBuffer=new Float32Array(2*this.overlapLength)},checkLimits:function checkLimits(a,b,c){return a<b?b:a>c?c:a},calcSeqParameters:function calcSeqParameters(){var a,b;if(this.bAutoSeqSetting){a=n-p*l+p*this._tempo;a=this.checkLimits(a,o,n);this.sequenceMs=Math.floor(a+.5)}if(this.bAutoSeekSetting){b=q-s*l+s*this._tempo;b=this.checkLimits(b,r,q);this.seekWindowMs=Math.floor(b+.5)}this.seekWindowLength=Math.floor(this.sampleRate*this.sequenceMs/1e3);this.seekLength=Math.floor(this.sampleRate*this.seekWindowMs/1e3)},set quickSeek(a){this.bQuickSeek=a},seekBestOverlapPosition:function seekBestOverlapPosition(){if(this.bQuickSeek){return this.seekBestOverlapPositionStereoQuick()}else{return this.seekBestOverlapPositionStereo()}},seekBestOverlapPositionStereo:function seekBestOverlapPositionStereo(){var a,b,c,d;this.precalcCorrReferenceStereo();b=Number.MIN_VALUE;a=0;for(d=0;d<this.seekLength;d++){c=this.calcCrossCorrStereo(2*d,this.pRefMidBuffer);if(c>b){b=c;a=d}}return a},seekBestOverlapPositionStereoQuick:function seekBestOverlapPositionStereoQuick(){var a,b,c,d,e,f,g;this.precalcCorrReferenceStereo();c=Number.MIN_VALUE;b=0;f=0;g=0;for(e=0;4>e;e++){a=0;while(k[e][a]){g=f+k[e][a];if(g>=this.seekLength){break}d=this.calcCrossCorrStereo(2*g,this.pRefMidBuffer);if(d>c){c=d;b=g}a++}f=b}return b},precalcCorrReferenceStereo:function precalcCorrReferenceStereo(){var a,b,c;for(a=0;a<this.overlapLength;a++){c=a*(this.overlapLength-a);b=2*a;this.pRefMidBuffer[b]=this.pMidBuffer[b]*c;this.pRefMidBuffer[b+1]=this.pMidBuffer[b+1]*c}},calcCrossCorrStereo:function calcCrossCorrStereo(a,b){var c=this._inputBuffer.vector;a+=this._inputBuffer.startIndex;var d,e,f;d=0;for(e=2;e<2*this.overlapLength;e+=2){f=e+a;d+=c[f]*b[e]+c[f+1]*b[e+1]}return d},overlap:function overlap(a){this.overlapStereo(2*a)},overlapStereo:function overlapStereo(a){var b=this._inputBuffer.vector;a+=this._inputBuffer.startIndex;var c=this._outputBuffer.vector,d=this._outputBuffer.endIndex,e,f,g,h,j,k,l;h=1/this.overlapLength;for(e=0;e<this.overlapLength;e++){g=(this.overlapLength-e)*h;j=e*h;f=2*e;k=f+a;l=f+d;c[l+0]=b[k+0]*j+this.pMidBuffer[f+0]*g;c[l+1]=b[k+1]*j+this.pMidBuffer[f+1]*g}},process:function process(){var a,b,c;if(null===this.pMidBuffer){if(this._inputBuffer.frameCount<this.overlapLength){return}this.pMidBuffer=new Float32Array(2*this.overlapLength);this._inputBuffer.receiveSamples(this.pMidBuffer,this.overlapLength)}while(this._inputBuffer.frameCount>=this.sampleReq){b=this.seekBestOverlapPosition();this._outputBuffer.ensureAdditionalCapacity(this.overlapLength);this.overlap(Math.floor(b));this._outputBuffer.put(this.overlapLength);c=this.seekWindowLength-2*this.overlapLength;if(0<c){this._outputBuffer.putBuffer(this._inputBuffer,b+this.overlapLength,c)}var d=this.inputBuffer.startIndex+2*(b+this.seekWindowLength-this.overlapLength);this.pMidBuffer.set(this._inputBuffer.vector.subarray(d,d+2*this.overlapLength));this.skipFract+=this.nominalSkip;a=Math.floor(this.skipFract);this.skipFract-=a;this._inputBuffer.receive(a)}}});a(g.prototype,{get tempo(){return this._tempo}});function h(a){this.rateTransposer=new d(!1);this.tdStretch=new g(!1,a);this._inputBuffer=new e;this._intermediateBuffer=new e;this._outputBuffer=new e;this._rate=0;this._tempo=0;this.virtualPitch=1;this.virtualRate=1;this.virtualTempo=1;this._calculateEffectiveRateAndTempo()}h.prototype={clear:function clear(){this.rateTransposer.clear();this.tdStretch.clear()},get rate(){return this._rate},set rate(a){this.virtualRate=a;this._calculateEffectiveRateAndTempo()},set rateChange(a){this.rate=1+.01*a},get tempo(){return this._tempo},set tempo(a){this.virtualTempo=a;this._calculateEffectiveRateAndTempo()},set tempoChange(a){this.tempo=1+.01*a},set pitch(a){this.virtualPitch=a;this._calculateEffectiveRateAndTempo()},set pitchOctaves(a){this.pitch=Math.exp(.69314718056*a);this._calculateEffectiveRateAndTempo()},set pitchSemitones(a){this.pitchOctaves=a/12},get inputBuffer(){return this._inputBuffer},get outputBuffer(){return this._outputBuffer},_calculateEffectiveRateAndTempo:function _calculateEffectiveRateAndTempo(){var a=this._tempo,c=this._rate;this._tempo=this.virtualTempo/this.virtualPitch;this._rate=this.virtualRate*this.virtualPitch;if(b(this._tempo,a)){this.tdStretch.tempo=this._tempo}if(b(this._rate,c)){this.rateTransposer.rate=this._rate}if(1<this._rate){if(this._outputBuffer!=this.rateTransposer.outputBuffer){this.tdStretch.inputBuffer=this._inputBuffer;this.tdStretch.outputBuffer=this._intermediateBuffer;this.rateTransposer.inputBuffer=this._intermediateBuffer;this.rateTransposer.outputBuffer=this._outputBuffer}}else{if(this._outputBuffer!=this.tdStretch.outputBuffer){this.rateTransposer.inputBuffer=this._inputBuffer;this.rateTransposer.outputBuffer=this._intermediateBuffer;this.tdStretch.inputBuffer=this._intermediateBuffer;this.tdStretch.outputBuffer=this._outputBuffer}}},process:function process(){if(1<this._rate){this.tdStretch.process();this.rateTransposer.process()}else{this.rateTransposer.process();this.tdStretch.process()}}};function i(a){this.buffer=a}i.prototype={extract:function extract(a,b,c){for(var d=this.buffer.getChannelData(0),e=this.buffer.getChannelData(1),f=0;f<b;f++){a[2*f]=d[f+c];a[2*f+1]=e[f+c]}return Math.min(b,d.length-c)}};return soundtouch={RateTransposer:d,Stretch:g,SimpleFilter:f,SoundTouch:h,WebAudioBufferSource:i,getWebAudioNode:function(a,b){var c=a.createScriptProcessor(4096,2,2),d=new Float32Array(8192);c.onaudioprocess=function(a){var e=a.outputBuffer.getChannelData(0),f=a.outputBuffer.getChannelData(1),g=b.extract(d,4096);if(0===g){c.disconnect()}for(var h=0;h<g;h++){e[h]=d[2*h];f[h]=d[2*h+1]}};return c}}});
//# sourceMappingURL=soundtouch.min.js.map

define ("filter_poodll/dlg_devicesettings",["jquery","core/log","filter_poodll/dlg_poodll"],function(a,b,c){b.debug("Device settings dialog: initialising");return{dlg:null,pmr:null,instanceprops:null,dlgbox:null,mediatype:null,init:function init(a,b){this.dlg=c.clone();this.dlg.setHeader("settings");this.pmr=a;this.instanceprops=b;this.mediatype=b.config.mediatype},clone:function clone(){return a.extend(!0,{},this)},fetch_dialogue_box:function fetch_dialogue_box(){return this.dlg.fetch_dialogue_box("settings")},set_dialogue_box:function set_dialogue_box(a){this.dlgbox=a;this.dlg.set_dialogue_box(a)},open:function open(){var a=this,c=this.instanceprops;navigator.mediaDevices.enumerateDevices().then(function(b){var c=[],d=[];b.forEach(function(a){switch(a.kind){case"audioinput":c.push(a);break;case"videoinput":d.push(a);break;}});var e="<div class=\"devicesettings_select\"><span class=\"devicesettings_select_label\">Audio: </span>"+a.makeSelect(c,"audio")+"</div>",f="<div class=\"devicesettings_select\"><span class=\"devicesettings_select_label\">Video: </span>"+a.makeSelect(d,"video")+"</div>",g="<div class=\"filter_poodll_mediadevices\">";if("video"==a.mediatype){g+=e+"<br>"+f}else{g+=e}g+="</div>";a.dlg.setContent(g);a.registerEvents();if("video"==a.instanceprops.config.mediatype){a.dlg.onclose=function(){a.resetVideoUserInterface()}}a.dlg.open()}).catch(function(a){b.debug(a)})},registerEvents:function registerEvents(){var a=this,b=this.instanceprops,c=b.controlbar.preview[0];if(c){c.pause()}if(b.mediaRecorder){b.mediaRecorder.stop()}this.dlgbox.find(".select_settings_audio").change(function(){a.instanceprops.useraudiodeviceid=this.value});this.dlgbox.find(".select_settings_video").change(function(){a.instanceprops.uservideodeviceid=this.value})},resetVideoUserInterface:function resetVideoUserInterface(){var a=this.instanceprops,c=a.controlbar.preview[0],d=this.pmr,e=d.fetch_video_constraints(a);d.tidy_old_stream(a.controlbarid);navigator.mediaDevices.getUserMedia(e).then(function(b){d.restream_preview_video_player(a.controlbarid,b)}).catch(function(a){b.debug("location 4567");b.debug(a)})},makeSelect:function makeSelect(a,b){if(1==a.length&&""==a[0].label){return"<div>No devices available yet.</div>"}switch(b){case"audio":var c=this.instanceprops.useraudiodeviceid;break;case"video":var c=this.instanceprops.uservideodeviceid;}var d="<select class=\"select_settings_"+b+"\">";a.forEach(function(a){var b="";if(c==a.deviceId){b="selected"}d+="<option value=\""+a.deviceId+"\"  "+b+">"+a.label+"</option>"});d+="</select>";return d}}});
//# sourceMappingURL=dlg_devicesettings.min.js.map

define ("filter_poodll/poodll_shadowmediaskin",["jquery","core/log","filter_poodll/utils_amd"],function(a,b){"use strict";b.debug("PoodLL Shadow Skin: initialising");return{instanceprops:null,pmr:null,uploaded:!1,recorded:!1,mustResetResourcePlayer:!1,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\"></div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_checkplayer_"+a+" \" style=\"display: none;\" controls></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_checkplayer_"+a+"\" width=\"320\" height=\"240\" playsinline=\"playsinline\"></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" src=\"@@RESOURCEURL@@\" playsinline controls></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+"\" style=\"display: none;\" src=\"@@RESOURCEURL@@\"></video>"},fetch_uploader_skin:function fetch_uploader_skin(){return!1},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);this.recorded=!0;this.do_play_resource(b);b.controlbar.resourceplayer.bind("ended",function(){b.controlbar.stopbutton.click()});self.set_visual_mode("recordingmode",b)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.checkplayer.attr("src",null);this.recorded=!0;this.do_play_resource(b);b.controlbar.resourceplayer.bind("ended",function(){b.controlbar.stopbutton.click()});self.set_visual_mode("recordingmode",b)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);this.update_status(a);if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(){},set_visual_mode:function set_visual_mode(a,b){var c=this;switch(a){case"recordingmode":c.disable_button(b.controlbar.startbutton);b.controlbar.startbutton.hide();c.disable_button(b.controlbar.stopplaybackbutton);b.controlbar.stopplaybackbutton.hide();c.disable_button(b.controlbar.resourcestopbutton);b.controlbar.resourcestopbutton.hide();c.enable_button(b.controlbar.stopbutton);b.controlbar.stopbutton.show();c.disable_button(b.controlbar.playbackbutton);b.controlbar.playbackbutton.show();c.disable_button(b.controlbar.resourceplaybutton);b.controlbar.resourceplaybutton.show();break;case"resourceplayingmode":c.disable_button(b.controlbar.stopbutton);b.controlbar.stopbutton.hide();c.disable_button(b.controlbar.playbackbutton);b.controlbar.playbackbutton.hide();c.disable_button(b.controlbar.resourceplaybutton);b.controlbar.resourceplaybutton.hide();c.disable_button(b.controlbar.startbutton);b.controlbar.startbutton.show();c.disable_button(b.controlbar.stopplaybackbutton);b.controlbar.stopplaybackbutton.show();c.enable_button(b.controlbar.resourcestopbutton);b.controlbar.resourcestopbutton.show();break;case"playingbackmode":c.disable_button(b.controlbar.stopbutton);b.controlbar.stopbutton.hide();c.disable_button(b.controlbar.playbackbutton);b.controlbar.playbackbutton.hide();c.disable_button(b.controlbar.resourcestopbutton);b.controlbar.resourcestopbutton.hide();c.disable_button(b.controlbar.startbutton);b.controlbar.startbutton.show();c.enable_button(b.controlbar.stopplaybackbutton);b.controlbar.stopplaybackbutton.show();c.disable_button(b.controlbar.resourceplaybutton);b.controlbar.resourceplaybutton.show();break;case"neverrecordedmode":c.disable_button(b.controlbar.stopbutton);b.controlbar.stopbutton.hide();c.disable_button(b.controlbar.stopplaybackbutton);b.controlbar.stopplaybackbutton.hide();c.disable_button(b.controlbar.resourcestopbutton);b.controlbar.resourcestopbutton.hide();c.enable_button(b.controlbar.startbutton);b.controlbar.startbutton.show();c.disable_button(b.controlbar.playbackbutton);b.controlbar.playbackbutton.show();c.enable_button(b.controlbar.resourceplaybutton);b.controlbar.resourceplaybutton.show();break;case"allstoppedmode":c.disable_button(b.controlbar.stopbutton);b.controlbar.stopbutton.hide();c.disable_button(b.controlbar.stopplaybackbutton);b.controlbar.stopplaybackbutton.hide();c.disable_button(b.controlbar.resourcestopbutton);b.controlbar.resourcestopbutton.hide();c.enable_button(b.controlbar.startbutton);b.controlbar.startbutton.show();c.enable_button(b.controlbar.playbackbutton);b.controlbar.playbackbutton.show();c.enable_button(b.controlbar.resourceplaybutton);b.controlbar.resourceplaybutton.show();break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio";e=e.replace("@@RESOURCEURL@@",g.config.resource);var j="poodll_mediarecorder_size_auto";switch(g.config.size){case"small":j="poodll_mediarecorder_size_small";break;case"big":j="poodll_mediarecorder_size_big";break;case"auto":j="poodll_mediarecorder_size_auto";}var k=this.pmr.fetch_strings(),l="<div class=\"poodll_mediarecorderholder_shadow "+i+" "+j+"\" id=\"holder_"+c+"\">";l+="<div class=\"poodll_mediarecorderbox_shadow\" id=\""+c+"\">";l+="<div class=\"style-holder "+h+"\">";var m=this.fetch_status_bar("shadow");l+=m,l+=d,l+=e,l+="<button type=\"button\" class=\"poodll_mediarecorder_button_shadow poodll_play-resource_shadow\"><span class=\"fa fa-play-circle fa-4x\"></span></button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_shadow poodll_stop-resource_shadow\" style=\"display: none;\"><span class=\"fa fa-stop-circle fa-4x\"></span></button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_shadow poodll_start-recording_shadow\"><span class=\"fa fa-play-circle fa-4x\"></span><hr style=\"color: white\"><span class=\"fa fa-microphone fa-4x\"></span></button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_shadow poodll_stop-recording_shadow pmr_disabled\" style=\"display: none;\" disabled><span class=\"fa fa-stop-circle fa-4x\"></span></button>";l+=" <button type=\"button\" class=\"poodll_mediarecorder_button_shadow poodll_playback-recording_shadow pmr_disabled\" disabled><span class=\"fa fa-play-circle fa-4x\"></span></button>";l+=" <button type=\"button\" class=\"poodll_mediarecorder_button_shadow poodll_stopplayback-recording_shadow\" style=\"display: none;\"><span class=\"fa fa-stop-circle fa-4x\"></span></button>";l+="<div class=\"marker\" style=\"display: none;\"><i class=\"fa fa-check\" aria-hidden=\"true\"></i></div>";l+="</div></div></div>";a(b).prepend(l);var n={marker:a("#"+c+"  .marker"),status:a("#"+c+"  .poodll_status_shadow"),resourceplayer:a("#"+c+"  .poodll_resourceplayer_shadow"),checkplayer:a("#"+c+"  .poodll_checkplayer_shadow"),resourceplaybutton:a("#"+c+"  .poodll_play-resource_shadow"),resourcestopbutton:a("#"+c+"  .poodll_stop-resource_shadow"),startbutton:a("#"+c+"  .poodll_start-recording_shadow"),stopbutton:a("#"+c+"  .poodll_stop-recording_shadow"),playbackbutton:a("#"+c+"  .poodll_playback-recording_shadow"),stopplaybackbutton:a("#"+c+"  .poodll_stopplayback-recording_shadow"),savebutton:a("#"+c+"  .poodll_save-recording_shadow")};return n},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){var c=this,d=this.pmr,e=this.fetch_instanceprops(b);e.controlbar.startbutton.click(function(){d.do_start_audio(e,a)});e.controlbar.stopbutton.click(function(){d.do_stop_audio(e);c.disable_button(this);var a=e.controlbar.resourceplayer;if(a&&a.get(0)){a.get(0).pause()}c.set_visual_mode("allstoppedmode",e);c.do_stop_resource(e)});e.controlbar.playbackbutton.click(function(){c.disable_button(this);e.controlbar.marker.show();var a=e.controlbar.resourceplayer.get(0);d.do_play_audio(e,a);e.mustResetResourcePlayer=!0;e.controlbar.resourceplayer.bind("ended",function(){c.set_visual_mode("allstoppedmode",e)});c.set_visual_mode("playingbackmode",e);c.set_completion(!0,e)});e.controlbar.stopplaybackbutton.click(function(){c.do_stop_resource(e);c.set_visual_mode("allstoppedmode",e)});e.controlbar.resourceplaybutton.click(function(){c.do_play_resource(e);e.controlbar.resourceplayer.bind("ended",function(){if(c.recorded){c.set_visual_mode("allstoppedmode",e)}else{c.set_visual_mode("neverrecordedmode",e)}});c.set_visual_mode("resourceplayingmode",e)});e.controlbar.resourcestopbutton.click(function(){c.do_stop_resource(e);if(c.recorded){c.set_visual_mode("allstoppedmode",e)}else{c.set_visual_mode("neverrecordedmode",e)}});e.controlbar.savebutton.click(function(){c.disable_button(this);if(e.blobs&&0<e.blobs.length){d.do_save_audio(e);c.uploaded=!0;c.disable_button(e.controlbar.startbutton)}else{e.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1});window.onbeforeunload=function(){c.enable_button(e.controlbar.startbutton);var a=e.controlbar.checkplayer;if(a&&a.get(0)){a.get(0).pause()}}},set_completion:function set_completion(a,b){var c=b.controlbar.completioncheck},do_stop_resource:function do_stop_resource(a){console.log("stopped the resource");var b=a.controlbar.resourceplayer.get(0);b.pause();b.currentTime=0;if(a.mustResetResourcePlayer){a.mustResetResourcePlayer=!1;b.src=a.config.resource;b.load()}},do_play_resource:function do_play_resource(a){var b=a.controlbar.resourceplayer.get(0);b.play();b.currentTime=0},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_shadowmediaskin.min.js.map

define ("filter_poodll/poodll_flashrecorder",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/lzloader"],function(a,b,c,d,e){"use strict";b.debug("PoodLL Flash Recorder: initialising");return{instanceprops:[],fetch_instance_props:function fetch_instance_props(a){return this.instanceprops[a]},init_instance_props:function init_instance_props(a){this.instanceprops[a]={savebutton:null,audiodatacontrol:null,config:null,uploader:null}},supports_current_browser:function supports_current_browser(a){var d=c.is_ios(),e=c.is_android();if(d||!a.flashonandroid&&e){return!1}else{if("audio"!=a.mediatype){return!1}b.debug("PoodLL Flash Recorder: supports this browser");return!0}},embed:function embed(b,f){if(1==f.flashmp3_cloudbypass){f.posturl=f.cloudbypassurl;f.filename=!1;f.s3filename=!1;f.using_s3=!1}this.init_instance_props(f.widgetid);var g=this.fetch_instance_props(f.widgetid);g.ie=c.is_ie();if(g.ie){f.flashmp3audio_widgetjson=f.flashmp3audio_widgetjson.replace("sendmethod=post","sendmethod=ajax")}g.config=f;var h=a.parseJSON(f.flashmp3audio_widgetjson);e.embed.swf(h);var i="";if(g.ie){i=" style=\"display: none\" "}var j=f.widgetid+"_savebutton",k="<button id=\""+j+"\" type=\"button\" class=\"poodll_save-recording\""+i+">"+M.util.get_string("recui_save","filter_poodll")+"</button>";a(b).append(k);var l=f.widgetid+"_adc";a(b).prepend("<input type=\"hidden\" name=\"audiodatacontrol\" id=\""+l+"\" value=\"\" />");g.uploader=d.clone();g.uploader.init(b,f);e.embed[f.widgetid].setCanvasAttribute("audiodatacontrol",l);g.savebutton=a("#"+j);g.audiodatacontrol=a("#"+l);this.registerevents(f.widgetid)},registerevents:function registerevents(a){var b=this.fetch_instance_props(a);b.audioblob=!1;b.savebutton.click(function(){var a=atob(b.audiodatacontrol.val()),c=a&&0<a.length;if(!c&&!b.audioblob){b.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"));return!1}if(!b.audioblob&&c){for(var d=[],f=0;f<a.length;f++){d.push(a.charCodeAt(f))}b.audioblob=new Blob([new Uint8Array(d)],{type:"audio/mpeg3"})}b.uploader.uploadBlob(b.audioblob,"audio/mpeg3");e.embed[b.config.widgetid].callMethod("poodllapi.mp3_disable()");b.audiodatacontrol.val("");return!1})}}});
//# sourceMappingURL=poodll_flashrecorder.min.js.map

define ("filter_poodll/dlg_poodll",["jquery","jqueryui","core/log"],function(a,b,c){"use strict";c.debug("Poodll Dialog: initialising");return{dlgbox:null,headertext:"",init:function init(){},clone:function clone(){return a.extend(!0,{},this)},setHeader:function setHeader(a){this.headertext=a},setContent:function setContent(a){this.clear();this.dlgbox.append(a)},clear:function clear(){this.dlgbox.children().last().remove()},open:function open(){this.dlgbox.toggle("slide",{direction:"left"},400)},close:function close(){var a=this;this.dlgbox.toggle("slide",{direction:"left",complete:a.onclose},400)},onclose:function onclose(){},test:function test(){c.debug("hio")},fetch_dialogue_box:function fetch_dialogue_box(a){var b="<div class=\"poodll_dialogue_box poodll_dialogue_box_"+a+" hide\"><div class=\"poodll_close_modal\">";b+="<i class=\"fa fa-window-close\" aria-hidden=\"true\"></div></i>";b+="<div class=\"poodll_dialogue_content\"><strong>"+this.headertext+"</strong></div>";b+="<div class=\"will_be_cleared\"></div></div>";return b},set_dialogue_box:function set_dialogue_box(a){this.dlgbox=a;var b=this;a.find(".poodll_close_modal").click(function(){b.close()})}}});
//# sourceMappingURL=dlg_poodll.min.js.map

define ("filter_poodll/media_refresher",["jquery","core/log"],function(a,b){"use strict";b.debug("Media refresher: initialising");return{placeholderduration:null,mediaduration:null,alertconverted:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c,d){this.placeholderduration=b;this.mediaduration=c;this.alertconverted=d;this.check_updates(a,"firstpass")},should_be_checked:function should_be_checked(c){b.debug("mediaduration: "+this.mediaduration);b.debug("placeholderduration: "+this.placeholderduration);b.debug("fixed to one mediaduration: "+parseFloat(this.mediaduration).toFixed(1));b.debug("fixed to one placeholderduration: "+parseFloat(this.placeholderduration).toFixed(1));if(!a.isNumeric(this.placeholderduration)){return!1}if(!a.isNumeric(this.mediaduration)){return!1}if(parseFloat(this.mediaduration).toFixed(1)!=parseFloat(this.placeholderduration).toFixed(1)){return!1}if(""==c){return!1}return!0},check_updates:function check_updates(a,c){this.should_be_checked(a);if("firstpass"==c&&!this.should_be_checked(a)){return}var d=new XMLHttpRequest,e=this;d.onreadystatechange=function(){if(4===this.readyState){if(200==d.status){var f=d.responseText,g=JSON.parse(f);if(g){switch(g.code){case"mediaready":e.alertconverted();break;case"stillwaiting":setTimeout(function(){e.check_updates(a,"secondpass")},15e3);break;case"notask":if("secondpass"==c){e.alertconverted()}break;case"notloggedin":default:}}}else{b.debug("Not 200 response:"+d.status)}}};d.open("POST",M.cfg.wwwroot+"/filter/poodll/ajaxmediaquery.php",!0);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.setRequestHeader("Cache-Control","no-cache");d.send("filename="+a)}}});
//# sourceMappingURL=media_refresher.min.js.map

define ("filter_poodll/poodll_mobilerecorder",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/poodll_uploadrecorder"],function(a,b,c,d,e){"use strict";b.debug("PoodLL Mobile Recorder: initialising");return{instanceprops:[],fetch_instance_props:function fetch_instance_props(a){return this.instanceprops[a]},init_instance_props:function init_instance_props(a){this.instanceprops[a]={config:null,uploader:null,linkid:null}},supports_current_browser:function supports_current_browser(a){if("audio"!=a.mediatype&&"video"!=a.mediatype){return!1}var b=c.is_ios();return b},embed:function embed(a,b){this.init_instance_props(b.widgetid);var c=this.fetch_instance_props(b.widgetid);c.config=b;c.uploader=d.clone();c.uploader.init(a,b);c.linkid="filter_poodll_mobilerecorder_link_"+b.widgetid;switch(b.mediatype){case"audio":this.insert_upload_button(a,b.widgetid);if(1==b.showmobile){this.insert_audio_button(a,b.widgetid)}break;case"video":this.insert_upload_button(a,b.widgetid);if(1==b.showmobile){this.insert_video_button(a,b.widgetid)}break;}this.register_events(a,b.widgetid);return!0},register_events:function register_events(b,c){var d=this.fetch_instance_props(c),f=d.config,g=this;a("#"+d.linkid).on("mousedown touchstart",function(){g.confirm_s3_arrival(c);d.uploader.Output(M.util.get_string("recui_awaitingconfirmation","filter_poodll"))});a("#"+d.linkid+"_uploadafile").on("mousedown touchstart",function(){a(b).empty();e.embed(b,f)})},insert_video_button:function insert_video_button(b,c){var d=this.fetch_instance_props(c),e="<a class =\"filter_poodll_mobilerecorderlink\" id=\""+d.linkid+"\" href=\"poodllrecorder://?presignedurl="+encodeURIComponent(d.config.quicktimesignedurl)+"&type="+d.config.mediatype+"&quality="+d.config.mobilequality+"&camera="+d.config.mobilecamera+"&timelimit="+d.config.timelimit+"\">"+M.util.get_string("recui_openrecorderapp","filter_poodll")+"</a>";a(b).prepend(e)},insert_audio_button:function insert_audio_button(b,c){var d=this.fetch_instance_props(c),e="<a class =\"filter_poodll_mobilerecorderlink\"  id=\""+d.linkid+"\" href=\"poodllrecorder://?presignedurl="+encodeURIComponent(d.config.posturl)+"&type="+d.config.mediatype+"&quality="+d.config.mobilequality+"&camera="+d.config.mobilecamera+"&timelimit="+d.config.timelimit+"\">"+M.util.get_string("recui_openrecorderapp","filter_poodll")+"</a>";a(b).prepend(e)},insert_upload_button:function insert_upload_button(b,c){var d=this.fetch_instance_props(c),e="<a class =\"filter_poodll_uploadafilelink\" id=\""+d.linkid+"_uploadafile\" href=\"#\">"+M.util.get_string("recui_uploadafile","filter_poodll")+"</a>";a(b).prepend(e)},confirm_s3_arrival:function confirm_s3_arrival(a){var b=this.fetch_instance_props(a),c=new XMLHttpRequest,d=b.config,e=d.wwwroot+"/filter/poodll/poodllfilelib.php",f="datatype=confirmarrival";f+="&mediatype="+d.mediatype;f+="&filename="+d.filename;c.open("POST",e,!0);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.setRequestHeader("Cache-Control","no-cache");c.setRequestHeader("Content-length",f.length);c.setRequestHeader("Connection","close");c.addEventListener("load",function(){if(c.response&&0<c.response.indexOf(d.filename)){b.uploader.pokeFilename(d.filename,b.uploader);b.uploader.postprocess_s3_upload(b.uploader);b.uploader.Output(M.util.get_string("recui_uploadsuccess","filter_poodll"));b.uploader.doCallback(b.uploader,d.filename)}else{setTimeout(function(){c.open("POST",e,!0);c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.setRequestHeader("Cache-Control","no-cache");c.setRequestHeader("Content-length",f.length);c.setRequestHeader("Connection","close");c.send(f)},2e3)}});c.send(f)}}});
//# sourceMappingURL=poodll_mobilerecorder.min.js.map

define ("filter_poodll/poodll_bmrmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/dlg_devicesettings","filter_poodll/anim_progress_bar","filter_poodll/upskin_bar"],function(a,b,c,d,e,f,g){"use strict";c.debug("PoodLL BMR Skin: initialising");return{instanceprops:null,pmr:null,uploaded:!1,devsettings:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=e.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+" hide\" controls playsinline=\"playsinline\" muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_preview_"+a+"\" playsinline=\"playsinline\" muted></video>"},fetch_resource_audio:function fetch_resource_audio(){return""},fetch_resource_video:function fetch_resource_video(){return""},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(a),d=g.clone();d.init(c.config,b,c.controlbar.bmr_progresscanvas,c.controlbar.status);return d},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);b.uploader.Output("");this.set_visual_mode("recordmode",a);b.timer.reset();b.timer.start();this.update_status(a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.uploader.Output("");b.controlbar.preview.attr("src",null);this.set_visual_mode("recordmode",a);b.timer.reset();b.timer.start();this.update_status(a)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},set_visual_mode:function set_visual_mode(a,b){var c=this,d=this.fetch_instanceprops(b);this.visualmode=a;switch(a){case"recordmode":c.disable_button(d.controlbar.startbutton);c.show_element(d.controlbar.startbutton);c.hide_element(d.controlbar.bmr_progresscanvas);c.enable_button(d.controlbar.pausebutton);c.show_element(d.controlbar.pausebutton);c.disable_button(d.controlbar.playbutton);c.hide_element(d.controlbar.resumebutton);c.enable_button(d.controlbar.stopbutton);c.disable_button(d.controlbar.savebutton);d.controlbar.preview.addClass("poodll_recording");d.controlbar.status.addClass("poodll_recording");if("audio"==d.config.mediatype){c.hide_element(d.controlbar.preview)}break;case"previewmode":c.disable_button(d.controlbar.stopbutton);c.enable_button(d.controlbar.playbutton);c.disable_button(d.controlbar.pausebutton);c.enable_button(d.controlbar.savebutton);d.controlbar.status.html(d.timer.fetch_display_time(d.timer.finalSeconds));c.show_element(d.controlbar.startbutton);c.disable_button(d.controlbar.resumebutton);c.hide_element(d.controlbar.resumebutton);c.hide_element(d.controlbar.bmr_progresscanvas);if(!c.uploaded){c.enable_button(d.controlbar.startbutton);c.enable_button(d.controlbar.savebutton)}c.show_element(d.controlbar.pausebutton);d.controlbar.preview.removeClass("poodll_recording");d.controlbar.status.removeClass("poodll_recording");if("audio"==d.config.mediatype){c.show_element(d.controlbar.preview)}c.enable_button(d.controlbar.playbutton);break;case"playmode":d.controlbar.status.html("00:00:00");c.disable_button(d.controlbar.playbutton);c.enable_button(d.controlbar.stopbutton);c.disable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.resumebutton);c.disable_button(d.controlbar.playbutton);c.show_element(d.controlbar.bmr_progresscanvas);c.show_element(d.controlbar.startbutton);c.hide_element(d.controlbar.resumebutton);break;case"pausedmode":c.disable_button(d.controlbar.pausebutton);c.hide_element(d.controlbar.startbutton);c.show_element(d.controlbar.resumebutton);c.enable_button(d.controlbar.resumebutton);c.enable_button(d.controlbar.savebutton);d.controlbar.preview.removeClass("poodll_recording");d.controlbar.status.removeClass("poodll_recording");break;case"uploadmode":c.disable_button(d.controlbar.savebutton);c.disable_button(d.controlbar.startbutton);c.show_element(d.controlbar.bmr_progresscanvas);break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="poodll_mediarecorder_size_auto";switch(g.config.size){case"small":i="poodll_mediarecorder_size_small";break;case"big":i="poodll_mediarecorder_size_big";break;case"auto":i="poodll_mediarecorder_size_auto";}var j=this.pmr.fetch_strings(),k=g.showupload?"":"hide",l="video"==f?"fa-video-camera":"fa-microphone",m="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",n="<div class=\"poodll_mediarecorderholder_bmr poodll_videorecorderholder_bmr "+m+" "+i+"\" id=\"holder_"+c+"\">";n+="<div class=\"poodll_mediarecorderbox_bmr\" id=\""+c+"\">";n+="<audio style=\"display: none !important;\" class=\"poodll-alert-recording\" id=\""+c+"\"><source src=\"https://poodll.com/wp-content/themes/Poodll-Theme/images/ding.mp3\" type=\"audio/mpeg\"></audio>";n+="<div class=\"style-holder "+h+"\">";n+="<div class=\"poodll_statusholder_bmr\" >";n+="<canvas class=\"bmr_range\"></canvas>";var o=this.fetch_status_bar("bmr");n+=o;n+="</div>";n+=d,n+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";n+="<button type=\"button\" class=\"poodll_mediarecorder_button_bmr poodll_start-recording_bmr\"><i class=\"fa "+l+"\" aria-hidden=\"true\"></i></button>";n+=" <button type=\"button\" class=\"poodll_mediarecorder_button_bmr poodll_resume-recording_bmr bmr_disabled hide\" disabled><i class=\"fa "+l+"\" aria-hidden=\"true\"></i></button>";n+="<button type=\"button\" class=\"poodll_mediarecorder_button_bmr poodll_stop-recording_bmr bmr_disabled\" disabled><i class=\"fa fa-stop\" aria-hidden=\"true\"></i></button>";n+="<button type=\"button\" class=\"poodll_mediarecorder_button_bmr poodll_pause-recording_bmr bmr_disabled\" disabled><i class=\"fa fa-pause\" aria-hidden=\"true\"></i></button>";n+=" <button type=\"button\" class=\"poodll_mediarecorder_button_bmr poodll_play-recording_bmr bmr_disabled\" disabled><i class=\"fa fa-play\" aria-hidden=\"true\"></i></button>";n+="<button type=\"button\" class=\"poodll_save-recording_bmr "+k+"\" disabled>"+j.recui_save+"</button>";n+="</div>";n+=this.devsettings.fetch_dialogue_box();n+=g.downloaddialog.fetch_dialogue_box();n+=g.errordialog.fetch_dialogue_box();n+="</div>";n+="</div>";a(b).prepend(n);var p={poodll_recording_alert:a("#"+c+" .poodll-alert-recording"),bmr_progresscanvas:a("#"+c+" .bmr_range"),settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),status:a("#"+c+" .poodll_status_bmr"),preview:a("#"+c+" .poodll_preview_bmr"),startbutton:a("#"+c+" .poodll_start-recording_bmr"),stopbutton:a("#"+c+" .poodll_stop-recording_bmr"),pausebutton:a("#"+c+" .poodll_pause-recording_bmr"),resumebutton:a("#"+c+" .poodll_resume-recording_bmr"),playbutton:a("#"+c+" .poodll_play-recording_bmr"),savebutton:a("#"+c+" .poodll_save-recording_bmr")};g.downloaddialog.set_dialogue_box(p.downloaddialog);g.errordialog.set_dialogue_box(p.errorsdialog);this.devsettings.set_dialogue_box(p.settingsdialog);return p},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){var c=this,d=this.pmr,e=this.fetch_instanceprops(b);e.controlbar.settingsicon.click(function(){if(!c.uploaded){c.devsettings.open()}else{e.downloaddialog.open()}});var g=f.clone();g.init(e.controlbar.bmr_progresscanvas);e.controlbar.startbutton.click(function(){d.do_start_audio(e,a)});e.controlbar.stopbutton.click(function(){d.do_stop_audio(e);var a=e.controlbar.preview;if(a&&a.get(0)){a.get(0).pause()}e.timer.stop();c.update_status(b);c.set_visual_mode("previewmode",b)});e.controlbar.pausebutton.click(function(){d.do_pause_audio(e);e.timer.pause();c.update_status(b);c.set_visual_mode("pausedmode",b)});e.controlbar.resumebutton.click(function(){d.do_resume_audio(e);e.timer.resume();c.update_status(b);c.set_visual_mode("recordmode",b)});e.controlbar.preview.on("timeupdate",function(){if("playmode"!=c.visualmode){return}var a=this.currentTime;e.controlbar.status.html(e.timer.fetch_display_time(a))});e.controlbar.playbutton.click(function(){var a=e.controlbar.preview.get(0);d.do_play_audio(e,a);c.set_visual_mode("playmode",b);g.clear();g.fetchCurrent=function(){var a=e.controlbar.preview.prop("currentTime"),b=e.controlbar.preview.prop("duration");if(!isFinite(b)){b=e.timer.finalseconds}return a/b};g.start()});e.controlbar.savebutton.click(function(){if(e.blobs&&0<e.blobs.length){c.set_visual_mode("uploadmode",b);d.do_save_audio(e);c.uploaded=!0}else{e.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1});window.onbeforeunload=function(){c.enable_button(e.controlbar.startbutton);var a=e.controlbar.preview;if(a&&a.get(0)){a.get(0).pause();a.get(0).controls=!1}}},show_element:function show_element(b){a(b).removeClass("hide");a(b).show()},hide_element:function hide_element(b){a(b).addClass("hide");a(b).hide()},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("bmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("bmr_disabled")}}});
//# sourceMappingURL=poodll_bmrmediaskin.min.js.map

define ("filter_poodll/poodll_mediaskins",["jquery","core/log","filter_poodll/poodll_basemediaskin","filter_poodll/poodll_onetwothreemediaskin","filter_poodll/poodll_goldmediaskin","filter_poodll/poodll_bmrmediaskin","filter_poodll/poodll_shadowmediaskin","filter_poodll/poodll_splitmediaskin","filter_poodll/poodll_fbmediaskin","filter_poodll/poodll_pushmediaskin","filter_poodll/poodll_readaloudmediaskin","filter_poodll/poodll_readseedmediaskin","filter_poodll/poodll_oncemediaskin","filter_poodll/poodll_freshmediaskin","filter_poodll/poodll_uploadmediaskin","filter_poodll/poodll_warningmediaskin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){"use strict";b.debug("PoodLL Media Skins: initialising");return{fetch_skin_clone:function fetch_skin_clone(a){var b="";switch(a){case"onetwothree":b=d.clone();break;case"gold":b=e.clone();break;case"burntrose":case"bmr":b=f.clone();break;case"fluencybuilder":b=i.clone();break;case"push":b=j.clone();break;case"readaloud":b=k.clone();break;case"readseed":b=l.clone();break;case"shadow":b=g.clone();break;case"split":b=h.clone();break;case"once":b=m.clone();break;case"fresh":b=n.clone();break;case"upload":b=o.clone();break;case"warning":b=p.clone();break;case"plain":case"standard":default:b=c.clone();}return b}}});
//# sourceMappingURL=poodll_mediaskins.min.js.map

define ("filter_poodll/poodll_flashsnapshotrecorder",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/lzloader"],function(a,b,c,d,e){"use strict";b.debug("PoodLL Flash Snapshot Recorder: initialising");return{savebutton:null,snapshotdatacontrol:null,supports_current_browser:function supports_current_browser(a){var d=c.is_ios(),e=c.is_android();if(d||!a.flashonandroid&&e){return!1}else{if("snapshot"!=a.mediatype){return!1}b.debug("PoodLL Flash Snapshot Recorder: supports this browser");return!0}},embed:function embed(b,c){var d=a.parseJSON(c.flashsnapshot_widgetjson);e.embed.swf(d)}}});
//# sourceMappingURL=poodll_flashsnapshotrecorder.min.js.map

define ("filter_poodll/poodll_mediarecorder",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/adapter","filter_poodll/uploader","filter_poodll/hermes","filter_poodll/timer","filter_poodll/audioanalyser","filter_poodll/msr_poodll","filter_poodll/dlg_errordisplay","filter_poodll/dlg_download","filter_poodll/speech_poodll","filter_poodll/poodll_mediaskins"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";b.debug("PoodLL Media Recorder: initialising");return{instanceprops:[],skins:[],laststream:[],fetch_instanceprops:function fetch_instanceprops(a){return this.instanceprops[a]},fetch_skin:function fetch_skin(a){return this.skins[a]},is_ios:function is_ios(){return c.is_ios()},supports_current_browser:function supports_current_browser(a){var d=0==M.cfg.wwwroot.indexOf("https:")||0==M.cfg.wwwroot.indexOf("http://localhost");if(!d){return!1}if("audio"!=a.mediatype&&"video"!=a.mediatype){return!1}var e=c.can_html5_record(a.mediatype);if(e){b.debug("PoodLL Media Recorder: supports this browser")}return e},xxxxsupports_current_browser:function xxxxsupports_current_browser(a){if("audio"!=a.mediatype&&"video"!=a.mediatype){return!1}var d=0==M.cfg.wwwroot.indexOf("https:")||0==M.cfg.wwwroot.indexOf("http://localhost");if(d&&navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var e=!1;switch(a.mediatype){case"audio":if(c.is_safari()&&!c.is_ios()&&!a.html5ondsafari){e=!1}else{e=!0}break;case"video":var f=-1!==c.is_edge()&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),g=c.is_safari();if(!f&&!g){e=!0}}if(e){b.debug("PoodLL Media Recorder: supports this browser")}return e}else{return!1}},embed:function embed(a,c){var d=this,h="filter_poodll_controlbar_"+c.widgetid;this.init_instance_props(h);var i=this.fetch_instanceprops(h);i.config=c;i.controlbarid=h;if(c.hideupload){i.showupload=!1}else{i.showupload=!0}i.timeinterval=c.media_timeinterval;i.audiomimetype=c.media_audiomimetype;i.videorecordertype=c.media_videorecordertype;i.videocaptureheight=c.media_videocaptureheight;i.errordialog=j.clone();i.errordialog.init(i);i.downloaddialog=k.clone();i.downloaddialog.init(this,i);i.config.hermes=f.clone();i.config.hermes.init(c.id,c.allowedURL,c.iframeembed);var l=this.init_skin(h,i.config.media_skin,i);if(i.config.speechevents&&i.speechrec.will_work_ok(i.config)){if(!i.config.language){i.config.language="en-US"}i.speechrec.init(i.config);i.speechrec.onfinalspeechcapture=function(a,b){i.config.hermes.postMessage({type:"speech",capturedspeech:a,speechresults:b});if(l.hasOwnProperty("onfinalspeechcapture")){l.onfinalspeechcapture(a,b)}}}else{b.debug("turning off speech events. not req. or not supported.");i.config.speechevents=!1}i.config.onuploadsuccess=function(a){d.onUploadSuccess(a,l)};i.config.onuploadfailure=function(a){d.onUploadFailure(a,l)};switch(c.mediatype){case"audio":var m=l.fetch_preview_audio(c.media_skin),n=l.fetch_resource_audio(c.media_skin);i.controlbar=this.fetch_controlbar_audio(a,h,m,n);i.uploader=e.clone();var o=l.fetch_uploader_skin(i.controlbarid,a);i.uploader.init(a,c,o);this.register_events_audio(h);if("upload"==i.config.media_skin||"warning"==i.config.media_skin){break}navigator.mediaDevices.getUserMedia({audio:!0}).then(function(){b.debug("successfully forced permissions and got user media")}).catch(function(a){b.debug("location 9998");b.debug(a);i.errordialog.open(a)});break;case"video":var m=l.fetch_preview_video(c.media_skin),n=l.fetch_resource_video(c.media_skin);i.controlbar=this.fetch_controlbar_video(a,h,m,n);i.uploader=e.clone();var o=l.fetch_uploader_skin(i.controlbarid,a);i.uploader.init(a,c,o);this.register_events_video(h);if("upload"==i.config.media_skin||"warning"==i.config.media_skin){break}navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(function(a){d.restream_preview_video_player(h,a)}).catch(function(a){b.debug("location 9999");b.debug(a)});break;}i.timer=g.clone();i.timer.init(i.config.timelimit,function(){l.handle_timer_update(h)});l.handle_timer_update(h);return l},init_instance_props:function init_instance_props(a){this.instanceprops[a]={};this.instanceprops[a].recorded_index=0;this.instanceprops[a].mediaRecorder=null;this.instanceprops[a].blobs=[];this.instanceprops[a].timeinterval=5e3;this.instanceprops[a].audiomimetype="audio/webm";this.instanceprops[a].videorecordertype="auto";this.instanceprops[a].videocapturewidth=320;this.instanceprops[a].videocaptureheight=240;this.instanceprops[a].controlbar="";this.instanceprops[a].previewvolume=1;this.instanceprops[a].timer={};this.instanceprops[a].timer={};this.instanceprops[a].showupload=!0;this.instanceprops[a].uploader={};this.instanceprops[a].uploaded=!1;this.instanceprops[a].useraudiodeviceid=!1;this.instanceprops[a].uservideodeviceid=!1;this.instanceprops[a].devices=[];var c=window.AudioContext||window.webkitAudioContext||!1;if("undefined"==typeof window.poodllmediarecorder_actx){var d=new c;window.poodllmediarecorder_actx=d;window.poodllmediarecorder_actx_cnt=1}else if(6==window.poodllmediarecorder_actx_cnt){var d=window.poodllmediarecorder_actx;b.debug("More than 6 contexts, reusing first one. visualizations might go weird")}else{var d=new c;window.poodllmediarecorder_actx_cnt+=1}this.instanceprops[a].audioctx=d;var e=h.clone();e.init(d);this.instanceprops[a].audioanalyser=e;this.instanceprops[a].previewstillcold=!0;this.instanceprops[a].speechrec=l.clone()},init_skin:function init_skin(a,b,c){this.skins[a]=m.fetch_skin_clone(b);this.skins[a].init(c,this);return this.skins[a]},onUploadSuccess:function onUploadSuccess(a,c){b.debug("from poodllmediarecorder: uploadsuccess");c.onUploadSuccess("filter_poodll_controlbar_"+a)},onUploadFailure:function onUploadFailure(a,c){b.debug("from poodllmediarecorder: uploadfailure");c.onUploadFailure("filter_poodll_controlbar_"+a);c.fetch_instanceprops().downloaddialog.open(c.pmr,c.instanceprops)},onMediaError:function onMediaError(a,c){c.errordialog.open(a);b.error("media error",a)},captureUserMedia:function captureUserMedia(a,b,c){navigator.mediaDevices.getUserMedia(a).then(b).catch(c)},warmup_context:function warmup_context(a){var b=a.audioctx;if("suspended"==b.state){b.resume()}var c=b.createBuffer(1,1,22050),d=b.createBufferSource();d.buffer=c;d.connect(b.destination);d.start(0)},warmup_preview:function warmup_preview(a){var c=a.controlbar.preview;if(a.previewstillcold&&c&&c.get(0)){var d=a.controlbar.preview[0].play();if(d!==void 0){d.then(function(){}).catch(function(a){b.debug(a)})}a.previewstillcold=!1}},do_start_audio:function do_start_audio(a,b){var c=this;this.warmup_context(a);this.warmup_preview(a);a.controlbar.preview[0].muted=!0;a.blobs=[];switch(a.config.mediatype){case"audio":var d=this.fetch_audio_constraints(a);break;case"video":var d=this.fetch_video_constraints(a);}this.tidy_old_stream(a.controlbarid);this.captureUserMedia(d,b,function(b){c.onMediaError(b,a)})},do_start_video:function do_start_video(){},do_stopplay_audio:function do_stopplay_audio(a,b){b.pause();b.muted=!1;switch(a.config.mediatype){case"audio":break;case"video":if(a.controlbar.hasOwnProperty("livepreview")){a.controlbar.preview.hide();a.controlbar.preview=a.controlbar.livepreview;a.controlbar.preview.show()}}},do_play_audio:function do_play_audio(d){if(d.blobs&&0<d.blobs.length){b.debug("playing type:"+d.blobs[0].type);c.doConcatenateBlobs(d.blobs,function(c){b.debug(c);var e=URL.createObjectURL(c);switch(d.config.mediatype){case"audio":var f=d.controlbar.preview[0];break;case"video":d.controlbar.livepreview=d.controlbar.preview;d.controlbar.preview=d.controlbar.preview.clone().insertAfter(d.controlbar.preview);var f=d.controlbar.preview[0];d.controlbar.livepreview.hide();}f.src=e;f.controls=!1;f.volume=d.previewvolume;f.muted=!1;a(f).bind("ended",function(){d.controlbar.stopbutton.click()});var g=f.play();if(g!==void 0){g.then(function(){}).catch(function(a){b.debug("location: do_play_audio");b.debug(a)})}})}},do_play_video:function do_play_video(){},do_save_audio:function do_save_audio(a){if(a.blobs&&0<a.blobs.length){c.doConcatenateBlobs(a.blobs,function(b){a.uploader.uploadBlob(b,a.blobs[0].type)});a.uploaded=!0;a.controlbar.startbutton.attr("disabled",!0)}},do_save_video:function do_save_video(){},do_stop_audio:function do_stop_audio(a){a.mediaRecorder.resume();a.mediaRecorder.stop();if(a.config.speechevents){a.speechrec.stop()}a.config.hermes.postMessage({type:"recording",action:"stopped"})},do_stop_video:function do_stop_video(){},do_pause_audio:function do_pause_audio(a){a.mediaRecorder.resume();a.mediaRecorder.pause()},do_pause_video:function do_pause_video(){},do_resume_audio:function do_resume_audio(a){a.mediaRecorder.resume()},do_resume_video:function do_resume_video(){},fetch_video_constraints:function fetch_video_constraints(a){var b={audio:!c.is_opera()&&!c.is_edge(),video:!0};if(a.uservideodeviceid){var d=a.uservideodeviceid.valueOf(),e={deviceId:d?{exact:d}:void 0};b.video=e}if(a.useraudiodeviceid){var f=a.useraudiodeviceid.valueOf(),e={deviceId:f?{exact:f}:void 0};b.audio=e}return b},fetch_audio_constraints:function fetch_audio_constraints(a){var b={audio:!0};if(c.is_safari()&&!a.useraudiodeviceid){a.audiomimetype="audio/wav"}if(a.useraudiodeviceid){var d={deviceId:a.useraudiodeviceid};b.audio=d}return b},register_events_audio:function register_events_audio(a){var c=this,d=this.fetch_instanceprops(a),e=this.skins[a];e.register_controlbar_events_audio(function onMediaSuccess(f){c.laststream[a]=f;var g="auto";if(d.config.hasOwnProperty("encoder")){g=d.config.encoder}d.mediaRecorder=i;d.mediaRecorder.init(f,d.audioctx,d.audioanalyser,d.config.mediatype,g);d.mediaRecorder.mimeType=d.audiomimetype;d.mediaRecorder.audioChannels=1;d.mediaRecorder.start(d.timeinterval,d.audioctx);d.mediaRecorder.ondataavailable=function(a){b.debug(a);d.blobs.push(a)};d.config.hermes.postMessage({type:"recording",action:"started"});if(d.config.speechevents){d.speechrec.start(f)}e.onMediaSuccess_audio(a)},a)},register_events_video:function register_events_video(a){var b=this,c=this.fetch_instanceprops(a),d=this.skins[a];d.register_controlbar_events_video(function onMediaSuccess(e){b.restream_preview_video_player(a,e);var f="auto";if(c.config.hasOwnProperty("encoder")){f=c.config.encoder}c.mediaRecorder=i;c.mediaRecorder.init(e,c.audioctx,c.audioanalyser,c.config.mediatype,f);if("mediarec"===c.videorecordertype){c.mediaRecorder.recorderType=MediaRecorderWrapper}c.mediaRecorder.videoWidth=c.videocapturewidth;c.mediaRecorder.videoHeight=c.videocaptureheight;c.mediaRecorder.start(c.timeinterval);c.mediaRecorder.ondataavailable=function(a){c.blobs.push(a)};c.config.hermes.postMessage({type:"recording",action:"started"});if(c.config.speechevents){c.speechrec.start(e)}d.onMediaSuccess_video(a)},a)},tidy_old_stream:function tidy_old_stream(a){if(this.laststream[a]){this.laststream[a].getTracks().forEach(function(a){a.stop()})}},restream_preview_video_player:function restream_preview_video_player(a,b){this.laststream[a]=b;this.init_video_preview(a);if(c.is_android()){navigator.mediaDevices.enumerateDevices()}},init_video_preview:function init_video_preview(a){var c=this.fetch_instanceprops(a),d=c.controlbar.preview[0];d.srcObject=this.laststream[a];d.controls=!1;d.volume=0;var e=d.play();if(e!==void 0){e.then(function(){}).catch(function(a){b.debug("location: init_video_preview");b.debug(a)})}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},fetch_controlbar_audio:function fetch_controlbar_audio(a,b,c,d){var e=this.fetch_instanceprops(b),f=this.fetch_skin(b),g=f.insert_controlbar_audio(a,b,c,d);return g},fetch_controlbar_video:function fetch_controlbar_video(a,b,c,d){var e=this.fetch_instanceprops(b),f=this.fetch_skin(b),g=f.insert_controlbar_video(a,b,c,d);return g},fetch_strings:function fetch_strings(){var b=[];a.each(["record","play","pause","continue","stop","save","restart","testmic","upload","recordagain","readytorecord","downloadfile"],function(a,c){b["recui_"+c]=M.util.get_string("recui_"+c,"filter_poodll");if(1<b["recui_"+c].indexOf(",filter_poodll]]")||""==b["recui_"+c]){b["recui_"+c]=c}});return b}}});
//# sourceMappingURL=poodll_mediarecorder.min.js.map

define ("filter_poodll/poodll_readaloudmediaskin",["jquery","jqueryui","core/log","filter_poodll/utils_amd","filter_poodll/upskin_radial","filter_poodll/anim_hwave_mic","filter_poodll/dlg_devicesettings"],function(a,b,c,d,e,f,g){"use strict";c.debug("PoodLL Read Aloud Skin: initialising");return{instanceprops:null,pmr:null,devsettings:null,therecanim:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b;this.devsettings=g.clone();this.devsettings.init(b,a)},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\" width=\"320\" height=\"50\">00:00:00</div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_preview_"+a+" hide\" playsInline muted></audio>"},fetch_preview_video:function fetch_preview_video(a){return this.fetch_preview_audio(a)},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+" hide\" ></audio>"},fetch_resource_video:function fetch_resource_video(a){return this.fetch_resource_audio(a)},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){this.fetch_instanceprops(a);this.set_visual_mode("recordingmode",a)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.preview.attr("src",null);b.uploader.Output("");this.therecanim.start();b.timer.reset();b.timer.start();this.update_status(a);this.set_visual_mode("recordingmode",a)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(a){var b=this.fetch_instanceprops(a);b.controlbar.status.html(b.timer.fetch_display_time())},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(a),d=e.clone();d.init(c.config,b,c.controlbar.playcanvas,c.controlbar.status);return d},set_visual_mode:function set_visual_mode(a,b){var c=this,d=this.fetch_instanceprops(b);switch(a){case"startmode":d.controlbar.status.hide();c.disable_button(d.controlbar.startbutton);c.enable_button(d.controlbar.testbutton);c.disable_button(d.controlbar.stopbutton);c.therecanim.clear();break;case"readymode":d.controlbar.status.hide();c.enable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.testbutton);c.disable_button(d.controlbar.stopbutton);c.therecanim.clear();break;case"recordingmode":if("1"==d.config.allowearlyexit&&d.timer.enabled){c.enable_button(d.controlbar.stopbutton)}c.disable_button(d.controlbar.startbutton);d.controlbar.status.hide();break;case"aftermode":c.disable_button(d.controlbar.startbutton);c.disable_button(d.controlbar.stopbutton);d.controlbar.status.show();break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){return this.prepare_controlbar_audio(a,b,c,d)},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d){var e=this.fetch_instanceprops(c),f=e.config.media_skin_style,g=this.pmr.fetch_strings(),h=M.util.get_string("recui_startactivity","filter_poodll"),i=M.util.get_string("recui_testmic","filter_poodll"),j=M.util.get_string("recui_stop","filter_poodll"),k=this.fetch_status_bar("readaloud"),l="<div class=\"poodll_mediarecorderholder_readaloud "+"poodll_mediarecorder_audio"+"\" id=\"holder_"+c+"\">";l+="<div class=\"poodll_mediarecorderbox_readaloud\" id=\""+c+"\">";l+=this.devsettings.fetch_dialogue_box();l+=e.downloaddialog.fetch_dialogue_box();l+=e.errordialog.fetch_dialogue_box();l+="<div class=\"style-holder "+f+"\">";l+=d,l+="<div class=\"settingsicon\" id=\"settingsicon_"+c+"\"><button type=\"button\" class=\"btn btn-info btn-lg\" data-toggle=\"modal\" data-target=\"#myModal\"><i class=\"fa fa-cogs\" aria-hidden=\"true\"></i></button></div>";l+="<canvas id=\""+c+"_playcanvas\" width=\"250\" height=\"120\"></canvas>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_readaloud poodll_start-recording_readaloud\">"+h+"</button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_readaloud poodll_test-recording_readaloud\">"+i+"</button>";l+="<button type=\"button\" class=\"poodll_mediarecorder_button_readaloud poodll_stop-recording_readaloud\">"+j+"</button>";l+=k,l+="</div></div></div>";a(b).prepend(l);var m={settingsdialog:a("#"+c+" .poodll_dialogue_box_settings"),downloaddialog:a("#"+c+" .poodll_dialogue_box_download"),errorsdialog:a("#"+c+" .poodll_dialogue_box_errors"),settingsicon:a("#"+c+" .settingsicon"),status:a("#"+c+" .poodll_status_readaloud"),preview:a("#"+c+" .poodll_preview_readaloud"),startbutton:a("#"+c+" .poodll_start-recording_readaloud"),testbutton:a("#"+c+" .poodll_test-recording_readaloud"),stopbutton:a("#"+c+" .poodll_stop-recording_readaloud"),playcanvas:a("#"+c+"_playcanvas")};e.downloaddialog.set_dialogue_box(m.downloaddialog);e.errordialog.set_dialogue_box(m.errorsdialog);this.devsettings.set_dialogue_box(m.settingsdialog);return m},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){var c=this,d=this.pmr,e=this.fetch_instanceprops(b);e.config.recanim="hwave_mic";var g=f.clone();c.therecanim=g;g.init(e.audioanalyser,e.controlbar.playcanvas.get(0));this.set_visual_mode("startmode",b);e.controlbar.testbutton.click(function(){e.config.hermes.disable();e.timer.disable();d.do_start_audio(e,a);setTimeout(function testover(){d.do_stop_audio(e);g.clear();if(g.sounddetected){c.set_visual_mode("readymode",b)}},4e3)});e.controlbar.settingsicon.click(function(){if(!c.uploaded){c.devsettings.open()}else{e.downloaddialog.open()}});e.controlbar.startbutton.click(function(){e.config.hermes.enable();e.timer.enable();d.do_start_audio(e,a)});e.controlbar.stopbutton.click(function(){d.do_stop_audio(e);g.clear();e.timer.stop();c.update_status(b);var a=function(){if(e.blobs&&0<e.blobs.length){d.do_save_audio(e);e.uploaded=!0;c.disable_button(e.controlbar.startbutton)}else{setTimeout(a,200)}};setTimeout(a,200);c.set_visual_mode("aftermode",b)});window.onbeforeunload=function(){}},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_readaloudmediaskin.min.js.map

define ("filter_poodll/speech_browser",["jquery","core/log"],function(a,b){"use strict";b.debug("speech_browser: initialising");return{recognition:null,recognizing:!1,ignore_onend:!1,final_transcript:"",start_timestamp:0,lang:"en-US",clone:function clone(){return a.extend(!0,{},this)},will_work_ok:function will_work_ok(){return"webkitSpeechRecognition"in window||"SpeechRecognition"in window},init:function init(a){var b=b||webkitSpeechRecognition;this.recognition=new b;this.recognition.continuous=!0;this.recognition.interimResults=!0;this.lang=a.language?a.language:"en-US";this.register_events()},set_grammar:function set_grammar(a){var b=b||webkitSpeechGrammarList;if(b){var c=new b;c.addFromString(a,1);this.recognition.grammars=c}},start:function start(){if(this.recognizing){return}this.recognizing=!0;this.final_transcript="";this.recognition.lang=this.lang;this.recognition.start();this.ignore_onend=!1;this.start_timestamp=Date.now()},stop:function stop(){this.recognizing=!1;this.recognition.stop()},register_events:function register_events(){var a=this.recognition,c=this;a.onstart=function(){c.recognizing=!0};a.onerror=function(a){if("no-speech"==a.error){b.debug("info_no_speech");c.ignore_onend=!0}if("audio-capture"==a.error){b.debug("info_no_microphone");c.ignore_onend=!0}if("not-allowed"==a.error){if(100>a.timeStamp-c.start_timestamp){b.debug("info_blocked")}else{b.debug("info_denied")}c.ignore_onend=!0}};a.onend=function(){if(!1==c.recognizing){return}if(c.ignore_onend){c.recognizing=!1}else{a.start()}};a.onresult=function(a){for(var b="",d=a.resultIndex;d<a.results.length;++d){if(a.results[d].isFinal){c.final_transcript+=a.results[d][0].transcript;c.onfinalspeechcapture(c.final_transcript,JSON.stringify(a.results));c.final_transcript=""}else{b+=a.results[d][0].transcript;c.oninterimspeechcapture(b)}}}},onfinalspeechcapture:function onfinalspeechcapture(a){b.debug(a)},oninterimspeechcapture:function oninterimspeechcapture(){}}});
//# sourceMappingURL=speech_browser.min.js.map

define ("filter_poodll/s3multipartupload",["jquery","core/log"],function(a,b){"use strict";b.debug("Filter PoodLL: s3multipartupload initialising");return{PART_SIZE:10485760,SERVER_LOC:"?",completed:!1,file:null,fileInfo:null,sendBackData:null,uploadXHR:[],partURLs:[],byterate:[],lastUploadedSize:[],lastUploadedTime:[],loaded:[],total:[],init:function init(a){this.completed=!1;this.file=a;this.fileInfo={name:this.file.name,type:this.file.type,size:this.file.size,lastModifiedDate:this.file.lastModifiedDate};this.sendBackData=null;this.uploadXHR=[];this.byterate=[];this.lastUploadedSize=[];this.lastUploadedTime=[];this.loaded=[];this.total=[]},createMultipartUpload:function createMultipartUpload(){var a=new XMLHttpRequest,c=this;a.onreadystatechange=function(){if(4===this.readyState){if(200==a.status){var d=a.responseText,e=JSON.parse(d);if(e){if(0<e.returnCode){var f={id:c.config.id,type:"error",code:e.returnCode,message:e.returnMessage};c.config.hermes.postMessage(f)}else{c.partURLs=e.partURLs;c.config.allowedURL=e.allowedURL;c.config.posturl=e.postURL;c.config.filename=e.filename;c.config.s3filename=e.s3filename;c.config.s3root=e.s3root;c.config.cloudfilename=e.shortfilename;c.config.cloudroot=e.shortroot;c.sendAll()}}else{b.debug("error:"+e.message)}}else{b.debug("Not 200 response:"+a.status)}}};var d=this.prepareParts(),e="wstoken="+this.config.wstoken+"&wsfunction="+"local_cpapi_fetch_multipartupload_details"+"&moodlewsrestformat="+this.config.moodlewsrestformat+"&mediatype="+this.config.mediatype+"&parts="+d,f=M.cfg.wwwroot+"/webservice/rest/server.php";a.open("POST",f,!0);a.setRequestHeader("Cache-Control","no-cache");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(e)},doMultipartUpload:function doMultipartUpload(){var a=new XMLHttpRequest,c=this;a.onreadystatechange=function(){if(4===this.readyState){if(200==a.status){var d=a.responseText,e=JSON.parse(d);if(e){if(0<e.returnCode){var f={id:c.config.id,type:"error",code:e.returnCode,message:e.returnMessage};c.config.hermes.postMessage(f)}else{c.partURLs=e.partURLs;c.config.allowedURL=e.allowedURL;c.config.posturl=e.postURL;c.config.filename=e.filename;c.config.s3filename=e.s3filename;c.config.s3root=e.s3root;c.config.cloudfilename=e.shortfilename;c.config.cloudroot=e.shortroot;c.sendAll()}}else{b.debug("error:"+e.message)}}else{b.debug("Not 200 response:"+a.status)}}};var d=this.prepareParts(),e="wstoken="+this.config.wstoken+"&wsfunction="+"local_cpapi_fetch_multipartupload_urls"+"&moodlewsrestformat="+this.config.moodlewsrestformat+"&mediatype="+this.config.mediatype+"&parts="+d,f=M.cfg.wwwroot+"/webservice/rest/server.php";a.open("POST",f,!0);a.setRequestHeader("Cache-Control","no-cache");a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.send(e)},start:function start(){this.createMultipartUpload()},prepareParts:function prepareParts(){var a=this.blobs=[];this.partURLs=[];var b=0,c=[],d,e,f=0;while(b<this.file.size){d=Math.min(b+this.PART_SIZE,this.file.size);filePart=this.file.slice(b,d);if(0<filePart.size)a.push(filePart);b=this.PART_SIZE*++f}for(var g=0;g<a.length;g++){e=a[g];c[g]={};c[g].partNumber=g+1;c[g].contentLength=e.size}return c},sendAll:function sendAll(){for(var a=this.blobs,b=a.length,c=0;c<b;c++){this.sendToS3(partURLs[c],a[c],c)}},sendToS3:function sendToS3(a,b,c){var d=this,f=b.size,g=d.uploadXHR[c]=new XMLHttpRequest;g.onreadystatechange=function(){if(4===g.readyState){if(200!==g.status){d.updateProgress();d.onS3UploadError(g);return}d.updateProgress()}};g.upload.onprogress=function(a){if(a.lengthComputable){d.total[c]=f;d.loaded[c]=a.loaded;if(d.lastUploadedTime[c]){var b=(new Date().getTime()-d.lastUploadedTime[c])/1e3;if(.005<b){var e=(d.loaded[c]-d.lastUploadedSize[c])/b;d.byterate[c]=e;d.lastUploadedTime[c]=new Date().getTime();d.lastUploadedSize[c]=d.loaded[c]}}else{d.byterate[c]=0;d.lastUploadedTime[c]=new Date().getTime();d.lastUploadedSize[c]=d.loaded[c]}if(0==c||d.total[0]==d.loaded[0])d.updateProgress()}};g.open("PUT",a,!0);g.send(b)},cancel:function cancel(){for(var b=this,c=0;c<this.uploadXHR.length;++c){this.uploadXHR[c].abort()}a.post(b.SERVER_LOC,{command:"abort",sendBackData:b.sendBackData}).done(function(){})},completeMultipartUpload:function completeMultipartUpload(){var b=this;if(this.completed)return;this.completed=!0;a.post(b.SERVER_LOC,{command:"complete",sendBackData:b.sendBackData}).done(function(a){b.onUploadCompleted(a)}).fail(function(a,c,d){b.onServerError("complete",a,c,d)})},updateProgress:function updateProgress(){for(var a=0,b=0,c=0,d=1,e=0;e<this.total.length;++e){b+=+this.loaded[e]||0;a+=this.total[e];if(this.loaded[e]!=this.total[e]){c+=+this.byterate[e]||0;d=0}}if(d)this.completeMultipartUpload();a=this.fileInfo.size;this.onProgressChanged(b,a,c)},onServerError:function onServerError(){},onS3UploadError:function onS3UploadError(){},onProgressChanged:function onProgressChanged(){},onUploadCompleted:function onUploadCompleted(){},onPrepareCompleted:function onPrepareCompleted(){}}});
//# sourceMappingURL=s3multipartupload.min.js.map

define('filter_poodll/msr_helper_whammy', ["jquery","core/log","filter_poodll/utils_amd","filter_poodll/poodll_whammy"],function(a,b,c,d){"use strict";return b.debug("PoodLL Whammy Recorder Helper: initialising"),{requestDataInvoked:!1,isOnStartedDrawingNonBlankFramesInvoked:!1,isStopDrawing:!1,canvas:null,context:null,video:!1,lastTime:!1,whammy:!1,isPaused:!1,width:!1,height:!1,speed:.8,quality:100,mediaStream:null,msr:null,audioctx:null,clone:function(){return a.extend(!0,{},this)},init:function(a,c,d){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.mediaStream=c,this.msr=a,this.audioctx=d,b.debug("initing whammy helper")},record:function(a){b.debug("recordingin whammy helper"),this.width||(this.width=320),this.height||(this.height=240),this.video&&this.video instanceof HTMLVideoElement&&(this.width||(this.width=this.video.videoWidth||this.video.clientWidth||320),this.height||(this.height=this.video.videoHeight||this.video.clientHeight||240)),this.video||(this.video={width:this.width,height:this.height}),this.canvas&&this.canvas.width&&this.canvas.height||(this.canvas={width:this.width,height:this.height}),this.video&&this.video instanceof HTMLVideoElement?this.isHTMLObject=!0:(this.video=document.createElement("video"),this.video.srcObject=this.mediaStream),this.video.muted=!0,this.video.play(),this.lastTime=(new Date).getTime(),this.whammy=d.Video,this.whammy.init(this.speed,this.quality),this.drawFrames(this)},clearOldRecordedFrames:function(){this.whammy.frames=[]},requestData:function(){var a=this;if(!this.isPaused){if(!this.whammy.frames.length)return void(this.requestDataInvoked=!1);this.requestDataInvoked=!0;var d=this.whammy.frames.slice(0);this.whammy.frames=this.dropBlackFrames(d,-1),this.whammy.compile(function(d){a.msr.ondataavailable(d),b.debug("video recorded blob size:"+c.bytesToSize(d.size))}),this.whammy.frames=[],this.requestDataInvoked=!1}},drawFrames:function(a){if(a.isPaused)return a.lastTime=(new Date).getTime(),void setTimeout(function(){a.drawFrames(a)},500);if(!a.isStopDrawing){if(a.requestDataInvoked)return setTimeout(function(){a.drawFrames(a)},100);var b=(new Date).getTime()-a.lastTime;if(!b)return a.drawFrames(a);a.lastTime=(new Date).getTime(),!a.isHTMLObject&&a.video.paused&&a.video.play(),a.context.drawImage(a.video,0,0,a.canvas.width,a.canvas.height),a.isStopDrawing||a.whammy.frames.push({duration:b,image:a.canvas.toDataURL("image/webp")}),a.isOnStartedDrawingNonBlankFramesInvoked||a.isBlankFrame(a.whammy.frames[a.whammy.frames.length-1])||(a.isOnStartedDrawingNonBlankFramesInvoked=!0,a.msr.onStartedDrawingNonBlankFrames()),setTimeout(function(){a.drawFrames(a)},10)}},stop:function(){this.isStopDrawing=!0,this.requestData()},isBlankFrame:function(a,b,c){var d=document.createElement("canvas");d.width=this.canvas.width,d.height=this.canvas.height;var e,f,g,h=d.getContext("2d"),i={r:0,g:0,b:0},j=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),k=b&&b>=0&&b<=1?b:0,l=c&&c>=0&&c<=1?c:0,m=new Image;m.src=a.image,h.drawImage(m,0,0,this.canvas.width,this.canvas.height);var n=h.getImageData(0,0,this.canvas.width,this.canvas.height);e=0,f=n.data.length,g=n.data.length/4;for(var o=0;o<f;o+=4){var p={r:n.data[o],g:n.data[o+1],b:n.data[o+2]},q=Math.sqrt(Math.pow(p.r-i.r,2)+Math.pow(p.g-i.g,2)+Math.pow(p.b-i.b,2));q<=j*k&&e++}return!(g-e<=g*l)},dropBlackFrames:function(a,b,c,d){var e=document.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height;for(var f=e.getContext("2d"),g=[],h=b===-1,i=b&&b>0&&b<=a.length?b:a.length,j={r:0,g:0,b:0},k=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),l=c&&c>=0&&c<=1?c:0,m=d&&d>=0&&d<=1?d:0,n=!1,o=0;o<i;o++){var p,q,r;if(!n){var s=new Image;s.src=a[o].image,f.drawImage(s,0,0,this.canvas.width,this.canvas.height);var t=f.getImageData(0,0,this.canvas.width,this.canvas.height);p=0,q=t.data.length,r=t.data.length/4;for(var u=0;u<q;u+=4){var v={r:t.data[u],g:t.data[u+1],b:t.data[u+2]},w=Math.sqrt(Math.pow(v.r-j.r,2)+Math.pow(v.g-j.g,2)+Math.pow(v.b-j.b,2));w<=k*l&&p++}}!n&&r-p<=r*m||(h&&(n=!0),g.push(a[o]))}return g=g.concat(a.slice(i)),g.length<=0&&g.push(a[a.length-1]),g},pause:function(){this.isPaused=!0},resume:function(){this.isPaused=!1}}});
define ("filter_poodll/dlg_download",["jquery","core/log","filter_poodll/dlg_poodll","filter_poodll/utils_amd"],function(a,b,c,d){b.debug("download dialog: initialising");return{dlg:null,instanceprops:null,pmr:null,dlgbox:null,init:function init(a,b){this.dlg=c.clone();this.dlg.setHeader("Download");this.instanceprops=b;this.pmr=a},clone:function clone(){return a.extend(!0,{},this)},fetch_blob_url:function fetch_blob_url(){var a=d.simpleConcatenateBlobs(this.instanceprops.blobs,this.instanceprops.blobs[0].type),b=URL.createObjectURL(a);return b},fetch_dialogue_box:function fetch_dialogue_box(){return this.dlg.fetch_dialogue_box("download")},set_dialogue_box:function set_dialogue_box(a){this.dlgbox=a;this.dlg.set_dialogue_box(a)},open:function open(){var a=this,b=this.instanceprops,c="",e=new Date().toISOString().replace(/[^0-9]/g,""),f=b.config.mediatype+"_"+e;d.doConcatenateBlobs(this.instanceprops.blobs,function(b){switch(b.type){case"audio/wav":case"audio/pcm":c=".wav";break;case"audio/ogg":c=".ogg";break;case"audio/webm":case"video/webm":c=".webm";break;default:var d=b.type.split("/");if(1<d.length){c="."+d[1]}}f=f+c;var e=URL.createObjectURL(b),g=M.util.get_string("recui_downloadfile","filter_poodll"),h="<div class=\"filter_poodll_dlgdownload_content\">";h+="<a href=\""+e+"\" download=\""+f+"\" class=\"btn btn-secondary\">"+g+"</a>";h+="</div>";a.dlg.setContent(h);a.registerEvents();a.dlg.open()})},registerEvents:function registerEvents(){}}});
//# sourceMappingURL=dlg_download.min.js.map

define ("filter_poodll/anim_hwave_fresh",["jquery","core/log"],function(a,b){"use strict";b.debug("anim_horizontal_wave: initialising");return{analyser:null,cvs:null,cvsctx:null,drawparams:{wavColor:"#6DDC6F",barColor:"#ad2323",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:10,shadowColor:"#fff",font:"18px Arial",textAlign:"center",textBaseline:"middle"},clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.cvs=b;this.cvsctx=b.getContext("2d");this.analyser=a;this.clear()},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height);this.cvsctx.lineWidth=2;this.cvsctx.strokeStyle=this.drawparams.wavColor;this.cvsctx.beginPath();this.cvsctx.moveTo(0,this.cvs.height/2);this.cvsctx.lineTo(this.cvs.width,this.cvs.height/2);this.cvsctx.stroke()},start:function start(){this.analyser.core.fftSize=2048;var a=this.analyser.core.fftSize,b=new Uint8Array(a),c=this.cvs.width,d=this.cvs.height,e=this.cvsctx,f=this.analyser;this.clear();var g=this,h=function(){requestAnimationFrame(h);if(!f.theinterval){return}f.core.getByteTimeDomainData(b);e.clearRect(0,0,c,d);e.lineWidth=2;e.strokeStyle=g.drawparams.wavColor;e.beginPath();for(var j=0,k=0;k<a;k++){var l=b[k]/128,m=l*d/2;if(0==k){e.moveTo(j,m)}else{e.lineTo(j,m)}j+=1*c/a}e.lineTo(c,d/2);e.stroke()};h()}}});
//# sourceMappingURL=anim_hwave_fresh.min.js.map

define('filter_poodll/poodll_whammy', ["jquery","core/log"],function(a,b){"use strict";function c(a){var b=URL.createObjectURL(new Blob([a.toString(),"this.onmessage =  function (e) {"+a.name+"(e.data);}"],{type:"application/javascript"})),c=new Worker(b);return URL.revokeObjectURL(b),c}function d(a){function b(a){var b=d(a);if(!b)return[];for(var e=3e4,f=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:m(b.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:b.width,id:176},{data:b.height,id:186}]}]}]}]}],g=0,i=0;g<a.length;){var j=[],k=0;do j.push(a[g]),k+=a[g].duration,g++;while(g<a.length&&k<e);var l=0,n={id:524531317,data:c(i,l,j)};f[1].data.push(n),i+=k}return h(f)}function c(a,b,c){return[{data:a,id:231}].concat(c.map(function(a){var c=i({discardable:0,frame:a.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(b)});return b+=a.duration,{data:c,id:163}}))}function d(a){if(!a[0])return void postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});for(var b=a[0].width,c=a[0].height,d=a[0].duration,e=1;e<a.length;e++)d+=a[e].duration;return{duration:d,width:b,height:c}}function e(a){for(var b=[];a>0;)b.push(255&a),a>>=8;return new Uint8Array(b.reverse())}function f(a){return new Uint8Array(a.split("").map(function(a){return a.charCodeAt(0)}))}function g(a){var b=[],c=a.length%8?new Array(9-a.length%8).join("0"):"";a=c+a;for(var d=0;d<a.length;d+=8)b.push(parseInt(a.substr(d,8),2));return new Uint8Array(b)}function h(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].data;"object"==typeof d&&(d=h(d)),"number"==typeof d&&(d=g(d.toString(2))),"string"==typeof d&&(d=f(d));var i=d.size||d.byteLength||d.length,j=Math.ceil(Math.ceil(Math.log(i)/Math.log(2))/8),k=i.toString(2),l=new Array(7*j+7+1-k.length).join("0")+k,m=new Array(j).join("0")+"1"+l;b.push(e(a[c].id)),b.push(g(m)),b.push(d)}return new Blob(b,{type:"video/webm"})}function i(a){var b=0;if(a.keyframe&&(b|=128),a.invisible&&(b|=8),a.lacing&&(b|=a.lacing<<1),a.discardable&&(b|=1),a.trackNum>127)throw"TrackNumber > 127 not supported";var c=[128|a.trackNum,a.timecode>>8,255&a.timecode,b].map(function(a){return String.fromCharCode(a)}).join("")+a.frame;return c}function j(a){for(var b=a.RIFF[0].WEBP[0],c=b.indexOf("Â*"),d=0,e=[];d<4;d++)e[d]=b.charCodeAt(c+3+d);var f,g,h;return h=e[1]<<8|e[0],f=16383&h,h=e[3]<<8|e[2],g=16383&h,{width:f,height:g,data:b,riff:a}}function k(a,b){return parseInt(a.substr(b+4,4).split("").map(function(a){var b=a.charCodeAt(0).toString(2);return new Array(8-b.length+1).join("0")+b}).join(""),2)}function l(a){for(var b=0,c={};b<a.length;){var d=a.substr(b,4),e=k(a,b),f=a.substr(b+4+4,e);b+=8+e,c[d]=c[d]||[],"RIFF"===d||"LIST"===d?c[d].push(l(f)):c[d].push(f)}return c}function m(a){return[].slice.call(new Uint8Array(new Float64Array([a]).buffer),0).map(function(a){return String.fromCharCode(a)}).reverse().join("")}var n=new b(a.map(function(a){var b=j(l(atob(a.image.slice(23))));return b.duration=a.duration,b}));postMessage(n)}b.debug("PoodLL Whammy: initialising");var e={};return e.init=function(a,b){this.frames=[],a||(a=1),this.duration=1e3/a,this.quality=b||.8},e.add=function(a,b){if("canvas"in a&&(a=a.canvas),"toDataURL"in a&&(a=a.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(a))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:a,duration:b||this.duration})},e.compile=function(a){var b=c(d);b.onmessage=function(b){return b.data.error?void console.error(b.data.error):void a(b.data)},b.postMessage(this.frames)},{Video:e}});
define ("filter_poodll/anim_hwave",["jquery","core/log"],function(a,b){"use strict";b.debug("anim_horizontal_wave: initialising");return{analyser:null,cvs:null,cvsctx:null,drawparams:{wavColor:"#0",barColor:"#ad2323",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:10,shadowColor:"#fff",font:"18px Arial",textAlign:"center",textBaseline:"middle"},clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.cvs=b;this.cvsctx=b.getContext("2d");this.analyser=a;this.clear()},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height);this.cvsctx.lineWidth=2;this.cvsctx.strokeStyle=this.drawparams.wavColor;this.cvsctx.beginPath();this.cvsctx.moveTo(0,this.cvs.height/2);this.cvsctx.lineTo(this.cvs.width,this.cvs.height/2);this.cvsctx.stroke()},start:function start(){this.analyser.core.fftSize=2048;var a=this.analyser.core.fftSize,b=new Uint8Array(a),c=this.cvs.width,d=this.cvs.height,e=this.cvsctx,f=this.analyser;this.clear();var g=this,h=function(){requestAnimationFrame(h);if(!f.theinterval){return}f.core.getByteTimeDomainData(b);e.clearRect(0,0,c,d);e.lineWidth=2;e.strokeStyle=g.drawparams.wavColor;e.beginPath();for(var j=0,k=0;k<a;k++){var l=b[k]/128,m=l*d/2;if(0==k){e.moveTo(j,m)}else{e.lineTo(j,m)}j+=1*c/a}e.lineTo(c,d/2);e.stroke()};h()}}});
//# sourceMappingURL=anim_hwave.min.js.map

define ("filter_poodll/hermes",["jquery","core/log"],function(a,b){"use strict";b.debug("Hermes (the messenger) initialising");return{allowedURL:"",id:"",iframeembed:!1,enabled:!1,eventListeners:!1,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c){this.allowedURL=b;this.id=a;this.iframeembed=c;this.enabled=!0;this.eventListeners=[];this.registerEvents()},disable:function disable(){this.enabled=!1},enable:function enable(){this.enabled=!0},on:function on(a,b){var c={};c.type=a;c.handler=b;this.eventListeners.push(c)},sendEvent:function sendEvent(a){for(var b=0;b<this.eventListeners.length;b++){if(a.type==this.eventListeners[b].type){this.eventListeners[b].handler(a)}}},postMessage:function postMessage(a){if(!this.enabled){return}if(!a.hasOwnProperty("type")){b.debug("All message objects must have at least the \"type\" property");return}if(this.iframeembed){a.id=this.id;window.parent.postMessage(a,this.allowedURL)}},registerEvents:function registerEvents(){var a=this;window.addEventListener("message",function(b){if(null==a.allowedURL||0!==a.allowedURL.indexOf(b.origin)){return}var c=b.data;if(c&&c.hasOwnProperty("id")&&c.id==a.id&&c.hasOwnProperty("type")){a.sendEvent(b.data)}})}}});
//# sourceMappingURL=hermes.min.js.map

define ("filter_poodll/msr_helper_stereoaudio",["jquery","core/log"],function(a,b){"use strict";b.debug("PoodLL Stereo Audio Recorder Helper: initialising");return{scriptprocessornode:null,requestDataInvoked:!1,recordingLength:0,isPaused:!1,deviceSampleRate:48e3,leftchannel:[],rightchannel:[],recording:!1,volume:null,audioInput:null,context:null,sampleRate:0,mimeType:0,isPCM:!1,numChannels:1,msr:null,audioctx:null,mediaStream:null,volumeGainNode:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,c,d){this.msr=a;this.audioctx=d;this.mediaStream=c;this.deviceSampleRate=d.sampleRate;this.sampleRate=this.deviceSampleRate;this.mimeType=a.mimeType||"audio/wav";this.isPCM=-1<this.mimeType.indexOf("audio/pcm");this.numChannels=a.audioChannels||1;b.debug("stereohelper mimetype: "+this.mimeType);this.misc()},misc:function misc(){var a=this,c=this.audioctx;this.volumeGainNode=c.createGain();var d=this.volumeGainNode;this.audioInput=c.createMediaStreamSource(this.mediaStream);var e=this.audioInput;e.connect(d);var f=this.msr.bufferSize||2048;if(0===this.msr.bufferSize){f=0}var g=null;if(c.createJavaScriptNode){g=c.createJavaScriptNode(f,this.numChannels,this.numChannels)}else if(c.createScriptProcessor){g=c.createScriptProcessor(f,this.numChannels,this.numChannels)}else{throw"WebAudio API has no support on this browser."}this.bufferSize=g.bufferSize;this.requestDataInvoked=!1;this.scriptprocessornode=g;if(1===this.numChannels){b.debug("All right-channels are skipped.")}this.isPaused=!1;g.onaudioprocess=function(b){if(!a.recording||a.requestDataInvoked||a.isPaused){return}var c=b.inputBuffer.getChannelData(0);a.leftchannel.push(new Float32Array(c));if(2===a.numChannels){var d=b.inputBuffer.getChannelData(1);a.rightchannel.push(new Float32Array(d))}a.recordingLength+=a.bufferSize};d.connect(this.msr.audioanalyser.core);this.msr.audioanalyser.core.connect(g);g.connect(c.destination)},record:function record(){this.recording=!0;this.leftchannel.length=this.rightchannel.length=0;this.recordingLength=0},encodeWAV:function encodeWAV(a){var c=new ArrayBuffer(44+2*a.length),d=new DataView(c);this.writeString(d,0,"RIFF");d.setUint32(4,36+2*a.length,!0);this.writeString(d,8,"WAVE");this.writeString(d,12,"fmt ");d.setUint32(16,16,!0);d.setUint16(20,1,!0);d.setUint16(22,this.numChannels,!0);d.setUint32(24,this.sampleRate,!0);d.setUint32(28,4*this.sampleRate,!0);d.setUint16(32,2*this.numChannels,!0);d.setUint16(34,16,!0);this.writeString(d,36,"data");d.setUint32(40,2*a.length,!0);this.floatTo16BitPCM(d,44,a);b.debug(2*a.length);return d},floatTo16BitPCM:function floatTo16BitPCM(a,b,c){for(var d=0,e;d<c.length;d++,b+=2){e=Math.max(-1,Math.min(1,c[d]));a.setInt16(b,0>e?32768*e:32767*e,!0)}},writeString:function writeString(a,b,c){for(var d=0;d<c.length;d++){a.setUint8(b+d,c.charCodeAt(d))}},requestData:function requestData(){if(this.isPaused){return}if(0===this.recordingLength){this.requestDataInvoked=!1;return}this.requestDataInvoked=!0;var a=this.leftchannel.slice(0),b=this.rightchannel.slice(0),c=this.recordingLength;this.leftchannel.length=this.rightchannel.length=[];this.recordingLength=0;this.requestDataInvoked=!1;var d=this.mergeBuffers(a,c),e=d;if(2===this.numChannels){var f=this.mergeBuffers(b,c);e=this.interleave(d,f)}var g=this.encodeWAV(e),h=new Blob([g],{type:"audio/wav"});this.msr.ondataavailable(h)},xrequestData:function xrequestData(){if(this.isPaused){return}if(0===this.recordingLength){this.requestDataInvoked=!1;return}this.requestDataInvoked=!0;var a=this.leftchannel.slice(0),b=this.rightchannel.slice(0),c=this.recordingLength;this.leftchannel.length=this.rightchannel.length=[];this.recordingLength=0;this.requestDataInvoked=!1;var d=this.mergeBuffers(a,c),e=d;if(2===this.numChannels){var f=this.mergeBuffers(b,c);this.interleaved=this.interleave(d,f)}if(this.isPCM){var g=new Blob([this.convertoFloat32ToInt16(e)],{type:"audio/pcm"});this.msr.ondataavailable(g);return}var h=new ArrayBuffer(44+2*e.length),j=new DataView(h);this.writeUTFBytes(j,0,"RIFF");j.setUint32(4,44+2*e.length-8,!0);this.writeUTFBytes(j,8,"WAVE");this.writeUTFBytes(j,12,"fmt ");j.setUint32(16,16,!0);j.setUint16(20,1,!0);j.setUint16(22,this.numChannels,!0);j.setUint32(24,this.sampleRate,!0);j.setUint32(28,2*(this.sampleRate*this.numChannels),!0);j.setUint16(32,2*this.numChannels,!0);j.setUint16(34,16,!0);this.writeUTFBytes(j,36,"data");j.setUint32(40,2*e.length,!0);for(var k=e.length,l=44,m=0;m<k;m++){j.setInt16(l,e[m]*(32767*1),!0);l+=2}var g=new Blob([j],{type:"audio/wav"});this.msr.ondataavailable(g)},stop:function stop(){this.recording=!1;this.requestData();this.audioInput.disconnect()},interleave:function interleave(a,b){for(var c=a.length+b.length,d=new Float32Array(c),e=0,f=0;f<c;){d[f++]=a[e];d[f++]=b[e];e++}return d},mergeBuffers:function mergeBuffers(a,b){for(var c=new Float32Array(b),d=0,e=a.length,f=0,g;f<e;f++){g=a[f];c.set(g,d);d+=g.length}return c},writeUTFBytes:function writeUTFBytes(a,b,c){for(var d=c.length,e=0;e<d;e++){a.setUint8(b+e,c.charCodeAt(e))}},convertoFloat32ToInt16:function convertoFloat32ToInt16(a){var b=a.length,c=new Int16Array(b);while(b--){c[b]=65535*a[b]}return c.buffer},pause:function pause(){this.isPaused=!0},resume:function resume(){this.isPaused=!1}}});
//# sourceMappingURL=msr_helper_stereoaudio.min.js.map

define ("filter_poodll/poodllrecorder",["jquery","core/log","filter_poodll/poodll_flashrecorder","filter_poodll/poodll_mediarecorder","filter_poodll/poodll_uploadrecorder","filter_poodll/poodll_mobilerecorder","filter_poodll/poodll_flashsnapshotrecorder","filter_poodll/poodll_snapshotrecorder","filter_poodll/poodll_red5recorder"],function(a,b,c,d,e,f,g,h,j){"use strict";b.debug("PoodLL Recorder: initialising");return{init:function init(k){var l="#amdopts_"+k.widgetid,m=a(l).get(0);if(m){this.config=JSON.parse(m.value);a(l).remove()}else{b.debug("PoodLL Recorder: No config found on page. Giving up.");return}this.config.wwwroot=M.cfg.wwwroot;this.config.sesskey=M.cfg.sesskey;var n=this.config.selector;if(!n){b.debug("unable to fetch element with selector:"+this.config.selector);return}for(var o=!1,p=0;p<this.config.rec_order.length;p++){switch(this.config.rec_order[p]){case"red5":o=j;break;case"flashaudio":o=c;break;case"media":o=d;break;case"upload":o=e;break;case"mobile":o=f;break;case"flashsnapshot":o=g;break;case"snapshot":o=h;break;}if(o.supports_current_browser(this.config)){o.embed(n,this.config);return}}b.debug("none of available recorders works on this browser")}}});
//# sourceMappingURL=poodllrecorder.min.js.map

function _typeof(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(e){return typeof e}}else{_typeof=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof(e)}!function(n){if("object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define ("filter_poodll/react-with-addons",[],n);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.React=n()}}(function(){return function d(p,e,t){function r(o,a){if(!e[o]){if(!p[o]){var i="function"==typeof require&&require;if(!a&&i)return i(o,!0);if(n)return n(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var u=e[o]={exports:{}};p[o][0].call(u.exports,function(t){var e=p[o][1][t];return r(e?e:t)},u,u.exports,d,p,e,t)}return e[o].exports}for(var n="function"==typeof require&&require,o=0;o<t.length;o++){r(t[o])}return r}({1:[function(n,e){"use strict";var t=n(22),r=n(26),o=n(37),a=n(29),i=n(62),u=n(91),s=n(93),l=n(115),c=n(137),p=n(140);n(168);r.addons={CSSTransitionGroup:a,LinkedStateMixin:t,PureRenderMixin:o,TransitionGroup:u,batchedUpdates:function batchedUpdates(){return s.batchedUpdates.apply(this,arguments)},cloneWithProps:l,createFragment:i.create,shallowCompare:c,update:p},e.exports=r},{115:115,137:137,140:140,168:168,22:22,26:26,29:29,37:37,62:62,91:91,93:93}],2:[function(n,e){"use strict";var t=n(70),r=n(119),o=n(152);e.exports={Mixin:{componentDidMount:function componentDidMount(){this.props.autoFocus&&o(r(this))}},focusDOMComponent:function focusDOMComponent(){o(t.getNode(this._rootNodeID))}}},{119:119,152:152,70:70}],3:[function(n,e){"use strict";function t(){var t=window.opera;return"object"==_typeof(t)&&"function"==typeof t.version&&12>=parseInt(t.version(),10)}function r(t){return(t.ctrlKey||t.altKey||t.metaKey)&&!(t.ctrlKey&&t.altKey)}function I(t){switch(t){case M.topCompositionStart:return N.compositionStart;case M.topCompositionEnd:return N.compositionEnd;case M.topCompositionUpdate:return N.compositionUpdate;}}function a(n,e){return n===M.topKeyDown&&e.keyCode===b}function i(n,e){switch(n){case M.topKeyUp:return-1!==C.indexOf(e.keyCode);case M.topKeyDown:return e.keyCode!==b;case M.topKeyPress:case M.topMouseDown:case M.topBlur:return!0;default:return!1;}}function o(n){var e=n.detail;return"object"==_typeof(e)&&"data"in e?e.data:null}function s(s,e,t,n,r){var u,g;if(E?u=I(s):O?i(s,n)&&(u=N.compositionEnd):a(s,n)&&(u=N.compositionStart),!u)return null;D&&(O||u!==N.compositionStart?u===N.compositionEnd&&O&&(g=O.getData()):O=h.getPooled(e));var y=m.getPooled(u,t,n,r);if(g)y.data=g;else{var p=o(n);null!==p&&(y.data=p)}return f.accumulateTwoPhaseDispatches(y),y}function u(a,e){switch(a){case M.topCompositionEnd:return o(e);case M.topKeyPress:var t=e.which;return t!==P?null:(k=!0,T);case M.topTextInput:var n=e.data;return n===T&&k?null:n;default:return null;}}function l(o,e){if(O){if(o===M.topCompositionEnd||i(o,e)){var t=O.getData();return h.release(O),O=null,t}return null}switch(o){case M.topPaste:return null;case M.topKeyPress:return e.which&&!r(e)?String.fromCharCode(e.which):null;case M.topCompositionEnd:return D?null:e.data;default:return null;}}function p(d,e,t,n,r){var o;if(o=v?u(d,n):l(d,n),!o)return null;var p=g.getPooled(N.beforeInput,t,n,r);return p.data=o,f.accumulateTwoPhaseDispatches(p),p}var d=n(15),f=n(19),c=n(144),h=n(20),m=n(100),g=n(104),y=n(163),C=[9,13,27,32],b=229,E=c.canUseDOM&&"CompositionEvent"in window,_=null;c.canUseDOM&&"documentMode"in document&&(_=document.documentMode);var v=c.canUseDOM&&"TextEvent"in window&&!_&&!t(),D=c.canUseDOM&&(!E||_&&8<_&&11>=_),P=32,T=String.fromCharCode(32),M=d.topLevelTypes,N={beforeInput:{phasedRegistrationNames:{bubbled:y({onBeforeInput:null}),captured:y({onBeforeInputCapture:null})},dependencies:[M.topCompositionEnd,M.topKeyPress,M.topTextInput,M.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:y({onCompositionEnd:null}),captured:y({onCompositionEndCapture:null})},dependencies:[M.topBlur,M.topCompositionEnd,M.topKeyDown,M.topKeyPress,M.topKeyUp,M.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:y({onCompositionStart:null}),captured:y({onCompositionStartCapture:null})},dependencies:[M.topBlur,M.topCompositionStart,M.topKeyDown,M.topKeyPress,M.topKeyUp,M.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:y({onCompositionUpdate:null}),captured:y({onCompositionUpdateCapture:null})},dependencies:[M.topBlur,M.topCompositionUpdate,M.topKeyDown,M.topKeyPress,M.topKeyUp,M.topMouseDown]}},k=!1,O=null;e.exports={eventTypes:N,extractEvents:function extractEvents(a,e,t,n,r){return[s(a,e,t,n,r),p(a,e,t,n,r)]}}},{100:100,104:104,144:144,15:15,163:163,19:19,20:20}],4:[function(n,e){"use strict";function d(n,e){return n+e.charAt(0).toUpperCase()+e.substring(1)}var r={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},t=["Webkit","ms","Moz","O"];Object.keys(r).forEach(function(n){t.forEach(function(e){r[d(e,n)]=r[n]})});e.exports={isUnitlessNumber:r,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}}},{}],5:[function(n,e){"use strict";var t=n(4),r=n(144),o=n(76),m=(n(146),n(116)),a=n(157),i=n(165),s=(n(168),i(function(t){return a(t)})),l=!1,f="cssFloat";if(r.canUseDOM){var u=document.createElement("div").style;try{u.font=""}catch(e){l=!0}void 0===document.documentElement.style.cssFloat&&(f="styleFloat")}var d={createMarkupForStyles:function createMarkupForStyles(o){var e="";for(var a in o){if(o.hasOwnProperty(a)){var n=o[a];null!=n&&(e+=s(a)+":",e+=m(a,n)+";")}}return e||null},setValueForStyles:function setValueForStyles(r,e){var d=r.style;for(var n in e){if(e.hasOwnProperty(n)){var i=m(n,e[n]);if("float"===n&&(n=f),i)d[n]=i;else{var a=l&&t.shorthandPropertyExpansions[n];if(a)for(var p in a){d[p]=""}else d[n]=""}}}}};o.measureMethods(d,"CSSPropertyOperations",{setValueForStyles:"setValueForStyles"}),e.exports=d},{116:116,144:144,146:146,157:157,165:165,168:168,4:4,76:76}],6:[function(n,e){"use strict";function t(){this._callbacks=null,this._contexts=null}var r=n(25),o=n(24),a=n(158);o(t.prototype,{enqueue:function enqueue(n,e){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(n),this._contexts.push(e)},notifyAll:function notifyAll(){var o=this._callbacks,e=this._contexts;if(o){o.length!==e.length?a(!1):void 0,this._callbacks=null,this._contexts=null;for(var t=0;t<o.length;t++){o[t].call(e[t])}o.length=0,e.length=0}},reset:function reset(){this._callbacks=null,this._contexts=null},destructor:function destructor(){this.reset()}}),r.addPoolingTo(t),e.exports=t},{158:158,24:24,25:25}],7:[function(n,e){"use strict";function U(n){var e=n.nodeName&&n.nodeName.toLowerCase();return"select"===e||"input"===e&&"file"===n.type}function r(n){var e=b.getPooled(T.change,M,n,E(n));g.accumulateTwoPhaseDispatches(e),C.batchedUpdates(o,e)}function o(t){c.enqueueEvents(t),c.processEventQueue(!1)}function a(n,e){N=n,M=e,N.attachEvent("onchange",r)}function i(){N&&(N.detachEvent("onchange",r),N=null,M=null)}function F(o,e,t){return o===P.topChange?t:void 0}function s(o,e,t){o===P.topFocus?(i(),a(e,t)):o===P.topBlur&&i()}function u(n,e){N=n,M=e,w=n.value,V=Object.getOwnPropertyDescriptor(n.constructor.prototype,"value"),Object.defineProperty(N,"value",j),N.attachEvent("onpropertychange",p)}function l(){N&&(delete N.value,N.detachEvent("onpropertychange",p),N=null,M=null,w=null,V=null)}function p(n){if("value"===n.propertyName){var e=n.srcElement.value;e!==w&&(w=e,r(n))}}function d(o,e,t){return o===P.topInput?t:void 0}function f(o,e,t){o===P.topFocus?(l(),u(e,t)):o===P.topBlur&&l()}function h(t){return t!==P.topSelectionChange&&t!==P.topKeyUp&&t!==P.topKeyDown||!N||N.value===w?void 0:(w=N.value,M)}function v(t){return t.nodeName&&"input"===t.nodeName.toLowerCase()&&("checkbox"===t.type||"radio"===t.type)}function m(o,e,t){return o===P.topClick?t:void 0}var t=n(15),c=n(16),g=n(19),y=n(144),C=n(93),b=n(102),E=n(125),_=n(130),x=n(131),D=n(163),P=t.topLevelTypes,T={change:{phasedRegistrationNames:{bubbled:D({onChange:null}),captured:D({onChangeCapture:null})},dependencies:[P.topBlur,P.topChange,P.topClick,P.topFocus,P.topInput,P.topKeyDown,P.topKeyUp,P.topSelectionChange]}},N=null,M=null,w=null,V=null,B=!1;y.canUseDOM&&(B=_("change")&&(!("documentMode"in document)||8<document.documentMode));var W=!1;y.canUseDOM&&(W=_("input")&&(!("documentMode"in document)||9<document.documentMode));var j={get:function get(){return V.get.call(this)},set:function set(t){w=""+t,V.set.call(this,t)}};e.exports={eventTypes:T,extractEvents:function extractEvents(r,e,t,n,o){var a,l;if(U(e)?B?a=F:l=s:x(e)?W?a=d:(a=h,l=f):v(e)&&(a=m),a){var y=a(r,e,t);if(y){var c=b.getPooled(T.change,y,n,o);return c.type="change",g.accumulateTwoPhaseDispatches(c),c}}l&&l(r,e,t)}}},{102:102,125:125,130:130,131:131,144:144,15:15,16:16,163:163,19:19,93:93}],8:[function(n,e){"use strict";var t=0;e.exports={createReactRootIndex:function createReactRootIndex(){return t++}}},{}],9:[function(n,e){"use strict";function t(o,e,t){var n=t>=o.childNodes.length?null:o.childNodes.item(t);o.insertBefore(e,n)}var r=n(12),o=n(72),a=n(76),d=n(135),p=n(136),s=n(158),i={dangerouslyReplaceNodeWithMarkup:r.dangerouslyReplaceNodeWithMarkup,updateTextContent:p,processUpdates:function processUpdates(a,e){for(var u,l=null,y=null,C=0;C<a.length;C++){if(u=a[C],u.type===o.MOVE_EXISTING||u.type===o.REMOVE_NODE){var b=u.fromIndex,E=u.parentNode.childNodes[b],f=u.parentID;E?void 0:s(!1),l=l||{},l[f]=l[f]||[],l[f][b]=E,y=y||[],y.push(E)}}var h;if(h=e.length&&"string"==typeof e[0]?r.dangerouslyRenderMarkup(e):e,y)for(var _=0;_<y.length;_++){y[_].parentNode.removeChild(y[_])}for(var x=0;x<a.length;x++){switch(u=a[x],u.type){case o.INSERT_MARKUP:t(u.parentNode,h[u.markupIndex],u.toIndex);break;case o.MOVE_EXISTING:t(u.parentNode,l[u.parentID][u.fromIndex],u.toIndex);break;case o.SET_MARKUP:d(u.parentNode,u.content);break;case o.TEXT_CONTENT:p(u.parentNode,u.content);break;case o.REMOVE_NODE:}}}};a.measureMethods(i,"DOMChildrenOperations",{updateTextContent:"updateTextContent"}),e.exports=i},{12:12,135:135,136:136,158:158,72:72,76:76}],10:[function(n,e){"use strict";function m(n,e){return(n&e)===e}var r=n(158),o={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function injectDOMPropertyConfig(a){var e=o,t=a.Properties||{},n=a.DOMAttributeNamespaces||{},i=a.DOMAttributeNames||{},s=a.DOMPropertyNames||{},u=a.DOMMutationMethods||{};a.isCustomAttribute&&g._isCustomAttributeFunctions.push(a.isCustomAttribute);for(var l in t){g.properties.hasOwnProperty(l)?r(!1):void 0;var p=l.toLowerCase(),d=t[l],c={attributeName:p,attributeNamespace:null,propertyName:l,mutationMethod:null,mustUseAttribute:m(d,e.MUST_USE_ATTRIBUTE),mustUseProperty:m(d,e.MUST_USE_PROPERTY),hasSideEffects:m(d,e.HAS_SIDE_EFFECTS),hasBooleanValue:m(d,e.HAS_BOOLEAN_VALUE),hasNumericValue:m(d,e.HAS_NUMERIC_VALUE),hasPositiveNumericValue:m(d,e.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:m(d,e.HAS_OVERLOADED_BOOLEAN_VALUE)};if(c.mustUseAttribute&&c.mustUseProperty?r(!1):void 0,!c.mustUseProperty&&c.hasSideEffects?r(!1):void 0,1>=c.hasBooleanValue+c.hasNumericValue+c.hasOverloadedBooleanValue?void 0:r(!1),i.hasOwnProperty(l)){var f=i[l];c.attributeName=f}n.hasOwnProperty(l)&&(c.attributeNamespace=n[l]),s.hasOwnProperty(l)&&(c.propertyName=s[l]),u.hasOwnProperty(l)&&(c.mutationMethod=u[l]),g.properties[l]=c}}},a={},g={ID_ATTRIBUTE_NAME:"data-reactid",properties:{},getPossibleStandardName:null,_isCustomAttributeFunctions:[],isCustomAttribute:function isCustomAttribute(o){for(var e=0,r;e<g._isCustomAttributeFunctions.length;e++){r=g._isCustomAttributeFunctions[e];if(r(o))return!0}return!1},getDefaultValueForProperty:function getDefaultValueForProperty(o,e){var t,d=a[o];return d||(a[o]=d={}),e in d||(t=document.createElement(o),d[e]=t[e]),d[e]},injection:o};e.exports=g},{158:158}],11:[function(n,e){"use strict";function d(t){return i.hasOwnProperty(t)?!0:a.hasOwnProperty(t)?!1:r.test(t)?(i[t]=!0,!0):(a[t]=!0,!1)}function m(n,e){return null==e||n.hasBooleanValue&&!e||n.hasNumericValue&&isNaN(e)||n.hasPositiveNumericValue&&1>e||n.hasOverloadedBooleanValue&&!1===e}var f=n(10),t=n(76),o=n(133),r=(n(168),/^[a-zA-Z_][\w\.\-]*$/),a={},i={},c={createMarkupForID:function createMarkupForID(t){return f.ID_ATTRIBUTE_NAME+"="+o(t)},setAttributeForID:function setAttributeForID(n,e){n.setAttribute(f.ID_ATTRIBUTE_NAME,e)},createMarkupForProperty:function createMarkupForProperty(a,e){var t=f.properties.hasOwnProperty(a)?f.properties[a]:null;if(t){if(m(t,e))return"";var n=t.attributeName;return t.hasBooleanValue||t.hasOverloadedBooleanValue&&!0===e?n+"=\"\"":n+"="+o(e)}return f.isCustomAttribute(a)?null==e?"":a+"="+o(e):null},createMarkupForCustomAttribute:function createMarkupForCustomAttribute(n,e){return d(n)&&null!=e?n+"="+o(e):""},setValueForProperty:function setValueForProperty(o,e,t){var n=f.properties.hasOwnProperty(e)?f.properties[e]:null;if(n){var r=n.mutationMethod;if(r)r(o,t);else if(m(n,t))this.deleteValueForProperty(o,e);else if(n.mustUseAttribute){var a=n.attributeName,d=n.attributeNamespace;d?o.setAttributeNS(d,a,""+t):n.hasBooleanValue||n.hasOverloadedBooleanValue&&!0===t?o.setAttribute(a,""):o.setAttribute(a,""+t)}else{var i=n.propertyName;n.hasSideEffects&&""+o[i]==""+t||(o[i]=t)}}else f.isCustomAttribute(e)&&c.setValueForAttribute(o,e,t)},setValueForAttribute:function setValueForAttribute(o,e,t){d(e)&&(null==t?o.removeAttribute(e):o.setAttribute(e,""+t))},deleteValueForProperty:function deleteValueForProperty(a,e){var t=f.properties.hasOwnProperty(e)?f.properties[e]:null;if(t){var n=t.mutationMethod;if(n)n(a,void 0);else if(t.mustUseAttribute)a.removeAttribute(t.attributeName);else{var r=t.propertyName,o=f.getDefaultValueForProperty(a.nodeName,r);t.hasSideEffects&&""+a[r]===o||(a[r]=o)}}else f.isCustomAttribute(e)&&a.removeAttribute(e)}};t.measureMethods(c,"DOMPropertyOperations",{setValueForProperty:"setValueForProperty",setValueForAttribute:"setValueForAttribute",deleteValueForProperty:"deleteValueForProperty"}),e.exports=c},{10:10,133:133,168:168,76:76}],12:[function(n,e){"use strict";function d(t){return t.substring(1,t.indexOf(" "))}var r=n(144),o=n(149),a=n(150),i=n(154),u=n(158);e.exports={dangerouslyRenderMarkup:function dangerouslyRenderMarkup(s){r.canUseDOM?void 0:u(!1);for(var e,l={},n=0;n<s.length;n++){s[n]?void 0:u(!1),e=d(s[n]),e=i(e)?e:"*",l[e]=l[e]||[],l[e][n]=s[n]}var c=[],b=0;for(e in l){if(l.hasOwnProperty(e)){var E,_=l[e];for(E in _){if(_.hasOwnProperty(E)){var x=_[E];_[E]=x.replace(/^(<[^ \/>]+)/,"$1 data-danger-index=\""+E+"\" ")}}for(var m=o(_.join(""),a),g=0,v;g<m.length;++g){v=m[g];v.hasAttribute&&v.hasAttribute("data-danger-index")&&(E=+v.getAttribute("data-danger-index"),v.removeAttribute("data-danger-index"),c.hasOwnProperty(E)?u(!1):void 0,c[E]=v,b+=1)}}}return b!==c.length?u(!1):void 0,c.length!==s.length?u(!1):void 0,c},dangerouslyReplaceNodeWithMarkup:function dangerouslyReplaceNodeWithMarkup(d,e){r.canUseDOM?void 0:u(!1),e?void 0:u(!1),"html"===d.tagName.toLowerCase()?u(!1):void 0;var t;t="string"==typeof e?o(e,a)[0]:e,d.parentNode.replaceChild(t,d)}}},{144:144,149:149,150:150,154:154,158:158}],13:[function(n,e){"use strict";var t=n(163),r=[t({ResponderEventPlugin:null}),t({SimpleEventPlugin:null}),t({TapEventPlugin:null}),t({EnterLeaveEventPlugin:null}),t({ChangeEventPlugin:null}),t({SelectEventPlugin:null}),t({BeforeInputEventPlugin:null})];e.exports=r},{163:163}],14:[function(n,e){"use strict";var t=n(15),b=n(19),o=n(106),a=n(70),r=n(163),i=t.topLevelTypes,s=a.getFirstReactDOM,l={mouseEnter:{registrationName:r({onMouseEnter:null}),dependencies:[i.topMouseOut,i.topMouseOver]},mouseLeave:{registrationName:r({onMouseLeave:null}),dependencies:[i.topMouseOut,i.topMouseOver]}},c=[null,null];e.exports={eventTypes:l,extractEvents:function extractEvents(p,e,t,n,r){if(p===i.topMouseOver&&(n.relatedTarget||n.fromElement))return null;if(p!==i.topMouseOut&&p!==i.topMouseOver)return null;var u;if(e.window===e)u=e;else{var E=e.ownerDocument;u=E?E.defaultView||E.parentWindow:window}var f,_,x="",D="";if(p===i.topMouseOut?(f=e,x=t,_=s(n.relatedTarget||n.toElement),_?D=a.getID(_):_=u,_=_||u):(f=u,_=e,D=t),f===_)return null;var P=o.getPooled(l.mouseLeave,x,n,r);P.type="mouseleave",P.target=f,P.relatedTarget=_;var y=o.getPooled(l.mouseEnter,D,n,r);return y.type="mouseenter",y.target=_,y.relatedTarget=f,b.accumulateEnterLeaveDispatches(P,y,x,D),c[0]=P,c[1]=y,c}}},{106:106,15:15,163:163,19:19,70:70}],15:[function(n,e){"use strict";var t=n(162),r=t({bubbled:null,captured:null}),o=t({topAbort:null,topBlur:null,topCanPlay:null,topCanPlayThrough:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topDurationChange:null,topEmptied:null,topEncrypted:null,topEnded:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topLoadedData:null,topLoadedMetadata:null,topLoadStart:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topPause:null,topPlay:null,topPlaying:null,topProgress:null,topRateChange:null,topReset:null,topScroll:null,topSeeked:null,topSeeking:null,topSelectionChange:null,topStalled:null,topSubmit:null,topSuspend:null,topTextInput:null,topTimeUpdate:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topVolumeChange:null,topWaiting:null,topWheel:null});e.exports={topLevelTypes:o,PropagationPhases:r}},{162:162}],16:[function(n,e){"use strict";var m=n(17),r=n(18),o=n(59),g=n(112),a=n(121),i=n(158),s=(n(168),{}),u=null,t=function(n,e){n&&(r.executeDispatchesInOrder(n,e),n.isPersistent()||n.constructor.release(n))},p=function(n){return t(n,!0)},d=function(n){return t(n,!1)},f=null,y={injection:{injectMount:r.injection.injectMount,injectInstanceHandle:function injectInstanceHandle(t){f=t},getInstanceHandle:function getInstanceHandle(){return f},injectEventPluginOrder:m.injectEventPluginOrder,injectEventPluginsByName:m.injectEventPluginsByName},eventNameDispatchConfigs:m.eventNameDispatchConfigs,registrationNameModules:m.registrationNameModules,putListener:function putListener(r,e,t){"function"!=typeof t?i(!1):void 0;var n=s[e]||(s[e]={});n[r]=t;var o=m.registrationNameModules[e];o&&o.didPutListener&&o.didPutListener(r,e,t)},getListener:function getListener(o,e){var t=s[e];return t&&t[o]},deleteListener:function deleteListener(r,e){var t=m.registrationNameModules[e];t&&t.willDeleteListener&&t.willDeleteListener(r,e);var n=s[e];n&&delete n[r]},deleteAllListeners:function deleteAllListeners(o){for(var e in s){if(s[e][o]){var t=m.registrationNameModules[e];t&&t.willDeleteListener&&t.willDeleteListener(o,e),delete s[e][o]}}},extractEvents:function extractEvents(r,e,t,n,o){for(var a,d=m.plugins,i=0,s;i<d.length;i++){s=d[i];if(s){var f=s.extractEvents(r,e,t,n,o);f&&(a=g(a,f))}}return a},enqueueEvents:function enqueueEvents(t){t&&(u=g(u,t))},processEventQueue:function processEventQueue(n){var e=u;u=null,n?a(e,p):a(e,d),u?i(!1):void 0,o.rethrowCaughtError()},__purge:function __purge(){s={}},__getListenerBank:function __getListenerBank(){return s}};e.exports=y},{112:112,121:121,158:158,168:168,17:17,18:18,59:59}],17:[function(n,e){"use strict";function d(){if(i)for(var o in f){var e=f[o],t=i.indexOf(o);if(-1<t?void 0:m(!1),!s.plugins[t]){e.extractEvents?void 0:m(!1),s.plugins[t]=e;var n=e.eventTypes;for(var r in n){p(n[r],e,r)?void 0:m(!1)}}}}function p(a,e,t){s.eventNameDispatchConfigs.hasOwnProperty(t)?m(!1):void 0,s.eventNameDispatchConfigs[t]=a;var n=a.phasedRegistrationNames;if(n){for(var r in n){if(n.hasOwnProperty(r)){var o=n[r];c(o,e,t)}}return!0}return a.registrationName?(c(a.registrationName,e,t),!0):!1}function c(o,e,t){s.registrationNameModules[o]?m(!1):void 0,s.registrationNameModules[o]=e,s.registrationNameDependencies[o]=e.eventTypes[t].dependencies}var m=n(158),i=null,f={},s={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function injectEventPluginOrder(t){i?m(!1):void 0,i=Array.prototype.slice.call(t),d()},injectEventPluginsByName:function injectEventPluginsByName(r){var e=!1;for(var a in r){if(r.hasOwnProperty(a)){var n=r[a];f.hasOwnProperty(a)&&f[a]===n||(f[a]?m(!1):void 0,f[a]=n,e=!0)}}e&&d()},getPluginModuleForEvent:function getPluginModuleForEvent(o){var e=o.dispatchConfig;if(e.registrationName)return s.registrationNameModules[e.registrationName]||null;for(var t in e.phasedRegistrationNames){if(e.phasedRegistrationNames.hasOwnProperty(t)){var n=s.registrationNameModules[e.phasedRegistrationNames[t]];if(n)return n}}return null},_resetEventPlugins:function _resetEventPlugins(){i=null;for(var a in f){f.hasOwnProperty(a)&&delete f[a]}s.plugins.length=0;var e=s.eventNameDispatchConfigs;for(var t in e){e.hasOwnProperty(t)&&delete e[t]}var n=s.registrationNameModules;for(var r in n){n.hasOwnProperty(r)&&delete n[r]}}};e.exports=s},{158:158}],18:[function(n,e){"use strict";function a(a,e,t,n){var r=a.type||"unknown-event";a.currentTarget=p.Mount.getNode(n),e?d.invokeGuardedCallbackWithCatch(r,t,a,n):d.invokeGuardedCallback(r,t,a,n),a.currentTarget=null}function o(o){var e=o._dispatchListeners,t=o._dispatchIDs;if(Array.isArray(e)){for(var n=0;n<e.length&&!o.isPropagationStopped();n++){if(e[n](o,t[n]))return t[n]}}else if(e&&e(o,t))return t;return null}var t=n(15),d=n(59),i=n(158),p=(n(168),{Mount:null,injectMount:function injectMount(t){p.Mount=t}}),r=t.topLevelTypes;e.exports={isEndish:function(t){return t===r.topMouseUp||t===r.topTouchEnd||t===r.topTouchCancel},isMoveish:function(t){return t===r.topMouseMove||t===r.topTouchMove},isStartish:function(t){return t===r.topMouseDown||t===r.topTouchStart},executeDirectDispatch:function(o){var e=o._dispatchListeners,t=o._dispatchIDs;Array.isArray(e)?i(!1):void 0;var n=e?e(o,t):null;return o._dispatchListeners=null,o._dispatchIDs=null,n},executeDispatchesInOrder:function(d,e){var t=d._dispatchListeners,n=d._dispatchIDs;if(Array.isArray(t))for(var r=0;r<t.length&&!d.isPropagationStopped();r++){a(d,e,t[r],n[r])}else t&&a(d,e,t,n);d._dispatchListeners=null,d._dispatchIDs=null},executeDispatchesInOrderStopAtTrue:function(n){var e=o(n);return n._dispatchIDs=null,n._dispatchListeners=null,e},hasDispatches:function(t){return!!t._dispatchListeners},getNode:function getNode(t){return p.Mount.getNode(t)},getID:function getID(t){return p.Mount.getID(t)},injection:p}},{15:15,158:158,168:168,59:59}],19:[function(n,e){"use strict";function d(o,e,t){var n=e.dispatchConfig.phasedRegistrationNames[t];return m(o,n)}function t(r,e,t){var n=e?c.bubbled:c.captured,o=d(r,t,n);o&&(t._dispatchListeners=u(t._dispatchListeners,o),t._dispatchIDs=u(t._dispatchIDs,r))}function o(n){n&&n.dispatchConfig.phasedRegistrationNames&&s.injection.getInstanceHandle().traverseTwoPhase(n.dispatchMarker,t,n)}function r(n){n&&n.dispatchConfig.phasedRegistrationNames&&s.injection.getInstanceHandle().traverseTwoPhaseSkipTarget(n.dispatchMarker,t,n)}function a(a,e,t){if(t&&t.dispatchConfig.registrationName){var n=t.dispatchConfig.registrationName,r=m(a,n);r&&(t._dispatchListeners=u(t._dispatchListeners,r),t._dispatchIDs=u(t._dispatchIDs,a))}}function i(t){t&&t.dispatchConfig.registrationName&&a(t.dispatchMarker,null,t)}var p=n(15),s=n(16),u=(n(168),n(112)),l=n(121),c=p.PropagationPhases,m=s.getListener;e.exports={accumulateTwoPhaseDispatches:function(t){l(t,o)},accumulateTwoPhaseDispatchesSkipTarget:function(t){l(t,r)},accumulateDirectDispatches:function(t){l(t,i)},accumulateEnterLeaveDispatches:function(o,e,t,n){s.injection.getInstanceHandle().traverseEnterLeave(t,n,a,o,e)}}},{112:112,121:121,15:15,16:16,168:168}],20:[function(n,e){"use strict";function t(t){this._root=t,this._startText=this.getText(),this._fallbackText=null}var r=n(25),o=n(24),a=n(128);o(t.prototype,{destructor:function destructor(){this._root=null,this._startText=null,this._fallbackText=null},getText:function getText(){return"value"in this._root?this._root.value:this._root[a()]},getData:function getData(){if(this._fallbackText)return this._fallbackText;var d,p,s=this._startText,n=s.length,r=this.getText(),o=r.length;for(d=0;n>d&&s[d]===r[d];d++){}var a=n-d;for(p=1;a>=p&&s[n-p]===r[o-p];p++){}var i=1<p?1-p:void 0;return this._fallbackText=r.slice(d,i),this._fallbackText}}),r.addPoolingTo(t),e.exports=t},{128:128,24:24,25:25}],21:[function(n,e){"use strict";var t,m=n(10),o=n(144),a=m.injection.MUST_USE_ATTRIBUTE,i=m.injection.MUST_USE_PROPERTY,u=m.injection.HAS_BOOLEAN_VALUE,s=m.injection.HAS_SIDE_EFFECTS,l=m.injection.HAS_NUMERIC_VALUE,c=m.injection.HAS_POSITIVE_NUMERIC_VALUE,p=m.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(o.canUseDOM){var d=document.implementation;t=d&&d.hasFeature&&d.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var f={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:a|u,allowTransparency:a,alt:null,async:u,autoComplete:null,autoPlay:u,capture:a|u,cellPadding:null,cellSpacing:null,charSet:a,challenge:a,checked:i|u,classID:a,className:t?a:i,cols:a|c,colSpan:null,content:null,contentEditable:null,contextMenu:a,controls:i|u,coords:null,crossOrigin:null,data:null,dateTime:a,default:u,defer:u,dir:null,disabled:a|u,download:p,draggable:null,encType:null,form:a,formAction:a,formEncType:a,formMethod:a,formNoValidate:u,formTarget:a,frameBorder:a,headers:null,height:a,hidden:a|u,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:i,inputMode:a,integrity:null,is:a,keyParams:a,keyType:a,kind:null,label:null,lang:null,list:a,loop:i|u,low:null,manifest:a,marginHeight:null,marginWidth:null,max:null,maxLength:a,media:a,mediaGroup:null,method:null,min:null,minLength:a,multiple:i|u,muted:i|u,name:null,nonce:a,noValidate:u,open:u,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:i|u,rel:null,required:u,reversed:u,role:a,rows:a|c,rowSpan:null,sandbox:null,scope:null,scoped:u,scrolling:null,seamless:a|u,selected:i|u,shape:null,size:a|c,sizes:a,span:c,spellCheck:null,src:null,srcDoc:i,srcLang:null,srcSet:a,start:l,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:i|s,width:a,wmode:a,wrap:null,about:a,datatype:a,inlist:a,prefix:a,property:a,resource:a,typeof:a,vocab:a,autoCapitalize:null,autoCorrect:null,autoSave:null,color:null,itemProp:a,itemScope:a|u,itemType:a,itemID:a,itemRef:a,results:null,security:a,unselectable:a},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",autoSave:"autosave",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};e.exports=f},{10:10,144:144}],22:[function(n,e){"use strict";var t=n(68),r=n(88);e.exports={linkState:function linkState(n){return new t(this.state[n],r.createStateKeySetter(this,n))}}},{68:68,88:88}],23:[function(n,e){"use strict";function t(t){null!=t.checkedLink&&null!=t.valueLink?s(!1):void 0}function r(n){t(n),null!=n.value||null!=n.onChange?s(!1):void 0}function o(n){t(n),null!=n.checked||null!=n.onChange?s(!1):void 0}function a(n){if(n){var e=n.getName();if(e)return" Check the render method of `"+e+"`."}return""}var i=n(80),u=n(79),s=n(158),l=(n(168),{button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0}),c={value:function value(n,e){return!n[e]||l[n.type]||n.onChange||n.readOnly||n.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function checked(n,e){return!n[e]||n.onChange||n.readOnly||n.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:i.func},p={};e.exports={checkPropTypes:function checkPropTypes(d,e,t){for(var n in c){if(c.hasOwnProperty(n))var r=c[n](e,n,d,u.prop);r instanceof Error&&!(r.message in p)&&(p[r.message]=!0,a(t))}},getValue:function getValue(t){return t.valueLink?(r(t),t.valueLink.value):t.value},getChecked:function getChecked(t){return t.checkedLink?(o(t),t.checkedLink.value):t.checked},executeOnChange:function executeOnChange(n,e){return n.valueLink?(r(n),n.valueLink.requestChange(e.target.value)):n.checkedLink?(o(n),n.checkedLink.requestChange(e.target.checked)):n.onChange?n.onChange.call(void 0,e):void 0}}},{158:158,168:168,79:79,80:80}],24:[function(n,e){"use strict";function t(t){if(null==t)throw new TypeError("Object.assign target cannot be null or undefined");for(var e=Object(t),n=Object.prototype.hasOwnProperty,r=1,d;r<arguments.length;r++){d=arguments[r];if(null!=d){var p=Object(d);for(var i in p){n.call(p,i)&&(e[i]=p[i])}}}return e}e.exports=t},{}],25:[function(n,e){"use strict";var a=n(158),r=function(o){var e=this;if(e.instancePool.length){var t=e.instancePool.pop();return e.call(t,o),t}return new e(o)},o=function(n){var e=this;n instanceof e?void 0:a(!1),n.destructor(),e.instancePool.length<e.poolSize&&e.instancePool.push(n)};e.exports={addPoolingTo:function d(a,e){var t=a;return t.instancePool=[],t.getPooled=e||r,t.poolSize||(t.poolSize=10),t.release=o,t},oneArgumentPooler:r,twoArgumentPooler:function a(o,e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,o,e),n}return new t(o,e)},threeArgumentPooler:function i(a,e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,a,e,t),r}return new n(a,e,t)},fourArgumentPooler:function u(d,e,t,n){var r=this;if(r.instancePool.length){var o=r.instancePool.pop();return r.call(o,d,e,t,n),o}return new r(d,e,t,n)},fiveArgumentPooler:function s(d,e,t,n,r){var o=this;if(o.instancePool.length){var a=o.instancePool.pop();return o.call(a,d,e,t,n,r),a}return new o(d,e,t,n,r)}}},{158:158}],26:[function(n,e){"use strict";var t=n(40),r=n(50),o=n(67),a=n(24),d=n(117),i={};a(i,o),a(i,{findDOMNode:d("findDOMNode","ReactDOM","react-dom",t,t.findDOMNode),render:d("render","ReactDOM","react-dom",t,t.render),unmountComponentAtNode:d("unmountComponentAtNode","ReactDOM","react-dom",t,t.unmountComponentAtNode),renderToString:d("renderToString","ReactDOMServer","react-dom/server",r,r.renderToString),renderToStaticMarkup:d("renderToStaticMarkup","ReactDOMServer","react-dom/server",r,r.renderToStaticMarkup)}),i.__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t,i.__SECRET_DOM_SERVER_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r,e.exports=i},{117:117,24:24,40:40,50:50,67:67}],27:[function(n,e){"use strict";var t=(n(66),n(119)),r=(n(168),"_getDOMNodeDidWarn");e.exports={getDOMNode:function getDOMNode(){return this.constructor._getDOMNodeDidWarn=!0,t(this)}}},{119:119,168:168,66:66}],28:[function(n,e){"use strict";function y(t){return Object.prototype.hasOwnProperty.call(t,c)||(t[c]=l++,p[t[c]]={}),p[t[c]]}var r=n(15),t=n(16),o=n(17),a=n(60),i=n(76),s=n(111),u=n(24),C=n(130),p={},d=!1,l=0,b={topAbort:"abort",topBlur:"blur",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},c="_reactListenersID"+(Math.random()+"").slice(2),m=u({},a,{ReactEventListener:null,injection:{injectReactEventListener:function injectReactEventListener(t){t.setHandleTopLevel(m.handleTopLevel),m.ReactEventListener=t}},setEnabled:function setEnabled(t){m.ReactEventListener&&m.ReactEventListener.setEnabled(t)},isEnabled:function isEnabled(){return!(!m.ReactEventListener||!m.ReactEventListener.isEnabled())},listenTo:function listenTo(d,e){for(var t=e,n=y(t),a=o.registrationNameDependencies[d],i=r.topLevelTypes,p=0,s;p<a.length;p++){s=a[p];n.hasOwnProperty(s)&&n[s]||(s===i.topWheel?C("wheel")?m.ReactEventListener.trapBubbledEvent(i.topWheel,"wheel",t):C("mousewheel")?m.ReactEventListener.trapBubbledEvent(i.topWheel,"mousewheel",t):m.ReactEventListener.trapBubbledEvent(i.topWheel,"DOMMouseScroll",t):s===i.topScroll?C("scroll",!0)?m.ReactEventListener.trapCapturedEvent(i.topScroll,"scroll",t):m.ReactEventListener.trapBubbledEvent(i.topScroll,"scroll",m.ReactEventListener.WINDOW_HANDLE):s===i.topFocus||s===i.topBlur?(C("focus",!0)?(m.ReactEventListener.trapCapturedEvent(i.topFocus,"focus",t),m.ReactEventListener.trapCapturedEvent(i.topBlur,"blur",t)):C("focusin")&&(m.ReactEventListener.trapBubbledEvent(i.topFocus,"focusin",t),m.ReactEventListener.trapBubbledEvent(i.topBlur,"focusout",t)),n[i.topBlur]=!0,n[i.topFocus]=!0):b.hasOwnProperty(s)&&m.ReactEventListener.trapBubbledEvent(s,b[s],t),n[s]=!0)}},trapBubbledEvent:function trapBubbledEvent(o,e,t){return m.ReactEventListener.trapBubbledEvent(o,e,t)},trapCapturedEvent:function trapCapturedEvent(o,e,t){return m.ReactEventListener.trapCapturedEvent(o,e,t)},ensureScrollValueMonitoring:function ensureScrollValueMonitoring(){if(!d){var t=s.refreshScrollValues;m.ReactEventListener.monitorScrollValue(t),d=!0}},eventNameDispatchConfigs:t.eventNameDispatchConfigs,registrationNameModules:t.registrationNameModules,putListener:t.putListener,getListener:t.getListener,deleteListener:t.deleteListener,deleteAllListeners:t.deleteAllListeners});i.measureMethods(m,"ReactBrowserEventEmitter",{putListener:"putListener",deleteListener:"deleteListener"}),e.exports=m},{111:111,130:130,15:15,16:16,17:17,24:24,60:60,76:76}],29:[function(n,e){"use strict";function t(n){var o="transition"+n+"Timeout";return function(t){if(t["transition"+t]){if(null==t[o])return new Error(o+" wasn't supplied to ReactCSSTransitionGroup: this can cause unreliable animations and won't be supported in a future version of React. See https://fb.me/react-animation-transition-group-timeout for more information.");if("number"!=typeof t[o])return new Error(o+" must be a number (in milliseconds)")}}}var r=n(26),o=n(24),a=n(91),d=n(30),i=r.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:d.propTypes.name,transitionAppear:r.PropTypes.bool,transitionEnter:r.PropTypes.bool,transitionLeave:r.PropTypes.bool,transitionAppearTimeout:t("Appear"),transitionEnterTimeout:t("Enter"),transitionLeaveTimeout:t("Leave")},getDefaultProps:function getDefaultProps(){return{transitionAppear:!1,transitionEnter:!0,transitionLeave:!0}},_wrapChild:function _wrapChild(t){return r.createElement(d,{name:this.props.transitionName,appear:this.props.transitionAppear,enter:this.props.transitionEnter,leave:this.props.transitionLeave,appearTimeout:this.props.transitionAppearTimeout,enterTimeout:this.props.transitionEnterTimeout,leaveTimeout:this.props.transitionLeaveTimeout},t)},render:function render(){return r.createElement(a,o({},this.props,{childFactory:this._wrapChild}))}});e.exports=i},{24:24,26:26,30:30,91:91}],30:[function(n,e){"use strict";var t=n(26),d=n(40),o=n(142),a=n(90),r=n(132),i=t.createClass({displayName:"ReactCSSTransitionGroupChild",propTypes:{name:t.PropTypes.oneOfType([t.PropTypes.string,t.PropTypes.shape({enter:t.PropTypes.string,leave:t.PropTypes.string,active:t.PropTypes.string}),t.PropTypes.shape({enter:t.PropTypes.string,enterActive:t.PropTypes.string,leave:t.PropTypes.string,leaveActive:t.PropTypes.string,appear:t.PropTypes.string,appearActive:t.PropTypes.string})]).isRequired,appear:t.PropTypes.bool,enter:t.PropTypes.bool,leave:t.PropTypes.bool,appearTimeout:t.PropTypes.number,enterTimeout:t.PropTypes.number,leaveTimeout:t.PropTypes.number},transition:function transition(i,p,e){var t=d.findDOMNode(this);if(!t)return void(p&&p());var n=this.props.name[i]||this.props.name+"-"+i,r=this.props.name[i+"Active"]||n+"-active",s=null,u=function(d){d&&d.target!==t||(clearTimeout(s),o.removeClass(t,n),o.removeClass(t,r),a.removeEndEventListener(t,u),p&&p())};o.addClass(t,n),this.queueClass(r),e?(s=setTimeout(u,e),this.transitionTimeouts.push(s)):a.addEndEventListener(t,u)},queueClass:function queueClass(t){this.classNameQueue.push(t),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,17))},flushClassNameQueue:function flushClassNameQueue(){this.isMounted()&&this.classNameQueue.forEach(o.addClass.bind(o,d.findDOMNode(this))),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function componentWillMount(){this.classNameQueue=[],this.transitionTimeouts=[]},componentWillUnmount:function componentWillUnmount(){this.timeout&&clearTimeout(this.timeout),this.transitionTimeouts.forEach(function(t){clearTimeout(t)})},componentWillAppear:function componentWillAppear(t){this.props.appear?this.transition("appear",t,this.props.appearTimeout):t()},componentWillEnter:function componentWillEnter(t){this.props.enter?this.transition("enter",t,this.props.enterTimeout):t()},componentWillLeave:function componentWillLeave(t){this.props.leave?this.transition("leave",t,this.props.leaveTimeout):t()},render:function render(){return r(this.props.children)}});e.exports=i},{132:132,142:142,26:26,40:40,90:90}],31:[function(n,e){"use strict";function t(a,e,t){var n=void 0===a[t];null!=e&&n&&(a[t]=o(e,null))}var d=n(82),o=n(129),a=n(138),r=n(139),i=(n(168),{instantiateChildren:function instantiateChildren(n){if(null==n)return null;var e={};return r(n,t,e),e},updateChildren:function updateChildren(i,e,t,n){if(!e&&!i)return null;for(var r in e){if(e.hasOwnProperty(r)){var m=i&&i[r],s=m&&m._currentElement,l=e[r];if(null!=m&&a(s,l))d.receiveComponent(m,l,t,n),e[r]=m;else{m&&d.unmountComponent(m,r);var c=o(l,null);e[r]=c}}}for(r in i){!i.hasOwnProperty(r)||e&&e.hasOwnProperty(r)||d.unmountComponent(i[r])}return e},unmountChildren:function unmountChildren(o){for(var e in o){if(o.hasOwnProperty(e)){var t=o[e];d.unmountComponent(t)}}}});e.exports=i},{129:129,138:138,139:139,168:168,82:82}],32:[function(n,e){"use strict";function d(t){return(""+t).replace(h,"//")}function i(n,e){this.func=n,this.context=e,this.count=0}function o(n,e){var t=n.func,r=n.context;t.call(r,e,n.count++)}function r(o,e,t,n){this.result=o,this.keyPrefix=e,this.func=t,this.context=n,this.count=0}function u(r,e,t){var n=r.result,o=r.keyPrefix,a=r.func,i=r.context,u=a.call(i,e,r.count++);Array.isArray(u)?c(u,n,t,l.thatReturnsArgument):null!=u&&(p.isValidElement(u)&&(u=p.cloneAndReplaceKey(u,o+(u!==e?d(u.key||"")+"/":"")+t)),n.push(u))}function c(p,e,t,n,o){var a="";null!=t&&(a=d(t)+"/");var c=r.getPooled(e,a,n,o);s(p,u,c),r.release(c)}function t(){return null}var a=n(25),p=n(55),l=n(150),s=n(139),m=a.twoArgumentPooler,f=a.fourArgumentPooler,h=/\/(?!\/)/g;i.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},a.addPoolingTo(i,m),r.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},a.addPoolingTo(r,f);e.exports={forEach:function(a,e,t){if(null==a)return a;var n=i.getPooled(e,t);s(a,o,n),i.release(n)},map:function(o,e,t){if(null==o)return o;var n=[];return c(o,n,null,e,t),n},mapIntoWithKeyPrefixInternal:c,count:function(n){return s(n,t,null)},toArray:function(n){var e=[];return c(n,e,null,l.thatReturnsArgument),e}}},{139:139,150:150,25:25,55:55}],33:[function(n,e){"use strict";function T(o,e){var t=b.hasOwnProperty(e)?b[e]:null;_.hasOwnProperty(e)&&(t!==y.OVERRIDE_BASE?h(!1):void 0),o.hasOwnProperty(e)&&(t!==y.DEFINE_MANY&&t!==y.DEFINE_MANY_MERGED?h(!1):void 0)}function r(r,e){if(e){"function"==typeof e?h(!1):void 0,c.isValidElement(e)?h(!1):void 0;var d=r.prototype;e.hasOwnProperty(g)&&E.mixins(r,e.mixins);for(var n in e){if(e.hasOwnProperty(n)&&n!==g){var o=e[n];if(T(d,n),E.hasOwnProperty(n))E[n](r,o);else{var a=b.hasOwnProperty(n),i=d.hasOwnProperty(n),s="function"==typeof o&&!a&&!i&&!1!==e.autobind;if(s)d.__reactAutoBindMap||(d.__reactAutoBindMap={}),d.__reactAutoBindMap[n]=o,d[n]=o;else if(i){var p=b[n];!a||p!==y.DEFINE_MANY_MERGED&&p!==y.DEFINE_MANY?h(!1):void 0,p===y.DEFINE_MANY_MERGED?d[n]=N(d[n],o):p===y.DEFINE_MANY&&(d[n]=t(d[n],o))}else d[n]=o}}}}}function o(d,e){if(e)for(var t in e){var n=e[t];if(e.hasOwnProperty(t)){var r=(t in E);r?h(!1):void 0;var o=(t in d);o?h(!1):void 0,d[t]=n}}}function a(o,e){o&&e&&"object"==_typeof(o)&&"object"==_typeof(e)?void 0:h(!1);for(var t in e){e.hasOwnProperty(t)&&(void 0!==o[t]?h(!1):void 0,o[t]=e[t])}return o}function N(d,e){return function(){var t=d.apply(this,arguments),n=e.apply(this,arguments);if(null==t)return n;if(null==n)return t;var r={};return a(r,t),a(r,n),r}}function t(n,e){return function(){n.apply(this,arguments),e.apply(this,arguments)}}function i(o,e){var t=e.bind(o);return t}function s(o){for(var e in o.__reactAutoBindMap){if(o.__reactAutoBindMap.hasOwnProperty(e)){var t=o.__reactAutoBindMap[e];o[e]=i(o,t)}}}var u=n(34),c=n(55),d=(n(79),n(78),n(74)),p=n(24),l=n(151),h=n(158),m=n(162),f=n(163),g=(n(168),f({mixins:null})),y=m({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),C=[],b={mixins:y.DEFINE_MANY,statics:y.DEFINE_MANY,propTypes:y.DEFINE_MANY,contextTypes:y.DEFINE_MANY,childContextTypes:y.DEFINE_MANY,getDefaultProps:y.DEFINE_MANY_MERGED,getInitialState:y.DEFINE_MANY_MERGED,getChildContext:y.DEFINE_MANY_MERGED,render:y.DEFINE_ONCE,componentWillMount:y.DEFINE_MANY,componentDidMount:y.DEFINE_MANY,componentWillReceiveProps:y.DEFINE_MANY,shouldComponentUpdate:y.DEFINE_ONCE,componentWillUpdate:y.DEFINE_MANY,componentDidUpdate:y.DEFINE_MANY,componentWillUnmount:y.DEFINE_MANY,updateComponent:y.OVERRIDE_BASE},E={displayName:function displayName(n,e){n.displayName=e},mixins:function mixins(o,e){if(e)for(var t=0;t<e.length;t++){r(o,e[t])}},childContextTypes:function childContextTypes(n,e){n.childContextTypes=p({},n.childContextTypes,e)},contextTypes:function contextTypes(n,e){n.contextTypes=p({},n.contextTypes,e)},getDefaultProps:function getDefaultProps(n,e){n.getDefaultProps?n.getDefaultProps=N(n.getDefaultProps,e):n.getDefaultProps=e},propTypes:function propTypes(n,e){n.propTypes=p({},n.propTypes,e)},statics:function statics(n,e){o(n,e)},autobind:function autobind(){}},_={replaceState:function replaceState(n,e){this.updater.enqueueReplaceState(this,n),e&&this.updater.enqueueCallback(this,e)},isMounted:function isMounted(){return this.updater.isMounted(this)},setProps:function setProps(n,e){this.updater.enqueueSetProps(this,n),e&&this.updater.enqueueCallback(this,e)},replaceProps:function replaceProps(n,e){this.updater.enqueueReplaceProps(this,n),e&&this.updater.enqueueCallback(this,e)}},x=function(){};p(x.prototype,u.prototype,_);e.exports={createClass:function createClass(o){var e=function(t,e,o){this.__reactAutoBindMap&&s(this),this.props=t,this.context=e,this.refs=l,this.updater=o||d,this.state=null;var n=this.getInitialState?this.getInitialState():null;"object"!=_typeof(n)||Array.isArray(n)?h(!1):void 0,this.state=n};e.prototype=new x,e.prototype.constructor=e,C.forEach(r.bind(null,e)),r(e,o),e.getDefaultProps&&(e.defaultProps=e.getDefaultProps()),e.prototype.render?void 0:h(!1);for(var t in b){e.prototype[t]||(e.prototype[t]=null)}return e},injection:{injectMixin:function injectMixin(t){C.push(t)}}}},{151:151,158:158,162:162,163:163,168:168,24:24,34:34,55:55,74:74,78:78,79:79}],34:[function(n,e){"use strict";function t(a,e,t){this.props=a,this.context=e,this.refs=o,this.updater=t||r}var r=n(74),o=(n(114),n(151)),a=n(158);n(168);t.prototype.isReactComponent={},t.prototype.setState=function(n,e){"object"!=_typeof(n)&&"function"!=typeof n&&null!=n?a(!1):void 0,this.updater.enqueueSetState(this,n),e&&this.updater.enqueueCallback(this,e)},t.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this),t&&this.updater.enqueueCallback(this,t)};e.exports=t},{114:114,151:151,158:158,168:168,74:74}],35:[function(n,e){"use strict";var t=n(45),r=n(70),o={processChildrenUpdates:t.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:t.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function unmountIDFromEnvironment(t){r.purgeID(t)}};e.exports=o},{45:45,70:70}],36:[function(n,e){"use strict";var t=n(158),r=!1,d={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function injectEnvironment(n){r?t(!1):void 0,d.unmountIDFromEnvironment=n.unmountIDFromEnvironment,d.replaceNodeWithMarkupByID=n.replaceNodeWithMarkupByID,d.processChildrenUpdates=n.processChildrenUpdates,r=!0}}};e.exports=d},{158:158}],37:[function(n,e){"use strict";var o=n(137);e.exports={shouldComponentUpdate:function shouldComponentUpdate(n,e){return o(this,n,e)}}},{137:137}],38:[function(n,e){"use strict";function C(o){var e=o._currentElement._owner||null;if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}function b(){}var o=n(36),t=n(39),E=n(55),u=n(66),r=n(76),s=n(79),_=(n(78),n(82)),p=n(92),d=n(24),x=n(151),h=n(158),l=n(138);n(168);b.prototype.render=function(){var t=u.get(this)._currentElement.type;return t(this.props,this.context,this.updater)};var v=1,a={construct:function construct(t){this._currentElement=t,this._rootNodeID=null,this._instance=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._topLevelWrapper=null,this._pendingCallbacks=null},mountComponent:function mountComponent(o,e,t){this._context=t,this._mountOrder=v++,this._rootNodeID=o;var n,d,s=this._processProps(this._currentElement.props),i=this._processContext(t),l=this._currentElement.type,c=("prototype"in l);c&&(n=new l(s,i,p)),(!c||null===n||!1===n||E.isValidElement(n))&&(d=n,n=new b(l)),n.props=s,n.context=i,n.refs=x,n.updater=p,this._instance=n,u.set(n,this);var f=n.state;void 0===f&&(n.state=f=null),"object"!=_typeof(f)||Array.isArray(f)?h(!1):void 0,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,n.componentWillMount&&(n.componentWillMount(),this._pendingStateQueue&&(n.state=this._processPendingState(n.props,n.context))),void 0===d&&(d=this._renderValidatedComponent()),this._renderedComponent=this._instantiateReactComponent(d);var g=_.mountComponent(this._renderedComponent,o,e,this._processChildContext(t));return n.componentDidMount&&e.getReactMountReady().enqueue(n.componentDidMount,n),g},unmountComponent:function unmountComponent(){var t=this._instance;t.componentWillUnmount&&t.componentWillUnmount(),_.unmountComponent(this._renderedComponent),this._renderedComponent=null,this._instance=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,this._topLevelWrapper=null,u.remove(t)},_maskContext:function _maskContext(a){var e=null,d=this._currentElement.type,n=d.contextTypes;if(!n)return x;e={};for(var r in n){e[r]=a[r]}return e},_processContext:function _processContext(n){var e=this._maskContext(n);return e},_processChildContext:function _processChildContext(a){var e=this._currentElement.type,t=this._instance,n=t.getChildContext&&t.getChildContext();if(n){"object"!=_typeof(e.childContextTypes)?h(!1):void 0;for(var r in n){r in e.childContextTypes?void 0:h(!1)}return d({},a,n)}return a},_processProps:function _processProps(t){return t},_checkPropTypes:function _checkPropTypes(r,e,t){var n=this.getName();for(var o in r){if(r.hasOwnProperty(o)){var a;try{"function"!=typeof r[o]?h(!1):void 0,a=r[o](e,o,n,t)}catch(e){a=e}a instanceof Error&&(C(this),t===s.prop)}}},receiveComponent:function receiveComponent(a,e,t){var n=this._currentElement,r=this._context;this._pendingElement=null,this.updateComponent(e,n,a,r,t)},performUpdateIfNecessary:function performUpdateIfNecessary(t){null!=this._pendingElement&&_.receiveComponent(this,this._pendingElement||this._currentElement,t,this._context),(null!==this._pendingStateQueue||this._pendingForceUpdate)&&this.updateComponent(t,this._currentElement,this._currentElement,this._context,this._context)},updateComponent:function updateComponent(d,e,t,n,r){var o,p=this._instance,i=this._context===r?p.context:this._processContext(r);e===t?o=t.props:(o=this._processProps(t.props),p.componentWillReceiveProps&&p.componentWillReceiveProps(o,i));var u=this._processPendingState(o,i),s=this._pendingForceUpdate||!p.shouldComponentUpdate||p.shouldComponentUpdate(o,u,i);s?(this._pendingForceUpdate=!1,this._performComponentUpdate(t,o,u,i,d,r)):(this._currentElement=t,this._context=r,p.props=o,p.state=u,p.context=i)},_processPendingState:function _processPendingState(p,e){var t=this._instance,n=this._pendingStateQueue,r=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!n)return t.state;if(r&&1===n.length)return n[0];for(var o=d({},r?n[0]:t.state),a=r?1:0,s;a<n.length;a++){s=n[a];d(o,"function"==typeof s?s.call(t,o,p,e):s)}return o},_performComponentUpdate:function _performComponentUpdate(d,e,t,n,r,o){var a,p,m,f=this._instance,l=!!f.componentDidUpdate;l&&(a=f.props,p=f.state,m=f.context),f.componentWillUpdate&&f.componentWillUpdate(e,t,n),this._currentElement=d,this._context=o,f.props=e,f.state=t,f.context=n,this._updateRenderedComponent(r,o),l&&r.getReactMountReady().enqueue(f.componentDidUpdate.bind(f,a,p,m),f)},_updateRenderedComponent:function _updateRenderedComponent(d,e){var t=this._renderedComponent,n=t._currentElement,r=this._renderValidatedComponent();if(l(n,r))_.receiveComponent(t,r,d,this._processChildContext(e));else{var o=this._rootNodeID,a=t._rootNodeID;_.unmountComponent(t),this._renderedComponent=this._instantiateReactComponent(r);var i=_.mountComponent(this._renderedComponent,o,d,this._processChildContext(e));this._replaceNodeWithMarkupByID(a,i)}},_replaceNodeWithMarkupByID:function _replaceNodeWithMarkupByID(n,e){o.replaceNodeWithMarkupByID(n,e)},_renderValidatedComponentWithoutOwnerOrContext:function _renderValidatedComponentWithoutOwnerOrContext(){var n=this._instance,e=n.render();return e},_renderValidatedComponent:function _renderValidatedComponent(){var n;t.current=this;try{n=this._renderValidatedComponentWithoutOwnerOrContext()}finally{t.current=null}return null===n||!1===n||E.isValidElement(n)?void 0:h(!1),n},attachRef:function attachRef(a,e){var t=this.getPublicInstance();null==t?h(!1):void 0;var n=e.getPublicInstance(),r=t.refs===x?t.refs={}:t.refs;r[a]=n},detachRef:function detachRef(n){var e=this.getPublicInstance().refs;delete e[n]},getName:function getName(){var n=this._currentElement.type,e=this._instance&&this._instance.constructor;return n.displayName||e&&e.displayName||n.name||e&&e.name||null},getPublicInstance:function getPublicInstance(){var t=this._instance;return t instanceof b?null:t},_instantiateReactComponent:null};r.measureMethods(a,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});e.exports={Mixin:a}},{138:138,151:151,158:158,168:168,24:24,36:36,39:39,55:55,66:66,76:76,78:78,79:79,82:82,92:92}],39:[function(n,e){"use strict";e.exports={current:null}},{}],40:[function(n,e){"use strict";var t=n(39),r=n(51),o=n(54),a=n(65),i=n(70),u=n(76),s=n(82),l=n(93),c=n(94),p=n(119),d=n(134);n(168);o.inject();var m=u.measure("React","render",i.render),f={findDOMNode:p,render:m,unmountComponentAtNode:i.unmountComponentAtNode,version:c,unstable_batchedUpdates:l.batchedUpdates,unstable_renderSubtreeIntoContainer:d};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:t,InstanceHandles:a,Mount:i,Reconciler:s,TextComponent:r});e.exports=f},{119:119,134:134,168:168,39:39,51:51,54:54,65:65,70:70,76:76,82:82,93:93,94:94}],41:[function(n,e){"use strict";var d={onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0};e.exports={getNativeProps:function getNativeProps(n,e){if(!e.disabled)return e;var t={};for(var o in e){e.hasOwnProperty(o)&&!d[o]&&(t[o]=e[o])}return t}}},{}],42:[function(n,e){"use strict";function t(){return this}function r(){var t=this._reactInternalComponent;return!!t}function o(){}function a(o,e){var t=this._reactInternalComponent;t&&(R.enqueueSetPropsInternal(t,o),e&&R.enqueueCallbackInternal(t,e))}function i(o,e){var t=this._reactInternalComponent;t&&(R.enqueueReplacePropsInternal(t,o),e&&R.enqueueCallbackInternal(t,e))}function ee(n,e){e&&(null!=e.dangerouslySetInnerHTML&&(null!=e.children?w(!1):void 0,"object"==_typeof(e.dangerouslySetInnerHTML)&&q in e.dangerouslySetInnerHTML?void 0:w(!1)),null!=e.style&&"object"!=_typeof(e.style)?w(!1):void 0)}function u(d,e,t,n){var r=N.findReactContainerForID(d);if(r){var o=r.nodeType===H?r.ownerDocument:r;V(e,o)}n.getReactMountReady().enqueue(s,{id:d,registrationName:e,listener:t})}function s(){var t=this;E.putListener(t.id,t.registrationName,t.listener)}function l(){var o=this;o._rootNodeID?void 0:w(!1);var e=N.getNode(o._rootNodeID);switch(e?void 0:w(!1),o._tag){case"iframe":o._wrapperState.listeners=[E.trapBubbledEvent(b.topLevelTypes.topLoad,"load",e)];break;case"video":case"audio":o._wrapperState.listeners=[];for(var t in Y){Y.hasOwnProperty(t)&&o._wrapperState.listeners.push(E.trapBubbledEvent(b.topLevelTypes[t],Y[t],e))}break;case"img":o._wrapperState.listeners=[E.trapBubbledEvent(b.topLevelTypes.topError,"error",e),E.trapBubbledEvent(b.topLevelTypes.topLoad,"load",e)];break;case"form":o._wrapperState.listeners=[E.trapBubbledEvent(b.topLevelTypes.topReset,"reset",e),E.trapBubbledEvent(b.topLevelTypes.topSubmit,"submit",e)];}}function p(){v.mountReadyWrapper(this)}function d(){P.postUpdateWrapper(this)}function c(t){$.call(X,t)||(Q.test(t)?void 0:w(!1),X[t]=!0)}function f(n,e){return 0<=n.indexOf("-")||null!=e.is}function h(t){c(t),this._tag=t.toLowerCase(),this._renderedChildren=null,this._previousStyle=null,this._previousStyleCopy=null,this._rootNodeID=null,this._wrapperState=null,this._topLevelWrapper=null,this._nodeWithLegacyProperties=null}var m=n(2),g=n(5),y=n(10),C=n(11),b=n(15),E=n(28),_=n(35),x=n(41),v=n(46),D=n(47),P=n(48),T=n(52),N=n(70),M=n(71),S=n(76),R=n(92),I=n(24),k=n(114),O=n(118),w=n(158),A=(n(130),n(163)),L=n(135),U=n(136),F=(n(166),n(141),n(168),E.deleteListener),V=E.listenTo,B=E.registrationNameModules,W={string:!0,number:!0},j=A({children:null}),K=A({style:null}),q=A({__html:null}),H=1,Y={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},z={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},G={listing:!0,pre:!0,textarea:!0},Q=(I({menuitem:!0},z),/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/),X={},$={}.hasOwnProperty;h.displayName="ReactDOMComponent",h.Mixin={construct:function construct(t){this._currentElement=t},mountComponent:function mountComponent(d,e,t){this._rootNodeID=d;var s=this._currentElement.props;switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":this._wrapperState={listeners:null},e.getReactMountReady().enqueue(l,this);break;case"button":s=x.getNativeProps(this,s,t);break;case"input":v.mountWrapper(this,s,t),s=v.getNativeProps(this,s,t);break;case"option":D.mountWrapper(this,s,t),s=D.getNativeProps(this,s,t);break;case"select":P.mountWrapper(this,s,t),s=P.getNativeProps(this,s,t),t=P.processChildContext(this,s,t);break;case"textarea":T.mountWrapper(this,s,t),s=T.getNativeProps(this,s,t);}ee(this,s);var c;if(e.useCreateElement){var f=t[N.ownerDocumentContextKey],a=f.createElement(this._currentElement.type);C.setAttributeForID(a,this._rootNodeID),N.getID(a),this._updateDOMProperties({},s,e,a),this._createInitialChildren(e,s,t,a),c=a}else{var i=this._createOpenTagMarkupAndPutListeners(e,s),u=this._createContentMarkup(e,s,t);c=!u&&z[this._tag]?i+"/>":i+">"+u+"</"+this._currentElement.type+">"}switch(this._tag){case"input":e.getReactMountReady().enqueue(p,this);case"button":case"select":case"textarea":s.autoFocus&&e.getReactMountReady().enqueue(m.focusDOMComponent,this);}return c},_createOpenTagMarkupAndPutListeners:function _createOpenTagMarkupAndPutListeners(d,e){var t="<"+this._currentElement.type;for(var p in e){if(e.hasOwnProperty(p)){var r=e[p];if(null!=r)if(B.hasOwnProperty(p))r&&u(this._rootNodeID,p,r,d);else{p===K&&(r&&(r=this._previousStyleCopy=I({},e.style)),r=g.createMarkupForStyles(r));var s=null;null!=this._tag&&f(this._tag,e)?p!==j&&(s=C.createMarkupForCustomAttribute(p,r)):s=C.createMarkupForProperty(p,r),s&&(t+=" "+s)}}}if(d.renderToStaticMarkup)return t;var l=C.createMarkupForID(this._rootNodeID);return t+" "+l},_createContentMarkup:function _createContentMarkup(d,e,t){var n="",p=e.dangerouslySetInnerHTML;if(null!=p)null!=p.__html&&(n=p.__html);else{var o=W[_typeof(e.children)]?e.children:null,a=null!=o?null:e.children;if(null!=o)n=O(o);else if(null!=a){var i=this.mountChildren(a,d,t);n=i.join("")}}return G[this._tag]&&"\n"===n.charAt(0)?"\n"+n:n},_createInitialChildren:function _createInitialChildren(d,e,t,n){var r=e.dangerouslySetInnerHTML;if(null!=r)null!=r.__html&&L(n,r.__html);else{var o=W[_typeof(e.children)]?e.children:null,a=null!=o?null:e.children;if(null!=o)U(n,o);else if(null!=a)for(var i=this.mountChildren(a,d,t),p=0;p<i.length;p++){n.appendChild(i[p])}}},receiveComponent:function receiveComponent(o,e,t){var n=this._currentElement;this._currentElement=o,this.updateComponent(e,n,o,t)},updateComponent:function updateComponent(i,e,t,n){var r=e.props,p=this._currentElement.props;switch(this._tag){case"button":r=x.getNativeProps(this,r),p=x.getNativeProps(this,p);break;case"input":v.updateWrapper(this),r=v.getNativeProps(this,r),p=v.getNativeProps(this,p);break;case"option":r=D.getNativeProps(this,r),p=D.getNativeProps(this,p);break;case"select":r=P.getNativeProps(this,r),p=P.getNativeProps(this,p);break;case"textarea":T.updateWrapper(this),r=T.getNativeProps(this,r),p=T.getNativeProps(this,p);}ee(this,p),this._updateDOMProperties(r,p,i,null),this._updateDOMChildren(r,p,i,n),!k&&this._nodeWithLegacyProperties&&(this._nodeWithLegacyProperties.props=p),"select"===this._tag&&i.getReactMountReady().enqueue(d,this)},_updateDOMProperties:function _updateDOMProperties(d,e,t,n){var p,l,m;for(p in d){if(!e.hasOwnProperty(p)&&d.hasOwnProperty(p))if(p===K){var h=this._previousStyleCopy;for(l in h){h.hasOwnProperty(l)&&(m=m||{},m[l]="")}this._previousStyleCopy=null}else B.hasOwnProperty(p)?d[p]&&F(this._rootNodeID,p):(y.properties[p]||y.isCustomAttribute(p))&&(n||(n=N.getNode(this._rootNodeID)),C.deleteValueForProperty(n,p))}for(p in e){var b=e[p],E=p===K?this._previousStyleCopy:d[p];if(e.hasOwnProperty(p)&&b!==E)if(p===K){if(b?b=this._previousStyleCopy=I({},b):this._previousStyleCopy=null,E){for(l in E){!E.hasOwnProperty(l)||b&&b.hasOwnProperty(l)||(m=m||{},m[l]="")}for(l in b){b.hasOwnProperty(l)&&E[l]!==b[l]&&(m=m||{},m[l]=b[l])}}else m=b;}else B.hasOwnProperty(p)?b?u(this._rootNodeID,p,b,t):E&&F(this._rootNodeID,p):f(this._tag,e)?(n||(n=N.getNode(this._rootNodeID)),p===j&&(b=null),C.setValueForAttribute(n,p,b)):(y.properties[p]||y.isCustomAttribute(p))&&(n||(n=N.getNode(this._rootNodeID)),null!=b?C.setValueForProperty(n,p,b):C.deleteValueForProperty(n,p))}m&&(n||(n=N.getNode(this._rootNodeID)),g.setValueForStyles(n,m))},_updateDOMChildren:function _updateDOMChildren(d,e,t,n){var r=W[_typeof(d.children)]?d.children:null,o=W[_typeof(e.children)]?e.children:null,a=d.dangerouslySetInnerHTML&&d.dangerouslySetInnerHTML.__html,i=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,p=null!=r?null:d.children,s=null!=o?null:e.children;null!=p&&null==s?this.updateChildren(null,t,n):(null!=r||null!=a)&&!(null!=o||null!=i)&&this.updateTextContent(""),null!=o?r!==o&&this.updateTextContent(""+o):null!=i?a!==i&&this.updateMarkup(""+i):null!=s&&this.updateChildren(s,t,n)},unmountComponent:function unmountComponent(){switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":var o=this._wrapperState.listeners;if(o)for(var e=0;e<o.length;e++){o[e].remove()}break;case"input":v.unmountWrapper(this);break;case"html":case"head":case"body":w(!1);}if(this.unmountChildren(),E.deleteAllListeners(this._rootNodeID),_.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null,this._wrapperState=null,this._nodeWithLegacyProperties){var r=this._nodeWithLegacyProperties;r._reactInternalComponent=null,this._nodeWithLegacyProperties=null}},getPublicInstance:function getPublicInstance(){if(!this._nodeWithLegacyProperties){var n=N.getNode(this._rootNodeID);n._reactInternalComponent=this,n.getDOMNode=t,n.isMounted=r,n.setState=o,n.replaceState=o,n.forceUpdate=o,n.setProps=a,n.replaceProps=i,n.props=this._currentElement.props,this._nodeWithLegacyProperties=n}return this._nodeWithLegacyProperties}},S.measureMethods(h,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"}),I(h.prototype,h.Mixin,M.Mixin),e.exports=h},{10:10,11:11,114:114,118:118,130:130,135:135,136:136,141:141,15:15,158:158,163:163,166:166,168:168,2:2,24:24,28:28,35:35,41:41,46:46,47:47,48:48,5:5,52:52,70:70,71:71,76:76,92:92}],43:[function(n,e){"use strict";var t=n(55),o=(n(56),n(164)),r=o({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hgroup:"hgroup",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul",var:"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",image:"image",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},function(n){return t.createFactory(n)});e.exports=r},{164:164,55:55,56:56}],44:[function(n,e){"use strict";e.exports={useCreateElement:!1}},{}],45:[function(n,e){"use strict";var d=n(9),p=n(11),o=n(70),t=n(76),a=n(158),i={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},r={updatePropertyByID:function updatePropertyByID(d,e,t){var n=o.getNode(d);i.hasOwnProperty(e)?a(!1):void 0,null!=t?p.setValueForProperty(n,e,t):p.deleteValueForProperty(n,e)},dangerouslyReplaceNodeWithMarkupByID:function dangerouslyReplaceNodeWithMarkupByID(r,e){var t=o.getNode(r);d.dangerouslyReplaceNodeWithMarkup(t,e)},dangerouslyProcessChildrenUpdates:function dangerouslyProcessChildrenUpdates(r,e){for(var t=0;t<r.length;t++){r[t].parentNode=o.getNode(r[t].parentID)}d.processUpdates(r,e)}};t.measureMethods(r,"ReactDOMIDOperations",{dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"}),e.exports=r},{11:11,158:158,70:70,76:76,9:9}],46:[function(n,e){"use strict";function g(){this._rootNodeID&&p.updateWrapper(this)}function r(r){var e=this._currentElement.props,p=y.executeOnChange(e,r);i.asap(g,this);var n=e.name;if("radio"===e.type&&null!=n){for(var o=t.getNode(this._rootNodeID),s=o;s.parentNode;){s=s.parentNode}for(var c=s.querySelectorAll("input[name="+JSON.stringify(""+n)+"][type=\"radio\"]"),d=0,C;d<c.length;d++){C=c[d];if(C!==o&&C.form===o.form){var b=t.getID(C);b?void 0:a(!1);var E=u[b];E?void 0:a(!1),i.asap(g,E)}}}return p}var o=n(45),y=n(23),t=n(70),i=n(93),s=n(24),a=n(158),u={},p={getNativeProps:function getNativeProps(n,e){var t=y.getValue(e),r=y.getChecked(e),o=s({},e,{defaultChecked:void 0,defaultValue:void 0,value:null!=t?t:n._wrapperState.initialValue,checked:null!=r?r:n._wrapperState.initialChecked,onChange:n._wrapperState.onChange});return o},mountWrapper:function mountWrapper(o,e){var t=e.defaultValue;o._wrapperState={initialChecked:e.defaultChecked||!1,initialValue:null!=t?t:null,onChange:r.bind(o)}},mountReadyWrapper:function mountReadyWrapper(t){u[t._rootNodeID]=t},unmountWrapper:function unmountWrapper(t){delete u[t._rootNodeID]},updateWrapper:function updateWrapper(a){var e=a._currentElement.props,t=e.checked;null!=t&&o.updatePropertyByID(a._rootNodeID,"checked",t||!1);var n=y.getValue(e);null!=n&&o.updatePropertyByID(a._rootNodeID,"value",""+n)}};e.exports=p},{158:158,23:23,24:24,45:45,70:70,93:93}],47:[function(n,e){"use strict";var d=n(32),t=n(48),r=n(24),p=(n(168),t.valueContextKey);e.exports={mountWrapper:function mountWrapper(d,e,t){var n=t[p],r=null;if(null!=n)if(r=!1,Array.isArray(n)){for(var i=0;i<n.length;i++){if(""+n[i]==""+e.value){r=!0;break}}}else r=""+n==""+e.value;d._wrapperState={selected:r}},getNativeProps:function getNativeProps(n,e){var t=r({selected:void 0,children:void 0},e);null!=n._wrapperState.selected&&(t.selected=n._wrapperState.selected);var o="";return d.forEach(e.children,function(t){null!=t&&("string"==typeof t||"number"==typeof t)&&(o+=t)}),t.children=o,t}}},{168:168,24:24,32:32,48:48}],48:[function(n,e){"use strict";function d(){if(this._rootNodeID&&this._wrapperState.pendingUpdate){this._wrapperState.pendingUpdate=!1;var n=this._currentElement.props,e=a.getValue(n);null!=e&&p(this,n,e)}}function p(d,e,t){var n,p,s=m.getNode(d._rootNodeID).options;if(e){for(n={},p=0;p<t.length;p++){n[""+t[p]]=!0}for(p=0;p<s.length;p++){var a=n.hasOwnProperty(s[p].value);s[p].selected!==a&&(s[p].selected=a)}}else{for(n=""+t,p=0;p<s.length;p++){if(s[p].value===n)return void(s[p].selected=!0)}s.length&&(s[0].selected=!0)}}function o(o){var e=this._currentElement.props,t=a.executeOnChange(e,o);return this._wrapperState.pendingUpdate=!0,r.asap(d,this),t}var a=n(23),m=n(70),r=n(93),i=n(24),s=(n(168),"__ReactDOMSelect_value$"+Math.random().toString(36).slice(2));e.exports={valueContextKey:s,getNativeProps:function getNativeProps(n,e){return i({},e,{onChange:n._wrapperState.onChange,value:void 0})},mountWrapper:function mountWrapper(r,e){var t=a.getValue(e);r._wrapperState={pendingUpdate:!1,initialValue:null!=t?t:e.defaultValue,onChange:o.bind(r),wasMultiple:!!e.multiple}},processChildContext:function processChildContext(o,e,t){var n=i({},t);return n[s]=o._wrapperState.initialValue,n},postUpdateWrapper:function postUpdateWrapper(o){var e=o._currentElement.props;o._wrapperState.initialValue=void 0;var t=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!e.multiple;var n=a.getValue(e);null!=n?(o._wrapperState.pendingUpdate=!1,p(o,!!e.multiple,n)):t!==!!e.multiple&&(null!=e.defaultValue?p(o,!!e.multiple,e.defaultValue):p(o,!!e.multiple,e.multiple?[]:""))}}},{168:168,23:23,24:24,70:70,93:93}],49:[function(n,e){"use strict";function g(o,e,t,n){return o===t&&e===n}function t(d){var e=document.selection,t=e.createRange(),n=t.text.length,r=t.duplicate();r.moveToElementText(d),r.setEndPoint("EndToStart",t);var o=r.text.length;return{start:o,end:o+n}}function o(r){var e=window.getSelection&&window.getSelection();if(!e||0===e.rangeCount)return null;var t=e.anchorNode,n=e.anchorOffset,o=e.focusNode,a=e.focusOffset,i=e.getRangeAt(0);try{i.startContainer.nodeType,i.endContainer.nodeType}catch(e){return null}var s=g(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset),u=s?0:i.toString().length,l=i.cloneRange();l.selectNodeContents(r),l.setEnd(i.startContainer,i.startOffset);var p=g(l.startContainer,l.startOffset,l.endContainer,l.endOffset),d=p?0:l.toString().length,c=d+u,f=document.createRange();f.setStart(t,n),f.setEnd(o,a);var h=f.collapsed;return{start:h?c:d,end:h?d:c}}function r(d,e){if(window.getSelection){var t=window.getSelection(),n=d[l()].length,r=Math.min(e.start,n),c="undefined"==typeof e.end?r:Math.min(e.end,n);if(!t.extend&&r>c){var f=c;c=r,r=f}var i=m(d,r),u=m(d,c);if(i&&u){var s=document.createRange();s.setStart(i.node,i.offset),t.removeAllRanges(),r>c?(t.addRange(s),t.extend(u.node,u.offset)):(s.setEnd(u.node,u.offset),t.addRange(s))}}}var a=n(144),m=n(127),l=n(128),i=a.canUseDOM&&"selection"in document&&!("getSelection"in window),p={getOffsets:i?t:o,setOffsets:i?function(a,e){var t,d,i=document.selection.createRange().duplicate();"undefined"==typeof e.end?(t=e.start,d=t):e.start>e.end?(t=e.end,d=e.start):(t=e.start,d=e.end),i.moveToElementText(a),i.moveStart("character",t),i.setEndPoint("EndToStart",i),i.moveEnd("character",d-t),i.select()}:r};e.exports=p},{127:127,128:128,144:144}],50:[function(n,e){"use strict";var t=n(54),r=n(86),o=n(94);t.inject();var a={renderToString:r.renderToString,renderToStaticMarkup:r.renderToStaticMarkup,version:o};e.exports=a},{54:54,86:86,94:94}],51:[function(n,e){"use strict";var t=n(9),d=n(11),o=n(35),p=n(70),r=n(24),i=n(118),s=n(136),a=(n(141),function(){});r(a.prototype,{construct:function construct(t){this._currentElement=t,this._stringText=""+t,this._rootNodeID=null,this._mountIndex=0},mountComponent:function mountComponent(o,e,t){if(this._rootNodeID=o,e.useCreateElement){var n=t[p.ownerDocumentContextKey],r=n.createElement("span");return d.setAttributeForID(r,o),p.getID(r),s(r,this._stringText),r}var a=i(this._stringText);return e.renderToStaticMarkup?a:"<span "+d.createMarkupForID(o)+">"+a+"</span>"},receiveComponent:function receiveComponent(r){if(r!==this._currentElement){this._currentElement=r;var e=""+r;if(e!==this._stringText){this._stringText=e;var n=p.getNode(this._rootNodeID);t.updateTextContent(n,e)}}},unmountComponent:function unmountComponent(){o.unmountIDFromEnvironment(this._rootNodeID)}}),e.exports=a},{11:11,118:118,136:136,141:141,24:24,35:35,70:70,9:9}],52:[function(n,e){"use strict";function d(){this._rootNodeID&&t.updateWrapper(this)}function p(r){var e=this._currentElement.props,t=o.executeOnChange(e,r);return a.asap(d,this),t}var o=n(23),r=n(45),a=n(93),i=n(24),s=n(158),t=(n(168),{getNativeProps:function getNativeProps(n,e){null!=e.dangerouslySetInnerHTML?s(!1):void 0;var t=i({},e,{defaultValue:void 0,value:void 0,children:n._wrapperState.initialValue,onChange:n._wrapperState.onChange});return t},mountWrapper:function mountWrapper(a,e){var t=e.defaultValue,d=e.children;null!=d&&(null!=t?s(!1):void 0,Array.isArray(d)&&(1>=d.length?void 0:s(!1),d=d[0]),t=""+d),null==t&&(t="");var u=o.getValue(e);a._wrapperState={initialValue:""+(null!=u?u:t),onChange:p.bind(a)}},updateWrapper:function updateWrapper(a){var e=a._currentElement.props,t=o.getValue(e);null!=t&&r.updatePropertyByID(a._rootNodeID,"value",""+t)}});e.exports=t},{158:158,168:168,23:23,24:24,45:45,93:93}],53:[function(n,e){"use strict";function t(){this.reinitializeTransaction()}var r=n(93),o=n(110),a=n(24),i=n(150),s={initialize:i,close:r.flushBatchedUpdates.bind(r)},u=[s,{initialize:i,close:function close(){p.isBatchingUpdates=!1}}];a(t.prototype,o.Mixin,{getTransactionWrappers:function getTransactionWrappers(){return u}});var l=new t,p={isBatchingUpdates:!1,batchedUpdates:function batchedUpdates(d,e,t,n,r,o){var a=p.isBatchingUpdates;p.isBatchingUpdates=!0,a?d(e,t,n,r,o):l.perform(d,null,e,t,n,r,o)}};e.exports=p},{110:110,150:150,24:24,93:93}],54:[function(n,e){"use strict";function t(){D||(D=!0,m.EventEmitter.injectReactEventListener(v),m.EventPluginHub.injectEventPluginOrder(i),m.EventPluginHub.injectInstanceHandle(g),m.EventPluginHub.injectMount(y),m.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:_,EnterLeaveEventPlugin:u,ChangeEventPlugin:o,SelectEventPlugin:b,BeforeInputEventPlugin:r}),m.NativeComponent.injectGenericComponentClass(f),m.NativeComponent.injectTextComponentClass(h),m.Class.injectMixin(c),m.DOMProperty.injectDOMPropertyConfig(l),m.DOMProperty.injectDOMPropertyConfig(x),m.EmptyComponent.injectEmptyComponent("noscript"),m.Updates.injectReconcileTransaction(C),m.Updates.injectBatchingStrategy(d),m.RootIndex.injectCreateReactRootIndex(s.canUseDOM?a.createReactRootIndex:E.createReactRootIndex),m.Component.injectEnvironment(p))}var r=n(3),o=n(7),a=n(8),i=n(13),u=n(14),s=n(144),l=n(21),c=n(27),p=n(35),d=n(53),f=n(42),h=n(51),v=n(61),m=n(63),g=n(65),y=n(70),C=n(81),b=n(96),E=n(97),_=n(98),x=n(95),D=!1;e.exports={inject:t}},{13:13,14:14,144:144,21:21,27:27,3:3,35:35,42:42,51:51,53:53,61:61,63:63,65:65,7:7,70:70,8:8,81:81,95:95,96:96,97:97,98:98}],55:[function(n,e){"use strict";var m=n(39),r=n(24),d=(n(114),"function"==typeof Symbol&&Symbol["for"]&&Symbol["for"]("react.element")||60103),p={key:!0,ref:!0,__self:!0,__source:!0},i=function(a,e,t,n,r,o,i){return{$$typeof:d,type:a,key:e,ref:t,props:i,_owner:o}};i.createElement=function(r,e,t){var n,u={},a=null,g=null,y=null,C=null;if(null!=e){g=void 0===e.ref?null:e.ref,a=void 0===e.key?null:""+e.key,y=void 0===e.__self?null:e.__self,C=void 0===e.__source?null:e.__source;for(n in e){e.hasOwnProperty(n)&&!p.hasOwnProperty(n)&&(u[n]=e[n])}}var b=arguments.length-2;if(1==b)u.children=t;else if(1<b){for(var d=Array(b),f=0;b>f;f++){d[f]=arguments[f+2]}u.children=d}if(r&&r.defaultProps){var E=r.defaultProps;for(n in E){"undefined"==typeof u[n]&&(u[n]=E[n])}}return i(r,a,g,y,C,m.current,u)},i.createFactory=function(n){var e=i.createElement.bind(null,n);return e.type=n,e},i.cloneAndReplaceKey=function(o,e){var t=i(o.type,e,o.ref,o._self,o._source,o._owner,o.props);return t},i.cloneAndReplaceProps=function(o,e){var t=i(o.type,o.key,o.ref,o._self,o._source,o._owner,e);return t},i.cloneElement=function(o,e,t){var n,u=r({},o.props),s=o.key,g=o.ref,y=o._self,C=o._source,d=o._owner;if(null!=e){void 0!==e.ref&&(g=e.ref,d=m.current),void 0!==e.key&&(s=""+e.key);for(n in e){e.hasOwnProperty(n)&&!p.hasOwnProperty(n)&&(u[n]=e[n])}}var b=arguments.length-2;if(1==b)u.children=t;else if(1<b){for(var h=Array(b),E=0;b>E;E++){h[E]=arguments[E+2]}u.children=h}return i(o.type,s,g,y,C,d,u)},i.isValidElement=function(t){return"object"==_typeof(t)&&null!==t&&t.$$typeof===d},e.exports=i},{114:114,24:24,39:39}],56:[function(n,e){"use strict";function g(){if(l.current){var t=l.current.getName();if(t)return" Check the render method of `"+t+"`."}return""}function y(n,e){n._store&&!n._store.validated&&null==n.key&&(n._store.validated=!0,o("uniqueKey",n,e))}function o(r,e,t){var n=g();if(!n){var d="string"==typeof t?t:t.displayName||t.name;d&&(n=" Check the top-level render call using <"+d+">.")}var a=c[r]||(c[r]={});if(a[n])return null;a[n]=!0;var i={parentOrOwner:n,url:" See https://fb.me/react-warning-keys for more information.",childOwner:null};return e&&e._owner&&e._owner!==l.current&&(i.childOwner=" It was passed a child from "+e._owner.getName()+"."),i}function t(o,e){if("object"==_typeof(o))if(Array.isArray(o))for(var t=0,d;t<o.length;t++){d=o[t];s.isValidElement(d)&&y(d,e)}else if(s.isValidElement(o))o._store&&(o._store.validated=!0);else if(o){var l=p(o);if(l&&l!==o.entries)for(var a,c=l.call(o);!(a=c.next()).done;){s.isValidElement(a.value)&&y(a.value,e)}}}function r(r,e,t,n){for(var o in e){if(e.hasOwnProperty(o)){var a;try{"function"!=typeof e[o]?d(!1):void 0,a=e[o](t,o,r,n)}catch(e){a=e}a instanceof Error&&!(a.message in u)&&(u[a.message]=!0,g())}}}function i(o){var e=o.type;if("function"==typeof e){var t=e.displayName||e.name;e.propTypes&&r(t,e.propTypes,o.props,a.prop),"function"==typeof e.getDefaultProps}}var s=n(55),a=n(79),l=(n(78),n(39)),p=(n(114),n(126)),d=n(158),c=(n(168),{}),u={},f={createElement:function createElement(n){var e=s.createElement.apply(this,arguments);if(null==e)return e;if("string"==typeof n||"function"==typeof n)for(var o=2;o<arguments.length;o++){t(arguments[o],n)}return i(e),e},createFactory:function createFactory(n){var e=f.createElement.bind(null,n);return e.type=n,e},cloneElement:function cloneElement(){for(var e=s.cloneElement.apply(this,arguments),n=2;n<arguments.length;n++){t(arguments[n],e.type)}return i(e),e}};e.exports=f},{114:114,126:126,158:158,168:168,39:39,55:55,78:78,79:79}],57:[function(n,e){"use strict";var t,d=n(55),o=n(58),a=n(82),i=n(24),p=function(n){this._currentElement=null,this._rootNodeID=null,this._renderedComponent=n(t)};i(p.prototype,{construct:function construct(){},mountComponent:function mountComponent(r,e,t){return o.registerNullComponentID(r),this._rootNodeID=r,a.mountComponent(this._renderedComponent,r,e,t)},receiveComponent:function receiveComponent(){},unmountComponent:function unmountComponent(){a.unmountComponent(this._renderedComponent),o.deregisterNullComponentID(this._rootNodeID),this._rootNodeID=null,this._renderedComponent=null}}),p.injection={injectEmptyComponent:function injectEmptyComponent(n){t=d.createElement(n)}},e.exports=p},{24:24,55:55,58:58,82:82}],58:[function(n,e){"use strict";var t={};e.exports={isNullComponentID:function(n){return!!t[n]},registerNullComponentID:function(n){t[n]=!0},deregisterNullComponentID:function(n){delete t[n]}}},{}],59:[function(n,e){"use strict";function t(o,e,t,n){try{return e(t,n)}catch(e){return void(null===r&&(r=e))}}var r=null;e.exports={invokeGuardedCallback:t,invokeGuardedCallbackWithCatch:t,rethrowCaughtError:function rethrowCaughtError(){if(r){var t=r;throw r=null,t}}}},{}],60:[function(n,e){"use strict";function d(t){r.enqueueEvents(t),r.processEventQueue(!1)}var r=n(16);e.exports={handleTopLevel:function handleTopLevel(o,e,t,n,a){var i=r.extractEvents(o,e,t,n,a);d(i)}}},{16:16}],61:[function(n,e){"use strict";function t(a){var e=p.getID(a),t=c.getReactRootIDFromNodeID(e),n=p.findReactContainerForID(t),r=p.getFirstReactDOM(n);return r}function r(n,e){this.topLevelType=n,this.nativeEvent=e,this.ancestors=[]}function o(t){a(t)}function a(r){for(var e=p.getFirstReactDOM(h(r.nativeEvent))||window,d=e;d;){r.ancestors.push(d),d=t(d)}for(var i=0;i<r.ancestors.length;i++){e=r.ancestors[i];var s=p.getID(e)||"";m._handleTopLevel(r.topLevelType,e,s,r.nativeEvent,h(r.nativeEvent))}}function i(n){var e=y(window);n(e)}var u=n(143),s=n(144),l=n(25),c=n(65),p=n(70),d=n(93),f=n(24),h=n(125),y=n(155);f(r.prototype,{destructor:function destructor(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),l.addPoolingTo(r,l.twoArgumentPooler);var m={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:s.canUseDOM?window:null,setHandleTopLevel:function setHandleTopLevel(t){m._handleTopLevel=t},setEnabled:function setEnabled(t){m._enabled=!!t},isEnabled:function isEnabled(){return m._enabled},trapBubbledEvent:function trapBubbledEvent(o,e,t){var n=t;return n?u.listen(n,e,m.dispatchEvent.bind(null,o)):null},trapCapturedEvent:function trapCapturedEvent(o,e,t){var n=t;return n?u.capture(n,e,m.dispatchEvent.bind(null,o)):null},monitorScrollValue:function monitorScrollValue(n){var e=i.bind(null,n);u.listen(window,"scroll",e)},dispatchEvent:function dispatchEvent(a,e){if(m._enabled){var t=r.getPooled(a,e);try{d.batchedUpdates(o,t)}finally{r.release(t)}}}};e.exports=m},{125:125,143:143,144:144,155:155,24:24,25:25,65:65,70:70,93:93}],62:[function(n,e){"use strict";var d=n(32),r=n(55),o=n(150),a=n(158),t=(n(168),{create:function create(i){if("object"!=_typeof(i)||!i||Array.isArray(i))return i;if(r.isValidElement(i))return i;1===i.nodeType?a(!1):void 0;var e=[];for(var t in i){d.mapIntoWithKeyPrefixInternal(i[t],e,t,o.thatReturnsArgument)}return e}});e.exports=t},{150:150,158:158,168:168,32:32,55:55}],63:[function(n,e){"use strict";var t=n(10),r=n(16),o=n(36),a=n(33),i=n(57),u=n(28),s=n(73),l=n(76),c=n(84),p=n(93),d={Component:o.injection,Class:a.injection,DOMProperty:t.injection,EmptyComponent:i.injection,EventPluginHub:r.injection,EventEmitter:u.injection,NativeComponent:s.injection,Perf:l.injection,RootIndex:c.injection,Updates:p.injection};e.exports=d},{10:10,16:16,28:28,33:33,36:36,57:57,73:73,76:76,84:84,93:93}],64:[function(n,e){"use strict";function d(n){return t(document.documentElement,n)}var p=n(49),t=n(147),r=n(152),a=n(153),i={hasSelectionCapabilities:function hasSelectionCapabilities(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&("input"===e&&"text"===n.type||"textarea"===e||"true"===n.contentEditable)},getSelectionInformation:function getSelectionInformation(){var t=a();return{focusedElem:t,selectionRange:i.hasSelectionCapabilities(t)?i.getSelection(t):null}},restoreSelection:function restoreSelection(p){var e=a(),t=p.focusedElem,n=p.selectionRange;e!==t&&d(t)&&(i.hasSelectionCapabilities(t)&&i.setSelection(t,n),r(t))},getSelection:function getSelection(o){var e;if("selectionStart"in o)e={start:o.selectionStart,end:o.selectionEnd};else if(document.selection&&o.nodeName&&"input"===o.nodeName.toLowerCase()){var r=document.selection.createRange();r.parentElement()===o&&(e={start:-r.moveStart("character",-o.value.length),end:-r.moveEnd("character",-o.value.length)})}else e=p.getOffsets(o);return e||{start:0,end:0}},setSelection:function setSelection(o,e){var t=e.start,n=e.end;if("undefined"==typeof n&&(n=t),"selectionStart"in o)o.selectionStart=t,o.selectionEnd=Math.min(n,o.value.length);else if(document.selection&&o.nodeName&&"input"===o.nodeName.toLowerCase()){var d=o.createTextRange();d.collapse(!0),d.moveStart("character",t),d.moveEnd("character",n-t),d.select()}else p.setOffsets(o,e)}};e.exports=i},{147:147,152:152,153:153,49:49}],65:[function(n,e){"use strict";function t(t){return a+t.toString(36)}function m(n,e){return n.charAt(e)===a||e===n.length}function o(t){return""===t||t.charAt(0)===a&&t.charAt(t.length-1)!==a}function g(n,e){return 0===e.indexOf(n)&&m(e,n.length)}function i(t){return t?t.substr(0,t.lastIndexOf(a)):""}function u(a,e){if(o(a)&&o(e)?void 0:y(!1),g(a,e)?void 0:y(!1),a===e)return a;var t,i=a.length+d;for(t=i;t<e.length&&!m(e,t);t++){}return e.substr(0,t)}function s(a,e){var t=Math.min(a.length,e.length);if(0===t)return"";for(var n=0,d=0;t>=d;d++){if(m(a,d)&&m(e,d))n=d;else if(a.charAt(d)!==e.charAt(d))break}var p=a.substr(0,n);return o(p)?void 0:y(!1),p}function l(d,s,m,n,r,o){d=d||"",s=s||"",d===s?y(!1):void 0;var a=g(s,d);a||g(d,s)?void 0:y(!1);for(var l=0,C=a?i:u,b=d;;b=C(b,s)){var E;if(r&&b===d||o&&b===s||(E=m(b,a,n)),!1===E||b===s)break;l++<p?void 0:y(!1)}}var r=n(84),y=n(158),a=".",d=".".length,p=1e4;e.exports={createReactRootID:function createReactRootID(){return t(r.createReactRootIndex())},createReactID:function createReactID(n,e){return n+e},getReactRootIDFromNodeID:function getReactRootIDFromNodeID(n){if(n&&n.charAt(0)==="."&&1<n.length){var e=n.indexOf(".",1);return-1<e?n.substr(0,e):n}return null},traverseEnterLeave:function traverseEnterLeave(d,e,t,n,r){var o=s(d,e);o!==d&&l(d,o,t,n,!1,!0),o!==e&&l(o,e,t,r,!0,!1)},traverseTwoPhase:function traverseTwoPhase(o,e,t){o&&(l("",o,e,t,!0,!1),l(o,"",e,t,!1,!0))},traverseTwoPhaseSkipTarget:function traverseTwoPhaseSkipTarget(o,e,t){o&&(l("",o,e,t,!0,!0),l(o,"",e,t,!0,!0))},traverseAncestors:function traverseAncestors(o,e,t){l("",o,e,t,!0,!1)},getFirstCommonAncestorID:s,_getNextDescendantID:u,isAncestorIDOf:g,SEPARATOR:"."}},{158:158,84:84}],66:[function(n,e){"use strict";e.exports={remove:function remove(t){t._reactInternalInstance=void 0},get:function get(t){return t._reactInternalInstance},has:function has(t){return void 0!==t._reactInternalInstance},set:function set(n,e){n._reactInternalInstance=e}}},{}],67:[function(n,e){"use strict";var t=n(32),r=n(34),o=n(33),a=n(43),i=n(55),u=(n(56),n(80)),s=n(94),l=n(24),c=n(132),p=i.createElement,d=i.createFactory,m=i.cloneElement,f={Children:{map:t.map,forEach:t.forEach,count:t.count,toArray:t.toArray,only:c},Component:r,createElement:p,cloneElement:m,isValidElement:i.isValidElement,PropTypes:u,createClass:o.createClass,createFactory:d,createMixin:function createMixin(t){return t},DOM:a,version:s,__spread:l};e.exports=f},{132:132,24:24,32:32,33:33,34:34,43:43,55:55,56:56,80:80,94:94}],68:[function(n,e){"use strict";function t(n,e){this.value=n,this.requestChange=e}var o=n(26);t.PropTypes={link:function(n){var e={value:"undefined"==typeof n?o.PropTypes.any.isRequired:n.isRequired,requestChange:o.PropTypes.func.isRequired};return o.PropTypes.shape(e)}},e.exports=t},{26:26}],69:[function(n,e){"use strict";var d=n(113),r={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function addChecksumToMarkup(n){var e=d(n);return n.replace(/\/?>/," "+r.CHECKSUM_ATTR_NAME+"=\""+e+"\"$&")},canReuseMarkup:function canReuseMarkup(a,e){var t=e.getAttribute(r.CHECKSUM_ATTR_NAME);t=t&&parseInt(t,10);var i=d(a);return i===t}};e.exports=r},{113:113}],70:[function(n,e){"use strict";function d(o,e){for(var t=Math.min(o.length,e.length),n=0;t>n;n++){if(o.charAt(n)!==e.charAt(n))return n}return o.length===e.length?-1:t}function j(t){return t?t.nodeType===w?t.documentElement:t.firstChild:null}function o(n){var e=j(n);return e&&W.getID(e)}function a(t){return t&&t.getAttribute&&t.getAttribute(k)||""}function r(o,e){if(o){a(o)!==e?R(!1):void 0;var t=W.findReactContainerForID(e);if(t&&N(t,o))return!0}return!1}function i(n){var e=O[n];return e&&r(e,n)?void(V=e):!1}function p(n){V=null,C.traverseAncestors(n,i);var e=V;return V=null,e}function s(d,e,t,n,r,o){h.useCreateElement&&(o=P({},o),t.nodeType===w?o[A]=t:o[A]=t.ownerDocument);var p=x.mountComponent(d,e,n,o);d._renderedComponent._topLevelWrapper=d,W._mountImageIntoNode(p,t,r,n)}function u(d,e,t,n,r){var o=D.ReactReconcileTransaction.getPooled(n);o.perform(s,null,d,e,t,o,n,r),D.ReactReconcileTransaction.release(o)}function l(n,e){for(x.unmountComponent(n),e.nodeType===w&&(e=e.documentElement);e.lastChild;){e.removeChild(e.lastChild)}}function m(n){var e=o(n);return e?e!==C.getReactRootIDFromNodeID(e):!1}function t(d){for(;d&&d.parentNode!==d;d=d.parentNode){if(1===d.nodeType){var i=a(d);if(i){var t,p=C.getReactRootIDFromNodeID(i),r=d;do{if(t=a(r),r=r.parentNode,null==r)return null}while(t!==p);if(r===U[p])return d}}}return null}var c=n(10),f=n(28),h=(n(39),n(44)),y=n(55),g=n(58),C=n(65),b=n(66),E=n(69),_=n(76),x=n(82),v=n(92),D=n(93),P=n(24),T=n(151),N=n(147),M=n(129),R=n(158),S=n(135),I=n(138),k=(n(141),n(168),c.ID_ATTRIBUTE_NAME),O={},w=9,A="__ReactMount_ownerDocument$"+Math.random().toString(36).slice(2),L={},U={},F=[],V=null,B=function(){};B.prototype.isReactComponent={},B.prototype.render=function(){return this.props};var W={TopLevelWrapper:B,_instancesByReactRootID:L,scrollMonitor:function scrollMonitor(n,e){e()},_updateRootComponent:function _updateRootComponent(o,e,t,n){return W.scrollMonitor(t,function(){v.enqueueElementInternal(o,e),n&&v.enqueueCallbackInternal(o,n)}),o},_registerComponent:function _registerComponent(o,e){!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11?R(!1):void 0,f.ensureScrollValueMonitoring();var t=W.registerContainer(e);return L[t]=o,t},_renderNewRootComponent:function _renderNewRootComponent(d,e,t,n){var r=M(d,null),o=W._registerComponent(r,e);return D.batchedUpdates(u,r,o,e,t,n),r},renderSubtreeIntoContainer:function renderSubtreeIntoContainer(o,e,t,n){return null==o||null==o._reactInternalInstance?R(!1):void 0,W._renderSubtreeIntoContainer(o,e,t,n)},_renderSubtreeIntoContainer:function _renderSubtreeIntoContainer(u,e,t,n){y.isValidElement(e)?void 0:R(!1);var r=new y(B,null,null,null,null,null,e),i=L[o(t)];if(i){var s=i._currentElement,l=s.props;if(I(l,e)){var c=i._renderedComponent.getPublicInstance(),p=n&&function(){n.call(c)};return W._updateRootComponent(i,r,t,p),c}W.unmountComponentAtNode(t)}var d=j(t),f=d&&!!a(d),h=m(t),C=W._renderNewRootComponent(r,t,f&&!i&&!h,null!=u?u._reactInternalInstance._processChildContext(u._reactInternalInstance._context):T)._renderedComponent.getPublicInstance();return n&&n.call(C),C},render:function render(o,e,t){return W._renderSubtreeIntoContainer(null,o,e,t)},registerContainer:function registerContainer(n){var e=o(n);return e&&(e=C.getReactRootIDFromNodeID(e)),e||(e=C.createReactRootID()),U[e]=n,e},unmountComponentAtNode:function unmountComponentAtNode(d){!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11?R(!1):void 0;var e=o(d),t=L[e];if(!t){var n=(m(d),a(d));return n&&n===C.getReactRootIDFromNodeID(n),!1}return D.batchedUpdates(l,t,d),delete L[e],delete U[e],!0},findReactContainerForID:function findReactContainerForID(o){var e=C.getReactRootIDFromNodeID(o),t=U[e];return t},findReactNodeByID:function findReactNodeByID(n){var e=W.findReactContainerForID(n);return W.findComponentRoot(e,n)},getFirstReactDOM:function getFirstReactDOM(n){return t(n)},findComponentRoot:function findComponentRoot(d,e){var t=F,n=0,s=p(e)||d;for(t[0]=s.firstChild,t.length=1;n<t.length;){for(var o,l=t[n++],c;l;){c=W.getID(l);c?e===c?o=l:C.isAncestorIDOf(c,e)&&(t.length=n=0,t.push(l.firstChild)):t.push(l.firstChild),l=l.nextSibling}if(o)return t.length=0,o}t.length=0,R(!1)},_mountImageIntoNode:function _mountImageIntoNode(o,e,t,n){if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11?R(!1):void 0,t){var r=j(e);if(E.canReuseMarkup(o,r))return;var a=r.getAttribute(E.CHECKSUM_ATTR_NAME);r.removeAttribute(E.CHECKSUM_ATTR_NAME);var i=r.outerHTML;r.setAttribute(E.CHECKSUM_ATTR_NAME,a);var p=o,s=d(p,i);" (client) "+p.substring(s-20,s+20)+"\n (server) "+i.substring(s-20,s+20),e.nodeType===9?R(!1):void 0}if(e.nodeType===9?R(!1):void 0,n.useCreateElement){for(;e.lastChild;){e.removeChild(e.lastChild)}e.appendChild(o)}else S(e,o)},ownerDocumentContextKey:A,getReactRootID:o,getID:function(o){var e=a(o);if(e)if(O.hasOwnProperty(e)){var t=O[e];t!==o&&(r(t,e)?R(!1):void 0,O[e]=o)}else O[e]=o;return e},setID:function(o,e){var t=a(o);t!==e&&delete O[t],o.setAttribute(k,e),O[e]=o},getNode:function(t){return O.hasOwnProperty(t)&&r(O[t],t)||(O[t]=W.findReactNodeByID(t)),O[t]},getNodeFromInstance:function(n){var e=b.get(n)._rootNodeID;return g.isNullComponentID(e)?null:(O.hasOwnProperty(e)&&r(O[e],e)||(O[e]=W.findReactNodeByID(e)),O[e])},isValid:r,purgeID:function(t){delete O[t]}};_.measureMethods(W,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"}),e.exports=W},{10:10,129:129,135:135,138:138,141:141,147:147,151:151,158:158,168:168,24:24,28:28,39:39,44:44,55:55,58:58,65:65,66:66,69:69,76:76,82:82,92:92,93:93}],71:[function(n,e){"use strict";function y(o,e,t){h.push({parentID:o,parentNode:null,type:l.INSERT_MARKUP,markupIndex:m.push(e)-1,content:null,fromIndex:null,toIndex:t})}function r(o,e,t){h.push({parentID:o,parentNode:null,type:l.MOVE_EXISTING,markupIndex:null,content:null,fromIndex:e,toIndex:t})}function t(n,e){h.push({parentID:n,parentNode:null,type:l.REMOVE_NODE,markupIndex:null,content:null,fromIndex:e,toIndex:null})}function o(n,e){h.push({parentID:n,parentNode:null,type:l.SET_MARKUP,markupIndex:null,content:e,fromIndex:null,toIndex:null})}function a(n,e){h.push({parentID:n,parentNode:null,type:l.TEXT_CONTENT,markupIndex:null,content:e,fromIndex:null,toIndex:null})}function i(){h.length&&(u.processChildrenUpdates(h,m),s())}function s(){h.length=0,m.length=0}var u=n(36),l=n(72),p=(n(39),n(82)),d=n(31),c=n(120),f=0,h=[],m=[];e.exports={Mixin:{_reconcilerInstantiateChildren:function _reconcilerInstantiateChildren(o,e,t){return d.instantiateChildren(o,e,t)},_reconcilerUpdateChildren:function _reconcilerUpdateChildren(a,e,t,n){var r;return r=c(e),d.updateChildren(a,r,t,n)},mountChildren:function mountChildren(d,e,t){var n=this._reconcilerInstantiateChildren(d,e,t);this._renderedChildren=n;var r=[],o=0;for(var c in n){if(n.hasOwnProperty(c)){var i=n[c],u=this._rootNodeID+c,s=p.mountComponent(i,u,e,t);i._mountIndex=o++,r.push(s)}}return r},updateTextContent:function updateTextContent(o){f++;var e=!0;try{var a=this._renderedChildren;d.unmountChildren(a);for(var n in a){a.hasOwnProperty(n)&&this._unmountChild(a[n])}this.setTextContent(o),e=!1}finally{f--,f||(e?s():i())}},updateMarkup:function updateMarkup(o){f++;var e=!0;try{var a=this._renderedChildren;d.unmountChildren(a);for(var n in a){a.hasOwnProperty(n)&&this._unmountChildByName(a[n],n)}this.setMarkup(o),e=!1}finally{f--,f||(e?s():i())}},updateChildren:function updateChildren(o,e,t){f++;var n=!0;try{this._updateChildren(o,e,t),n=!1}finally{f--,f||(n?s():i())}},_updateChildren:function _updateChildren(d,e,t){var n=this._renderedChildren,r=this._reconcilerUpdateChildren(n,d,e,t);if(this._renderedChildren=r,r||n){var o,p=0,c=0;for(o in r){if(r.hasOwnProperty(o)){var m=n&&n[o],s=r[o];m===s?(this.moveChild(m,c,p),p=Math.max(m._mountIndex,p),m._mountIndex=c):(m&&(p=Math.max(m._mountIndex,p),this._unmountChild(m)),this._mountChildByNameAtIndex(s,o,c,e,t)),c++}}for(o in n){!n.hasOwnProperty(o)||r&&r.hasOwnProperty(o)||this._unmountChild(n[o])}}},unmountChildren:function unmountChildren(){var t=this._renderedChildren;d.unmountChildren(t),this._renderedChildren=null},moveChild:function moveChild(o,e,t){o._mountIndex<t&&r(this._rootNodeID,o._mountIndex,e)},createChild:function createChild(n,e){y(this._rootNodeID,e,n._mountIndex)},removeChild:function removeChild(n){t(this._rootNodeID,n._mountIndex)},setTextContent:function setTextContent(t){a(this._rootNodeID,t)},setMarkup:function setMarkup(t){o(this._rootNodeID,t)},_mountChildByNameAtIndex:function _mountChildByNameAtIndex(d,e,t,n,r){var o=this._rootNodeID+e,a=p.mountComponent(d,o,n,r);d._mountIndex=t,this.createChild(d,a)},_unmountChild:function _unmountChild(t){this.removeChild(t),t._mountIndex=null}}}},{120:120,31:31,36:36,39:39,72:72,82:82}],72:[function(n,e){"use strict";var t=n(162),r=t({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,SET_MARKUP:null,TEXT_CONTENT:null});e.exports=r},{162:162}],73:[function(n,e){"use strict";function t(t){return s?void 0:i(!1),new s(t.type,t.props)}function o(t){return new p(t)}function r(t){return t instanceof p}var a=n(24),i=n(158),s=null,u={},p=null;e.exports={getComponentClassForElement:function(o){if("function"==typeof o.type)return o.type;var e=o.type,t=u[e];return null==t&&(u[e]=t=null(e)),t},createInternalComponent:t,createInstanceForText:o,isTextComponent:r,injection:{injectGenericComponentClass:function injectGenericComponentClass(t){s=t},injectTextComponentClass:function injectTextComponentClass(t){p=t},injectComponentClasses:function injectComponentClasses(t){a(u,t)}}}},{158:158,24:24}],74:[function(n,e){"use strict";function t(){}var r=(n(168),{isMounted:function isMounted(){return!1},enqueueCallback:function enqueueCallback(){},enqueueForceUpdate:function enqueueForceUpdate(n){t(n,"forceUpdate")},enqueueReplaceState:function enqueueReplaceState(n){t(n,"replaceState")},enqueueSetState:function enqueueSetState(n){t(n,"setState")},enqueueSetProps:function enqueueSetProps(n){t(n,"setProps")},enqueueReplaceProps:function enqueueReplaceProps(n){t(n,"replaceProps")}});e.exports=r},{168:168}],75:[function(n,e){"use strict";var a=n(158),r={isValidOwner:function isValidOwner(t){return!(!t||"function"!=typeof t.attachRef||"function"!=typeof t.detachRef)},addComponentAsRefTo:function addComponentAsRefTo(o,e,t){r.isValidOwner(t)?void 0:a(!1),t.attachRef(e,o)},removeComponentAsRefFrom:function removeComponentAsRefFrom(o,e,t){r.isValidOwner(t)?void 0:a(!1),t.getPublicInstance().refs[e]===o.getPublicInstance()&&t.detachRef(e)}};e.exports=r},{158:158}],76:[function(n,e){"use strict";var t={enableMeasure:!1,storedMeasure:function(o,e,t){return t},measureMethods:function measureMethods(){},measure:function measure(o,e,t){return t},injection:{injectMeasure:function injectMeasure(n){t.storedMeasure=n}}};e.exports=t},{}],77:[function(n,e){"use strict";function t(o){return function(e,t,n){e.hasOwnProperty(t)?e[t]=o(e[t],n):e[t]=n}}function r(o,e){for(var t in e){if(e.hasOwnProperty(t)){var n=p[t];n&&p.hasOwnProperty(t)?n(o,t,e[t]):o.hasOwnProperty(t)||(o[t]=e[t])}}return o}var o=n(24),a=n(150),d=n(161),i=t(function(n,e){return o({},e,n)}),p={children:a,className:t(d),style:i};e.exports={mergeProps:function mergeProps(n,e){return r(o({},n),e)}}},{150:150,161:161,24:24}],78:[function(n,e){"use strict";e.exports={}},{}],79:[function(n,e){"use strict";var t=n(162),r=t({prop:null,context:null,childContext:null});e.exports=r},{162:162}],80:[function(n,e){"use strict";function a(d){function e(e,t,n,r,p,a){if(r=r||m,a=a||n,null==t[n]){var s=c[p];return e?new Error("Required "+s+" `"+a+"` was not specified in "+("`"+r+"`.")):null}return d(t,n,r,p,a)}var t=e.bind(null,!1);return t.isRequired=e.bind(null,!0),t}function t(d){function e(e,t,n,r,o){var a=e[t],i=f(a);if(i!==d){var u=c[r],s=p(a);return new Error("Invalid "+u+" `"+o+"` of type "+("`"+s+"` supplied to `"+n+"`, expected ")+("`"+d+"`."))}return null}return a(e)}function d(a){switch(_typeof(a)){case"number":case"string":case"undefined":return!0;case"boolean":return!a;case"object":if(Array.isArray(a))return a.every(d);if(null===a||i.isValidElement(a))return!0;var e=s(a);if(!e)return!1;var t,p=e.call(a);if(e!==a.entries){for(;!(t=p.next()).done;){if(!d(t.value))return!1}}else for(;!(t=p.next()).done;){var r=t.value;if(r&&!d(r[1]))return!1}return!0;default:return!1;}}function f(n){var e=_typeof(n);return Array.isArray(n)?"array":n instanceof RegExp?"object":e}function p(n){var e=f(n);if("object"===e){if(n instanceof Date)return"date";if(n instanceof RegExp)return"regexp"}return e}function l(t){return t.constructor&&t.constructor.name?t.constructor.name:"<<anonymous>>"}var i=n(55),c=n(78),o=n(150),s=n(126),m="<<anonymous>>",r={array:t("array"),bool:t("boolean"),func:t("function"),number:t("number"),object:t("object"),string:t("string"),any:function(){return a(o.thatReturns(null))}(),arrayOf:function(n){function e(e,t,d,r,o){var a=e[t];if(!Array.isArray(a)){var i=c[r],p=f(a);return new Error("Invalid "+i+" `"+o+"` of type "+("`"+p+"` supplied to `"+d+"`, expected an array."))}for(var s=0,u;s<a.length;s++){u=n(a,s,d,r,o+"["+s+"]");if(u instanceof Error)return u}return null}return a(e)},element:function(){function t(d,e,t,n,r){if(!i.isValidElement(d[e])){var o=c[n];return new Error("Invalid "+o+" `"+r+"` supplied to "+("`"+t+"`, expected a single ReactElement."))}return null}return a(t)}(),instanceOf:function(d){function e(e,t,n,r,o){if(!(e[t]instanceof d)){var a=c[r],i=d.name||m,p=l(e[t]);return new Error("Invalid "+a+" `"+o+"` of type "+("`"+p+"` supplied to `"+n+"`, expected ")+("instance of `"+i+"`."))}return null}return a(e)},node:function(){function t(i,e,t,n,r){if(!d(i[e])){var o=c[n];return new Error("Invalid "+o+" `"+r+"` supplied to "+("`"+t+"`, expected a ReactNode."))}return null}return a(t)}(),objectOf:function(n){function e(e,t,d,r,o){var a=e[t],i=f(a);if("object"!==i){var p=c[r];return new Error("Invalid "+p+" `"+o+"` of type "+("`"+i+"` supplied to `"+d+"`, expected an object."))}for(var s in a){if(a.hasOwnProperty(s)){var u=n(a,s,d,r,o+"."+s);if(u instanceof Error)return u}}return null}return a(e)},oneOf:function(d){function e(e,t,n,r,o){for(var a=e[t],i=0;i<d.length;i++){if(a===d[i])return null}var p=c[r],s=JSON.stringify(d);return new Error("Invalid "+p+" `"+o+"` of value `"+a+"` "+("supplied to `"+n+"`, expected one of "+s+"."))}return a(Array.isArray(d)?e:function(){return new Error("Invalid argument supplied to oneOf, expected an instance of array.")})},oneOfType:function(d){function e(e,t,n,r,o){for(var a=0,p;a<d.length;a++){p=d[a];if(null==p(e,t,n,r,o))return null}var l=c[r];return new Error("Invalid "+l+" `"+o+"` supplied to "+("`"+n+"`."))}return a(Array.isArray(d)?e:function(){return new Error("Invalid argument supplied to oneOfType, expected an instance of array.")})},shape:function(n){function e(e,t,d,r,o){var a=e[t],i=f(a);if("object"!==i){var u=c[r];return new Error("Invalid "+u+" `"+o+"` of type `"+i+"` "+("supplied to `"+d+"`, expected `object`."))}for(var s in n){var l=n[s];if(l){var m=l(a,s,d,r,o+"."+s);if(m)return m}}return null}return a(e)}};e.exports=r},{126:126,150:150,55:55,78:78}],81:[function(n,e){"use strict";function t(t){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=r.getPooled(null),this.useCreateElement=!t&&d.useCreateElement}var r=n(6),o=n(25),a=n(28),d=n(44),i=n(64),s=n(110),u=n(24),l={initialize:i.getSelectionInformation,close:i.restoreSelection},p=[l,{initialize:function initialize(){var t=a.isEnabled();return a.setEnabled(!1),t},close:function close(t){a.setEnabled(t)}},{initialize:function initialize(){this.reactMountReady.reset()},close:function close(){this.reactMountReady.notifyAll()}}];u(t.prototype,s.Mixin,{getTransactionWrappers:function getTransactionWrappers(){return p},getReactMountReady:function getReactMountReady(){return this.reactMountReady},destructor:function destructor(){r.release(this.reactMountReady),this.reactMountReady=null}}),o.addPoolingTo(t),e.exports=t},{110:110,24:24,25:25,28:28,44:44,6:6,64:64}],82:[function(n,e){"use strict";function d(){r.attachRefs(this,this._currentElement)}var r=n(83);e.exports={mountComponent:function mountComponent(r,e,t,n){var o=r.mountComponent(e,t,n);return r._currentElement&&null!=r._currentElement.ref&&t.getReactMountReady().enqueue(d,r),o},unmountComponent:function unmountComponent(t){r.detachRefs(t,t._currentElement),t.unmountComponent()},receiveComponent:function receiveComponent(o,e,t,n){var a=o._currentElement;if(e!==a||n!==o._context){var i=r.shouldUpdateRefs(a,e);i&&r.detachRefs(o,a),o.receiveComponent(e,t,n),i&&o._currentElement&&null!=o._currentElement.ref&&t.getReactMountReady().enqueue(d,o)}},performUpdateIfNecessary:function performUpdateIfNecessary(n,e){n.performUpdateIfNecessary(e)}}},{83:83}],83:[function(n,e){"use strict";function d(r,e,t){"function"==typeof r?r(e.getPublicInstance()):o.addComponentAsRefTo(e,r,t)}function r(r,e,t){"function"==typeof r?r(null):o.removeComponentAsRefFrom(e,r,t)}var o=n(75),t={};t.attachRefs=function(o,e){if(null!==e&&!1!==e){var t=e.ref;null!=t&&d(t,o,e._owner)}},t.shouldUpdateRefs=function(n,e){return null===n||!1===n||null===e||!1===e||e._owner!==n._owner||e.ref!==n.ref},t.detachRefs=function(o,e){if(null!==e&&!1!==e){var t=e.ref;null!=t&&r(t,o,e._owner)}},e.exports=t},{75:75}],84:[function(n,e){"use strict";var t={createReactRootIndex:null,injection:{injectCreateReactRootIndex:function injectCreateReactRootIndex(n){t.createReactRootIndex=n}}};e.exports=t},{}],85:[function(n,e){"use strict";e.exports={isBatchingUpdates:!1,batchedUpdates:function batchedUpdates(){}}},{}],86:[function(n,e){"use strict";var o=n(53),r=n(55),a=n(65),i=n(69),s=n(85),u=n(87),l=n(93),p=n(151),d=n(129),c=n(158);e.exports={renderToString:function(m){r.isValidElement(m)?void 0:c(!1);var e;try{l.injection.injectBatchingStrategy(s);var f=a.createReactRootID();return e=u.getPooled(!1),e.perform(function(){var t=d(m,null),n=t.mountComponent(f,e,p);return i.addChecksumToMarkup(n)},null)}finally{u.release(e),l.injection.injectBatchingStrategy(o)}},renderToStaticMarkup:function(i){r.isValidElement(i)?void 0:c(!1);var e;try{l.injection.injectBatchingStrategy(s);var m=a.createReactRootID();return e=u.getPooled(!0),e.perform(function(){var t=d(i,null);return t.mountComponent(m,e,p)},null)}finally{u.release(e),l.injection.injectBatchingStrategy(o)}}}},{129:129,151:151,158:158,53:53,55:55,65:65,69:69,85:85,87:87,93:93}],87:[function(n,e){"use strict";function t(t){this.reinitializeTransaction(),this.renderToStaticMarkup=t,this.reactMountReady=o.getPooled(null),this.useCreateElement=!1}var r=n(25),o=n(6),a=n(110),d=n(24),i=n(150),p=[{initialize:function initialize(){this.reactMountReady.reset()},close:i}];d(t.prototype,a.Mixin,{getTransactionWrappers:function getTransactionWrappers(){return p},getReactMountReady:function getReactMountReady(){return this.reactMountReady},destructor:function destructor(){o.release(this.reactMountReady),this.reactMountReady=null}}),r.addPoolingTo(t),e.exports=t},{110:110,150:150,24:24,25:25,6:6}],88:[function(n,e){"use strict";function a(o,e){var t={};return function(n){t[e]=n,o.setState(t)}}var t={createStateSetter:function createStateSetter(d,e){return function(t,n,r,o,a,i){var p=e.call(d,t,n,r,o,a,i);p&&d.setState(p)}},createStateKeySetter:function createStateKeySetter(o,e){var t=o.__keySetters||(o.__keySetters={});return t[e]||(t[e]=a(o,e))}};t.Mixin={createStateSetter:function createStateSetter(n){return t.createStateSetter(this,n)},createStateKeySetter:function createStateKeySetter(n){return t.createStateKeySetter(this,n)}},e.exports=t},{}],89:[function(n,e){"use strict";var t=n(120);e.exports={getChildMapping:function getChildMapping(n){return n?t(n):n},mergeChildMappings:function mergeChildMappings(d,p){function c(e){return p.hasOwnProperty(e)?p[e]:d[e]}d=d||{},p=p||{};var n={},r=[];for(var m in d){p.hasOwnProperty(m)?r.length&&(n[m]=r,r=[]):r.push(m)}var a,f={};for(var u in p){if(n.hasOwnProperty(u))for(a=0;a<n[u].length;a++){var s=n[u][a];f[n[u][a]]=c(s)}f[u]=c(u)}for(a=0;a<r.length;a++){f[r[a]]=c(r[a])}return f}}},{120:120}],90:[function(n,e){"use strict";function t(){var a=document.createElement("div"),e=a.style;"AnimationEvent"in window||delete d.animationend.animation,"TransitionEvent"in window||delete d.transitionend.transition;for(var t in d){var n=d[t];for(var r in n){if(r in e){i.push(n[r]);break}}}}function r(o,e,t){o.addEventListener(e,t,!1)}function o(o,e,t){o.removeEventListener(e,t,!1)}var a=n(144),d={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},i=[];a.canUseDOM&&t();e.exports={addEndEventListener:function addEndEventListener(o,e){return 0===i.length?void window.setTimeout(e,0):void i.forEach(function(t){r(o,t,e)})},removeEndEventListener:function removeEndEventListener(r,e){0!==i.length&&i.forEach(function(t){o(r,t,e)})}}},{144:144}],91:[function(n,e){"use strict";var d=n(26),p=n(89),o=n(24),t=n(150),r=d.createClass({displayName:"ReactTransitionGroup",propTypes:{component:d.PropTypes.any,childFactory:d.PropTypes.func},getDefaultProps:function getDefaultProps(){return{component:"span",childFactory:t.thatReturnsArgument}},getInitialState:function getInitialState(){return{children:p.getChildMapping(this.props.children)}},componentWillMount:function componentWillMount(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidMount:function componentDidMount(){var n=this.state.children;for(var e in n){n[e]&&this.performAppear(e)}},componentWillReceiveProps:function componentWillReceiveProps(o){var e=p.getChildMapping(o.children),t=this.state.children;this.setState({children:p.mergeChildMappings(t,e)});for(var n in e){var d=t&&t.hasOwnProperty(n);!e[n]||d||this.currentlyTransitioningKeys[n]||this.keysToEnter.push(n)}for(n in t){var a=e&&e.hasOwnProperty(n);!t[n]||a||this.currentlyTransitioningKeys[n]||this.keysToLeave.push(n)}},componentDidUpdate:function componentDidUpdate(){var n=this.keysToEnter;this.keysToEnter=[],n.forEach(this.performEnter);var e=this.keysToLeave;this.keysToLeave=[],e.forEach(this.performLeave)},performAppear:function performAppear(n){this.currentlyTransitioningKeys[n]=!0;var e=this.refs[n];e.componentWillAppear?e.componentWillAppear(this._handleDoneAppearing.bind(this,n)):this._handleDoneAppearing(n)},_handleDoneAppearing:function _handleDoneAppearing(o){var e=this.refs[o];e.componentDidAppear&&e.componentDidAppear(),delete this.currentlyTransitioningKeys[o];var t=p.getChildMapping(this.props.children);t&&t.hasOwnProperty(o)||this.performLeave(o)},performEnter:function performEnter(n){this.currentlyTransitioningKeys[n]=!0;var e=this.refs[n];e.componentWillEnter?e.componentWillEnter(this._handleDoneEntering.bind(this,n)):this._handleDoneEntering(n)},_handleDoneEntering:function _handleDoneEntering(o){var e=this.refs[o];e.componentDidEnter&&e.componentDidEnter(),delete this.currentlyTransitioningKeys[o];var t=p.getChildMapping(this.props.children);t&&t.hasOwnProperty(o)||this.performLeave(o)},performLeave:function performLeave(n){this.currentlyTransitioningKeys[n]=!0;var e=this.refs[n];e.componentWillLeave?e.componentWillLeave(this._handleDoneLeaving.bind(this,n)):this._handleDoneLeaving(n)},_handleDoneLeaving:function _handleDoneLeaving(r){var e=this.refs[r];e.componentDidLeave&&e.componentDidLeave(),delete this.currentlyTransitioningKeys[r];var t=p.getChildMapping(this.props.children);t&&t.hasOwnProperty(r)?this.performEnter(r):this.setState(function(e){var t=o({},e.children);return delete t[r],{children:t}})},render:function render(){var o=[];for(var e in this.state.children){var t=this.state.children[e];t&&o.push(d.cloneElement(this.props.childFactory(t),{ref:e,key:e}))}return d.createElement(this.props.component,this.props,o)}});e.exports=r},{150:150,24:24,26:26,89:89}],92:[function(n,e){"use strict";function d(n){t.enqueueUpdate(n)}function r(t){var e=o.get(t);return e?e:null}var p=(n(39),n(55)),o=n(66),t=n(93),a=n(24),s=n(158),i=(n(168),{isMounted:function isMounted(n){var e=o.get(n);return e?!!e._renderedComponent:!1},enqueueCallback:function enqueueCallback(o,e){"function"!=typeof e?s(!1):void 0;var t=r(o);return t?(t._pendingCallbacks?t._pendingCallbacks.push(e):t._pendingCallbacks=[e],void d(t)):null},enqueueCallbackInternal:function enqueueCallbackInternal(n,e){"function"!=typeof e?s(!1):void 0,n._pendingCallbacks?n._pendingCallbacks.push(e):n._pendingCallbacks=[e],d(n)},enqueueForceUpdate:function enqueueForceUpdate(n){var e=r(n,"forceUpdate");e&&(e._pendingForceUpdate=!0,d(e))},enqueueReplaceState:function enqueueReplaceState(o,e){var t=r(o,"replaceState");t&&(t._pendingStateQueue=[e],t._pendingReplaceState=!0,d(t))},enqueueSetState:function enqueueSetState(o,e){var t=r(o,"setState");if(t){var n=t._pendingStateQueue||(t._pendingStateQueue=[]);n.push(e),d(t)}},enqueueSetProps:function enqueueSetProps(o,e){var t=r(o,"setProps");t&&i.enqueueSetPropsInternal(t,e)},enqueueSetPropsInternal:function enqueueSetPropsInternal(r,e){var t=r._topLevelWrapper;t?void 0:s(!1);var n=t._pendingElement||t._currentElement,o=n.props,i=a({},o.props,e);t._pendingElement=p.cloneAndReplaceProps(n,p.cloneAndReplaceProps(o,i)),d(t)},enqueueReplaceProps:function enqueueReplaceProps(o,e){var t=r(o,"replaceProps");t&&i.enqueueReplacePropsInternal(t,e)},enqueueReplacePropsInternal:function enqueueReplacePropsInternal(r,e){var t=r._topLevelWrapper;t?void 0:s(!1);var n=t._pendingElement||t._currentElement,o=n.props;t._pendingElement=p.cloneAndReplaceProps(n,p.cloneAndReplaceProps(o,e)),d(t)},enqueueElementInternal:function enqueueElementInternal(n,e){n._pendingElement=e,d(n)}});e.exports=i},{158:158,168:168,24:24,39:39,55:55,66:66,93:93}],93:[function(n,e){"use strict";function E(){N.ReactReconcileTransaction&&v?void 0:f(!1)}function t(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=s.getPooled(),this.reconcileTransaction=N.ReactReconcileTransaction.getPooled(!1)}function o(r,e,t,n,o,a){E(),v.batchedUpdates(r,e,t,n,o,a)}function _(n,e){return n._mountOrder-e._mountOrder}function r(i){var e=i.dirtyComponentsLength;e!==m.length?f(!1):void 0,m.sort(_);for(var t=0;e>t;t++){var p=m[t],r=p._pendingCallbacks;if(p._pendingCallbacks=null,d.performUpdateIfNecessary(p,i.reconcileTransaction),r)for(var o=0;o<r.length;o++){i.callbackQueue.enqueue(r[o],p.getPublicInstance())}}}function a(t){return E(),v.isBatchingUpdates?void m.push(t):void v.batchedUpdates(a,t)}function i(n,e){v.isBatchingUpdates?void 0:f(!1),h.enqueue(n,e),g=!0}var s=n(6),u=n(25),p=n(76),d=n(82),l=n(110),c=n(24),f=n(158),m=[],h=s.getPooled(),g=!1,v=null,P=[{initialize:function initialize(){this.dirtyComponentsLength=m.length},close:function close(){this.dirtyComponentsLength!==m.length?(m.splice(0,this.dirtyComponentsLength),x()):m.length=0}},{initialize:function initialize(){this.callbackQueue.reset()},close:function close(){this.callbackQueue.notifyAll()}}];c(t.prototype,l.Mixin,{getTransactionWrappers:function getTransactionWrappers(){return P},destructor:function destructor(){this.dirtyComponentsLength=null,s.release(this.callbackQueue),this.callbackQueue=null,N.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function perform(o,e,t){return l.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,o,e,t)}}),u.addPoolingTo(t);var x=function(){for(;m.length||g;){if(m.length){var n=t.getPooled();n.perform(r,null,n),t.release(n)}if(g){g=!1;var e=h;h=s.getPooled(),e.notifyAll(),s.release(e)}}};x=p.measure("ReactUpdates","flushBatchedUpdates",x);var N={ReactReconcileTransaction:null,batchedUpdates:o,enqueueUpdate:a,flushBatchedUpdates:x,injection:{injectReconcileTransaction:function injectReconcileTransaction(t){t?void 0:f(!1),N.ReactReconcileTransaction=t},injectBatchingStrategy:function injectBatchingStrategy(t){t?void 0:f(!1),"function"!=typeof t.batchedUpdates?f(!1):void 0,"boolean"!=typeof t.isBatchingUpdates?f(!1):void 0,v=t}},asap:i};e.exports=N},{110:110,158:158,24:24,25:25,6:6,76:76,82:82}],94:[function(n,e){"use strict";e.exports="0.14.3"},{}],95:[function(n,e){"use strict";var t=n(10),r=t.injection.MUST_USE_ATTRIBUTE,o={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},a={Properties:{clipPath:r,cx:r,cy:r,d:r,dx:r,dy:r,fill:r,fillOpacity:r,fontFamily:r,fontSize:r,fx:r,fy:r,gradientTransform:r,gradientUnits:r,markerEnd:r,markerMid:r,markerStart:r,offset:r,opacity:r,patternContentUnits:r,patternUnits:r,points:r,preserveAspectRatio:r,r:r,rx:r,ry:r,spreadMethod:r,stopColor:r,stopOpacity:r,stroke:r,strokeDasharray:r,strokeLinecap:r,strokeOpacity:r,strokeWidth:r,textAnchor:r,transform:r,version:r,viewBox:r,x1:r,x2:r,x:r,xlinkActuate:r,xlinkArcrole:r,xlinkHref:r,xlinkRole:r,xlinkShow:r,xlinkTitle:r,xlinkType:r,xmlBase:r,xmlLang:r,xmlSpace:r,y1:r,y2:r,y:r},DOMAttributeNamespaces:{xlinkActuate:o.xlink,xlinkArcrole:o.xlink,xlinkHref:o.xlink,xlinkRole:o.xlink,xlinkShow:o.xlink,xlinkTitle:o.xlink,xlinkType:o.xlink,xmlBase:o.xml,xmlLang:o.xml,xmlSpace:o.xml},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlLang:"xml:lang",xmlSpace:"xml:space"}};e.exports=a},{10:10}],96:[function(n,e){"use strict";function x(o){if("selectionStart"in o&&a.hasSelectionCapabilities(o))return{start:o.selectionStart,end:o.selectionEnd};if(window.getSelection){var e=window.getSelection();return{anchorNode:e.anchorNode,anchorOffset:e.anchorOffset,focusNode:e.focusNode,focusOffset:e.focusOffset}}if(document.selection){var t=document.selection.createRange();return{parentElement:t.parentElement(),text:t.text,top:t.boundingTop,left:t.boundingLeft}}}function D(a,e){if(P||null==m||m!==s())return null;var t=x(m);if(!v||!d(v,t)){v=t;var n=i.getPooled(f.select,h,a,e);return n.type="select",n.target=m,r.accumulateTwoPhaseDispatches(n),n}return null}var t=n(15),r=n(19),o=n(144),a=n(64),i=n(102),s=n(153),u=n(131),p=n(163),d=n(166),l=t.topLevelTypes,c=o.canUseDOM&&"documentMode"in document&&11>=document.documentMode,f={select:{phasedRegistrationNames:{bubbled:p({onSelect:null}),captured:p({onSelectCapture:null})},dependencies:[l.topBlur,l.topContextMenu,l.topFocus,l.topKeyDown,l.topMouseDown,l.topMouseUp,l.topSelectionChange]}},m=null,h=null,v=null,P=!1,T=!1,N=p({onSelect:null});e.exports={eventTypes:f,extractEvents:function extractEvents(o,e,t,n,r){if(!T)return null;switch(o){case l.topFocus:(u(e)||"true"===e.contentEditable)&&(m=e,h=t,v=null);break;case l.topBlur:m=null,h=null,v=null;break;case l.topMouseDown:P=!0;break;case l.topContextMenu:case l.topMouseUp:return P=!1,D(n,r);case l.topSelectionChange:if(c)break;case l.topKeyDown:case l.topKeyUp:return D(n,r);}return null},didPutListener:function didPutListener(n,e){e===N&&(T=!0)}}},{102:102,131:131,144:144,15:15,153:153,163:163,166:166,19:19,64:64}],97:[function(n,e){"use strict";var t=Math.pow(2,53);e.exports={createReactRootIndex:function createReactRootIndex(){return Math.ceil(Math.random()*9007199254740992)}}},{}],98:[function(n,e){"use strict";var t=n(15),T=n(143),N=n(19),o=n(70),a=n(99),i=n(102),s=n(103),u=n(105),l=n(106),p=n(101),d=n(107),c=n(108),f=n(109),h=n(150),m=n(122),g=n(158),r=n(163),y=t.topLevelTypes,C={abort:{phasedRegistrationNames:{bubbled:r({onAbort:!0}),captured:r({onAbortCapture:!0})}},blur:{phasedRegistrationNames:{bubbled:r({onBlur:!0}),captured:r({onBlurCapture:!0})}},canPlay:{phasedRegistrationNames:{bubbled:r({onCanPlay:!0}),captured:r({onCanPlayCapture:!0})}},canPlayThrough:{phasedRegistrationNames:{bubbled:r({onCanPlayThrough:!0}),captured:r({onCanPlayThroughCapture:!0})}},click:{phasedRegistrationNames:{bubbled:r({onClick:!0}),captured:r({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:r({onContextMenu:!0}),captured:r({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:r({onCopy:!0}),captured:r({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:r({onCut:!0}),captured:r({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:r({onDoubleClick:!0}),captured:r({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:r({onDrag:!0}),captured:r({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:r({onDragEnd:!0}),captured:r({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:r({onDragEnter:!0}),captured:r({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:r({onDragExit:!0}),captured:r({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:r({onDragLeave:!0}),captured:r({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:r({onDragOver:!0}),captured:r({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:r({onDragStart:!0}),captured:r({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:r({onDrop:!0}),captured:r({onDropCapture:!0})}},durationChange:{phasedRegistrationNames:{bubbled:r({onDurationChange:!0}),captured:r({onDurationChangeCapture:!0})}},emptied:{phasedRegistrationNames:{bubbled:r({onEmptied:!0}),captured:r({onEmptiedCapture:!0})}},encrypted:{phasedRegistrationNames:{bubbled:r({onEncrypted:!0}),captured:r({onEncryptedCapture:!0})}},ended:{phasedRegistrationNames:{bubbled:r({onEnded:!0}),captured:r({onEndedCapture:!0})}},error:{phasedRegistrationNames:{bubbled:r({onError:!0}),captured:r({onErrorCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:r({onFocus:!0}),captured:r({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:r({onInput:!0}),captured:r({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:r({onKeyDown:!0}),captured:r({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:r({onKeyPress:!0}),captured:r({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:r({onKeyUp:!0}),captured:r({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:r({onLoad:!0}),captured:r({onLoadCapture:!0})}},loadedData:{phasedRegistrationNames:{bubbled:r({onLoadedData:!0}),captured:r({onLoadedDataCapture:!0})}},loadedMetadata:{phasedRegistrationNames:{bubbled:r({onLoadedMetadata:!0}),captured:r({onLoadedMetadataCapture:!0})}},loadStart:{phasedRegistrationNames:{bubbled:r({onLoadStart:!0}),captured:r({onLoadStartCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:r({onMouseDown:!0}),captured:r({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:r({onMouseMove:!0}),captured:r({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:r({onMouseOut:!0}),captured:r({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:r({onMouseOver:!0}),captured:r({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:r({onMouseUp:!0}),captured:r({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:r({onPaste:!0}),captured:r({onPasteCapture:!0})}},pause:{phasedRegistrationNames:{bubbled:r({onPause:!0}),captured:r({onPauseCapture:!0})}},play:{phasedRegistrationNames:{bubbled:r({onPlay:!0}),captured:r({onPlayCapture:!0})}},playing:{phasedRegistrationNames:{bubbled:r({onPlaying:!0}),captured:r({onPlayingCapture:!0})}},progress:{phasedRegistrationNames:{bubbled:r({onProgress:!0}),captured:r({onProgressCapture:!0})}},rateChange:{phasedRegistrationNames:{bubbled:r({onRateChange:!0}),captured:r({onRateChangeCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:r({onReset:!0}),captured:r({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:r({onScroll:!0}),captured:r({onScrollCapture:!0})}},seeked:{phasedRegistrationNames:{bubbled:r({onSeeked:!0}),captured:r({onSeekedCapture:!0})}},seeking:{phasedRegistrationNames:{bubbled:r({onSeeking:!0}),captured:r({onSeekingCapture:!0})}},stalled:{phasedRegistrationNames:{bubbled:r({onStalled:!0}),captured:r({onStalledCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:r({onSubmit:!0}),captured:r({onSubmitCapture:!0})}},suspend:{phasedRegistrationNames:{bubbled:r({onSuspend:!0}),captured:r({onSuspendCapture:!0})}},timeUpdate:{phasedRegistrationNames:{bubbled:r({onTimeUpdate:!0}),captured:r({onTimeUpdateCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:r({onTouchCancel:!0}),captured:r({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:r({onTouchEnd:!0}),captured:r({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:r({onTouchMove:!0}),captured:r({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:r({onTouchStart:!0}),captured:r({onTouchStartCapture:!0})}},volumeChange:{phasedRegistrationNames:{bubbled:r({onVolumeChange:!0}),captured:r({onVolumeChangeCapture:!0})}},waiting:{phasedRegistrationNames:{bubbled:r({onWaiting:!0}),captured:r({onWaitingCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:r({onWheel:!0}),captured:r({onWheelCapture:!0})}}},b={topAbort:C.abort,topBlur:C.blur,topCanPlay:C.canPlay,topCanPlayThrough:C.canPlayThrough,topClick:C.click,topContextMenu:C.contextMenu,topCopy:C.copy,topCut:C.cut,topDoubleClick:C.doubleClick,topDrag:C.drag,topDragEnd:C.dragEnd,topDragEnter:C.dragEnter,topDragExit:C.dragExit,topDragLeave:C.dragLeave,topDragOver:C.dragOver,topDragStart:C.dragStart,topDrop:C.drop,topDurationChange:C.durationChange,topEmptied:C.emptied,topEncrypted:C.encrypted,topEnded:C.ended,topError:C.error,topFocus:C.focus,topInput:C.input,topKeyDown:C.keyDown,topKeyPress:C.keyPress,topKeyUp:C.keyUp,topLoad:C.load,topLoadedData:C.loadedData,topLoadedMetadata:C.loadedMetadata,topLoadStart:C.loadStart,topMouseDown:C.mouseDown,topMouseMove:C.mouseMove,topMouseOut:C.mouseOut,topMouseOver:C.mouseOver,topMouseUp:C.mouseUp,topPaste:C.paste,topPause:C.pause,topPlay:C.play,topPlaying:C.playing,topProgress:C.progress,topRateChange:C.rateChange,topReset:C.reset,topScroll:C.scroll,topSeeked:C.seeked,topSeeking:C.seeking,topStalled:C.stalled,topSubmit:C.submit,topSuspend:C.suspend,topTimeUpdate:C.timeUpdate,topTouchCancel:C.touchCancel,topTouchEnd:C.touchEnd,topTouchMove:C.touchMove,topTouchStart:C.touchStart,topVolumeChange:C.volumeChange,topWaiting:C.waiting,topWheel:C.wheel};for(var E in b){b[E].dependencies=[E]}var _=r({onClick:null}),x={};e.exports={eventTypes:C,extractEvents:function extractEvents(h,e,t,n,r){var o=b[h];if(!o)return null;var E;switch(h){case y.topAbort:case y.topCanPlay:case y.topCanPlayThrough:case y.topDurationChange:case y.topEmptied:case y.topEncrypted:case y.topEnded:case y.topError:case y.topInput:case y.topLoad:case y.topLoadedData:case y.topLoadedMetadata:case y.topLoadStart:case y.topPause:case y.topPlay:case y.topPlaying:case y.topProgress:case y.topRateChange:case y.topReset:case y.topSeeked:case y.topSeeking:case y.topStalled:case y.topSubmit:case y.topSuspend:case y.topTimeUpdate:case y.topVolumeChange:case y.topWaiting:E=i;break;case y.topKeyPress:if(0===m(n))return null;case y.topKeyDown:case y.topKeyUp:E=u;break;case y.topBlur:case y.topFocus:E=s;break;case y.topClick:if(2===n.button)return null;case y.topContextMenu:case y.topDoubleClick:case y.topMouseDown:case y.topMouseMove:case y.topMouseOut:case y.topMouseOver:case y.topMouseUp:E=l;break;case y.topDrag:case y.topDragEnd:case y.topDragEnter:case y.topDragExit:case y.topDragLeave:case y.topDragOver:case y.topDragStart:case y.topDrop:E=p;break;case y.topTouchCancel:case y.topTouchEnd:case y.topTouchMove:case y.topTouchStart:E=d;break;case y.topScroll:E=c;break;case y.topWheel:E=f;break;case y.topCopy:case y.topCut:case y.topPaste:E=a;}E?void 0:g(!1);var _=E.getPooled(o,t,n,r);return N.accumulateTwoPhaseDispatches(_),_},didPutListener:function didPutListener(n,e){if(e===_){var t=o.getNode(n);x[n]||(x[n]=T.listen(t,"click",h))}},willDeleteListener:function willDeleteListener(n,e){e===_&&(x[n].remove(),delete x[n])}}},{101:101,102:102,103:103,105:105,106:106,107:107,108:108,109:109,122:122,143:143,15:15,150:150,158:158,163:163,19:19,70:70,99:99}],99:[function(n,e){"use strict";function t(o,e,t,n){a.call(this,o,e,t,n)}var a=n(102);a.augmentClass(t,{clipboardData:function clipboardData(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),e.exports=t},{102:102}],100:[function(n,e){"use strict";function t(o,e,t,n){a.call(this,o,e,t,n)}var a=n(102);a.augmentClass(t,{data:null}),e.exports=t},{102:102}],101:[function(n,e){"use strict";function t(o,e,t,n){a.call(this,o,e,t,n)}var a=n(106);a.augmentClass(t,{dataTransfer:null}),e.exports=t},{106:106}],102:[function(n,e){"use strict";function t(d,e,t,n){this.dispatchConfig=d,this.dispatchMarker=e,this.nativeEvent=t,this.target=n,this.currentTarget=n;var r=this.constructor.Interface;for(var o in r){if(r.hasOwnProperty(o)){var a=r[o];a?this[o]=a(t):this[o]=t[o]}}var i=null!=t.defaultPrevented?t.defaultPrevented:!1===t.returnValue;i?this.isDefaultPrevented=p.thatReturnsTrue:this.isDefaultPrevented=p.thatReturnsFalse,this.isPropagationStopped=p.thatReturnsFalse}var d=n(25),o=n(24),p=n(150),r=(n(168),{type:null,currentTarget:p.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function timeStamp(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null});o(t.prototype,{preventDefault:function preventDefault(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():t.returnValue=!1,this.isDefaultPrevented=p.thatReturnsTrue)},stopPropagation:function stopPropagation(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,this.isPropagationStopped=p.thatReturnsTrue)},persist:function persist(){this.isPersistent=p.thatReturnsTrue},isPersistent:p.thatReturnsFalse,destructor:function destructor(){var n=this.constructor.Interface;for(var e in n){this[e]=null}this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),t.Interface=r,t.augmentClass=function(a,e){var t=this,n=Object.create(t.prototype);o(n,a.prototype),a.prototype=n,a.prototype.constructor=a,a.Interface=o({},t.Interface,e),a.augmentClass=t.augmentClass,d.addPoolingTo(a,d.fourArgumentPooler)},d.addPoolingTo(t,d.fourArgumentPooler),e.exports=t},{150:150,168:168,24:24,25:25}],103:[function(n,e){"use strict";function t(o,e,t,n){a.call(this,o,e,t,n)}var a=n(108);a.augmentClass(t,{relatedTarget:null}),e.exports=t},{108:108}],104:[function(n,e){"use strict";function t(o,e,t,n){a.call(this,o,e,t,n)}var a=n(102);a.augmentClass(t,{data:null}),e.exports=t},{102:102}],105:[function(n,e){"use strict";function t(o,e,t,n){d.call(this,o,e,t,n)}var d=n(108),o=n(122),r=n(123),a=n(124);d.augmentClass(t,{key:r,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:a,charCode:function charCode(t){return"keypress"===t.type?o(t):0},keyCode:function keyCode(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function which(t){return"keypress"===t.type?o(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),e.exports=t},{108:108,122:122,123:123,124:124}],106:[function(n,e){"use strict";function t(o,e,t,n){d.call(this,o,e,t,n)}var d=n(108),o=n(111),r=n(124);d.augmentClass(t,{screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:r,button:function button(n){var e=n.button;return"which"in n?e:2===e?2:4===e?1:0},buttons:null,relatedTarget:function relatedTarget(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)},pageX:function pageX(t){return"pageX"in t?t.pageX:t.clientX+o.currentScrollLeft},pageY:function pageY(t){return"pageY"in t?t.pageY:t.clientY+o.currentScrollTop}}),e.exports=t},{108:108,111:111,124:124}],107:[function(n,e){"use strict";function t(o,e,t,n){d.call(this,o,e,t,n)}var d=n(108),o=n(124);d.augmentClass(t,{touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:o}),e.exports=t},{108:108,124:124}],108:[function(n,e){"use strict";function t(o,e,t,n){d.call(this,o,e,t,n)}var d=n(102),o=n(125);d.augmentClass(t,{view:function view(r){if(r.view)return r.view;var e=o(r);if(null!=e&&e.window===e)return e;var t=e.ownerDocument;return t?t.defaultView||t.parentWindow:window},detail:function detail(t){return t.detail||0}}),e.exports=t},{102:102,125:125}],109:[function(n,e){"use strict";function t(o,e,t,n){a.call(this,o,e,t,n)}var a=n(106);a.augmentClass(t,{deltaX:function deltaX(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function deltaY(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),e.exports=t},{106:106}],110:[function(n,e){"use strict";var d=n(158),t={Mixin:{reinitializeTransaction:function reinitializeTransaction(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function isInTransaction(){return!!this._isInTransaction},perform:function perform(r,e,t,n,o,a,i,p){this.isInTransaction()?d(!1):void 0;var s,u;try{this._isInTransaction=!0,s=!0,this.initializeAll(0),u=r.call(e,t,n,o,a,i,p),s=!1}finally{try{if(s)try{this.closeAll(0)}catch(e){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return u},initializeAll:function initializeAll(o){for(var e=this.transactionWrappers,a=o,d;a<e.length;a++){d=e[a];try{this.wrapperInitData[a]=t.OBSERVED_ERROR,this.wrapperInitData[a]=d.initialize?d.initialize.call(this):null}finally{if(this.wrapperInitData[a]===t.OBSERVED_ERROR)try{this.initializeAll(a+1)}catch(e){}}}},closeAll:function closeAll(r){this.isInTransaction()?void 0:d(!1);for(var e=this.transactionWrappers,a=r;a<e.length;a++){var p,s=e[a],i=this.wrapperInitData[a];try{p=!0,i!==t.OBSERVED_ERROR&&s.close&&s.close.call(this,i),p=!1}finally{if(p)try{this.closeAll(a+1)}catch(e){}}}this.wrapperInitData.length=0}},OBSERVED_ERROR:{}};e.exports=t},{158:158}],111:[function(n,e){"use strict";var t={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function refreshScrollValues(n){t.currentScrollLeft=n.x,t.currentScrollTop=n.y}};e.exports=t},{}],112:[function(n,e){"use strict";function t(o,e){if(null==e?a(!1):void 0,null==o)return e;var t=Array.isArray(o),n=Array.isArray(e);return t&&n?(o.push.apply(o,e),o):t?(o.push(e),o):n?[o].concat(e):[o,e]}var a=n(158);e.exports=t},{158:158}],113:[function(n,e){"use strict";function t(o){for(var e=1,p=0,s=0,u=o.length,a=-4&u;a>s;){for(;s<Math.min(s+4096,a);s+=4){p+=(e+=o.charCodeAt(s))+(e+=o.charCodeAt(s+1))+(e+=o.charCodeAt(s+2))+(e+=o.charCodeAt(s+3))}e%=d,p%=d}for(;u>s;s++){p+=e+=o.charCodeAt(s)}return e%=d,p%=d,e|p<<16}var d=65521;e.exports=t},{}],114:[function(n,e){"use strict";e.exports=!1},{}],115:[function(n,e){"use strict";var r=n(55),o=n(77),t=n(163),a=(n(168),t({children:null}));e.exports=function(d,e){var t=o.mergeProps(e,d.props);return!t.hasOwnProperty(a)&&d.props.hasOwnProperty(a)&&(t.children=d.props.children),r.createElement(d.type,t)}},{163:163,168:168,55:55,77:77}],116:[function(n,e){"use strict";function t(a,e){var d=null==e||"boolean"==typeof e||""===e;if(d)return"";var n=isNaN(e);return n||0===e||o.hasOwnProperty(a)&&o[a]?""+e:("string"==typeof e&&(e=e.trim()),e+"px")}var r=n(4),o=r.isUnitlessNumber;e.exports=t},{4:4}],117:[function(n,e){"use strict";function t(a,e,t,n,r){return r}n(24),n(168);e.exports=t},{168:168,24:24}],118:[function(n,e){"use strict";function t(t){return o[t]}var o={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"};e.exports=function(n){return(""+n).replace(/[&><"']/g,t)}},{}],119:[function(n,e){"use strict";var t=(n(39),n(66)),o=n(70),r=n(158);n(168);e.exports=function(n){return null==n?null:1===n.nodeType?n:t.has(n)?o.getNodeFromInstance(n):(null!=n.render&&"function"==typeof n.render?r(!1):void 0,void r(!1))}},{158:158,168:168,39:39,66:66,70:70}],120:[function(n,e){"use strict";function o(a,e,t){var n=a,r=void 0===n[t];r&&null!=e&&(n[t]=e)}var r=n(139);n(168);e.exports=function(n){if(null==n)return n;var e={};return r(n,o,e),e}},{139:139,168:168}],121:[function(n,e){"use strict";e.exports=function r(o,e,t){Array.isArray(o)?o.forEach(e,t):o&&e.call(t,o)}},{}],122:[function(n,e){"use strict";function t(o){var e,r=o.keyCode;return"charCode"in o?(e=o.charCode,0===e&&13===r&&(e=13)):e=r,32<=e||13===e?e:0}e.exports=t},{}],123:[function(n,e){"use strict";var t=n(122),o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};e.exports=function(a){if(a.key){var e=o[a.key]||a.key;if("Unidentified"!==e)return e}if("keypress"===a.type){var d=t(a);return 13===d?"Enter":String.fromCharCode(d)}return"keydown"===a.type||"keyup"===a.type?r[a.keyCode]||"Unidentified":""}},{122:122}],124:[function(n,e){"use strict";function t(a){var e=this,t=e.nativeEvent;if(t.getModifierState)return t.getModifierState(a);var n=o[a];return n?!!t[n]:!1}var o={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};e.exports=function(){return t}},{}],125:[function(n,e){"use strict";e.exports=function(n){var e=n.target||n.srcElement||window;return 3===e.nodeType?e.parentNode:e}},{}],126:[function(n,e){"use strict";var r="function"==typeof Symbol&&Symbol.iterator;e.exports=function(n){var e=n&&(r&&n[r]||n["@@iterator"]);return"function"==typeof e?e:void 0}},{}],127:[function(n,e){"use strict";function d(t){for(;t&&t.firstChild;){t=t.firstChild}return t}function r(t){for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}}function t(o,e){for(var t=d(o),p=0,s=0;t;){if(3===t.nodeType){if(s=p+t.textContent.length,e>=p&&s>=e)return{node:t,offset:e-p};p=s}t=d(r(t))}}e.exports=t},{}],128:[function(n,e){"use strict";function t(){return!o&&r.canUseDOM&&(o="textContent"in document.documentElement?"textContent":"innerText"),o}var r=n(144),o=null;e.exports=t},{144:144}],129:[function(n,e){"use strict";function t(t){return"function"==typeof t&&"undefined"!=typeof t.prototype&&"function"==typeof t.prototype.mountComponent&&"function"==typeof t.prototype.receiveComponent}function r(o){var e;if(null===o||!1===o)e=new a(r);else if("object"==_typeof(o)){var i=o;!i||"function"!=typeof i.type&&"string"!=typeof i.type?p(!1):void 0,e="string"==typeof i.type?d.createInternalComponent(i):t(i.type)?new i.type(i):new s}else"string"==typeof o||"number"==typeof o?e=d.createInstanceForText(o):p(!1);return e.construct(o),e._mountIndex=0,e._mountImage=null,e}var o=n(38),a=n(57),d=n(73),i=n(24),p=n(158),s=(n(168),function(){});i(s.prototype,o.Mixin,{_instantiateReactComponent:r}),e.exports=r},{158:158,168:168,24:24,38:38,57:57,73:73}],130:[function(n,e){"use strict";function t(o,e){if(!p.canUseDOM||e&&!("addEventListener"in document))return!1;var t="on"+o,n=(t in document);if(!n){var a=document.createElement("div");a.setAttribute(t,"return;"),n="function"==typeof a[t]}return!n&&d&&"wheel"===o&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var d,p=n(144);p.canUseDOM&&(d=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),e.exports=t},{144:144}],131:[function(n,e){"use strict";var r={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};e.exports=function(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&("input"===e&&r[n.type]||"textarea"===e)}},{}],132:[function(n,e){"use strict";var t=n(55),o=n(158);e.exports=function(n){return t.isValidElement(n)?void 0:o(!1),n}},{158:158,55:55}],133:[function(n,e){"use strict";var t=n(118);e.exports=function(n){return"\""+t(n)+"\""}},{118:118}],134:[function(n,e){"use strict";var t=n(70);e.exports=t.renderSubtreeIntoContainer},{70:70}],135:[function(n,e){"use strict";var t=n(144),o=function(n,e){n.innerHTML=e};if("undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction&&(o=function(n,e){MSApp.execUnsafeLocalFunction(function(){n.innerHTML=e})}),t.canUseDOM){var r=document.createElement("div");r.innerHTML=" ",""===r.innerHTML&&(o=function(o,e){if(o.parentNode&&o.parentNode.replaceChild(o,o),/^[ \r\n\t\f]/.test(e)||"<"===e[0]&&/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/.test(e)){o.innerHTML=String.fromCharCode(65279)+e;var t=o.firstChild;1===t.data.length?o.removeChild(t):t.deleteData(0,1)}else o.innerHTML=e})}e.exports=o},{144:144}],136:[function(n,e){"use strict";var t=n(144),r=n(118),o=n(135),a=function(n,e){n.textContent=e};t.canUseDOM&&("textContent"in document.documentElement||(a=function(n,e){o(n,r(e))})),e.exports=a},{118:118,135:135,144:144}],137:[function(n,e){"use strict";var r=n(166);e.exports=function(o,e,t){return!r(o.props,e)||!r(o.state,t)}},{166:166}],138:[function(n,e){"use strict";function t(d,e){var t=null===d||!1===d,n=null===e||!1===e;if(t||n)return t===n;var r=_typeof(d),o=_typeof(e);return"string"===r||"number"===r?"string"===o||"number"===o:"object"===o&&d.type===e.type&&d.key===e.key}e.exports=t},{}],139:[function(n,e){"use strict";function t(t){return s[t]}function x(n,e){return n&&null!=n.key?a(n.key):e.toString(36)}function o(n){return(""+n).replace(c,t)}function a(t){return"$"+o(t)}function i(o,h,t,n){var r=_typeof(o);if(("undefined"===r||"boolean"===r)&&(o=null),null===o||"string"===r||"number"===r||u.isValidElement(o))return t(n,o,""===h?d+x(o,0):h),1;var D,P,T=0,N=""===h?d:h+f;if(Array.isArray(o))for(var m=0;m<o.length;m++){D=o[m],P=N+x(D,m),T+=i(D,P,t,n)}else{var M=l(o);if(M){var y,R=M.call(o);if(M!==o.entries)for(var b=0;!(y=R.next()).done;){D=y.value,P=N+x(D,b++),T+=i(D,P,t,n)}else for(;!(y=R.next()).done;){var S=y.value;S&&(D=S[1],P=N+a(S[0])+f+x(D,0),T+=i(D,P,t,n))}}else"object"===r&&(o+"",p(!1))}return T}var u=(n(39),n(55)),r=n(65),l=n(126),p=n(158),d=(n(168),r.SEPARATOR),f=":",s={"=":"=0",".":"=1",":":"=2"},c=/[=.:]/g;e.exports=function(o,e,t){return null==o?0:i(o,"",e,t)}},{126:126,158:158,168:168,39:39,55:55,65:65}],140:[function(n,e){"use strict";function y(t){return Array.isArray(t)?t.concat():t&&"object"==_typeof(t)?a(new t.constructor,t):t}function r(o,e,t){Array.isArray(o)?void 0:i(!1);var n=e[t];Array.isArray(n)?void 0:i(!1)}function o(g,e){if("object"!=_typeof(e)?i(!1):void 0,s.call(e,d))return 1!==Object.keys(e).length?i(!1):void 0,e[d];var t=y(g);if(s.call(e,f)){var C=e[f];C&&"object"==_typeof(C)?void 0:i(!1),t&&"object"==_typeof(t)?void 0:i(!1),a(t,e[f])}s.call(e,l)&&(r(g,e,l),e[l].forEach(function(n){t.push(n)})),s.call(e,c)&&(r(g,e,c),e[c].forEach(function(n){t.unshift(n)})),s.call(e,p)&&(Array.isArray(g)?void 0:i(!1),Array.isArray(e[p])?void 0:i(!1),e[p].forEach(function(n){Array.isArray(n)?void 0:i(!1),t.splice.apply(t,n)})),s.call(e,h)&&("function"!=typeof e[h]?i(!1):void 0,t=e[h](t));for(var b in e){u.hasOwnProperty(b)&&u[b]||(t[b]=o(g[b],e[b]))}return t}var a=n(24),t=n(163),i=n(158),s={}.hasOwnProperty,l=t({$push:null}),c=t({$unshift:null}),p=t({$splice:null}),d=t({$set:null}),f=t({$merge:null}),h=t({$apply:null}),u={};[l,c,p,d,f,h].forEach(function(t){u[t]=!0}),e.exports=o},{158:158,163:163,24:24}],141:[function(n,e){"use strict";var t=(n(24),n(150)),r=(n(168),t);e.exports=r},{150:150,168:168,24:24}],142:[function(n,e){"use strict";var a=n(158),r={addClass:function addClass(n,e){return /\s/.test(e)?a(!1):void 0,e&&(n.classList?n.classList.add(e):r.hasClass(n,e)||(n.className=n.className+" "+e)),n},removeClass:function removeClass(n,e){return /\s/.test(e)?a(!1):void 0,e&&(n.classList?n.classList.remove(e):r.hasClass(n,e)&&(n.className=n.className.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),n},conditionClass:function conditionClass(o,e,t){return(t?r.addClass:r.removeClass)(o,e)},hasClass:function hasClass(n,e){return /\s/.test(e)?a(!1):void 0,n.classList?!!e&&n.classList.contains(e):-1<(" "+n.className+" ").indexOf(" "+e+" ")}};e.exports=r},{158:158}],143:[function(n,e){"use strict";var o=n(150);e.exports={listen:function listen(o,e,t){return o.addEventListener?(o.addEventListener(e,t,!1),{remove:function remove(){o.removeEventListener(e,t,!1)}}):o.attachEvent?(o.attachEvent("on"+e,t),{remove:function remove(){o.detachEvent("on"+e,t)}}):void 0},capture:function capture(r,e,t){return r.addEventListener?(r.addEventListener(e,t,!0),{remove:function remove(){r.removeEventListener(e,t,!0)}}):{remove:o}},registerDefault:function registerDefault(){}}},{150:150}],144:[function(n,e){"use strict";var t=!("undefined"==typeof window||!window.document||!window.document.createElement),r={canUseDOM:t,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:t&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:t&&!!window.screen,isInWorker:!t};e.exports=r},{}],145:[function(n,e){"use strict";e.exports=function(t){return t.replace(/-(.)/g,function(n,e){return e.toUpperCase()})}},{}],146:[function(n,e){"use strict";var t=n(145);e.exports=function(n){return t(n.replace(/^-ms-/,"ms-"))}},{145:145}],147:[function(n,e){"use strict";function t(o,i){var p=!0;e:for(;p;){var s=o,r=i;if(p=!1,s&&r){if(s===r)return!0;if(d(s))return!1;if(d(r)){o=s,i=r.parentNode,p=!0;continue e}return s.contains?s.contains(r):s.compareDocumentPosition?!!(16&s.compareDocumentPosition(r)):!1}return!1}}var d=n(160);e.exports=t},{160:160}],148:[function(n,e){"use strict";function t(t){return!!t&&("object"==_typeof(t)||"function"==typeof t)&&"length"in t&&!("setInterval"in t)&&"number"!=typeof t.nodeType&&(Array.isArray(t)||"callee"in t||"item"in t)}var o=n(167);e.exports=function(n){return t(n)?Array.isArray(n)?n.slice():o(n):[n]}},{167:167}],149:[function(n,e){"use strict";function m(n){var e=n.match(a);return e&&e[1].toLowerCase()}function t(l,e){var t=s;s?void 0:u(!1);var f=m(l),o=f&&i(f);if(o){t.innerHTML=o[1]+l+o[2];for(var a=o[0];a--;){t=t.lastChild}}else t.innerHTML=l;var h=t.getElementsByTagName("script");h.length&&(e?void 0:u(!1),r(h).forEach(e));for(var p=r(t.childNodes);t.lastChild;){t.removeChild(t.lastChild)}return p}var o=n(144),r=n(148),i=n(154),u=n(158),s=o.canUseDOM?document.createElement("div"):null,a=/^\s*<(\w+)/;e.exports=t},{144:144,148:148,154:154,158:158}],150:[function(n,e){"use strict";function t(t){return function(){return t}}function r(){}r.thatReturns=t,r.thatReturnsFalse=t(!1),r.thatReturnsTrue=t(!0),r.thatReturnsNull=t(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(t){return t},e.exports=r},{}],151:[function(n,e){"use strict";e.exports={}},{}],152:[function(n,e){"use strict";e.exports=function(t){try{t.focus()}catch(e){}}},{}],153:[function(n,e){"use strict";e.exports=function(){if("undefined"==typeof document)return null;try{return document.activeElement||document.body}catch(t){return document.body}}},{}],154:[function(n,e){"use strict";var t=n(144),o=n(158),r=t.canUseDOM?document.createElement("div"):null,a={},i=[1,"<select multiple=\"true\">","</select>"],s=[1,"<table>","</table>"],u=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<svg xmlns=\"http://www.w3.org/2000/svg\">","</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:i,option:i,caption:s,colgroup:s,tbody:s,tfoot:s,thead:s,td:u,th:u};["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"].forEach(function(t){p[t]=l,a[t]=!0}),e.exports=function(t){return r?void 0:o(!1),p.hasOwnProperty(t)||(t="*"),a.hasOwnProperty(t)||("*"===t?r.innerHTML="<link />":r.innerHTML="<"+t+"></"+t+">",a[t]=!r.firstChild),a[t]?p[t]:null}},{144:144,158:158}],155:[function(n,e){"use strict";e.exports=function(t){return t===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:t.scrollLeft,y:t.scrollTop}}},{}],156:[function(n,e){"use strict";e.exports=function(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}},{}],157:[function(n,e){"use strict";var t=n(156);e.exports=function(n){return t(n).replace(/^ms-/,"-ms-")}},{156:156}],158:[function(n,e){"use strict";e.exports=function r(r,e,t,n,d,o,a,i){if(!r){var p;if(void 0===e)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[t,n,d,o,a,i],l=0;p=new Error("Invariant Violation: "+e.replace(/%s/g,function(){return u[l++]}))}throw p.framesToPop=1,p}}},{}],159:[function(n,e){"use strict";function t(t){return!(!t||!("function"==typeof Node?t instanceof Node:"object"==_typeof(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName))}e.exports=t},{}],160:[function(n,e){"use strict";var t=n(159);e.exports=function(n){return t(n)&&3==n.nodeType}},{159:159}],161:[function(n,e){"use strict";function t(o){o||(o="");var a,d=arguments.length;if(1<d)for(var n=1;d>n;n++){a=arguments[n],a&&(o=(o?o+" ":"")+a)}return o}e.exports=t},{}],162:[function(n,e){"use strict";var o=n(158);e.exports=function o(r){var e,a={};r instanceof Object&&!Array.isArray(r)?void 0:o(!1);for(e in r){r.hasOwnProperty(e)&&(a[e]=e)}return a}},{158:158}],163:[function(n,e){"use strict";e.exports=function r(n){for(var e in n){if(n.hasOwnProperty(e))return e}return null}},{}],164:[function(n,e){"use strict";function t(o,e,t){if(!o)return null;var n={};for(var r in o){d.call(o,r)&&(n[r]=e.call(t,o[r],r,o))}return n}var d=Object.prototype.hasOwnProperty;e.exports=t},{}],165:[function(n,e){"use strict";e.exports=function(o){var e={};return function(t){return e.hasOwnProperty(t)||(e[t]=o.call(this,t)),e[t]}}},{}],166:[function(n,e){"use strict";function t(o,e){if(o===e)return!0;if("object"!=_typeof(o)||null===o||"object"!=_typeof(e)||null===e)return!1;var t=Object.keys(o),n=Object.keys(e);if(t.length!==n.length)return!1;for(var d=r.bind(e),a=0;a<t.length;a++){if(!d(t[a])||o[t[a]]!==e[t[a]])return!1}return!0}var r=Object.prototype.hasOwnProperty;e.exports=t},{}],167:[function(n,e){"use strict";function t(n){var e=n.length;if(Array.isArray(n)||"object"!=_typeof(n)&&"function"!=typeof n?d(!1):void 0,"number"!=typeof e?d(!1):void 0,0===e||e-1 in n?void 0:d(!1),n.hasOwnProperty)try{return Array.prototype.slice.call(n)}catch(e){}for(var t=Array(e),o=0;e>o;o++){t[o]=n[o]}return t}var d=n(158);e.exports=t},{158:158}],168:[function(n,e){"use strict";var t=n(150);e.exports=t},{150:150}]},{},[1])(1)});
//# sourceMappingURL=react-with-addons.min.js.map

define ("filter_poodll/literallycanvas_amd",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/uploader","filter_poodll/react_amd","filter_poodll/literallycanvas"],function(a,b,c,d,e,f){"use strict";b.debug("Filter PoodLL: literallycanvas.js initialising");return{instanceprops:[],loadliterallycanvas:function loadliterallycanvas(b){var c="#amdopts_"+b.recorderid,e=a(c).get(0);if(e){b=JSON.parse(e.value);this.config=b;a(c).remove()}var g="#"+b.recorderid+"_literally",h=a(g)[0],i=4,j=.2;if(0<b.whiteboardnozoom){i=1;j=1}if(b.backgroundimage){var k=a("#"+b.recorderid+"_separate-background-image")[0],l=new Image;l.src=k.src;l.crossOrigin="Anonymous";var m=f.createShape("Image",{x:0,y:0,image:l,scale:1}),n=f.init(h,{imageURLPrefix:b.imageurlprefix,backgroundColor:b.backgroundcolor,backgroundShapes:[m],recorderid:b.recorderid,zoomMax:i,zoomMin:j})}else{var n=f.init(h,{imageURLPrefix:b.imageurlprefix,backgroundColor:b.backgroundcolor,recorderid:b.recorderid,zoomMax:i,zoomMin:j})}b.lc=n;var o=b.vectordata;if(o){if(0==o.indexOf("{\"shapes\"")||0==o.indexOf("{\"colors\"")){n.loadSnapshot(JSON.parse(o))}}b.uploader=d.clone();b.uploader.init(g,b);this.instanceprops[b.recorderid]=b;this.registerEvents(b.recorderid)},registerEvents:function registerEvents(b){var d=this,e=this.instanceprops[b];if(e.autosave){e.lc.on("drawingChange",function(){var d=a("#"+b+"_messages")[0],f=a("#"+b+"_btn_upload_whiteboard")[0];if(d){if(f){f.disabled=!1}d.innerHTML="";var g=c.timeouthandles[b];if(g){clearTimeout(g)}c.timeouthandles[b]=setTimeout(function(){c.WhiteboardUploadHandler(b,e.lc,e,e.uploader)},e.autosave)}})}else{e.lc.on("drawingChange",function(){var c=a("#"+b+"_messages");if(c){c.innerHTML="File has not been saved."}})}var f=a("#"+b+"_btn_upload_whiteboard");if(f){if(e.autosave){f.click(function(){c.WhiteboardUploadHandler(b,e.lc,e,e.uploader)})}else{f.click(function(){var a=c.getCvs(b,e.lc,e);c.pokeVectorData(b,e.lc,e);e.uploader.uploadFile(a.toDataURL(),"image")})}}}}});
//# sourceMappingURL=literallycanvas_amd.min.js.map

define ("filter_poodll/anim_progress_bar",["jquery","core/log"],function(a,b){"use strict";b.debug("Bar Progress: initialising");return{playcanvas:null,context:null,startx:null,starty:null,barwidth:null,barheight:null,enabled:!1,drawparams:{barColor:"#C2C2C2",textColor:"#0",font:"12px Arial",textAlign:"center"},clone:function clone(){return a.extend(!0,{},this)},init:function init(a){this.playcanvas=a.get(0);this.startx=0;this.starty=0;this.barwidth=this.playcanvas.width;this.barheight=this.playcanvas.height;this.context=this.playcanvas.getContext("2d")},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.context.clearRect(this.startx,this.starty,this.barwidth,this.barheight)},fetchCurrent:function fetchCurrent(){return 0},stop:function stop(){this.enabled=!1;this.clear()},stopthere:function stopthere(){this.enabled=!1},start:function start(){this.clear();this.enabled=!0;var a=this;this.context.textAlign=this.drawparams.textAlign;this.context.font=this.drawparams.font;var b=this.drawparams.textColor,c=function(){if(!a.enabled){return}a.clear();a.context.fillStyle=a.drawparams.barColor;a.context.fillRect(a.startx,a.starty,a.fetchCurrent()*a.barwidth,a.barheight);var b=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;b(c)};c()}}});
//# sourceMappingURL=anim_progress_bar.min.js.map

define ("filter_poodll/responsiveiframe",["jquery","core/log"],function(a,b){"use strict";b.debug("responsive iframe initialising");return{defheight:150,defwidth:300,init:function init(b){var c=a("#"+b.iframeid);if(0==c.length){c=a("#"+b.iframeid,window.parent.document)}if(0<c.length){var d={currentheight:this.defheight,currentwidth:this.defwidth,theiframe:c,thisref:this};this._iframeResize(d)}},_iframeResize:function _iframeResize(a){var b=a.theiframe;if(!b||1>b.length){return}var c=b[0].contentWindow.document.body.scrollHeight,d=b[0].contentWindow.document.body.scrollWidth;if(c!=a.currentheight||d!=a.currentwidth){b.attr("height",c+"px");b.attr("width",d+"px")}a.currentheight=c;a.currentwidth=d;setTimeout(a.thisref._iframeResize,100,a)}}});
//# sourceMappingURL=responsiveiframe.min.js.map

define('filter_poodll/poodll_mediastreamrecorder', ["jquery","core/log"],function(a,b){"use strict";return b.debug("PoodLL Recorder: initialising"),{init:function(){},start:function(){},stop:function(){},resume:function(){},ondataavailable:function(a){b.debug("ondataavailable:"+a)},onstop:function(a){b.debug(a)}}});
define ("filter_poodll/speech_poodll",["jquery","core/log","filter_poodll/speech_browser","filter_poodll/speech_awstranscriber"],function(a,b,c,d){"use strict";b.debug("speech_poodll: initialising");return{recognizer:null,clone:function clone(){return a.extend(!0,{},this)},will_work_ok:function will_work_ok(a){if("streamingtranscriber"in a){switch(a.streamingtranscriber){case"aws":return d.will_work_ok(a);case"browser":return c.will_work_ok(a);}}return c.will_work_ok(a)||d.will_work_ok(a)},init:function init(a){if("streamingtranscriber"in a){switch(a.streamingtranscriber){case"aws":this.recognizer=d.clone();this.recognizer.init(a);break;case"browser":this.recognizer=c.clone();this.recognizer.init(a);break;}}if(!this.recognizer){if(c.will_work_ok(a)){this.recognizer=c.clone();this.recognizer.init(a)}else if(d.will_work_ok(a)){this.recognizer=d.clone();this.recognizer.init(a)}else{b.debug("no usable speech recognizer found");return!1}}},set_grammar:function set_grammar(a){this.recognizer.set_grammar(a)},start:function start(a){if(!this.recognizer){return}this.recognizer.onfinalspeechcapture=this.onfinalspeechcapture;this.recognizer.oninterimspeechcapture=this.oninterimspeechcapture;if(this.recognizer){this.recognizer.start(a)}},stop:function stop(){if(!this.recognizer){return}if(this.recognizer){this.recognizer.stop()}},onfinalspeechcapture:function onfinalspeechcapture(a){if(!this.recognizer){return}b.debug("final:"+a)},oninterimspeechcapture:function oninterimspeechcapture(a){if(!this.recognizer){return}b.debug("interim:"+a)}}});
//# sourceMappingURL=speech_poodll.min.js.map

define ("filter_poodll/poodll_scenariomediaskin",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/upskin_bar"],function(a,b,c,d){"use strict";b.debug("PoodLL Scenario Skin: initialising");return{instanceprops:null,pmr:null,uploaded:!1,recorded:!1,played:!1,mustResetResourcePlayer:!1,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.pmr=b},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+"\"></div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_checkplayer_"+a+" hide\" controls playsinline=\"playsinline\"></audio>"},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_checkplayer_"+a+"\" width=\"320\" height=\"240\" playsinline=\"playsinline\"></video>"},fetch_resource_audio:function fetch_resource_audio(a){return"<audio class=\"poodll_resourceplayer_"+a+" hide\" src=\"@@RESOURCEURL@@\" playsinline controls></audio>"},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+" hide\" src=\"@@RESOURCEURL@@\" playsinline=\"playsinline\"></video>"},fetch_uploader_skin:function fetch_uploader_skin(a,b){var c=this.fetch_instanceprops(a),e=d.clone();e.init(c.config,b,c.controlbar.split_progresscanvas,c.controlbar.status);return e},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);b.controlbar.stopbutton.attr("disabled",!1);b.controlbar.savebutton.attr("disabled",!1)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.checkplayer.attr("src",null);b.controlbar.stopbutton.attr("disabled",!1);b.controlbar.savebutton.attr("disabled",!1)},handle_timer_update:function handle_timer_update(a){if(!this.played&&!this.recorded){return}var b=this.fetch_instanceprops(a),c=M.util.get_string("recui_recording","filter_poodll");this.update_status(a,c+b.timer.fetch_display_time());if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stopbutton.click()}},update_status:function update_status(a,b){var c=this.fetch_instanceprops(a);c.controlbar.status.html(b)},set_visual_mode:function set_visual_mode(a,b){var c=this;switch(a){case"recordingmode":c.disable_button(b.controlbar.resourceplaybutton);b.controlbar.resourceplaybutton.empty();b.controlbar.resourceplaybutton.html("<span class=\"fa fa-microphone fa-3x\"></span>");b.controlbar.resourceplaybutton.addClass("poodll_mediarecorderholder_scenario_recordcolor");b.controlbar.status.addClass("poodll_mediarecorderholder_scenario_recordcolor");c.handle_timer_update(b.controlbarid);c.enable_button(b.controlbar.stopbutton);break;case"resourceplayingmode":c.disable_button(b.controlbar.resourceplaybutton);c.disable_button(b.controlbar.stopbutton);break;case"neverrecordedmode":b.controlbar.resourceplaybutton.empty();b.controlbar.resourceplaybutton.html("<p style=\"margin-bottom: 0px; font-size: 24px;\">Start</p>");c.enable_button(b.controlbar.resourceplaybutton);c.disable_button(b.controlbar.stopbutton);this.update_status(b.controlbarid,M.util.get_string("recui_ready","filter_poodll"));break;case"allstoppedmode":c.disable_button(b.controlbar.resourceplaybutton);c.disable_button(b.controlbar.stopbutton);b.controlbar.resourceplaybutton.empty();b.controlbar.resourceplaybutton.html("<span class=\"fa fa-check fa-3x\"></span>");b.controlbar.resourceplaybutton.removeClass("poodll_mediarecorderholder_scenario_recordcolor");b.controlbar.status.removeClass("poodll_mediarecorderholder_scenario_recordcolor");this.update_status(b.controlbarid,M.util.get_string("recui_finished","filter_poodll"));break;}},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio";e=e.replace("@@RESOURCEURL@@",g.config.resource);var j=this.pmr.fetch_strings(),k="<div class=\"poodll_mediarecorderholder_scenario "+i+"\" id=\"holder_"+c+"\">";k+="<div class=\"poodll_mediarecorderbox_scenario\" id=\""+c+"\">";k+="<div class=\"style-holder "+h+"\">";k+=d,k+=e,k+="<button type=\"button\" class=\"poodll_mediarecorder_button_scenario poodll_start-recording_scenario hide\"><span class=\"fa fa-microphone fa-3x\"></span></button>";k+=" <button type=\"button\" class=\"poodll_mediarecorder_button_scenario poodll_playback-recording_scenario hide\"><span class=\"fa fa-play-circle fa-3x\"></span></button>";k+=" <button type=\"button\" class=\"poodll_mediarecorder_button_scenario poodll_stopplayback-recording_scenario hide\"><span class=\"fa fa-stop-circle fa-3x\"></span></button>";k+="<button type=\"button\" class=\"poodll_save-recording_scenario pmr_disabled hide\">"+j.recui_save+"</button></div>";k+="<div class=\"poodll_mediarecorderholder_scenario\"><button type=\"button\" class=\"poodll_mediarecorder_button_scenario poodll_stop-recording_scenario pmr_disabled\" disabled><p style=\"margin-bottom: 0px;font-size: 24px;\">Submit</p></button></div>";k+="<div class=\"poodll_statusholder_scenario\" >";k+="<canvas class=\"scenario_range\"></canvas>";var l=this.fetch_status_bar("scenario");k+=l;k+="</div>";k+="</div></div></div>";a(b).append(k);a(".qtext").prepend("<hr />");a(".qtext").prepend("<div class=\"poodll_mediarecorderholder_scenario poodll_mediarecorder_scenario_topscenario\"><button type=\"button\" class=\"poodll_mediarecorder_button_scenario poodll_play-resource_scenario\"><p style=\"margin-bottom: 0px; font-size: 24px;\">Start</p></button></div>");var m={scenario_progresscanvas:a("#"+c+" .scenario_range"),marker:a("#"+c+"  .marker"),resourceplayer:a("#"+c+"  .poodll_resourceplayer_scenario"),checkplayer:a("#"+c+"  .poodll_checkplayer_scenario"),stopbutton:a("#"+c+"  .poodll_stop-recording_scenario"),resourcestopbutton:a("#"+c+"  .poodll_stop-resource_scenario"),startbutton:a("#"+c+"  .poodll_start-recording_scenario"),playbackbutton:a("#"+c+"  .poodll_playback-recording_scenario"),stopplaybackbutton:a("#"+c+"  .poodll_stopplayback-recording_scenario"),savebutton:a("#"+c+"  .poodll_save-recording_scenario"),resourceplaybutton:a(".poodll_mediarecorder_button_scenario.poodll_play-resource_scenario"),status:a(".poodll_status_scenario")};return m},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},do_callback:function do_callback(b){switch(b[1]){case"filesubmitted":var c=document.getElementById(b[3]);if(null==c){c=parent.document.getElementById(b[3])}if(c){c.value=b[2]}a("#responseform input[name=next]").attr("disabled",!1);}},register_controlbar_events_audio:function register_controlbar_events_audio(b,c){var d=this,e=this.pmr,f=this.fetch_instanceprops(c);this.set_visual_mode("neverrecordedmode",f);f.config.callbackjs=d.do_callback;a("#responseform input[name=next]").attr("disabled",!0);f.controlbar.startbutton.click(function(){e.do_start_audio(f,b);d.recorded=!0;f.timer.reset();f.timer.start();d.set_visual_mode("recordingmode",f)});f.controlbar.stopbutton.click(function(){d.do_stop_resource(f);e.do_stop_audio(f);d.disable_button(this);setTimeout(function(){f.controlbar.savebutton.click()},100);f.timer.stop();d.set_visual_mode("allstoppedmode",f)});f.controlbar.resourceplaybutton.click(function(){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(){f.controlbar.startbutton.trigger("click");d.played=!0;if(""!=f.config.resource){d.do_play_resource(f)}}).catch(function(a){alert(a)})});f.controlbar.resourcestopbutton.click(function(){d.do_stop_resource(f);if(d.recorded){d.set_visual_mode("allstoppedmode",f)}else{d.set_visual_mode("neverrecordedmode",f)}});f.controlbar.savebutton.click(function(){d.disable_button(this);if(f.blobs&&0<f.blobs.length){e.do_save_audio(f);d.uploaded=!0;d.disable_button(f.controlbar.startbutton)}else{f.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1})},set_completion:function set_completion(a,b){var c=b.controlbar.completioncheck},do_stop_resource:function do_stop_resource(a){console.log("stopped the resource");var b=a.controlbar.resourceplayer.get(0);b.pause();b.currentTime=0;if(a.mustResetResourcePlayer){a.mustResetResourcePlayer=!1;b.src=a.config.resource;b.load()}},do_play_resource:function do_play_resource(a){var b=a.controlbar.resourceplayer.get(0);b.play();b.currentTime=0},enable_button:function enable_button(b){a(b).attr("disabled",!1);a(b).removeClass("pmr_disabled")},disable_button:function disable_button(b){a(b).attr("disabled",!0);a(b).addClass("pmr_disabled")}}});
//# sourceMappingURL=poodll_scenariomediaskin.min.js.map

define ("filter_poodll/msr_poodll",["jquery","core/log","filter_poodll/utils_amd","filter_poodll/msr_stereoaudio","filter_poodll/msr_plain"],function(a,b,c,d,e){"use strict";b.debug("PoodLL MS Recorder: initialising");return{sampleRate:48e3,mimeType:"audio/wav",audioChannels:1,bufferSize:2048,therecorder:null,audioctx:null,audioanalyser:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,f,g,h,i){this.audioctx=f;this.audioanalyser=g;if("auto"!=i){switch(i){case"stereoaudio":if("audio"==h){this.therecorder=d}else{this.therecorder=e}break;case"plain":default:this.therecorder=e;}}else if(c.has_mediarecorder()){this.therecorder=e;b.debug("using plain recorder")}else if("audio"==h){this.therecorder=d;b.debug("using stereo recorder")}if(this.therecorder){this.therecorder.init(this,a,f,h)}},start:function start(){this.therecorder.start();this.audioanalyser.start()},stop:function stop(){this.therecorder.stop();this.audioanalyser.clear()},pause:function pause(){this.therecorder.pause();this.audioanalyser.clear()},resume:function resume(){this.therecorder.resume();this.audioanalyser.start()},ondataavailable:function ondataavailable(a){b.debug("ondataavailable:"+a)},onStartedDrawingNonBlankFrames:function onStartedDrawingNonBlankFrames(){b.debug("started drawing non blank frames:")},onstop:function onstop(a){b.debug(a)}}});
//# sourceMappingURL=msr_poodll.min.js.map

define ("filter_poodll/speech_awstranscriber",["jquery","core/log"],function(a,b){"use strict";b.debug("aws_instant: initialising");return{final_transcript:"",start_timestamp:0,transcriber:null,clone:function clone(){return a.extend(!0,{},this)},will_work_ok:function will_work_ok(a){var b=!1;switch(a.language){case"en-AU":case"en-GB":case"en-US":case"es-US":case"fr-FR":case"fr-CA":b=!0;break;default:b=!1;}if(b){switch(a.region){case"useast1":case"useast2":case"uswest2":case"sydney":case"dublin":case"ottawa":b=!0;break;default:b=!1;}}return b},init:function init(a){var b=this;require(["https://cdn.jsdelivr.net/gh/justinhunt/cloudpoodll@latest/amd/build/awstranscriber.min.js"],function(c){b.transcriber=c;a.expiretime=300;a.token=a.wstoken;a.wsserver=M.cfg.wwwroot;b.transcriber.init(a);b.register_events()})},set_grammar:function set_grammar(){},start:function start(a){if(this.transcriber.active){return}this.final_transcript="";this.transcriber.start(a,this.transcriber);this.ignore_onend=!1;this.start_timestamp=Date.now()},stop:function stop(){if(!this.transcriber.active){return}this.transcriber.stop(this.transcriber)},register_events:function register_events(){var a=this;this.transcriber.onFinalResult=function(b,c){a.onfinalspeechcapture(b,c)}},onfinalspeechcapture:function onfinalspeechcapture(a){b.debug(a)},oninterimspeechcapture:function oninterimspeechcapture(){}}});
//# sourceMappingURL=speech_awstranscriber.min.js.map

(function(a){if("function"==typeof define&&define.amd){define ("filter_poodll/jquery.flip",["jquery"],a)}else{a(jQuery)}})(function(a){var b=function(b,c){b.data("flipped",!0);var e="rotate"+b.data("axis");b.find(b.data("front")).css({transform:e+(b.data("reverse")?"(-180deg)":"(180deg)"),"z-index":"0"});b.find(b.data("back")).css({transform:e+"(0deg)","z-index":"1"});b.one(d(),function(){a(this).trigger("flip:done");if(c!==void 0){c.call(this)}})},c=function(b,c){b.data("flipped",!1);var e="rotate"+b.data("axis");b.find(b.data("front")).css({transform:e+"(0deg)","z-index":"1"});b.find(b.data("back")).css({transform:e+(b.data("reverse")?"(180deg)":"(-180deg)"),"z-index":"0"});b.one(d(),function(){a(this).trigger("flip:done");if(c!==void 0){c.call(this)}})},d=function(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c){if(b.style[a]!==void 0){return c[a]}}};a.fn.flip=function(d,f){if("function"==typeof d){f=d}this.each(function(){var g=a(this);if(d!==void 0&&("boolean"==typeof d||"string"==typeof d)){if("toggle"==d){d=!g.data("flipped")}if(d){b(g,f)}else{c(g,f)}}else if(!g.data("initiated")){g.data("initiated",!0);var h=a.extend({axis:"y",reverse:!1,trigger:"click",speed:500,forceHeight:!1,forceWidth:!1,autoSize:!0,front:"auto",back:"auto"},d);if("auto"==h.front){h.front=0<g.find(".front").length?".front":"div:first-child"}else if("autostrict"==h.front){h.front="div:first-child"}if("auto"==h.back){h.back=0<g.find(".back").length?".back":"div:first-child + div"}else if("autostrict"==h.back){h.back="div:first-child + div"}g.data("reverse",h.reverse);g.data("axis",h.axis);g.data("front",h.front);g.data("back",h.back);var i="rotate"+("x"==h.axis.toLowerCase()?"x":"y"),j=2*g["outer"+("rotatex"==i?"Height":"Width")]();g.find(g.data("back")).css({transform:i+"("+(h.reverse?"180deg":"-180deg")+")"});g.css({perspective:j,position:"relative"});var k=h.speed/1e3||.5,l=g.find(h.front).add(h.back,g);if(h.forceHeight){l.outerHeight(g.height())}else if(h.autoSize){l.css({height:"100%"})}if(h.forceWidth){l.outerWidth(g.width())}else if(h.autoSize){l.css({width:"100%"})}l.css({"backface-visibility":"hidden","transform-style":"preserve-3d",position:"absolute","z-index":"1"});l.find("*").css({"backface-visibility":"hidden"});g.find(g.data("back")).css({transform:i+"("+(h.reverse?"180deg":"-180deg")+")","z-index":"0"});if((window.chrome||window.Intl&&Intl.v8BreakIterator)&&"CSS"in window){g.css({"-webkit-transform-style":"preserve-3d"})}setTimeout(function(){l.css({transition:"all "+k+"s ease-out"});if(f!==void 0){f.call(this)}},20);if("click"==h.trigger.toLowerCase()){g.on(a.fn.tap?"tap.flip":"click.flip",function(d){if(!d){d=window.event}if(g.find(a(d.target).closest("button, a, input[type=\"submit\"]")).length){return}if(g.data("flipped")){c(g)}else{b(g)}})}else if("hover"==h.trigger.toLowerCase()){var m=function(){g.off("mouseleave.flip");b(g);setTimeout(function(){g.on("mouseleave.flip",n);if(!g.is(":hover")){c(g)}},h.speed+150)},n=function(){c(g)};g.on("mouseenter.flip",m);g.on("mouseleave.flip",n)}}else{if(d&&(d.axis!==void 0||d.reverse!==void 0)){e.call(this,d,function(){g.trigger("flip:change");if(f!==void 0){f.call(this)}})}}});return this};var e=function(b,c){var d=!1;if(b.axis!==void 0&&a(this).data("axis")!=b.axis.toLowerCase()){a(this).data("axis",b.axis.toLowerCase());d=!0}if(b.reverse!==void 0&&a(this).data("reverse")!=b.reverse){a(this).data("reverse",b.reverse);d=!0}if(d){var e=a(this).find(a(this).data("front")).add(a(this).data("back"),a(this)),f=e.css("transition");e.css({transition:"none"});var g="rotate"+a(this).data("axis");if(a(this).data("flipped")){a(this).find(a(this).data("front")).css({transform:g+(a(this).data("reverse")?"(-180deg)":"(180deg)"),"z-index":"0"})}else{a(this).find(a(this).data("back")).css({transform:g+"("+(a(this).data("reverse")?"180deg":"-180deg")+")","z-index":"0"})}setTimeout(function(){e.css({transition:f});c.call(this)}.bind(this),0)}else{setTimeout(c.bind(this),0)}}});
//# sourceMappingURL=jquery.flip.min.js.map

define ("filter_poodll/msr_stereoaudio",["jquery","core/log","filter_poodll/msr_helper_stereoaudio"],function(a,b,c){"use strict";b.debug("PoodLL Recorder: initialising");return{timeout:0,mediaRecorder:null,mediaStream:null,msr:null,mediaType:"audio",clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c,d){this.msr=a;this.mediaStream=b;this.audioctx=c;this.mediaType=d},start:function start(a){a=a||1e3;var b=this;this.mediaRecorder=c.clone();this.mediaRecorder.init(this.msr,this.mediaStream,this.audioctx);this.mediaRecorder.record();this.timeout=setInterval(function(){b.mediaRecorder.requestData()},a)},stop:function stop(){if(this.mediaRecorder){this.mediaRecorder.stop();clearTimeout(this.timeout)}},pause:function pause(){if(!this.mediaRecorder){return}this.mediaRecorder.pause()},resume:function resume(){if(!this.mediaRecorder){return}this.mediaRecorder.resume()},ondataavailable:function ondataavailable(a){b.debug("ondataavailable:"+a)},onstop:function onstop(a){b.debug(a)}}});
//# sourceMappingURL=msr_stereoaudio.min.js.map

define('filter_poodll/radialprogress', ["jquery","core/log"],function(a,b){"use strict";return b.debug("Radial Progress: initialising"),{playcanvas:null,context:null,x:null,y:null,currenttime:0,enabled:!1,clone:function(){return a.extend(!0,{},this)},init:function(a){this.playcanvas=a.get(0),this.x=this.playcanvas.width/2,this.y=this.playcanvas.height/2,this.context=this.playcanvas.getContext("2d"),this.context.lineWidth=10,this.context.strokeStyle="#ad2323",this.context.setLineDash([15,5]),this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowBlur=10,this.context.shadowColor="#fff"},clear:function(){this.context.clearRect(0,0,this.playcanvas.width,this.playcanvas.height)},fetchCurrent:function(){return 0},stop:function(){this.enabled=!1,this.clear()},start:function(){this.clear(),this.enabled=!0;var a=this,b=function(){if(a.enabled){var c=65,d=!1,e=2*Math.PI,f=Math.PI/2;a.context.beginPath(),a.context.arc(a.x,a.y,c,-f,e*a.fetchCurrent()-f,d),a.context.stroke();var g=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;g(b)}};b()}}});
define ("filter_poodll/poodll_fbmediaskin",["jquery","core/log","filter_poodll/utils_amd"],function(a,b){"use strict";b.debug("PoodLL Fluencybuilder Skin: initialising");return{instanceprops:null,pmr:null,uploaded:!1,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.instanceprops=a;this.instanceprops.warmedup=!1;this.pmr=b},fetch_instanceprops:function fetch_instanceprops(){return this.instanceprops},onUploadSuccess:function onUploadSuccess(b){a("#"+b+" > .poodll_save-recording").hide();a("#"+b+" > .poodll_savedsuccessfully").show()},onUploadFailure:function onUploadFailure(){},fetch_status_bar:function fetch_status_bar(a){return"<div class=\"poodll_status_"+a+" hide\"></div>"},fetch_preview_audio:function fetch_preview_audio(a){return"<audio class=\"poodll_checkplayer_"+a+" hide\" playsinline=\"playsinline\" muted></audio>"},fetch_model_audio:function fetch_model_audio(){var a="<audio class=\"poodll_modelplayer_fluencybuilder hide\" src=\""+M.cfg.wwwroot+"/filter/poodll/ding.mp3\" playsinline=\"playsinline\"></audio>";return a},fetch_preview_video:function fetch_preview_video(a){return"<video class=\"poodll_checkplayer_"+a+"\" width=\"320\" height=\"240\" playsinline=\"playsinline\" muted></video>"},fetch_resource_audio:function fetch_resource_audio(a){var b="<audio class=\"poodll_resourceplayer_"+a+" hide\" src=\""+M.cfg.wwwroot+"/filter/poodll/ding.mp3\" playsinline=\"playsinline\"></audio>";return b},fetch_resource_video:function fetch_resource_video(a){return"<video class=\"poodll_resourceplayer_"+a+" hide\" src=\"@@RESOURCEURLx@@\" playsinline=\"playsinline\"></video>"},fetch_uploader_skin:function fetch_uploader_skin(){return!1},fetch_ding_player:function fetch_ding_player(){var a="<audio class=\"poodll_dingplayer_fluencybuilder hide\"  src=\""+M.cfg.wwwroot+"/filter/poodll/ding.mp3\" ></audio>";return a},onMediaError:function onMediaError(a){console.error("media error",a)},onMediaSuccess_video:function onMediaSuccess_video(a){var b=this.fetch_instanceprops(a);this.highlight_button("bwrapper_start-recording",a);b.uploader.Output("");b.timer.reset();b.timer.start();this.update_status(a);b.controlbar.stopbutton.attr("disabled",!1);b.controlbar.savebutton.attr("disabled",!1)},onMediaSuccess_audio:function onMediaSuccess_audio(a){var b=this.fetch_instanceprops(a);b.controlbar.checkplayer.attr("src",null);this.pmr.do_pause_audio(b)},handle_timer_update:function handle_timer_update(a){var b=this.fetch_instanceprops(a);this.update_status(a);if(0==b.timer.seconds&&0<b.timer.initseconds){b.controlbar.stoprecbutton.click()}},update_status:function update_status(){},insert_controlbar_video:function insert_controlbar_video(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"video");return e},insert_controlbar_audio:function insert_controlbar_audio(a,b,c,d){var e=this.prepare_controlbar(a,b,c,d,"audio");return e},prepare_controlbar:function prepare_controlbar(b,c,d,e,f){var g=this.fetch_instanceprops(c),h=g.config.media_skin_style,i="video"==f?"poodll_mediarecorder_video":"poodll_mediarecorder_audio",e=e.replace("@@RESOURCEURL@@",g.config.resource),j=this.fetch_model_audio();j=j.replace("@@MODELURL@@",g.config.resource2);var k=this.fetch_ding_player(),l=this.fetch_status_bar("fluencybuilder"),m="poodll_mediarecorder_size_auto";switch(g.config.size){case"small":m="poodll_mediarecorder_size_small";break;case"big":m="poodll_mediarecorder_size_big";break;case"auto":m="poodll_mediarecorder_size_auto";}var n="<div class=\"poodll_mediarecorderholder_fluencybuilder "+i+" "+m+"\" id=\"holder_"+c+"\">";n+="<div class=\"poodll_mediarecorderbox_fluencybuilder\" id=\""+c+"\">";n+="<div class=\"style-holder "+h+"\">";n+=l,n+=k,n+=j,n+=d,n+=e,n+="<div class=\"fb_bwrapper bwrapper_play-resource mod_fluencybuilder_autobutton_inactive\"><button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_play-resource_fluencybuilder\"><i class=\"fa fa-assistive-listening-systems\" aria-hidden=\"true\"></i></button></div>";n+="<div class=\"fb_bwrapper bwrapper_start-recording mod_fluencybuilder_autobutton_inactive\"><button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_start-recording_fluencybuilder\" disabled><i class=\"fa fa-microphone\" aria-hidden=\"true\"></i></button></div>";n+="<div class=\"fb_bwrapper bwrapper_play-model mod_fluencybuilder_autobutton_inactive\"> <button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_play-model_fluencybuilder\" disabled><i class=\"fa fa-play-circle\" aria-hidden=\"true\"></i></button></div>";n+="<button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_play-recording_fluencybuilder hide\">"+M.util.get_string("recui_play","filter_poodll")+"</button>";n+="<button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_stop-playing_fluencybuilder hide\">stopplay</button>";n+="<button type=\"button\" class=\"poodll_mediarecorder_button_fluencybuilder poodll_stop-recording_fluencybuilder hide\">"+M.util.get_string("recui_stop","filter_poodll")+"</button>";n+="<button type=\"button\" class=\"poodll_save-recording_fluencybuilder pmr_disabled hide\">"+M.util.get_string("recui_save","filter_poodll")+"</button>";n+="</div></div></div>";a(b).prepend(n);var o={status:a("#"+c+"  .poodll_status_fluencybuilder"),dingplayer:a("#"+c+"  .poodll_dingplayer_fluencybuilder"),modelplayer:a("#"+c+"  .poodll_modelplayer_fluencybuilder"),resourceplayer:a("#"+c+"  .poodll_resourceplayer_fluencybuilder"),checkplayer:a("#"+c+"  .poodll_checkplayer_fluencybuilder"),resourcebutton:a("#"+c+"  .poodll_play-resource_fluencybuilder"),startbutton:a("#"+c+"  .poodll_start-recording_fluencybuilder"),stoprecbutton:a("#"+c+"  .poodll_stop-recording_fluencybuilder"),stopbutton:a("#"+c+"  .poodll_stop-playing_fluencybuilder"),playbutton:a("#"+c+"  .poodll_play-recording_fluencybuilder"),playmodelbutton:a("#"+c+"  .poodll_play-model_fluencybuilder"),savebutton:a("#"+c+"  .poodll_save-recording_fluencybuilder"),resourcewrapper:a("#"+c+"  .bwrapper_play-resource"),startrecwrapper:a("#"+c+"  .bwrapper_start-recording"),playmodelwrapper:a("#"+c+"  .bwrapper_play-model")};return o},register_controlbar_events_video:function register_controlbar_events_video(a,b){return this.register_controlbar_events_audio(a,b)},play_ding:function play_ding(a,b){var c=this.fetch_instanceprops(b);c.controlbar.dingplayer[0].play();switch(a){case"click_start":c.controlbar.startbutton.click();break;case"click_play":c.controlbar.playmodelbutton.click();break;case"show_dialog":alert("dialog");break;default:c.controlbar.dingplayer[0].onended=null;}},highlight_button:function highlight_button(b,c){var d=a("#"+c+"  .fb_bwrapper");a(d).each(function(){if(a(this).hasClass(b)){a(this).removeClass("mod_fluencybuilder_autobutton_inactive");a(this).addClass("mod_fluencybuilder_autobutton_active")}else{a(this).removeClass("mod_fluencybuilder_autobutton_active");a(this).addClass("mod_fluencybuilder_autobutton_inactive")}})},warmup_recorder:function warmup_recorder(b,c){var d=this.fetch_instanceprops(b);this.pmr.warmup_context(d);this.pmr.warmup_preview(d);this.pmr.do_start_audio(d,c);var e=d.controlbar.modelplayer.get(0),f=d.controlbar.dingplayer.get(0),g=d.controlbar.resourceplayer.get(0);if(!d.warmedup){try{g.play();f.play();e.play();g.pause();f.pause();e.pause()}catch(a){}}var h=M.cfg.wwwroot+"/filter/poodll/ding.mp3";a(e).attr("src",d.config.resource2);a(f).attr("src",h);a(g).attr("src",d.config.resource);d.warmedup=!0},register_controlbar_events_audio:function register_controlbar_events_audio(a,b){var c=this,d=this.pmr,e=this.fetch_instanceprops(b);e.controlbar.resourceplayer.on("ended",function(){if(e.warmedup){c.play_ding("click_start",b)}});e.controlbar.modelplayer.on("ended",function(){c.highlight_button("",b)});e.controlbar.startbutton.click(function(){d.do_resume_audio(e);c.highlight_button("bwrapper_start-recording",b);e.uploader.Output("");e.timer.reset();e.timer.start();c.update_status(b);e.controlbar.stopbutton.attr("disabled",!1);e.controlbar.savebutton.attr("disabled",!1)});e.controlbar.stoprecbutton.click(function(){d.do_stop_audio(e);c.play_ding("click_play",b);e.timer.stop();c.update_status(b)});e.controlbar.stopbutton.click(function(){c.highlight_button("none",b);e.timer.stop();c.update_status(b)});e.controlbar.playmodelbutton.click(function(){var a=e.controlbar.modelplayer.get(0);a.play();c.highlight_button("bwrapper_play-model",b)});e.controlbar.playbutton.click(function(){var a=e.controlbar.checkplayer.get(0);d.do_play_audio(e,a)});e.controlbar.resourcebutton.click(function(){c.warmup_recorder(b,a);c.disable_button(this);var d=e.controlbar.resourceplayer.get(0);d.play();c.highlight_button("bwrapper_play-resource",b)});e.controlbar.savebutton.click(function(){c.disable_button(this);if(e.blobs&&0<e.blobs.length){d.do_save_audio(e);c.uploaded=!0;c.disable_button(e.controlbar.startbutton)}else{e.uploader.Output(M.util.get_string("recui_nothingtosaveerror","filter_poodll"))}return!1});window.onbeforeunload=function(){c.enable_button(e.controlbar.startbutton);var a=e.controlbar.checkplayer;if(a&&a.get(0)){a.get(0).pause()}}},enable_button:function enable_button(b){a(b).prop("disabled",!1)},disable_button:function disable_button(b){a(b).prop("disabled",!0)},show_button:function show_button(a){a.show()},hide_button:function hide_button(a){a.hide()}}});
//# sourceMappingURL=poodll_fbmediaskin.min.js.map

define ("filter_poodll/mediaparser",["jquery","core/log"],function(a,b){"use strict";b.debug("Media Parser: initialising");return{parse:function parse(b,c){var d={mediaurl:!1,lang:!1,subtitlesurl:!1,sources:!1,imgurl:!1},e=a("#"+b+" "+c).first();if(1===e.length){d.lang=a("#"+b+" "+c+" track[kind=\"captions\"]").first().attr("srclang");d.subtitlesurl=a("#"+b+" "+c+" track[kind=\"captions\"]").first().attr("src");if(e.attr("src")!==void 0){d.mediaurl=e.attr("src")}else{d.mediaurl=a("#"+b+" "+c+" source").first().attr("src")}d.sources=a("#"+b+" "+c+" source");e.addClass("nomediaplugin");e.addClass("nopoodll")}else{var f=a("#"+b+" a").first();d.mediaurl=f.attr("href");d.lang=f.attr("data-lang");d.subtitlesurl=f.attr("data-subtitles");d.imgurl=f.attr("data-img");if(d.subtitlesurl===void 0&&0<d.mediaurl.split("?").length){var g=new URLSearchParams(d.mediaurl.split("?")[1]);d.subtitlesurl=g.get("data-subtitles");d.lang=g.get("data-language");d.mediaurl=mediaurl.split("?")[0]}f.addClass("nomediaplugin");f.addClass("nopoodll")}if(!d.imgurl){var h=a("#"+b+" img").first();if(1===h.length){d.imgurl=h.attr("src")}}return d}}});
//# sourceMappingURL=mediaparser.min.js.map

define ("filter_poodll/upskin_plain",["jquery","core/log"],function(a,b){"use strict";b.debug("upskin_plain: initialising");return{element:null,cvs:null,cvsctx:null,clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b,c,d){this.config=a;this.element=b;this.cvs=c;this.messagearea=d},initControls:function initControls(){var b=this.config.media_skin_style,c="<div id=\""+this.config.widgetid+"_progress\" class=\"p_progress x progress_"+b+"\"><p></p></div>";c+="<div id=\""+this.config.widgetid+"_messages\" class=\"p_messages x messages_"+b+"\"></div>";a(this.element).append(c)},initProgressSession:function initProgressSession(b){var c=!1,d=a("#"+this.config.widgetid+"_progress");if(d.length){var e=d.get(0);c=e.firstChild;if(null===c){c=e.appendChild(document.createElement("p"))}c.className="";c.style.display="block";c.style.backgroundPosition="100% 0";b.upload.addEventListener("progress",function(a){var b=parseInt(100-100*(a.loaded/a.total));c.style.backgroundPosition=b+"% 0"})}},deactivateProgressSession:function deactivateProgressSession(){},showMessage:function showMessage(b){var c=a("#"+this.config.widgetid+"_messages");c.text(b)}}});
//# sourceMappingURL=upskin_plain.min.js.map

define ("filter_poodll/poodll_uploadrecorder",["jquery","core/log","filter_poodll/uploader"],function(a,b,c){"use strict";b.debug("PoodLL Upload Recorder: initialising");return{config:null,instanceprops:[],fetch_instance_props:function fetch_instance_props(a){return this.instanceprops[a]},init_instance_props:function init_instance_props(a){this.instanceprops[a]={config:null,uploader:null}},supports_current_browser:function supports_current_browser(){return!0},embed:function embed(a,b){this.init_instance_props(b.widgetid);var d=this.fetch_instance_props(b.widgetid);d.config=b;d.uploader=c.clone();d.uploader.init(a,b);this.insert_controls(a,b.widgetid);this.register_events(b.widgetid)},insert_controls:function insert_controls(b,c){var d=this.fetch_instance_props(c),e="",f=d.config;switch(f.mediatype){case"video":e="video/*";break;case"snapshot":case"image":e="image/*";case"audio":var g=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(g){e="video/*"}else{e="audio/*"}default:e="";}var h="<div class=\"p_btn_wrapper\">";h+="<input type=\"file\" id=\""+f.widgetid+"_poodllfileselect\" name=\"poodllfileselect[]\" accept=\""+e+"\"/>";h+="<button type=\"button\" class=\"p_btn\">"+M.util.get_string("recui_recordorchoose","filter_poodll")+"</button>";h+="</div>";a(b).prepend(h)},register_events:function register_events(b){var c=this;a("#"+b+"_poodllfileselect").on("change",function(a){c.FileSelectHandler(a,b)})},FileSelectHandler:function FileSelectHandler(a,c){for(var d=this.fetch_instance_props(c),e=a.target.files||a.dataTransfer.files,f=0,g;g=e[f];f++){b.debug("filetype:"+g.type);d.uploader.uploadBlob(g,g.type)}},ParseFile:function ParseFile(a,c){var d=this.fetch_instance_props(c),f="",g=new FileReader;g.onloadend=function(b){f=b.target.result;d.uploader.uploadFile(f,a.type)};b.debug("filetype:"+a.type);g.readAsDataURL(a)}}});
//# sourceMappingURL=poodll_uploadrecorder.min.js.map

define ("filter_poodll/anim_hwave_mic",["jquery","core/log"],function(a,b){"use strict";b.debug("anim_horizontal_wave_mic: initialising");return{analyser:null,cvs:null,cvsctx:null,sounddetected:!1,imgone:null,imgoneloaded:!1,drawparams:{micColor:"#CCCCCC",wavColor:"#CCCCCC",lineWidth:2},clone:function clone(){return a.extend(!0,{},this)},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},init:function init(a,b){this.cvs=b;this.cvsctx=b.getContext("2d");this.cvsctx.textAlign="center";this.analyser=a;var c=this;this.imgone=new Image;this.imgone.addEventListener("load",function(){c.imgoneloaded=!0});this.imgone.src=M.cfg.wwwroot+"/filter/poodll/pix/svg/mic.svg"},clear:function clear(){if(!this.imgoneloaded){var a=this;this.imgone.addEventListener("load",function(){a.imgoneloaded=!0;a.clear()});return}this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height);this.cvsctx.beginPath();this.cvsctx.lineWidth=this.drawparams.lineWidth;this.cvsctx.strokeStyle=this.drawparams.wavColor;this.cvsctx.moveTo(0,this.cvs.height/2);this.cvsctx.lineTo(this.cvs.width,this.cvs.height/2);this.cvsctx.stroke();this.drawMic(this.cvsctx,this.cvs.width,this.cvs.height,this.imgone)},drawMic:function drawMic(a,b,c,d){var e=(b-d.width)/2,f=(c-d.height)/2;a.drawImage(d,e,f)},start:function start(){this.analyser.core.fftSize=2048;var a=this.analyser.core.fftSize,b=new Uint8Array(a),c=this.cvs.width,d=this.cvs.height,e=this.cvsctx,f=this.analyser,g=this;this.clear();var h=function(){requestAnimationFrame(h);if(!f.theinterval){return}f.core.getByteTimeDomainData(b);e.clearRect(0,0,c,d);e.lineWidth=g.drawparams.lineWidth;e.strokeStyle=g.drawparams.wavColor;e.beginPath();var j=0;if(0<a){var k=b[a-1];if(128!=k){g.sounddetected=!0}}for(var l=0;l<a;l++){var m=b[l]/128,n=m*d/2;if(0==l){e.moveTo(j,n)}else{e.lineTo(j,n)}j+=2*c/a}e.lineTo(c,d/2);e.stroke();g.drawMic(e,c,d,g.imgone)};h()}}});
//# sourceMappingURL=anim_hwave_mic.min.js.map

define ("filter_poodll/anim_ripple",["jquery","core/log"],function(a,b){"use strict";b.debug("anim_ripple: initialising");return{analyser:null,cvs:null,cvsctx:null,drawparams:{rippleColor:"#0",lineWidth:2},clone:function clone(){return a.extend(!0,{},this)},init:function init(a,b){this.cvs=b;this.cvsctx=b.getContext("2d");this.analyser=a},setDrawParam:function setDrawParam(a,b){this.drawparams[a]=b},clear:function clear(){this.cvsctx.clearRect(0,0,this.cvs.width,this.cvs.height)},start:function start(){this.analyser.core.fftSize=2048;var a=this.analyser.core.fftSize,b=new Uint8Array(a),c=this.cvs.width,d=this.cvs.height,e=this.cvsctx,f=this.analyser;this.clear();var g=this,h=function(){requestAnimationFrame(h);if(!f.theinterval){return}f.core.getByteTimeDomainData(b);e.clearRect(0,0,c,d);e.lineWidth=g.drawparams.lineWidth;e.setLineDash([15,5]);e.strokeStyle=g.drawparams.rippleColor;e.beginPath();if(0<a){var j=1+a/5}for(var k=0;k<a;k=k+j){var l=b[k]/128;e.arc(c/2,d/2,50+l*(d-100)/4,0,2*Math.PI)}e.stroke()};h()}}});
//# sourceMappingURL=anim_ripple.min.js.map

function _typeof2(e){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof2=function(e){return typeof e}}else{_typeof2=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return _typeof2(e)}(function(e,a){if("object"===("undefined"==typeof exports?"undefined":_typeof2(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof2(module)))module.exports=a();else if("function"==typeof define&&define.amd)define ("filter_poodll/wavesurfer",[],a);else if("object"===("undefined"==typeof exports?"undefined":_typeof2(exports)))exports.WaveSurfer=a();else e.WaveSurfer=a()})(window,function(){return function(e){var t={};function a(r){if(t[r]){return t[r].exports}var n=t[r]={i:r,l:!1,exports:{}};e[r].call(n.exports,n,n.exports,a);n.l=!0;return n.exports}a.m=e;a.c=t;a.d=function(e,t,r){if(!a.o(e,t)){Object.defineProperty(e,t,{enumerable:!0,get:r})}};a.r=function(e){if("undefined"!=typeof Symbol&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:!0})};a.t=function(e,t){if(1&t)e=a(e);if(8&t)return e;if(4&t&&"object"===_typeof2(e)&&e&&e.__esModule)return e;var r=Object.create(null);a.r(r);Object.defineProperty(r,"default",{enumerable:!0,value:e});if(2&t&&"string"!=typeof e)for(var n in e){a.d(r,n,function(a){return e[a]}.bind(null,n))}return r};a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};a.d(t,"a",t);return t};a.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)};a.p="";return a(a.s="./src/wavesurfer.js")}({"./node_modules/debounce/index.js":function node_modulesDebounceIndexJs(e){function a(e,a,t){var n,s,o,i,l;if(null==a)a=100;function r(){var d=Date.now()-i;if(d<a&&0<=d){n=setTimeout(r,a-d)}else{n=null;if(!t){l=e.apply(o,s);o=s=null}}}var d=function(){o=this;s=arguments;i=Date.now();var d=t&&!n;if(!n)n=setTimeout(r,a);if(d){l=e.apply(o,s);o=s=null}return l};d.clear=function(){if(n){clearTimeout(n);n=null}};d.flush=function(){if(n){l=e.apply(o,s);o=s=null;clearTimeout(n);n=null}};return d}a.debounce=a;e.exports=a},"./src/drawer.canvasentry.js":function srcDrawerCanvasentryJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var i=r(t("./src/util/style.js")),l=r(t("./src/util/get-id.js"));function r(e){return e&&e.__esModule?e:{default:e}}function n(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function s(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function o(e,a,t){if(a)s(e.prototype,a);if(t)s(e,t);return e}var d=function(){function e(){n(this,e);this.wave=null;this.waveCtx=null;this.progress=null;this.progressCtx=null;this.start=0;this.end=1;this.id=(0,l.default)("undefined"!=typeof this.constructor.name?this.constructor.name.toLowerCase()+"_":"canvasentry_");this.canvasContextAttributes={}}o(e,[{key:"initWave",value:function(e){this.wave=e;this.waveCtx=this.wave.getContext("2d",this.canvasContextAttributes)}},{key:"initProgress",value:function(e){this.progress=e;this.progressCtx=this.progress.getContext("2d",this.canvasContextAttributes)}},{key:"updateDimensions",value:function(e,a,t,r){this.start=this.wave.offsetLeft/a||0;this.end=this.start+e/a;this.wave.width=t;this.wave.height=r;var n={width:e+"px"};(0,i.default)(this.wave,n);if(this.hasProgressCanvas){this.progress.width=t;this.progress.height=r;(0,i.default)(this.progress,n)}}},{key:"clearWave",value:function(){this.waveCtx.clearRect(0,0,this.waveCtx.canvas.width,this.waveCtx.canvas.height);if(this.hasProgressCanvas){this.progressCtx.clearRect(0,0,this.progressCtx.canvas.width,this.progressCtx.canvas.height)}}},{key:"setFillStyles",value:function(e,a){this.waveCtx.fillStyle=e;if(this.hasProgressCanvas){this.progressCtx.fillStyle=a}}},{key:"fillRects",value:function(e,a,t,r,n){this.fillRectToContext(this.waveCtx,e,a,t,r,n);if(this.hasProgressCanvas){this.fillRectToContext(this.progressCtx,e,a,t,r,n)}}},{key:"fillRectToContext",value:function(e,a,t,r,n,s){if(!e){return}if(s){this.drawRoundedRect(e,a,t,r,n,s)}else{e.fillRect(a,t,r,n)}}},{key:"drawRoundedRect",value:function(e,a,t,r,n,s){if(0===n){return}if(0>n){n*=-1;t-=n}e.beginPath();e.moveTo(a+s,t);e.lineTo(a+r-s,t);e.quadraticCurveTo(a+r,t,a+r,t+s);e.lineTo(a+r,t+n-s);e.quadraticCurveTo(a+r,t+n,a+r-s,t+n);e.lineTo(a+s,t+n);e.quadraticCurveTo(a,t+n,a,t+n-s);e.lineTo(a,t+s);e.quadraticCurveTo(a,t,a+s,t);e.closePath();e.fill()}},{key:"drawLines",value:function(e,a,t,r,n,s){this.drawLineToContext(this.waveCtx,e,a,t,r,n,s);if(this.hasProgressCanvas){this.drawLineToContext(this.progressCtx,e,a,t,r,n,s)}}},{key:"drawLineToContext",value:function(e,a,t,r,n){if(!e){return}var s=a.length/2,o=Math.round(s*this.start),l=Math.round(s*this.end)+1,d=o,u=l,c=this.wave.width/(u-d-1),p=r+n,f=t/r;e.beginPath();e.moveTo((d-o)*c,p);e.lineTo((d-o)*c,p-Math.round((a[2*d]||0)/f));var y,m,v;for(y=d;y<u;y++){m=a[2*y]||0;v=Math.round(m/f);e.lineTo((y-o)*c+this.halfPixel,p-v)}var g=u-1;for(g;g>=d;g--){m=a[2*g+1]||0;v=Math.round(m/f);e.lineTo((g-o)*c+this.halfPixel,p-v)}e.lineTo((d-o)*c,p-Math.round((a[2*d+1]||0)/f));e.closePath();e.fill()}},{key:"destroy",value:function(){this.waveCtx=null;this.wave=null;this.progressCtx=null;this.progress=null}},{key:"getImage",value:function(e,a,t){var r=this;if("blob"===t){return new Promise(function(t){r.wave.toBlob(t,e,a)})}else if("dataURL"===t){return this.wave.toDataURL(e,a)}}}]);return e}();a.default=d;e.exports=a.default;return a.default},"./src/drawer.js":function srcDrawerJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var y=n(t("./src/util/index.js"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;r=function(){return e};return e}function n(e){if(e&&e.__esModule){return e}if(null===e||"object"!==s(e)&&"function"!=typeof e){return{default:e}}var a=r();if(a&&a.has(e)){return a.get(e)}var t={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e){if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;if(i&&(i.get||i.set)){Object.defineProperty(t,o,i)}else{t[o]=e[o]}}}t.default=e;if(a){a.set(e,t)}return t}function s(e){if("function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)){s=function(e){return _typeof2(e)}}else{s=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)}}return s(e)}function o(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function i(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function l(e,a,t){if(a)i(e.prototype,a);if(t)i(e,t);return e}function d(e,a){if(a&&("object"===s(a)||"function"==typeof a)){return a}return u(e)}function u(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function c(e){c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return c(e)}function p(e,a){if("function"!=typeof a&&null!==a){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}});if(a)f(e,a)}function f(e,a){f=Object.setPrototypeOf||function(e,a){e.__proto__=a;return e};return f(e,a)}var m=function(e){p(a,e);function a(e,t){var r;o(this,a);r=d(this,c(a).call(this));r.container=e;r.params=t;r.width=0;r.height=t.height*r.params.pixelRatio;r.lastPos=0;r.wrapper=null;return r}l(a,[{key:"style",value:function(e,a){return y.style(e,a)}},{key:"createWrapper",value:function(){this.wrapper=this.container.appendChild(document.createElement("wave"));this.style(this.wrapper,{display:"block",position:"relative",userSelect:"none",webkitUserSelect:"none",height:this.params.height+"px"});if(this.params.fillParent||this.params.scrollParent){this.style(this.wrapper,{width:"100%",overflowX:this.params.hideScrollbar?"hidden":"auto",overflowY:"hidden"})}this.setupWrapperEvents()}},{key:"handleEvent",value:function(a,e){e||a.preventDefault();var t=a.targetTouches?a.targetTouches[0].clientX:a.clientX,r=this.wrapper.getBoundingClientRect(),n=this.width,s=this.getWidth(),o;if(!this.params.fillParent&&n<s){o=(this.params.rtl?r.right-t:t-r.left)*(this.params.pixelRatio/n)||0;if(1<o){o=1}}else{o=((this.params.rtl?r.right-t:t-r.left)+this.wrapper.scrollLeft)/this.wrapper.scrollWidth||0}return o}},{key:"setupWrapperEvents",value:function(){var a=this;this.wrapper.addEventListener("click",function(t){var e=a.wrapper.offsetHeight-a.wrapper.clientHeight;if(0!=e){var r=a.wrapper.getBoundingClientRect();if(t.clientY>=r.bottom-e){return}}if(a.params.interact){a.fireEvent("click",t,a.handleEvent(t))}});this.wrapper.addEventListener("dblclick",function(t){if(a.params.interact){a.fireEvent("dblclick",t,a.handleEvent(t))}});this.wrapper.addEventListener("scroll",function(t){return a.fireEvent("scroll",t)})}},{key:"drawPeaks",value:function(e,a,t,r){if(!this.setWidth(a)){this.clearWave()}this.params.barWidth?this.drawBars(e,0,t,r):this.drawWave(e,0,t,r)}},{key:"resetScroll",value:function(){if(null!==this.wrapper){this.wrapper.scrollLeft=0}}},{key:"recenter",value:function(e){var a=this.wrapper.scrollWidth*e;this.recenterOnPosition(a,!0)}},{key:"recenterOnPosition",value:function(e,a){var t=this.wrapper.scrollLeft,r=~~(this.wrapper.clientWidth/2),n=this.wrapper.scrollWidth-this.wrapper.clientWidth,s=e-r,o=s-t;if(0==n){return}if(!a&&-r<=o&&o<r){var i=this.params.autoCenterRate;i/=r;i*=n;o=Math.max(-i,Math.min(i,o));s=t+o}s=Math.max(0,Math.min(n,s));if(s!=t){this.wrapper.scrollLeft=s}}},{key:"getScrollX",value:function(){var e=0;if(this.wrapper){var a=this.params.pixelRatio;e=Math.round(this.wrapper.scrollLeft*a);if(this.params.scrollParent){var t=~~(this.wrapper.scrollWidth*a-this.getWidth());e=Math.min(t,Math.max(0,e))}}return e}},{key:"getWidth",value:function(){return Math.round(this.container.clientWidth*this.params.pixelRatio)}},{key:"setWidth",value:function(e){if(this.width==e){return!1}this.width=e;if(this.params.fillParent||this.params.scrollParent){this.style(this.wrapper,{width:""})}else{this.style(this.wrapper,{width:~~(this.width/this.params.pixelRatio)+"px"})}this.updateSize();return!0}},{key:"setHeight",value:function(e){if(e==this.height){return!1}this.height=e;this.style(this.wrapper,{height:~~(this.height/this.params.pixelRatio)+"px"});this.updateSize();return!0}},{key:"progress",value:function(e){var a=1/this.params.pixelRatio,t=Math.round(e*this.width)*a;if(t<this.lastPos||t-this.lastPos>=a){this.lastPos=t;if(this.params.scrollParent&&this.params.autoCenter){var r=~~(this.wrapper.scrollWidth*e);this.recenterOnPosition(r,this.params.autoCenterImmediately)}this.updateProgress(t)}}},{key:"destroy",value:function(){this.unAll();if(this.wrapper){if(this.wrapper.parentNode==this.container){this.container.removeChild(this.wrapper)}this.wrapper=null}}},{key:"updateCursor",value:function(){}},{key:"updateSize",value:function(){}},{key:"drawBars",value:function(){}},{key:"drawWave",value:function(){}},{key:"clearWave",value:function(){}},{key:"updateProgress",value:function(){}}]);return a}(y.Observer);a.default=m;e.exports=a.default},"./src/drawer.multicanvas.js":function srcDrawerMulticanvasJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var m=s(t("./src/drawer.js")),v=n(t("./src/util/index.js")),g=s(t("./src/drawer.canvasentry.js"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;r=function(){return e};return e}function n(e){if(e&&e.__esModule){return e}if(null===e||"object"!==o(e)&&"function"!=typeof e){return{default:e}}var a=r();if(a&&a.has(e)){return a.get(e)}var t={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e){if(Object.prototype.hasOwnProperty.call(e,s)){var i=n?Object.getOwnPropertyDescriptor(e,s):null;if(i&&(i.get||i.set)){Object.defineProperty(t,s,i)}else{t[s]=e[s]}}}t.default=e;if(a){a.set(e,t)}return t}function s(e){return e&&e.__esModule?e:{default:e}}function o(e){if("function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)){o=function(e){return _typeof2(e)}}else{o=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)}}return o(e)}function i(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function l(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function d(e,a,t){if(a)l(e.prototype,a);if(t)l(e,t);return e}function u(e,a){if(a&&("object"===o(a)||"function"==typeof a)){return a}return c(e)}function c(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function p(e){p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return p(e)}function f(e,a){if("function"!=typeof a&&null!==a){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}});if(a)y(e,a)}function y(e,a){y=Object.setPrototypeOf||function(e,a){e.__proto__=a;return e};return y(e,a)}var k=function(e){f(a,e);function a(e,t){var r;i(this,a);r=u(this,p(a).call(this,e,t));r.maxCanvasWidth=t.maxCanvasWidth;r.maxCanvasElementWidth=Math.round(t.maxCanvasWidth/t.pixelRatio);r.hasProgressCanvas=t.waveColor!=t.progressColor;r.halfPixel=.5/t.pixelRatio;r.canvases=[];r.progressWave=null;r.EntryClass=g.default;r.canvasContextAttributes=t.drawingContextAttributes;r.overlap=2*Math.ceil(t.pixelRatio/2);r.barRadius=t.barRadius||0;return r}d(a,[{key:"init",value:function(){this.createWrapper();this.createElements()}},{key:"createElements",value:function(){this.progressWave=this.wrapper.appendChild(this.style(document.createElement("wave"),{position:"absolute",zIndex:3,left:0,top:0,bottom:0,overflow:"hidden",width:"0",display:"none",boxSizing:"border-box",borderRightStyle:"solid",pointerEvents:"none"}));this.addCanvas();this.updateCursor()}},{key:"updateCursor",value:function(){this.style(this.progressWave,{borderRightWidth:this.params.cursorWidth+"px",borderRightColor:this.params.cursorColor})}},{key:"updateSize",value:function(){var e=this,a=Math.round(this.width/this.params.pixelRatio),t=Math.ceil(a/(this.maxCanvasElementWidth+this.overlap));while(this.canvases.length<t){this.addCanvas()}while(this.canvases.length>t){this.removeCanvas()}var r=this.maxCanvasWidth+this.overlap,n=this.canvases.length-1;this.canvases.forEach(function(a,t){if(t==n){r=e.width-e.maxCanvasWidth*n}e.updateDimensions(a,r,e.height);a.clearWave()})}},{key:"addCanvas",value:function(){var e=new this.EntryClass;e.canvasContextAttributes=this.canvasContextAttributes;e.hasProgressCanvas=this.hasProgressCanvas;e.halfPixel=this.halfPixel;var a=this.maxCanvasElementWidth*this.canvases.length;e.initWave(this.wrapper.appendChild(this.style(document.createElement("canvas"),{position:"absolute",zIndex:2,left:a+"px",top:0,bottom:0,height:"100%",pointerEvents:"none"})));if(this.hasProgressCanvas){e.initProgress(this.progressWave.appendChild(this.style(document.createElement("canvas"),{position:"absolute",left:a+"px",top:0,bottom:0,height:"100%"})))}this.canvases.push(e)}},{key:"removeCanvas",value:function(){var e=this.canvases[this.canvases.length-1];e.wave.parentElement.removeChild(e.wave);if(this.hasProgressCanvas){e.progress.parentElement.removeChild(e.progress)}if(e){e.destroy();e=null}this.canvases.pop()}},{key:"updateDimensions",value:function(e,a,t){var r=Math.round(a/this.params.pixelRatio),n=Math.round(this.width/this.params.pixelRatio);e.updateDimensions(r,n,a,t);this.style(this.progressWave,{display:"block"})}},{key:"clearWave",value:function(){var e=this;v.frame(function(){e.canvases.forEach(function(e){return e.clearWave()})})()}},{key:"drawBars",value:function(e,a,t,r){var n=this;return this.prepareDraw(e,a,t,r,function(e){var a=e.absmax,s=e.hasMinVals,o=e.height,l=e.offsetY,d=e.halfH,u=e.peaks;if(void 0===t){return}var c=s?2:1,p=u.length/c,f=n.params.barWidth*n.params.pixelRatio,y=null===n.params.barGap?Math.max(n.params.pixelRatio,~~(f/2)):Math.max(n.params.pixelRatio,n.params.barGap*n.params.pixelRatio),m=p/n.width,v=t;for(v;v<r;v+=f+y){var g=u[Math.floor(v*m*c)]||0,k=Math.round(g/a*d);if(0==k&&n.params.barMinHeight)k=n.params.barMinHeight;n.fillRect(v+n.halfPixel,d-k+l,f+n.halfPixel,2*k,n.barRadius)}})}},{key:"drawWave",value:function(e,a,t,r){var n=this;return this.prepareDraw(e,a,t,r,function(e){var a=e.absmax,s=e.hasMinVals,o=e.height,l=e.offsetY,d=e.halfH,u=e.peaks;if(!s){var c=[],p=u.length,f=0;for(f;f<p;f++){c[2*f]=u[f];c[2*f+1]=-u[f]}u=c}if(void 0!==t){n.drawLine(u,a,d,l,t,r)}n.fillRect(0,d+l-n.halfPixel,n.width,n.halfPixel,n.barRadius)})}},{key:"drawLine",value:function(e,a,t,r,n,s){var o=this;this.canvases.forEach(function(i){o.setFillStyles(i);i.drawLines(e,a,t,r,n,s)})}},{key:"fillRect",value:function(e,a,t,r,n){var s=Math.floor(e/this.maxCanvasWidth),o=Math.min(Math.ceil((e+t)/this.maxCanvasWidth)+1,this.canvases.length),l=s;for(l;l<o;l++){var d=this.canvases[l],u=l*this.maxCanvasWidth,c={x1:Math.max(e,l*this.maxCanvasWidth),y1:a,x2:Math.min(e+t,l*this.maxCanvasWidth+d.wave.width),y2:a+r};if(c.x1<c.x2){this.setFillStyles(d);d.fillRects(c.x1-u,c.y1,c.x2-c.x1,c.y2-c.y1,n)}}}},{key:"prepareDraw",value:function(e,a,t,r,n){var s=this;return v.frame(function(){if(e[0]instanceof Array){var o=e;if(s.params.splitChannels){s.setHeight(o.length*s.params.height*s.params.pixelRatio);return o.forEach(function(e,a){return s.prepareDraw(e,a,t,r,n)})}e=o[0]}var i=1/s.params.barHeight;if(s.params.normalize){var l=v.max(e),d=v.min(e);i=-d>l?-d:l}var u=[].some.call(e,function(e){return 0>e}),c=s.params.height*s.params.pixelRatio;return n({absmax:i,hasMinVals:u,height:c,offsetY:c*a||0,halfH:c/2,peaks:e})})()}},{key:"setFillStyles",value:function(e){e.setFillStyles(this.params.waveColor,this.params.progressColor)}},{key:"getImage",value:function(e,a,t){if("blob"===t){return Promise.all(this.canvases.map(function(r){return r.getImage(e,a,t)}))}else if("dataURL"===t){var r=this.canvases.map(function(r){return r.getImage(e,a,t)});return 1<r.length?r:r[0]}}},{key:"updateProgress",value:function(e){this.style(this.progressWave,{width:e+"px"})}}]);return a}(m.default);a.default=k;e.exports=a.default},"./src/mediaelement-webaudio.js":function srcMediaelementWebaudioJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var y=function(e){return e&&e.__esModule?e:{default:e}}(t("./src/mediaelement.js"));function r(e){if("function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)){r=function(e){return _typeof2(e)}}else{r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)}}return r(e)}function n(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function s(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function o(e,a,t){if(a)s(e.prototype,a);if(t)s(e,t);return e}function i(e,a){if(a&&("object"===r(a)||"function"==typeof a)){return a}return l(e)}function l(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function d(e,a,t){if("undefined"!=typeof Reflect&&Reflect.get){d=Reflect.get}else{d=function(e,a,t){var r=u(e,a);if(!r)return;var n=Object.getOwnPropertyDescriptor(r,a);if(n.get){return n.get.call(t)}return n.value}}return d(e,a,t||e)}function u(e,a){while(!Object.prototype.hasOwnProperty.call(e,a)){e=c(e);if(null===e)break}return e}function c(e){c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return c(e)}function p(e,a){if("function"!=typeof a&&null!==a){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}});if(a)f(e,a)}function f(e,a){f=Object.setPrototypeOf||function(e,a){e.__proto__=a;return e};return f(e,a)}var m=function(e){p(a,e);function a(e){var t;n(this,a);t=i(this,c(a).call(this,e));t.params=e;t.sourceMediaElement=null;return t}o(a,[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate);this.createTimer();this.createVolumeNode();this.createScriptNode();this.createAnalyserNode()}},{key:"_load",value:function(e,t){d(c(a.prototype),"_load",this).call(this,e,t);this.createMediaElementSource(e)}},{key:"createMediaElementSource",value:function(e){this.sourceMediaElement=this.ac.createMediaElementSource(e);this.sourceMediaElement.connect(this.analyser)}}]);return a}(y.default);a.default=m;e.exports=a.default},"./src/mediaelement.js":function srcMediaelementJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var v=function(e){return e&&e.__esModule?e:{default:e}}(t("./src/webaudio.js")),g=n(t("./src/util/index.js"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;r=function(){return e};return e}function n(e){if(e&&e.__esModule){return e}if(null===e||"object"!==s(e)&&"function"!=typeof e){return{default:e}}var a=r();if(a&&a.has(e)){return a.get(e)}var t={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e){if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;if(i&&(i.get||i.set)){Object.defineProperty(t,o,i)}else{t[o]=e[o]}}}t.default=e;if(a){a.set(e,t)}return t}function s(e){if("function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)){s=function(e){return _typeof2(e)}}else{s=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)}}return s(e)}function o(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function i(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function l(e,a,t){if(a)i(e.prototype,a);if(t)i(e,t);return e}function d(e,a){if(a&&("object"===s(a)||"function"==typeof a)){return a}return u(e)}function u(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function c(e,a,t){if("undefined"!=typeof Reflect&&Reflect.get){c=Reflect.get}else{c=function(e,a,t){var r=p(e,a);if(!r)return;var n=Object.getOwnPropertyDescriptor(r,a);if(n.get){return n.get.call(t)}return n.value}}return c(e,a,t||e)}function p(e,a){while(!Object.prototype.hasOwnProperty.call(e,a)){e=f(e);if(null===e)break}return e}function f(e){f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return f(e)}function y(e,a){if("function"!=typeof a&&null!==a){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}});if(a)m(e,a)}function m(e,a){m=Object.setPrototypeOf||function(e,a){e.__proto__=a;return e};return m(e,a)}var k=function(e){y(a,e);function a(e){var t;o(this,a);t=d(this,f(a).call(this,e));t.params=e;t.media={currentTime:0,duration:0,paused:!0,playbackRate:1,play:function(){},pause:function(){},volume:0};t.mediaType=e.mediaType.toLowerCase();t.elementPosition=e.elementPosition;t.peaks=null;t.playbackRate=1;t.volume=1;t.isMuted=!1;t.buffer=null;t.onPlayEnd=null;t.mediaListeners={};return t}l(a,[{key:"init",value:function(){this.setPlaybackRate(this.params.audioRate);this.createTimer()}},{key:"_setupMediaListeners",value:function(){var e=this;this.mediaListeners.error=function(){e.fireEvent("error","Error loading media element")};this.mediaListeners.canplay=function(){e.fireEvent("canplay")};this.mediaListeners.ended=function(){e.fireEvent("finish")};this.mediaListeners.play=function(){e.fireEvent("play")};this.mediaListeners.pause=function(){e.fireEvent("pause")};this.mediaListeners.seeked=function(){e.fireEvent("seek")};this.mediaListeners.volumechange=function(){e.isMuted=e.media.muted;if(e.isMuted){e.volume=0}else{e.volume=e.media.volume}e.fireEvent("volume")};Object.keys(this.mediaListeners).forEach(function(a){e.media.removeEventListener(a,e.mediaListeners[a]);e.media.addEventListener(a,e.mediaListeners[a])})}},{key:"createTimer",value:function(){var e=this;this.on("play",function a(){if(e.isPaused()){return}e.fireEvent("audioprocess",e.getCurrentTime());g.frame(a)()});this.on("pause",function(){e.fireEvent("audioprocess",e.getCurrentTime())})}},{key:"load",value:function(e,a,t,r){var n=document.createElement(this.mediaType);n.controls=this.params.mediaControls;n.autoplay=this.params.autoplay||!1;n.preload=null==r?"auto":r;n.src=e;n.style.width="100%";var s=a.querySelector(this.mediaType);if(s){a.removeChild(s)}a.appendChild(n);this._load(n,t)}},{key:"loadElt",value:function(e,a){e.controls=this.params.mediaControls;e.autoplay=this.params.autoplay||!1;this._load(e,a)}},{key:"_load",value:function(e,a){if(!(e instanceof HTMLMediaElement)||"undefined"==typeof e.addEventListener){throw new Error("media parameter is not a valid media element")}if("function"==typeof e.load){e.load()}this.media=e;this._setupMediaListeners();this.peaks=a;this.onPlayEnd=null;this.buffer=null;this.isMuted=e.muted;this.setPlaybackRate(this.playbackRate);this.setVolume(this.volume)}},{key:"isPaused",value:function(){return!this.media||this.media.paused}},{key:"getDuration",value:function(){if(this.explicitDuration){return this.explicitDuration}var e=(this.buffer||this.media).duration;if(e>=1/0){e=this.media.seekable.end(0)}return e}},{key:"getCurrentTime",value:function(){return this.media&&this.media.currentTime}},{key:"getPlayedPercents",value:function(){return this.getCurrentTime()/this.getDuration()||0}},{key:"getPlaybackRate",value:function(){return this.playbackRate||this.media.playbackRate}},{key:"setPlaybackRate",value:function(e){this.playbackRate=e||1;this.media.playbackRate=this.playbackRate}},{key:"seekTo",value:function(e){if(null!=e){this.media.currentTime=e}this.clearPlayEnd()}},{key:"play",value:function(e,a){this.seekTo(e);var t=this.media.play();a&&this.setPlayEnd(a);return t}},{key:"pause",value:function(){var e;if(this.media){e=this.media.pause()}this.clearPlayEnd();return e}},{key:"setPlayEnd",value:function(e){var a=this;this.clearPlayEnd();this._onPlayEnd=function(t){if(t>=e){a.pause();a.seekTo(e)}};this.on("audioprocess",this._onPlayEnd)}},{key:"clearPlayEnd",value:function(){if(this._onPlayEnd){this.un("audioprocess",this._onPlayEnd);this._onPlayEnd=null}}},{key:"getPeaks",value:function(e,t,r){if(this.buffer){return c(f(a.prototype),"getPeaks",this).call(this,e,t,r)}return this.peaks||[]}},{key:"setSinkId",value:function(e){if(e){if(!this.media.setSinkId){return Promise.reject(new Error("setSinkId is not supported in your browser"))}return this.media.setSinkId(e)}return Promise.reject(new Error("Invalid deviceId: "+e))}},{key:"getVolume",value:function(){return this.volume}},{key:"setVolume",value:function(e){this.volume=e;if(this.media.volume!==this.volume){this.media.volume=this.volume}}},{key:"destroy",value:function(){var e=this;this.pause();this.unAll();this.destroyed=!0;Object.keys(this.mediaListeners).forEach(function(a){if(e.media){e.media.removeEventListener(a,e.mediaListeners[a])}});if(this.params.removeMediaElementOnDestroy&&this.media&&this.media.parentNode){this.media.parentNode.removeChild(this.media)}this.media=null}}]);return a}(v.default);a.default=k;e.exports=a.default},"./src/peakcache.js":function srcPeakcacheJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;function t(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function r(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function n(e,a,t){if(a)r(e.prototype,a);if(t)r(e,t);return e}var s=function(){function e(){t(this,e);this.clearPeakCache()}n(e,[{key:"clearPeakCache",value:function(){this.peakCacheRanges=[];this.peakCacheLength=-1}},{key:"addRangeToPeakCache",value:function(e,a,t){if(e!=this.peakCacheLength){this.clearPeakCache();this.peakCacheLength=e}var r=[],n=0;while(n<this.peakCacheRanges.length&&this.peakCacheRanges[n]<a){n++}if(0==n%2){r.push(a)}while(n<this.peakCacheRanges.length&&this.peakCacheRanges[n]<=t){r.push(this.peakCacheRanges[n]);n++}if(0==n%2){r.push(t)}r=r.filter(function(e,a,t){if(0==a){return e!=t[a+1]}else if(a==t.length-1){return e!=t[a-1]}return e!=t[a-1]&&e!=t[a+1]});this.peakCacheRanges=this.peakCacheRanges.concat(r);this.peakCacheRanges=this.peakCacheRanges.sort(function(e,a){return e-a}).filter(function(e,a,t){if(0==a){return e!=t[a+1]}else if(a==t.length-1){return e!=t[a-1]}return e!=t[a-1]&&e!=t[a+1]});var s=[];for(n=0;n<r.length;n+=2){s.push([r[n],r[n+1]])}return s}},{key:"getCacheRanges",value:function(){var e=[],a;for(a=0;a<this.peakCacheRanges.length;a+=2){e.push([this.peakCacheRanges[a],this.peakCacheRanges[a+1]])}return e}}]);return e}();a.default=s;e.exports=a.default},"./src/util/ajax.js":function srcUtilAjaxJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e){var a=new r.default,t=new XMLHttpRequest,n=!1;t.open(e.method||"GET",e.url,!0);t.responseType=e.responseType||"json";if(e.xhr){if(e.xhr.requestHeaders){e.xhr.requestHeaders.forEach(function(e){t.setRequestHeader(e.key,e.value)})}if(e.xhr.withCredentials){t.withCredentials=!0}}t.addEventListener("progress",function(t){a.fireEvent("progress",t);if(t.lengthComputable&&t.loaded==t.total){n=!0}});t.addEventListener("load",function(r){if(!n){a.fireEvent("progress",r)}a.fireEvent("load",r);if(200==t.status||206==t.status){a.fireEvent("success",t.response,r)}else{a.fireEvent("error",r)}});t.addEventListener("error",function(t){return a.fireEvent("error",t)});t.send();a.xhr=t;return a};var r=function(e){return e&&e.__esModule?e:{default:e}}(t("./src/util/observer.js"));e.exports=a.default},"./src/util/extend.js":function srcUtilExtendJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e){console.warn("util.extend is deprecated; use Object.assign instead");for(var a=arguments.length,t=Array(1<a?a-1:0),r=1;r<a;r++){t[r-1]=arguments[r]}t.forEach(function(a){Object.keys(a).forEach(function(t){e[t]=a[t]})});return e};e.exports=a.default},"./src/util/fetch.js":function srcUtilFetchJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e){if(!e){throw new Error("fetch options missing")}else if(!e.url){throw new Error("fetch url missing")}var a=new o.default,t=new Headers,r=new Request(e.url);a.controller=new AbortController;if(e&&e.requestHeaders){e.requestHeaders.forEach(function(e){t.append(e.key,e.value)})}var n=e.responseType||"json",s={method:e.method||"GET",headers:t,mode:e.mode||"cors",credentials:e.credentials||"same-origin",cache:e.cache||"default",redirect:e.redirect||"follow",referrer:e.referrer||"client",signal:a.controller.signal};fetch(r,s).then(function(e){a.response=e;var t=!0;if(!e.body){t=!1}var r=e.headers.get("content-length");if(null===r){t=!1}if(!t){return e}a.onProgress=function(t){a.fireEvent("progress",t)};return new Response(new ReadableStream(new i(a,r,e)),s)}).then(function(e){var a;if(e.ok){switch(n){case"arraybuffer":return e.arrayBuffer();case"json":return e.json();case"blob":return e.blob();case"text":return e.text();default:a="Unknown responseType: "+n;break;}}if(!a){a="HTTP error status: "+e.status}throw new Error(a)}).then(function(e){a.fireEvent("success",e)}).catch(function(e){a.fireEvent("error",e)});a.fetchRequest=r;return a};var o=function(e){return e&&e.__esModule?e:{default:e}}(t("./src/util/observer.js"));function r(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function n(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function s(e,a,t){if(a)n(e.prototype,a);if(t)n(e,t);return e}var i=function(){function e(a,t,n){r(this,e);this.instance=a;this.instance._reader=n.body.getReader();this.total=parseInt(t,10);this.loaded=0}s(e,[{key:"start",value:function(e){var a=this;(function t(){a.instance._reader.read().then(function(r){var n=r.done,s=r.value;if(n){if(0===a.total){a.instance.onProgress.call(a.instance,{loaded:a.loaded,total:a.total,lengthComputable:!1})}e.close();return}a.loaded+=s.byteLength;a.instance.onProgress.call(a.instance,{loaded:a.loaded,total:a.total,lengthComputable:!(0===a.total)});e.enqueue(s);t()}).catch(function(a){e.error(a)})})()}}]);return e}();e.exports=a.default},"./src/util/frame.js":function srcUtilFrameJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e){return function(){for(var a=arguments.length,t=Array(a),n=0;n<a;n++){t[n]=arguments[n]}return(0,r.default)(function(){return e.apply(void 0,t)})}};var r=function(e){return e&&e.__esModule?e:{default:e}}(t("./src/util/request-animation-frame.js"));e.exports=a.default},"./src/util/get-id.js":function srcUtilGetIdJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e){if(void 0===e){e="wavesurfer_"}return e+Math.random().toString(32).substring(2)};e.exports=a.default},"./src/util/index.js":function srcUtilIndexJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});Object.defineProperty(a,"ajax",{enumerable:!0,get:function(){return n.default}});Object.defineProperty(a,"getId",{enumerable:!0,get:function(){return s.default}});Object.defineProperty(a,"max",{enumerable:!0,get:function(){return o.default}});Object.defineProperty(a,"min",{enumerable:!0,get:function(){return i.default}});Object.defineProperty(a,"Observer",{enumerable:!0,get:function(){return l.default}});Object.defineProperty(a,"extend",{enumerable:!0,get:function(){return d.default}});Object.defineProperty(a,"style",{enumerable:!0,get:function(){return u.default}});Object.defineProperty(a,"requestAnimationFrame",{enumerable:!0,get:function(){return c.default}});Object.defineProperty(a,"frame",{enumerable:!0,get:function(){return p.default}});Object.defineProperty(a,"debounce",{enumerable:!0,get:function(){return f.default}});Object.defineProperty(a,"preventClick",{enumerable:!0,get:function(){return y.default}});Object.defineProperty(a,"fetchFile",{enumerable:!0,get:function(){return m.default}});var n=r(t("./src/util/ajax.js")),s=r(t("./src/util/get-id.js")),o=r(t("./src/util/max.js")),i=r(t("./src/util/min.js")),l=r(t("./src/util/observer.js")),d=r(t("./src/util/extend.js")),u=r(t("./src/util/style.js")),c=r(t("./src/util/request-animation-frame.js")),p=r(t("./src/util/frame.js")),f=r(t("./node_modules/debounce/index.js")),y=r(t("./src/util/prevent-click.js")),m=r(t("./src/util/fetch.js"));function r(e){return e&&e.__esModule?e:{default:e}}},"./src/util/max.js":function srcUtilMaxJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e){var a=-Infinity;Object.keys(e).forEach(function(t){if(e[t]>a){a=e[t]}});return a};e.exports=a.default},"./src/util/min.js":function srcUtilMinJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e){var a=+Infinity;Object.keys(e).forEach(function(t){if(e[t]<a){a=e[t]}});return a};e.exports=a.default},"./src/util/observer.js":function srcUtilObserverJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;function t(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function r(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function n(e,a,t){if(a)r(e.prototype,a);if(t)r(e,t);return e}var s=function(){function e(){t(this,e);this.handlers=null}n(e,[{key:"on",value:function(e,a){var t=this;if(!this.handlers){this.handlers={}}var r=this.handlers[e];if(!r){r=this.handlers[e]=[]}r.push(a);return{name:e,callback:a,un:function(a,e){return t.un(a,e)}}}},{key:"un",value:function(e,a){if(!this.handlers){return}var t=this.handlers[e],r;if(t){if(a){for(r=t.length-1;0<=r;r--){if(t[r]==a){t.splice(r,1)}}}else{t.length=0}}}},{key:"unAll",value:function(){this.handlers=null}},{key:"once",value:function(e,a){var t=this;return this.on(e,function r(){for(var n=arguments.length,s=Array(n),o=0;o<n;o++){s[o]=arguments[o]}a.apply(t,s);setTimeout(function(){t.un(e,r)},0)})}},{key:"fireEvent",value:function(e){for(var a=arguments.length,t=Array(1<a?a-1:0),r=1;r<a;r++){t[r-1]=arguments[r]}if(!this.handlers){return}var n=this.handlers[e];n&&n.forEach(function(e){e.apply(void 0,t)})}}]);return e}();a.default=s;e.exports=a.default},"./src/util/prevent-click.js":function srcUtilPreventClickJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(){document.body.addEventListener("click",t,!0)};function t(e){e.stopPropagation();document.body.removeEventListener("click",t,!0)}e.exports=a.default},"./src/util/request-animation-frame.js":function srcUtilRequestAnimationFrameJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var t=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)}).bind(window);a.default=t;e.exports=a.default},"./src/util/style.js":function srcUtilStyleJs(e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(e,a){Object.keys(a).forEach(function(t){if(e.style[t]!==a[t]){e.style[t]=a[t]}});return e};e.exports=a.default},"./src/wavesurfer.js":function srcWavesurferJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var m=s(t("./src/util/index.js")),v=r(t("./src/drawer.multicanvas.js")),g=r(t("./src/webaudio.js")),k=r(t("./src/mediaelement.js")),h=r(t("./src/peakcache.js")),b=r(t("./src/mediaelement-webaudio.js"));function r(e){return e&&e.__esModule?e:{default:e}}function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;n=function(){return e};return e}function s(e){if(e&&e.__esModule){return e}if(null===e||"object"!==o(e)&&"function"!=typeof e){return{default:e}}var a=n();if(a&&a.has(e)){return a.get(e)}var t={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e){if(Object.prototype.hasOwnProperty.call(e,s)){var i=r?Object.getOwnPropertyDescriptor(e,s):null;if(i&&(i.get||i.set)){Object.defineProperty(t,s,i)}else{t[s]=e[s]}}}t.default=e;if(a){a.set(e,t)}return t}function o(e){if("function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)){o=function(e){return _typeof2(e)}}else{o=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)}}return o(e)}function i(e,a){if(a&&("object"===o(a)||"function"==typeof a)){return a}return d(e)}function l(e){l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return l(e)}function d(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function u(e,a){if("function"!=typeof a&&null!==a){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}});if(a)c(e,a)}function c(e,a){c=Object.setPrototypeOf||function(e,a){e.__proto__=a;return e};return c(e,a)}function p(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function f(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function y(e,a,t){if(a)f(e.prototype,a);if(t)f(e,t);return e}var P=function(){y(e,[{key:"create",value:function(){}}]);function e(){p(this,e)}y(e,[{key:"init",value:function(){}},{key:"destroy",value:function(){}}]);return e}(),w=function(e){u(a,e);y(a,null,[{key:"create",value:function(e){var t=new a(e);return t.init()}}]);function a(e){var t;p(this,a);t=i(this,l(a).call(this));t.defaultParams={audioContext:null,audioScriptProcessor:null,audioRate:1,autoCenter:!0,autoCenterRate:5,autoCenterImmediately:!1,backend:"WebAudio",backgroundColor:null,barHeight:1,barRadius:0,barGap:null,barMinHeight:null,container:null,cursorColor:"#333",cursorWidth:1,dragSelection:!0,drawingContextAttributes:{desynchronized:!1},duration:null,fillParent:!0,forceDecode:!1,height:128,hideScrollbar:!1,interact:!0,loopSelection:!0,maxCanvasWidth:4e3,mediaContainer:null,mediaControls:!1,mediaType:"audio",minPxPerSec:20,normalize:!1,partialRender:!1,pixelRatio:window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,plugins:[],progressColor:"#555",removeMediaElementOnDestroy:!0,renderer:v.default,responsive:!1,rtl:!1,scrollParent:!1,skipLength:2,splitChannels:!1,waveColor:"#999",xhr:{}};t.backends={MediaElement:k.default,WebAudio:g.default,MediaElementWebAudio:b.default};t.util=m;t.params=Object.assign({},t.defaultParams,e);t.container="string"==typeof e.container?document.querySelector(t.params.container):t.params.container;if(!t.container){throw new Error("Container element not found")}if(null==t.params.mediaContainer){t.mediaContainer=t.container}else if("string"==typeof t.params.mediaContainer){t.mediaContainer=document.querySelector(t.params.mediaContainer)}else{t.mediaContainer=t.params.mediaContainer}if(!t.mediaContainer){throw new Error("Media Container element not found")}if(1>=t.params.maxCanvasWidth){throw new Error("maxCanvasWidth must be greater than 1")}else if(1==t.params.maxCanvasWidth%2){throw new Error("maxCanvasWidth must be an even number")}if(!0===t.params.rtl){m.style(t.container,{transform:"rotateY(180deg)"})}if(t.params.backgroundColor){t.setBackgroundColor(t.params.backgroundColor)}t.savedVolume=0;t.isMuted=!1;t.tmpEvents=[];t.currentRequest=null;t.arraybuffer=null;t.drawer=null;t.backend=null;t.peakCache=null;if("function"!=typeof t.params.renderer){throw new Error("Renderer parameter is invalid")}t.Drawer=t.params.renderer;if("AudioElement"==t.params.backend){t.params.backend="MediaElement"}if(("WebAudio"==t.params.backend||"MediaElementWebAudio"===t.params.backend)&&!g.default.prototype.supportsWebAudio.call(null)){t.params.backend="MediaElement"}t.Backend=t.backends[t.params.backend];t.initialisedPluginList={};t.isDestroyed=!1;t.isReady=!1;var r=0;t._onResize=m.debounce(function(){if(r!=t.drawer.wrapper.clientWidth&&!t.params.scrollParent){r=t.drawer.wrapper.clientWidth;t.drawer.fireEvent("redraw")}},"number"==typeof t.params.responsive?t.params.responsive:100);return i(t,d(t))}y(a,[{key:"init",value:function(){this.registerPlugins(this.params.plugins);this.createDrawer();this.createBackend();this.createPeakCache();return this}},{key:"registerPlugins",value:function(e){var a=this;e.forEach(function(e){return a.addPlugin(e)});e.forEach(function(e){if(!e.deferInit){a.initPlugin(e.name)}});this.fireEvent("plugins-registered",e);return this}},{key:"getActivePlugins",value:function(){return this.initialisedPluginList}},{key:"addPlugin",value:function(e){var a=this;if(!e.name){throw new Error("Plugin does not have a name!")}if(!e.instance){throw new Error("Plugin ".concat(e.name," does not have an instance property!"))}if(e.staticProps){Object.keys(e.staticProps).forEach(function(t){a[t]=e.staticProps[t]})}var t=e.instance,r=Object.getOwnPropertyNames(m.Observer.prototype);r.forEach(function(e){t.prototype[e]=m.Observer.prototype[e]});this[e.name]=new t(e.params||{},this);this.fireEvent("plugin-added",e.name);return this}},{key:"initPlugin",value:function(e){if(!this[e]){throw new Error("Plugin ".concat(e," has not been added yet!"))}if(this.initialisedPluginList[e]){this.destroyPlugin(e)}this[e].init();this.initialisedPluginList[e]=!0;this.fireEvent("plugin-initialised",e);return this}},{key:"destroyPlugin",value:function(e){if(!this[e]){throw new Error("Plugin ".concat(e," has not been added yet and cannot be destroyed!"))}if(!this.initialisedPluginList[e]){throw new Error("Plugin ".concat(e," is not active and cannot be destroyed!"))}if("function"!=typeof this[e].destroy){throw new Error("Plugin ".concat(e," does not have a destroy function!"))}this[e].destroy();delete this.initialisedPluginList[e];this.fireEvent("plugin-destroyed",e);return this}},{key:"destroyAllPlugins",value:function(){var e=this;Object.keys(this.initialisedPluginList).forEach(function(a){return e.destroyPlugin(a)})}},{key:"createDrawer",value:function(){var a=this;this.drawer=new this.Drawer(this.container,this.params);this.drawer.init();this.fireEvent("drawer-created",this.drawer);if(!1!==this.params.responsive){window.addEventListener("resize",this._onResize,!0);window.addEventListener("orientationchange",this._onResize,!0)}this.drawer.on("redraw",function(){a.drawBuffer();a.drawer.progress(a.backend.getPlayedPercents())});this.drawer.on("click",function(t,e){setTimeout(function(){return a.seekTo(e)},0)});this.drawer.on("scroll",function(t){if(a.params.partialRender){a.drawBuffer()}a.fireEvent("scroll",t)})}},{key:"createBackend",value:function(){var e=this;if(this.backend){this.backend.destroy()}this.backend=new this.Backend(this.params);this.backend.init();this.fireEvent("backend-created",this.backend);this.backend.on("finish",function(){e.drawer.progress(e.backend.getPlayedPercents());e.fireEvent("finish")});this.backend.on("play",function(){return e.fireEvent("play")});this.backend.on("pause",function(){return e.fireEvent("pause")});this.backend.on("audioprocess",function(a){e.drawer.progress(e.backend.getPlayedPercents());e.fireEvent("audioprocess",a)});if("MediaElement"===this.params.backend||"MediaElementWebAudio"===this.params.backend){this.backend.on("seek",function(){e.drawer.progress(e.backend.getPlayedPercents())});this.backend.on("volume",function(){var a=e.getVolume();e.fireEvent("volume",a);if(e.backend.isMuted!==e.isMuted){e.isMuted=e.backend.isMuted;e.fireEvent("mute",e.isMuted)}})}}},{key:"createPeakCache",value:function(){if(this.params.partialRender){this.peakCache=new h.default}}},{key:"getDuration",value:function(){return this.backend.getDuration()}},{key:"getCurrentTime",value:function(){return this.backend.getCurrentTime()}},{key:"setCurrentTime",value:function(e){if(e>=this.getDuration()){this.seekTo(1)}else{this.seekTo(e/this.getDuration())}}},{key:"play",value:function(e,a){var t=this;this.fireEvent("interaction",function(){return t.play(e,a)});return this.backend.play(e,a)}},{key:"setPlayEnd",value:function(e){this.backend.setPlayEnd(e)}},{key:"pause",value:function(){if(!this.backend.isPaused()){return this.backend.pause()}}},{key:"playPause",value:function(){return this.backend.isPaused()?this.play():this.pause()}},{key:"isPlaying",value:function(){return!this.backend.isPaused()}},{key:"skipBackward",value:function(e){this.skip(-e||-this.params.skipLength)}},{key:"skipForward",value:function(e){this.skip(e||this.params.skipLength)}},{key:"skip",value:function(e){var a=this.getDuration()||1,t=this.getCurrentTime()||0;t=Math.max(0,Math.min(a,t+(e||0)));this.seekAndCenter(t/a)}},{key:"seekAndCenter",value:function(e){this.seekTo(e);this.drawer.recenter(e)}},{key:"seekTo",value:function(e){var a=this;if("number"!=typeof e||!isFinite(e)||0>e||1<e){throw new Error("Error calling wavesurfer.seekTo, parameter must be a number between 0 and 1!")}this.fireEvent("interaction",function(){return a.seekTo(e)});var t=this.backend.isPaused();if(!t){this.backend.pause()}var r=this.params.scrollParent;this.params.scrollParent=!1;this.backend.seekTo(e*this.getDuration());this.drawer.progress(e);if(!t){this.backend.play()}this.params.scrollParent=r;this.fireEvent("seek",e)}},{key:"stop",value:function(){this.pause();this.seekTo(0);this.drawer.progress(0)}},{key:"setSinkId",value:function(e){return this.backend.setSinkId(e)}},{key:"setVolume",value:function(e){this.backend.setVolume(e);this.fireEvent("volume",e)}},{key:"getVolume",value:function(){return this.backend.getVolume()}},{key:"setPlaybackRate",value:function(e){this.backend.setPlaybackRate(e)}},{key:"getPlaybackRate",value:function(){return this.backend.getPlaybackRate()}},{key:"toggleMute",value:function(){this.setMute(!this.isMuted)}},{key:"setMute",value:function(e){if(e===this.isMuted){this.fireEvent("mute",this.isMuted);return}if(e){this.savedVolume=this.backend.getVolume();this.backend.setVolume(0);this.isMuted=!0;this.fireEvent("volume",0)}else{this.backend.setVolume(this.savedVolume);this.isMuted=!1;this.fireEvent("volume",this.savedVolume)}this.fireEvent("mute",this.isMuted)}},{key:"getMute",value:function(){return this.isMuted}},{key:"getFilters",value:function(){return this.backend.filters||[]}},{key:"toggleScroll",value:function(){this.params.scrollParent=!this.params.scrollParent;this.drawBuffer()}},{key:"toggleInteraction",value:function(){this.params.interact=!this.params.interact}},{key:"getWaveColor",value:function(){return this.params.waveColor}},{key:"setWaveColor",value:function(e){this.params.waveColor=e;this.drawBuffer()}},{key:"getProgressColor",value:function(){return this.params.progressColor}},{key:"setProgressColor",value:function(e){this.params.progressColor=e;this.drawBuffer()}},{key:"getBackgroundColor",value:function(){return this.params.backgroundColor}},{key:"setBackgroundColor",value:function(e){this.params.backgroundColor=e;m.style(this.container,{background:this.params.backgroundColor})}},{key:"getCursorColor",value:function(){return this.params.cursorColor}},{key:"setCursorColor",value:function(e){this.params.cursorColor=e;this.drawer.updateCursor()}},{key:"getHeight",value:function(){return this.params.height}},{key:"setHeight",value:function(e){this.params.height=e;this.drawer.setHeight(e*this.params.pixelRatio);this.drawBuffer()}},{key:"drawBuffer",value:function(){var e=Math.round(this.getDuration()*this.params.minPxPerSec*this.params.pixelRatio),a=this.drawer.getWidth(),t=e,r=0,n=Math.max(r+a,t);if(this.params.fillParent&&(!this.params.scrollParent||e<a)){t=a;r=0;n=t}var s;if(this.params.partialRender){var o=this.peakCache.addRangeToPeakCache(t,r,n),l;for(l=0;l<o.length;l++){s=this.backend.getPeaks(t,o[l][0],o[l][1]);this.drawer.drawPeaks(s,t,o[l][0],o[l][1])}}else{s=this.backend.getPeaks(t,r,n);this.drawer.drawPeaks(s,t,r,n)}this.fireEvent("redraw",s,t)}},{key:"zoom",value:function(e){if(!e){this.params.minPxPerSec=this.defaultParams.minPxPerSec;this.params.scrollParent=!1}else{this.params.minPxPerSec=e;this.params.scrollParent=!0}this.drawBuffer();this.drawer.progress(this.backend.getPlayedPercents());this.drawer.recenter(this.getCurrentTime()/this.getDuration());this.fireEvent("zoom",e)}},{key:"loadArrayBuffer",value:function(e){var a=this;this.decodeArrayBuffer(e,function(e){if(!a.isDestroyed){a.loadDecodedBuffer(e)}})}},{key:"loadDecodedBuffer",value:function(e){this.backend.load(e);this.drawBuffer();this.isReady=!0;this.fireEvent("ready")}},{key:"loadBlob",value:function(e){var a=this,t=new FileReader;t.addEventListener("progress",function(t){return a.onProgress(t)});t.addEventListener("load",function(t){return a.loadArrayBuffer(t.target.result)});t.addEventListener("error",function(){return a.fireEvent("error","Error reading file")});t.readAsArrayBuffer(e);this.empty()}},{key:"load",value:function(e,a,t,r){if(!e){throw new Error("url parameter cannot be empty")}this.empty();if(t){var n={"Preload is not 'auto', 'none' or 'metadata'":-1===["auto","metadata","none"].indexOf(t),"Peaks are not provided":!a,"Backend is not of type 'MediaElement' or 'MediaElementWebAudio'":-1===["MediaElement","MediaElementWebAudio"].indexOf(this.params.backend),"Url is not of type string":"string"!=typeof e},s=Object.keys(n).filter(function(e){return n[e]});if(s.length){console.warn("Preload parameter of wavesurfer.load will be ignored because:\n\t- "+s.join("\n\t- "));t=null}}switch(this.params.backend){case"WebAudio":return this.loadBuffer(e,a,r);case"MediaElement":case"MediaElementWebAudio":return this.loadMediaElement(e,a,t,r);}}},{key:"loadBuffer",value:function(e,a,t){var r=this,n=function(a){if(a){r.tmpEvents.push(r.once("ready",a))}return r.getArrayBuffer(e,function(e){return r.loadArrayBuffer(e)})};if(a){this.backend.setPeaks(a,t);this.drawBuffer();this.tmpEvents.push(this.once("interaction",n))}else{return n()}}},{key:"loadMediaElement",value:function(e,a,t,r){var n=this,s=e;if("string"==typeof e){this.backend.load(s,this.mediaContainer,a,t)}else{var o=e;this.backend.loadElt(o,a);s=o.src}this.tmpEvents.push(this.backend.once("canplay",function(){if(!n.backend.destroyed){n.drawBuffer();n.isReady=!0;n.fireEvent("ready")}}),this.backend.once("error",function(e){return n.fireEvent("error",e)}));if(a){this.backend.setPeaks(a,r)}if((!a||this.params.forceDecode)&&this.backend.supportsWebAudio()){this.getArrayBuffer(s,function(e){n.decodeArrayBuffer(e,function(e){n.backend.buffer=e;n.backend.setPeaks(null);n.drawBuffer();n.fireEvent("waveform-ready")})})}}},{key:"decodeArrayBuffer",value:function(e,a){var t=this;this.arraybuffer=e;this.backend.decodeArrayBuffer(e,function(r){if(!t.isDestroyed&&t.arraybuffer==e){a(r);t.arraybuffer=null}},function(){return t.fireEvent("error","Error decoding audiobuffer")})}},{key:"getArrayBuffer",value:function(e,a){var t=this,r=Object.assign({url:e,responseType:"arraybuffer"},this.params.xhr),n=m.fetchFile(r);this.currentRequest=n;this.tmpEvents.push(n.on("progress",function(a){t.onProgress(a)}),n.on("success",function(e){a(e);t.currentRequest=null}),n.on("error",function(a){t.fireEvent("error",a);t.currentRequest=null}));return n}},{key:"onProgress",value:function(a){var e;if(a.lengthComputable){e=a.loaded/a.total}else{e=a.loaded/(a.loaded+1e6)}this.fireEvent("loading",Math.round(100*e),a.target)}},{key:"exportPCM",value:function(e,a,t,r,n){e=e||1024;r=r||0;a=a||1e4;t=t||!1;var s=this.backend.getPeaks(e,r,n),o=[].map.call(s,function(e){return Math.round(e*a)/a});return new Promise(function(e){var a=JSON.stringify(o);if(!t){window.open("data:application/json;charset=utf-8,"+encodeURIComponent(a))}e(a)})}},{key:"exportImage",value:function(e,a,t){if(!e){e="image/png"}if(!a){a=1}if(!t){t="dataURL"}return this.drawer.getImage(e,a,t)}},{key:"cancelAjax",value:function(){if(this.currentRequest&&this.currentRequest.controller){this.currentRequest.controller.abort();this.currentRequest=null}}},{key:"clearTmpEvents",value:function(){this.tmpEvents.forEach(function(a){return a.un()})}},{key:"empty",value:function(){if(!this.backend.isPaused()){this.stop();this.backend.disconnectSource()}this.isReady=!1;this.cancelAjax();this.clearTmpEvents();this.drawer.progress(0);this.drawer.setWidth(0);this.drawer.drawPeaks({length:this.drawer.getWidth()},0)}},{key:"destroy",value:function(){this.destroyAllPlugins();this.fireEvent("destroy");this.cancelAjax();this.clearTmpEvents();this.unAll();if(!1!==this.params.responsive){window.removeEventListener("resize",this._onResize,!0);window.removeEventListener("orientationchange",this._onResize,!0)}if(this.backend){this.backend.destroy()}if(this.drawer){this.drawer.destroy()}this.isDestroyed=!0;this.isReady=!1;this.arraybuffer=null}}]);return a}(m.Observer);a.default=w;w.VERSION="3.3.3";w.util=m;e.exports=a.default},"./src/webaudio.js":function srcWebaudioJs(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;var m=n(t("./src/util/index.js"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;r=function(){return e};return e}function n(e){if(e&&e.__esModule){return e}if(null===e||"object"!==s(e)&&"function"!=typeof e){return{default:e}}var a=r();if(a&&a.has(e)){return a.get(e)}var t={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e){if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;if(i&&(i.get||i.set)){Object.defineProperty(t,o,i)}else{t[o]=e[o]}}}t.default=e;if(a){a.set(e,t)}return t}function s(e){if("function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)){s=function(e){return _typeof2(e)}}else{s=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)}}return s(e)}function o(e,a,t){if(a in e){Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0})}else{e[a]=t}return e}function i(e,a){if(!(e instanceof a)){throw new TypeError("Cannot call a class as a function")}}function l(e,a){if(a&&("object"===s(a)||"function"==typeof a)){return a}return d(e)}function d(e){if(void 0===e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function u(e){u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return u(e)}function c(e,a){for(var t=0,r;t<a.length;t++){r=a[t];r.enumerable=r.enumerable||!1;r.configurable=!0;if("value"in r)r.writable=!0;Object.defineProperty(e,r.key,r)}}function p(e,a,t){if(a)c(e.prototype,a);if(t)c(e,t);return e}function f(e,a){if("function"!=typeof a&&null!==a){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}});if(a)y(e,a)}function y(e,a){y=Object.setPrototypeOf||function(e,a){e.__proto__=a;return e};return y(e,a)}var v=function(e){f(a,e);p(a,[{key:"supportsWebAudio",value:function(){return!!(window.AudioContext||window.webkitAudioContext)}},{key:"getAudioContext",value:function(){if(!window.WaveSurferAudioContext){window.WaveSurferAudioContext=new(window.AudioContext||window.webkitAudioContext)}return window.WaveSurferAudioContext}},{key:"getOfflineAudioContext",value:function(e){if(!window.WaveSurferOfflineAudioContext){window.WaveSurferOfflineAudioContext=new(window.OfflineAudioContext||window.webkitOfflineAudioContext)(1,2,e)}return window.WaveSurferOfflineAudioContext}}]);function a(e){var t,r,n;i(this,a);n=l(this,u(a).call(this));n.audioContext=null;n.offlineAudioContext=null;n.stateBehaviors=(t={},o(t,"playing",{init:function(){this.addOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition+this.getPlayedTime()}}),o(t,"paused",{init:function(){this.removeOnAudioProcess()},getPlayedPercents:function(){var e=this.getDuration();return this.getCurrentTime()/e||0},getCurrentTime:function(){return this.startPosition}}),o(t,"finished",{init:function(){this.removeOnAudioProcess();this.fireEvent("finish")},getPlayedPercents:function(){return 1},getCurrentTime:function(){return this.getDuration()}}),t);n.params=e;n.ac=e.audioContext||(n.supportsWebAudio()?n.getAudioContext():{});n.lastPlay=n.ac.currentTime;n.startPosition=0;n.scheduledPause=null;n.states=(r={},o(r,"playing",Object.create(n.stateBehaviors.playing)),o(r,"paused",Object.create(n.stateBehaviors.paused)),o(r,"finished",Object.create(n.stateBehaviors.finished)),r);n.buffer=null;n.filters=[];n.gainNode=null;n.mergedPeaks=null;n.offlineAc=null;n.peaks=null;n.playbackRate=1;n.analyser=null;n.scriptNode=null;n.source=null;n.splitPeaks=[];n.state=null;n.explicitDuration=e.duration;n.destroyed=!1;return n}p(a,[{key:"init",value:function(){this.createVolumeNode();this.createScriptNode();this.createAnalyserNode();this.setState("paused");this.setPlaybackRate(this.params.audioRate);this.setLength(0)}},{key:"disconnectFilters",value:function(){if(this.filters){this.filters.forEach(function(e){e&&e.disconnect()});this.filters=null;this.analyser.connect(this.gainNode)}}},{key:"setState",value:function(e){if(this.state!==this.states[e]){this.state=this.states[e];this.state.init.call(this)}}},{key:"setFilter",value:function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++){a[t]=arguments[t]}this.setFilters(a)}},{key:"setFilters",value:function(e){this.disconnectFilters();if(e&&e.length){this.filters=e;this.analyser.disconnect();e.reduce(function(e,a){e.connect(a);return a},this.analyser).connect(this.gainNode)}}},{key:"createScriptNode",value:function(){if(this.params.audioScriptProcessor){this.scriptNode=this.params.audioScriptProcessor}else{if(this.ac.createScriptProcessor){this.scriptNode=this.ac.createScriptProcessor(a.scriptBufferSize)}else{this.scriptNode=this.ac.createJavaScriptNode(a.scriptBufferSize)}}this.scriptNode.connect(this.ac.destination)}},{key:"addOnAudioProcess",value:function(){var e=this;this.scriptNode.onaudioprocess=function(){var a=e.getCurrentTime();if(a>=e.getDuration()){e.setState("finished");e.fireEvent("pause")}else if(a>=e.scheduledPause){e.pause()}else if(e.state===e.states.playing){e.fireEvent("audioprocess",a)}}}},{key:"removeOnAudioProcess",value:function(){this.scriptNode.onaudioprocess=function(){}}},{key:"createAnalyserNode",value:function(){this.analyser=this.ac.createAnalyser();this.analyser.connect(this.gainNode)}},{key:"createVolumeNode",value:function(){if(this.ac.createGain){this.gainNode=this.ac.createGain()}else{this.gainNode=this.ac.createGainNode()}this.gainNode.connect(this.ac.destination)}},{key:"setSinkId",value:function(e){if(e){var a=new window.Audio;if(!a.setSinkId){return Promise.reject(new Error("setSinkId is not supported in your browser"))}a.autoplay=!0;var t=this.ac.createMediaStreamDestination();this.gainNode.disconnect();this.gainNode.connect(t);a.srcObject=t.stream;return a.setSinkId(e)}else{return Promise.reject(new Error("Invalid deviceId: "+e))}}},{key:"setVolume",value:function(e){this.gainNode.gain.setValueAtTime(e,this.ac.currentTime)}},{key:"getVolume",value:function(){return this.gainNode.gain.value}},{key:"decodeArrayBuffer",value:function(e,a,t){if(!this.offlineAc){this.offlineAc=this.getOfflineAudioContext(this.ac&&this.ac.sampleRate?this.ac.sampleRate:44100)}this.offlineAc.decodeAudioData(e,function(e){return a(e)},t)}},{key:"setPeaks",value:function(e,a){if(null!=a){this.explicitDuration=a}this.peaks=e}},{key:"setLength",value:function(e){if(this.mergedPeaks&&e==2*this.mergedPeaks.length-1+2){return}this.splitPeaks=[];this.mergedPeaks=[];var a=this.buffer?this.buffer.numberOfChannels:1,t;for(t=0;t<a;t++){this.splitPeaks[t]=[];this.splitPeaks[t][2*(e-1)]=0;this.splitPeaks[t][2*(e-1)+1]=0}this.mergedPeaks[2*(e-1)]=0;this.mergedPeaks[2*(e-1)+1]=0}},{key:"getPeaks",value:function(e,a,t){if(this.peaks){return this.peaks}if(!this.buffer){return[]}a=a||0;t=t||e-1;this.setLength(e);if(!this.buffer){return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}if(!this.buffer.length){var r=this.createBuffer(1,4096,this.sampleRate);this.buffer=r.buffer}var n=this.buffer.length/e,s=this.buffer.numberOfChannels,o;for(o=0;o<s;o++){var l=this.splitPeaks[o],d=this.buffer.getChannelData(o),u=void 0;for(u=a;u<=t;u++){var p=~~(u*n),f=0,y=0,m=void 0;for(m=p;m<~~(p+n);m+=~~(n/10)||1){var v=d[m];if(v>y){y=v}if(v<f){f=v}}l[2*u]=y;l[2*u+1]=f;if(0==o||y>this.mergedPeaks[2*u]){this.mergedPeaks[2*u]=y}if(0==o||f<this.mergedPeaks[2*u+1]){this.mergedPeaks[2*u+1]=f}}}return this.params.splitChannels?this.splitPeaks:this.mergedPeaks}},{key:"getPlayedPercents",value:function(){return this.state.getPlayedPercents.call(this)}},{key:"disconnectSource",value:function(){if(this.source){this.source.disconnect()}}},{key:"destroy",value:function(){if(!this.isPaused()){this.pause()}this.unAll();this.buffer=null;this.destroyed=!0;this.disconnectFilters();this.disconnectSource();this.gainNode.disconnect();this.scriptNode.disconnect();this.analyser.disconnect();if(this.params.closeAudioContext){if("function"==typeof this.ac.close&&"closed"!=this.ac.state){this.ac.close()}this.ac=null;if(!this.params.audioContext){window.WaveSurferAudioContext=null}else{this.params.audioContext=null}window.WaveSurferOfflineAudioContext=null}}},{key:"load",value:function(e){this.startPosition=0;this.lastPlay=this.ac.currentTime;this.buffer=e;this.createSource()}},{key:"createSource",value:function(){this.disconnectSource();this.source=this.ac.createBufferSource();this.source.start=this.source.start||this.source.noteGrainOn;this.source.stop=this.source.stop||this.source.noteOff;this.source.playbackRate.setValueAtTime(this.playbackRate,this.ac.currentTime);this.source.buffer=this.buffer;this.source.connect(this.analyser)}},{key:"isPaused",value:function(){return this.state!==this.states.playing}},{key:"getDuration",value:function(){if(this.explicitDuration){return this.explicitDuration}if(!this.buffer){return 0}return this.buffer.duration}},{key:"seekTo",value:function(e,a){if(!this.buffer){return}this.scheduledPause=null;if(null==e){e=this.getCurrentTime();if(e>=this.getDuration()){e=0}}if(null==a){a=this.getDuration()}this.startPosition=e;this.lastPlay=this.ac.currentTime;if(this.state===this.states.finished){this.setState("paused")}return{start:e,end:a}}},{key:"getPlayedTime",value:function(){return(this.ac.currentTime-this.lastPlay)*this.playbackRate}},{key:"play",value:function(e,a){if(!this.buffer){return}this.createSource();var t=this.seekTo(e,a);e=t.start;a=t.end;this.scheduledPause=a;this.source.start(0,e);if("suspended"==this.ac.state){this.ac.resume&&this.ac.resume()}this.setState("playing");this.fireEvent("play")}},{key:"pause",value:function(){this.scheduledPause=null;this.startPosition+=this.getPlayedTime();this.source&&this.source.stop(0);this.setState("paused");this.fireEvent("pause")}},{key:"getCurrentTime",value:function(){return this.state.getCurrentTime.call(this)}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"setPlaybackRate",value:function(e){e=e||1;if(this.isPaused()){this.playbackRate=e}else{this.pause();this.playbackRate=e;this.play()}}},{key:"setPlayEnd",value:function(e){this.scheduledPause=e}}]);return a}(m.Observer);a.default=v;v.scriptBufferSize=256;e.exports=a.default}})});
//# sourceMappingURL=wavesurfer.min.js.map

define ("format_flexsections/format",["jquery","core/ajax","core/templates","core/notification","core/str"],function(a,b,c,d,f){var g=function(b,c){b.preventDefault();var e=a(b.currentTarget).attr("href");f.get_strings([{key:"confirm",component:"moodle"},{key:c,component:"format_flexsections"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location.href=e+"&confirm=1"})}).fail(d.exception)};return{init:function init(){a("body").on("click","li.section > .controls > a[data-action=\"delete\"]",function(a){g(a,"confirmdelete")});a("body").on("click","li.section > .controls > a[data-action=\"mergeup\"]",function(a){g(a,"confirmmerge")})}}});
//# sourceMappingURL=format.min.js.map

/**
 * Grid Format
 *
 * @package    course/format
 * @subpackage grid
 * @version    See the value of '$plugin->version' in version.php.
 * @copyright  2016 Gareth J Barnard
 * @author     G J Barnard - {@link http://about.me/gjbarnard} and
 *                           {@link http://moodle.org/user/profile.php?id=442195}
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @license    Chartist is MIT licenced: https://raw.githubusercontent.com/gionkunz/chartist-js/master/LICENSE-MIT
 */
/* jshint ignore:start */
define('format_grid/tooltip', ["jquery","core/log"],function(a,b){"use strict";// jshint ;_;
/* ========================================================================
     * Bootstrap: transition.js v3.3.7
     * http://getbootstrap.com/javascript/#transitions
     * ========================================================================
     * Copyright 2011-2016 Twitter, Inc.
     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
     * ======================================================================== */
// CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
// ============================================================
function c(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}
// TOOLTIP PLUGIN DEFINITION
// =========================
function d(b){return this.each(function(){var c=a(this),d=c.data("bs.gridtooltip"),f="object"==typeof b&&b;!d&&/destroy|hide/.test(b)||(d||c.data("bs.gridtooltip",d=new e(this,f)),"string"==typeof b&&d[b]())})}
// http://blog.alexmaccaw.com/css-transitions
a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one("bsTransitionEnd",function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=c(),a.support.transition&&(a.event.special.bsTransitionEnd={bindType:a.support.transition.end,delegateType:a.support.transition.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}})});/* ========================================================================
     * Bootstrap: tooltip.js v3.3.7
     * http://getbootstrap.com/javascript/#tooltip
     * Inspired by the original jQuery.tipsy by Jason Frame
     * ========================================================================
     * Copyright 2011-2016 Twitter, Inc.
     * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
     * ======================================================================== */
// TOOLTIP PUBLIC CLASS DEFINITION
// ===============================
var e=function(a,b){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("gridtooltip",a,b)};e.VERSION="3.3.7",e.TRANSITION_DURATION=150,e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},e.prototype.init=function(b,c,d){if(this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.$viewport=this.options.viewport&&a(a.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},e.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},e.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusin"==b.type?"focus":"hover"]=!0),c.tip().hasClass("in")||"in"==c.hoverState?void(c.hoverState="in"):(clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show())},e.prototype.isInStateTrue=function(){for(var a in this.inState)if(this.inState[a])return!0;return!1},e.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data("bs."+this.type);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c)),b instanceof a.Event&&(c.inState["focusout"==b.type?"focus":"hover"]=!1),!c.isInStateTrue())return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},e.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(b);var c=a.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(b.isDefaultPrevented()||!c)return;var d=this,f=this.tip(),g=this.getUID(this.type);this.setContent(),f.attr("id",g),this.$element.attr("aria-describedby",g),this.options.animation&&f.addClass("fade");var h="function"==typeof this.options.placement?this.options.placement.call(this,f[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,j=i.test(h);j&&(h=h.replace(i,"")||"top");var k={top:0,left:0,display:"block"};f.detach().css(k).addClass(h).data("bs."+this.type,this),this.options.container?f.appendTo(this.options.container):f.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var l=this.getPosition(),m=f[0].offsetWidth,n=f[0].offsetHeight;if(j){var o=h,p=this.getPosition(this.$viewport);h="bottom"==h&&l.bottom+n>p.bottom?"top":"top"==h&&l.top-n<p.top?"bottom":"right"==h&&l.right+m>p.width?"left":"left"==h&&l.left-m<p.left?"right":h,f.removeClass(o).addClass(h)}var q=this.getCalculatedOffset(h,l,m,n);this.applyPlacement(q,h);var r=function(){var a=d.hoverState;d.$element.trigger("shown.bs."+d.type),d.hoverState=null,"out"==a&&d.leave(d)};a.support.transition&&this.$tip.hasClass("fade")?f.one("bsTransitionEnd",r).emulateTransitionEnd(e.TRANSITION_DURATION):r()}},e.prototype.applyPlacement=function(b,c){var d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);
// we must check for NaN for ie 8/9
isNaN(g)&&(g=0),isNaN(h)&&(h=0),b.top+=g,b.left+=h,
// $.fn.offset doesn't round pixel values
// so we use setOffset directly with our own function B-0
a.offset.setOffset(d[0],a.extend({using:function(a){d.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),d.addClass("in");
// check to see if placing tip in new offset caused the tip to resize itself
var i=d[0].offsetWidth,j=d[0].offsetHeight;"top"==c&&j!=f&&(b.top=b.top+f-j);var k=this.getViewportAdjustedDelta(c,b,i,j);k.left?b.left+=k.left:b.top+=k.top;var l=/top|bottom/.test(c),m=l?2*k.left-e+i:2*k.top-f+j,n=l?"offsetWidth":"offsetHeight";d.offset(b),this.replaceArrow(m,d[0][n],l)},e.prototype.replaceArrow=function(a,b,c){this.arrow().css(c?"left":"top",50*(1-a/b)+"%").css(c?"top":"left","")},e.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},e.prototype.hide=function(b){function c(){"in"!=d.hoverState&&f.detach(),d.$element&&// TODO: Check whether guarding this code with this `if` is really necessary.
d.$element.removeAttr("aria-describedby").trigger("hidden.bs."+d.type),b&&b()}var d=this,f=a(this.$tip),g=a.Event("hide.bs."+this.type);if(this.$element.trigger(g),!g.isDefaultPrevented())return f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one("bsTransitionEnd",c).emulateTransitionEnd(e.TRANSITION_DURATION):c(),this.hoverState=null,this},e.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(b){b=b||this.$element;var c=b[0],d="BODY"==c.tagName,e=c.getBoundingClientRect();null==e.width&&(
// width and height are missing in IE8, so compute them manually; see https://github.com/twbs/bootstrap/issues/14093
e=a.extend({},e,{width:e.right-e.left,height:e.bottom-e.top}));var f=window.SVGElement&&c instanceof window.SVGElement,g=d?{top:0,left:0}:f?null:b.offset(),h={scroll:d?document.documentElement.scrollTop||document.body.scrollTop:b.scrollTop()},i=d?{width:a(window).width(),height:a(window).height()}:null;return a.extend({},e,h,i,g)},e.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},e.prototype.getViewportAdjustedDelta=function(a,b,c,d){var e={top:0,left:0};if(!this.$viewport)return e;var f=this.options.viewport&&this.options.viewport.padding||0,g=this.getPosition(this.$viewport);if(/right|left/.test(a)){var h=b.top-f-g.scroll,i=b.top+f-g.scroll+d;h<g.top?// top overflow
e.top=g.top-h:i>g.top+g.height&&(// bottom overflow
e.top=g.top+g.height-i)}else{var j=b.left-f,k=b.left+f+c;j<g.left?// left overflow
e.left=g.left-j:k>g.right&&(// right overflow
e.left=g.left+g.width-k)}return e},e.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},e.prototype.getUID=function(a){do a+=~~(1e6*Math.random());while(document.getElementById(a));return a},e.prototype.tip=function(){if(!this.$tip&&(this.$tip=a(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(b){var c=this;b&&(c=a(b.currentTarget).data("bs."+this.type),c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data("bs."+this.type,c))),b?(c.inState.click=!c.inState.click,c.isInStateTrue()?c.enter(c):c.leave(c)):c.tip().hasClass("in")?c.leave(c):c.enter(c)},e.prototype.destroy=function(){var a=this;clearTimeout(this.timeout),this.hide(function(){a.$element.off("."+a.type).removeData("bs."+a.type),a.$tip&&a.$tip.detach(),a.$tip=null,a.$arrow=null,a.$viewport=null,a.$element=null})};var f=a.fn.gridtooltip;
// TOOLTIP NO CONFLICT
// ===================
return a.fn.gridtooltip=d,a.fn.gridtooltip.Constructor=e,a.fn.gridtooltip.noConflict=function(){return a.fn.gridtooltip=f,this},b.debug("Grid Format AMD"),{init:function(){a(document).ready(function(a){a("[data-toggle=gridtooltip]").gridtooltip()}),b.debug("Grid Format AMD init")}}});
define('report_competency/user_course_navigation', ["jquery"],function(a){var b=function(b,c,d,e){this._baseUrl=c,this._userId=d+"",this._courseId=e,a(b).on("change",this._userChanged.bind(this))};return b.prototype._userChanged=function(b){M.util.js_pending("report_competency/user_course_navigation:_userChanged");var c=a(b.target).val(),d="?user="+c+"&id="+this._courseId;document.location=this._baseUrl+d},b.prototype._userId=null,b.prototype._courseId=null,b.prototype._baseUrl=null,b});
define('report_competency/grading_popup', ["jquery","core/notification","core/str","core/ajax","core/log","core/templates","tool_lp/dialogue"],function(a,b,c,d,e,f,g){var h=function(b,c){this._regionSelector=b,this._userCompetencySelector=c,a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};return h.prototype._handleClick=function(c){var f=a(c.target).closest(this._userCompetencySelector),g=a(f).data("competencyid"),h=a(f).data("courseid"),i=a(f).data("userid");e.debug("Clicked on cell: competencyId="+g+", courseId="+h+", userId="+i);var j=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_course",args:{userid:i,competencyid:g,courseid:h}},{methodname:"core_competency_user_competency_viewed_in_course",args:{userid:i,competencyid:g,courseid:h}}]);a.when(j[0],j[1]).then(this._contextLoaded.bind(this))["catch"](b.exception)},h.prototype._contextLoaded=function(b){return b.displayuser=!0,M.util.js_pending("report_competency/grading_popup:_contextLoaded"),a.when(c.get_string("usercompetencysummary","report_competency"),f.render("tool_lp/user_competency_summary_in_course",b)).then(function(a,b){return new g(a,b[0],function(){f.runTemplateJS(b[1]),M.util.js_complete("report_competency/grading_popup:_contextLoaded")},this._refresh.bind(this),(!0))}.bind(this))},h.prototype._refresh=function(){var c=a(this._regionSelector),e=c.data("courseid"),f=c.data("userid");return d.call([{methodname:"report_competency_data_for_report",args:{courseid:e,userid:f},done:this._pageContextLoaded.bind(this),fail:b.exception}])},h.prototype._pageContextLoaded=function(a){f.render("report_competency/report",a).then(function(a,b){f.replaceNode(this._regionSelector,a,b)}.bind(this))["catch"](b.exception)},h.prototype._regionSelector=null,h.prototype._userCompetencySelector=null,h});
define('report_insights/actions', ["jquery","core/ajax","core/notification"],function(a,b,c){return{init:function(d){a("a[data-prediction-methodname][data-prediction-id="+d+"]").on("click",function(e){e.preventDefault();var f=a(e.currentTarget),g=f.attr("data-prediction-methodname"),h=f.closest("tr");if(h.length>0){var i=b.call([{methodname:g,args:{predictionid:d}}])[0];i.done(function(){h[0].remove(),a(".insights-list tr").length<2&&(document.referrer?window.location.assign(document.referrer):window.location.reload(!0))}).fail(c.exception)}})}}});
define('report_progress/completion_override', ["jquery","core/ajax","core/str","core/modal_factory","core/modal_events","core/notification","core/custom_interaction_events","core/templates"],function(a,b,c,d,e,f,g,h){var i,j,k=function(a,b){return a>0?"i/completion-"+b+"-y-override":"i/completion-"+b+"-n-override"},l=function(a){h.render("core/loading",{}).then(function(c){return j.append(c),b.call([{methodname:"core_completion_override_activity_completion_status",args:a}])[0]}).then(function(b){var d=b.state>0?1:0,e=d?"completion-y-override":"completion-n-override";c.get_string(e,"completion",i).then(function(a){var b={state:a,date:"",user:j.attr("data-userfullname"),activity:j.attr("data-activityname")};return c.get_string("progress-title","completion",b)}).then(function(a){var b=j.attr("data-completiontracking");return h.renderPix(k(d,b),"core",a)}).then(function(b){var c=d>0?0:1;j.find(".loading-icon").remove(),j.data("changecompl",a.userid+"-"+a.cmid+"-"+c),j.attr("data-changecompl",a.userid+"-"+a.cmid+"-"+c),j.children("img").replaceWith(b)})["catch"](f.exception)})["catch"](f.exception)},m=function(b,g){g.originalEvent.preventDefault(),g.originalEvent.stopPropagation(),b.preventDefault(),b.stopPropagation(),j=a(b.currentTarget);var h=j.data("changecompl").split("-"),i={userid:h[0],cmid:h[1],newstate:h[2]},k=1==i.newstate?"completion-y":"completion-n";c.get_strings([{key:k,component:"completion"}]).then(function(a){return c.get_strings([{key:"confirm",component:"moodle"},{key:"areyousureoverridecompletion",component:"completion",param:a[0]}])}).then(function(a){return d.create({type:d.types.CONFIRM,title:a[0],body:a[1]})}).then(function(a){a.getRoot().on(e.yes,function(){l(i)}),a.getRoot().on(e.hidden,function(){j.focus(),a.destroy()}),a.show()})["catch"](f.exception)},n=function(b){i=b,a("#completion-progress a.changecompl").each(function(a,b){g.define(b,[g.events.activate])}),a("#completion-progress").on(g.events.activate,"a.changecompl",function(a,b){m(a,b)})};return{init:n}});
define('gradingform_guide/comment_chooser', ["jquery","core/templates","core/notification","core/yui"],function(a,b,c){return{initialise:function(d,e,f,g){function h(b,c){var e="<label>"+M.util.get_string("insertcomment","gradingform_guide")+"</label>",g="comment-chooser-"+d+"-cancel",h='<button id="'+g+'">'+M.util.get_string("cancel","moodle")+"</button>",i=new M.core.dialogue({modal:!0,headerContent:e,bodyContent:b,footerContent:h,focusAfterHide:"#"+f,id:"comments-chooser-dialog-"+d});a("#"+g).click(function(){i.hide()}),a.each(c,function(b,c){var e="#comment-option-"+d+"-"+c.id;a(e).click(function(){var b=a("#"+f),d=b.val();""!==d.trim()&&(d+="\n"),d+=c.description,b.val(d),i.hide()}),a(document).off("keypress",e).on("keypress",e,function(){var b=event.which||event.keyCode;13!=b&&32!=b||a(e).click()})}),i.after("visibleChange",function(a){a.prevVal&&!a.newVal&&this.destroy()},i),i.show()}function i(){var a={criterionId:d,comments:g};b.render("gradingform_guide/comment_chooser",a).done(function(a){h(a,g)}).fail(c.exception)}a("#"+e).click(function(a){a.preventDefault(),i()})}}});
define('plagiarism_compilatio/compilatio_ajax_api', ["jquery"],function(i){function o(){i(".compilatio-button").each(function(){i(this).attr("disabled","disabled"),i(this).addClass("disabled"),i(this).attr("href","#")})}var t={},a=t.getIndexingState=function(o,t,a,n){i(document).ready(function(){i.post(o+"/plagiarism/compilatio/ajax/get_indexing_state.php",{idDoc:a,apiconfigid:n},function(s){i(".compi-"+t+" .compilatio-library").detach(),i(".compi-"+t).prepend(s),setTimeout(function(){i(".compi-"+t+" > div:first-child").click(function(){c(o,t,a,n)})},250)})})},c=t.toggleIndexingState=function(o,t,c,n){var s;i(".compi-"+t+" > div:first-child").is(".compilatio-library-in")&&(i(".compi-"+t+" > div:first-child").removeClass("compilatio-library-in"),s=0),i(".compi-"+t+" > div:first-child").is(".compilatio-library-out")&&(i(".compi-"+t+" > div:first-child").removeClass("compilatio-library-out"),s=1),i(".compi-"+t+" > div:first-child").addClass("compilatio-library"),i.post(o+"/plagiarism/compilatio/ajax/set_indexing_state.php",{idDoc:c,indexingState:s,apiconfigid:n},function(i){"true"==i&&a(o,t,c,n)})};return t.refreshButton=function(t,a,c){i(document).ready(function(){var n=a.length,s=0,l=i("i.fa-refresh").parent("button");0==n?o():l.click(function(){o(),i("#compilatio-home").html("<p>"+c+"<progress id='compi-update-progress' value='"+s+"' max='"+n+"'></progress></p>"),i("#compilatio-logo").click(),a.forEach(function(o){i.post(t+"/plagiarism/compilatio/ajax/compilatio_check_analysis.php",{id:o},function(){s++,i("#compi-update-progress").val(s),s==n&&window.location.reload()})})})})},t.startAllAnalysis=function(t,a){i(document).ready(function(){i("button.comp-start-btn").click(function(){o(),i.post(t+"/plagiarism/compilatio/ajax/compilatio_start_all_analysis.php",{cmid:a},function(){window.location.reload()})})})},t.startAnalysis=function(o,t,a,c=!1){i(document).ready(function(){setTimeout(function(){i(".compi-"+t+" > div:last-child").click(function(){i.post(o+"/plagiarism/compilatio/ajax/compilatio_start_analysis.php",{docId:a,cmid:c},function(){window.location.reload()})})},300)})},t.restartFailedAnalysis=function(t,a){i(document).ready(function(){i("button.comp-restart-btn").click(function(){o(),i.post(t+"/plagiarism/compilatio/ajax/compilatio_restart_failed_analysis.php",{cmid:a},function(){window.location.reload()})})})},t.compilatioTabs=function(o,t){i(document).ready(function(){var a="";a=t?"#compilatio-search":o.length>0?"#compilatio-notifications":"#compilatio-home",i("#compilatio-container").css("height","auto"),i("#compilatio-tabs").show();var c=i("#compilatio-show-notifications, #show-stats, #show-help, #show-search"),n=i("#compilatio-notifications, #compilatio-stats, #compilatio-help, #compilatio-home, #compilatio-search");function s(o,t){t.is(":visible")||(t.show(),n.not(t).hide(),c.not(o).removeClass("active"),o.toggleClass("active"),i("#compilatio-hide-area").fadeIn())}n.not(i(a)).hide(),i("#compilatio-show-notifications").on("click",function(){s(i(this),i("#compilatio-notifications"))}),i("#show-stats").on("click",function(){s(i(this),i("#compilatio-stats"))}),i("#show-help").on("click",function(){s(i(this),i("#compilatio-help"))}),i("#show-search").on("click",function(){s(i(this),i("#compilatio-search"))}),i("#compilatio-logo").on("click",function(){var o=i("#compilatio-home");o.show(),n.not(o).hide(),c.removeClass("active"),i("#compilatio-hide-area").fadeIn()}),i("#compilatio-hide-area").on("click",function(){n.hide(),i(this).fadeOut(),c.removeClass("active")})})},t});
define('plagiarism_compilatio/compilatio_form', ["jquery"],function(e){var t={afterPercentValues:function(t,a){e(document).ready(function(){var n=e("<span>",{class:"compilatio-after-input"}).text(t),r=e("<span>",{class:"compilatio-after-input"}).text(t+", "+a+".");e("#green_threshold").after(n),e("#orange_threshold").after(r)})}};return t});
define('tool_analytics/log_info', ["jquery","core/str","core/modal_factory","core/notification"],function(a,b,c,d){return{loadInfo:function(e,f){var g=a('[data-model-log-id="'+e+'"]');b.get_string("loginfo","tool_analytics").then(function(b){var d=a("<ul>");return f.forEach(function(a){d.append("<li>"+a+"</li>")}),d.append("</ul>"),c.create({title:b,body:d.html(),large:!0},g)})["catch"](d.exception)}}});
define('tool_analytics/model', ["jquery","core/str","core/log","core/notification","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g={clear:{title:{key:"clearpredictions",component:"tool_analytics"},body:{key:"clearmodelpredictions",component:"tool_analytics"}}},h=function(b){return a(b.closest("tr")[0]).find("span.target-name").text()};return{confirmAction:function(i,j){a('[data-action-id="'+i+'"]').on("click",function(i){i.preventDefault();var k=a(i.currentTarget);if("undefined"==typeof g[j])return void c.error('Action "'+j+'" is not allowed.');var l=[g[j].title,g[j].body];l[1].param=h(k);var m=b.get_strings(l),n=e.create({type:e.types.SAVE_CANCEL});a.when(m,n).then(function(a,b){return b.setTitle(a[0]),b.setBody(a[1]),b.setSaveButtonText(a[0]),b.getRoot().on(f.save,function(){window.location.href=k.attr("href")}),b.show(),b}).fail(d.exception)})}}});
define('tool_dataprivacy/data_request_modal', ["jquery","core/notification","core/custom_interaction_events","core/modal","core/modal_registry","tool_dataprivacy/events"],function(a,b,c,d,e,f){var g=!1,h={APPROVE_BUTTON:'[data-action="approve"]',DENY_BUTTON:'[data-action="deny"]',COMPLETE_BUTTON:'[data-action="complete"]'},i=function(a){d.call(this,a)};return i.TYPE="tool_dataprivacy-data_request",i.prototype=Object.create(d.prototype),i.prototype.constructor=i,i.prototype.registerEventListeners=function(){d.prototype.registerEventListeners.call(this),this.getModal().on(c.events.activate,h.APPROVE_BUTTON,function(b,c){var d=a.Event(f.approve);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,h.DENY_BUTTON,function(b,c){var d=a.Event(f.deny);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this)),this.getModal().on(c.events.activate,h.COMPLETE_BUTTON,function(b,c){var d=a.Event(f.complete);this.getRoot().trigger(d,this),d.isDefaultPrevented()||(this.hide(),c.originalEvent.preventDefault())}.bind(this))},g||(e.register(i.TYPE,i,"tool_dataprivacy/data_request_modal"),g=!0),i});
define('tool_dataprivacy/myrequestactions', ["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events","core/templates","core/pending"],function(a,b,c,d,e,f,g,h){function i(a){var e={methodname:"tool_dataprivacy_contact_dpo",args:{message:a}},f="success";b.call([e])[0].then(function(a){return a.result?d.get_string("requestsubmitted","tool_dataprivacy"):(f="error",a.warnings.join("<br>"))}).done(function(a){c.addNotification({message:a,type:f})}).fail(c.exception)}var j={CANCEL_REQUEST:'[data-action="cancel"]',CONTACT_DPO:'[data-action="contactdpo"]'},k=function(){this.registerEvents()};return k.prototype.registerEvents=function(){a(j.CANCEL_REQUEST).click(function(g){g.preventDefault();var h=a(this).data("requestid"),i=[{key:"cancelrequest",component:"tool_dataprivacy"},{key:"cancelrequestconfirmation",component:"tool_dataprivacy"}];d.get_strings(i).then(function(a){var d=a[0],g=a[1];return e.create({title:d,body:g,type:e.types.SAVE_CANCEL}).then(function(a){return a.setSaveButtonText(d),a.getRoot().on(f.save,function(){var a={requestid:h},d={methodname:"tool_dataprivacy_cancel_data_request",args:a};b.call([d])[0].done(function(a){a.result?window.location.reload():c.addNotification({message:a.warnings[0].message,type:"error"})}).fail(c.exception)}),a.getRoot().on(f.hidden,function(){a.destroy()}),a})}).done(function(a){a.show()}).fail(c.exception)}),a(j.CONTACT_DPO).click(function(b){var j=new h("dataprivacy/crud:initModal:contactdpo");b.preventDefault();var k=a(this).data("replytoemail"),l=[{key:"contactdataprotectionofficer",component:"tool_dataprivacy"},{key:"send",component:"tool_dataprivacy"}],m="";d.get_strings(l).then(function(a){var b=a[0];m=a[1];var c={replytoemail:k};return e.create({title:b,body:g.render("tool_dataprivacy/contact_dpo",c),type:e.types.SAVE_CANCEL,large:!0})}).then(function(b){b.setSaveButtonText(m),b.show(),b.getRoot().on(f.save,function(b){var c=a("#message").val().trim();0===c.length?(b.preventDefault(),a('[data-region="messageinput"]').addClass("has-danger notifyproblem"),a("#id_error_message").removeAttr("hidden")):i(c)}),b.getRoot().on(f.hidden,function(){b.destroy()})}).then(j.resolve)["catch"](c.exception)})},{init:function(){return new k}}});
define('tool_dataprivacy/data_deletion', ["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){function g(a){var g=[{key:"confirm",component:"moodle"},{key:"confirmcontextdeletion",component:"tool_dataprivacy"}],h="tool_dataprivacy_confirm_contexts_for_deletion",i="";d.get_strings(g).then(function(a){i=a[0];var b=a[1];return e.create({title:i,body:b,type:e.types.SAVE_CANCEL})}).then(function(d){return d.setSaveButtonText(i),d.getRoot().on(f.save,function(){var d={ids:a},e={methodname:h,args:d};b.call([e])[0].done(function(a){a.result?window.location.reload():c.addNotification({message:a.warnings[0].message,type:"error"})}).fail(c.exception)}),d.getRoot().on(f.hidden,function(){d.destroy()}),d}).done(function(a){a.show()}).fail(c.exception)}var h={MARK_FOR_DELETION:'[data-action="markfordeletion"]',SELECT_ALL:'[data-action="selectall"]'},i={SELECTCONTEXT:".selectcontext"},j=function(){this.registerEvents()};return j.prototype.registerEvents=function(){a(h.MARK_FOR_DELETION).click(function(b){b.preventDefault();var c=[];a(i.SELECTCONTEXT).each(function(){var b=a(this);b.is(":checked")&&c.push(b.val())}),g(c)}),a(h.SELECT_ALL).change(function(b){b.preventDefault();var c=a(this);c.is(":checked")?a(i.SELECTCONTEXT).attr("checked","checked"):a(i.SELECTCONTEXT).removeAttr("checked")})},j});
define('tool_dataprivacy/defaultsactions', ["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events","core/templates"],function(a,b,c,d,e,f,g){function h(b,d,h,j,k,l,m,n){null!==h&&l.forEach(function(a){a.id===h&&(a.selected=!0)}),null!==j&&m.forEach(function(a){a.id===j&&(a.selected=!0)});var o={contextlevel:d,categoryoptions:l,purposeoptions:m};null!==n&&n.length&&(null===k?o.newactivitydefaults=!0:n.forEach(function(a){k===a.name&&(a.selected=!0)}),o.modemodule=!0,o.activityoptions=n),e.create({title:b,body:g.render("tool_dataprivacy/category_purpose_form",o),type:e.types.SAVE_CANCEL,large:!0}).then(function(b){return b.getRoot().on(f.save,function(){var b=a("#activity"),c="undefined"!=typeof b?b.val():null,d=a("#override"),e="undefined"!=typeof d&&d.is(":checked");i(a("#contextlevel").val(),a("#category").val(),a("#purpose").val(),c,e)}),b.getRoot().on(f.hidden,function(){b.destroy()}),b.show(),b})["catch"](c.exception)}function i(a,c,d,e,f){var g={methodname:"tool_dataprivacy_set_context_defaults",args:{contextlevel:a,category:c,purpose:d,override:f,activity:e}};b.call([g])[0].done(function(a){a.result&&window.location.reload()})}var j={EDIT_LEVEL_DEFAULTS:'[data-action="edit-level-defaults"]',NEW_ACTIVITY_DEFAULTS:'[data-action="new-activity-defaults"]',EDIT_ACTIVITY_DEFAULTS:'[data-action="edit-activity-defaults"]',DELETE_ACTIVITY_DEFAULTS:'[data-action="delete-activity-defaults"]'},k=-1,l=function(){this.registerEvents()};return l.prototype.registerEvents=function(){a(j.EDIT_LEVEL_DEFAULTS).click(function(e){e.preventDefault();var f=a(this),g=f.data("contextlevel"),i=f.data("category"),j=f.data("purpose"),k=[{methodname:"tool_dataprivacy_get_category_options",args:{}},{methodname:"tool_dataprivacy_get_purpose_options",args:{}}],l=b.call(k),m=d.get_string("editdefaults","tool_dataprivacy",a("#defaults-header").text());a.when(l[0],l[1],m).then(function(a,b,c){var d=a.options,e=b.options;return h(c,g,i,j,null,d,e,null),!0})["catch"](c.exception)}),a(j.NEW_ACTIVITY_DEFAULTS).click(function(e){e.preventDefault();var f=a(this),g=f.data("contextlevel"),i=[{methodname:"tool_dataprivacy_get_category_options",args:{}},{methodname:"tool_dataprivacy_get_purpose_options",args:{}},{methodname:"tool_dataprivacy_get_activity_options",args:{nodefaults:!0}}],j=b.call(i),k=d.get_string("addnewdefaults","tool_dataprivacy");a.when(j[0],j[1],j[2],k).then(function(a,b,c,d){var e=a.options,f=b.options,i=c.options;return h(d,g,null,null,null,e,f,i),!0})["catch"](c.exception)}),a(j.EDIT_ACTIVITY_DEFAULTS).click(function(e){e.preventDefault();var f=a(this),g=f.data("contextlevel"),i=f.data("category"),j=f.data("purpose"),k=f.data("activityname"),l=[{methodname:"tool_dataprivacy_get_category_options",args:{}},{methodname:"tool_dataprivacy_get_purpose_options",args:{}},{methodname:"tool_dataprivacy_get_activity_options",args:{}}],m=b.call(l),n=d.get_string("editmoduledefaults","tool_dataprivacy");a.when(m[0],m[1],m[2],n).then(function(a,b,c,d){var e=a.options,f=b.options,l=c.options;return h(d,g,i,j,k,e,f,l),!0})["catch"](c.exception)}),a(j.DELETE_ACTIVITY_DEFAULTS).click(function(b){b.preventDefault();var h=a(this),j=h.data("contextlevel"),l=h.data("activityname"),m=h.data("activitydisplayname"),n=k,o=k;e.create({title:d.get_string("deletedefaults","tool_dataprivacy",m),body:g.render("tool_dataprivacy/delete_activity_defaults",{activityname:m}),type:e.types.SAVE_CANCEL,large:!0}).then(function(a){return a.setSaveButtonText(d.get_string("delete")),a.getRoot().on(f.save,function(){i(j,n,o,l,!1)}),a.getRoot().on(f.hidden,function(){a.destroy()}),a.show(),!0})["catch"](c.exception)})},{init:function(){return new l}}});
define('tool_dataprivacy/categoriesactions', ["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g={DELETE:'[data-action="deletecategory"]'},h=function(){this.registerEvents()};return h.prototype.registerEvents=function(){a(g.DELETE).click(function(g){g.preventDefault();var h=a(this).data("id"),i=a(this).data("name"),j=[{key:"deletecategory",component:"tool_dataprivacy"},{key:"deletecategorytext",component:"tool_dataprivacy",param:i},{key:"delete"}];d.get_strings(j).then(function(d){var g=d[0],i=d[1],j=d[2];return e.create({title:g,body:i,type:e.types.SAVE_CANCEL}).then(function(d){return d.setSaveButtonText(j),d.getRoot().on(f.save,function(){var d={methodname:"tool_dataprivacy_delete_category",args:{id:h}};b.call([d])[0].done(function(b){b.result?a('tr[data-categoryid="'+h+'"]').remove():c.addNotification({message:b.warnings[0].message,type:"error"})}).fail(c.exception)}),d.getRoot().on(f.hidden,function(){d.destroy()}),d})}).done(function(a){a.show()}).fail(c.exception)})},{init:function(){return new h}}});
define('tool_dataprivacy/events', [],function(){return{approve:"tool_dataprivacy-data_request:approve",bulkApprove:"tool_dataprivacy-data_request:bulk_approve",deny:"tool_dataprivacy-data_request:deny",bulkDeny:"tool_dataprivacy-data_request:bulk_deny",complete:"tool_dataprivacy-data_request:complete"}});
define('tool_dataprivacy/purposesactions', ["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){var g={DELETE:'[data-action="deletepurpose"]'},h=function(){this.registerEvents()};return h.prototype.registerEvents=function(){a(g.DELETE).click(function(g){g.preventDefault();var h=a(this).data("id"),i=a(this).data("name"),j=[{key:"deletepurpose",component:"tool_dataprivacy"},{key:"deletepurposetext",component:"tool_dataprivacy",param:i},{key:"delete"}];d.get_strings(j).then(function(d){var g=d[0],i=d[1],j=d[2];return e.create({title:g,body:i,type:e.types.SAVE_CANCEL}).then(function(d){return d.setSaveButtonText(j),d.getRoot().on(f.save,function(){var d={methodname:"tool_dataprivacy_delete_purpose",args:{id:h}};b.call([d])[0].done(function(b){b.result?a('tr[data-purposeid="'+h+'"]').remove():c.addNotification({message:b.warnings[0].message,type:"error"})}).fail(c.exception)}),d.getRoot().on(f.hidden,function(){d.destroy()}),d})}).done(function(a){a.show()}).fail(c.exception)})},{init:function(){return new h}}});
define('tool_dataprivacy/requestactions', ["jquery","core/ajax","core/notification","core/str","core/modal_factory","core/modal_events","core/templates","tool_dataprivacy/data_request_modal","tool_dataprivacy/events"],function(a,b,c,d,e,f,g,h,i){function j(a){return{wsfunction:"tool_dataprivacy_approve_data_request",wsparams:{requestid:a}}}function k(a){return{wsfunction:"tool_dataprivacy_bulk_approve_data_requests",wsparams:{requestids:a}}}function l(a){return{wsfunction:"tool_dataprivacy_deny_data_request",wsparams:{requestid:a}}}function m(a){return{wsfunction:"tool_dataprivacy_bulk_deny_data_requests",wsparams:{requestids:a}}}function n(a){return{wsfunction:"tool_dataprivacy_mark_complete",wsparams:{requestid:a}}}function o(a,b){var g=[];switch(a){case i.approve:g=[{key:"approverequest",component:"tool_dataprivacy"},{key:"confirmapproval",component:"tool_dataprivacy"}];break;case i.bulkApprove:g=[{key:"bulkapproverequests",component:"tool_dataprivacy"},{key:"confirmbulkapproval",component:"tool_dataprivacy"}];break;case i.deny:g=[{key:"denyrequest",component:"tool_dataprivacy"},{key:"confirmdenial",component:"tool_dataprivacy"}];break;case i.bulkDeny:g=[{key:"bulkdenyrequests",component:"tool_dataprivacy"},{key:"confirmbulkdenial",component:"tool_dataprivacy"}];break;case i.complete:g=[{key:"markcomplete",component:"tool_dataprivacy"},{key:"confirmcompletion",component:"tool_dataprivacy"}]}var h="";d.get_strings(g).then(function(a){h=a[0];var b=a[1];return e.create({title:h,body:b,type:e.types.SAVE_CANCEL})}).then(function(a){a.setSaveButtonText(h),a.getRoot().on(f.save,function(){p(b.wsfunction,b.wsparams)}),a.getRoot().on(f.hidden,function(){a.destroy()}),a.show()})["catch"](c.exception)}function p(a,d){var e={methodname:a,args:d};b.call([e])[0].done(function(a){a.result?window.location.reload():c.addNotification({message:a.warnings[0].message,type:"error"})}).fail(c.exception)}var q={APPROVE_REQUEST:'[data-action="approve"]',DENY_REQUEST:'[data-action="deny"]',VIEW_REQUEST:'[data-action="view"]',MARK_COMPLETE:'[data-action="complete"]',CHANGE_BULK_ACTION:'[id="bulk-action"]',CONFIRM_BULK_ACTION:'[id="confirm-bulk-action"]',SELECT_ALL:'[data-action="selectall"]'},r={APPROVE:1,DENY:2},s={SELECT_REQUEST:".selectrequests"},t=function(){this.registerEvents()};return t.prototype.registerEvents=function(){a(q.VIEW_REQUEST).click(function(d){d.preventDefault();var k=a(this).data("requestid"),m={requestid:k},n={methodname:"tool_dataprivacy_get_data_request",args:m},q=b.call([n]);a.when(q[0]).then(function(a){return a.result?a.result:(c.addNotification({message:a.warnings[0].message,type:"error"}),!1)}).then(function(a){var b=g.render("tool_dataprivacy/request_details",a),c={approvedeny:a.approvedeny,canmarkcomplete:a.canmarkcomplete};return e.create({title:a.typename,body:b,type:h.TYPE,large:!0,templateContext:c})}).then(function(a){a.getRoot().on(i.approve,function(){o(i.approve,j(k))}),a.getRoot().on(i.deny,function(){o(i.deny,l(k))}),a.getRoot().on(i.complete,function(){var a={requestid:k};p("tool_dataprivacy_mark_complete",a)}),a.getRoot().on(f.hidden,function(){a.destroy()}),a.show()})["catch"](c.exception)}),a(q.APPROVE_REQUEST).click(function(b){b.preventDefault();var c=a(this).data("requestid");o(i.approve,j(c))}),a(q.DENY_REQUEST).click(function(b){b.preventDefault();var c=a(this).data("requestid");o(i.deny,l(c))}),a(q.MARK_COMPLETE).click(function(b){b.preventDefault();var c=a(this).data("requestid");o(i.complete,n(c))}),a(q.CONFIRM_BULK_ACTION).click(function(){var b=[],e="",f={},g=[{key:"selectbulkaction",component:"tool_dataprivacy"},{key:"selectdatarequests",component:"tool_dataprivacy"},{key:"ok"}],h=parseInt(a("#bulk-action").val());if(h!=r.APPROVE&&h!=r.DENY)return void d.get_strings(g).done(function(a){c.alert("",a[0],a[2])}).fail(c.exception);if(a(".selectrequests:checked").each(function(){b.push(a(this).val())}),b.length<1)return void d.get_strings(g).done(function(a){c.alert("",a[1],a[2])}).fail(c.exception);switch(h){case r.APPROVE:e=i.bulkApprove,f=k(b);break;case r.DENY:e=i.bulkDeny,f=m(b)}o(e,f)}),a(q.SELECT_ALL).change(function(b){b.preventDefault();var c=a(this).is(":checked");a(s.SELECT_REQUEST).prop("checked",c)})},t});
define('tool_dataprivacy/request_filter', ["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={REQUEST_FILTERS:"#request-filters"},f=function(){var f=[{key:"filter",component:"moodle"},{key:"nofiltersapplied",component:"moodle"}];c.get_strings(f).then(function(a){var c=a[0],d=a[1];return b.enhance(e.REQUEST_FILTERS,!1,"",c,!1,!0,d,!0)}).fail(d.exception);var g=a(e.REQUEST_FILTERS).val();a(e.REQUEST_FILTERS).on("change",function(){var b=a(this).val();g.join(",")!==b.join(",")&&(0===b.length&&a("#filters-cleared").val(1),a(this.form).submit())})};return{init:function(){f()}}});
define('tool_dataprivacy/data_registry', ["jquery","core/str","core/ajax","core/notification","core/templates","core/modal_factory","core/modal_events","core/fragment","tool_dataprivacy/add_purpose","tool_dataprivacy/add_category"],function(a,b,c,d,e,f,g,h,i,j){var k={TREE_NODES:"[data-context-tree-node=1]",FORM_CONTAINER:"#context-form-container"},l=function(a,b,c){this.systemContextId=a,this.currentContextLevel=b,this.currentContextId=c,this.init()};return l.prototype.systemContextId=0,l.prototype.currentContextLevel=0,l.prototype.currentContextId=0,l.prototype.addpurpose=null,l.prototype.addcategory=null,l.prototype.init=function(){this.addpurpose=i.getInstance(this.systemContextId),this.addcategory=j.getInstance(this.systemContextId);var a=[{key:"changessaved",component:"moodle"},{key:"contextpurposecategorysaved",component:"tool_dataprivacy"},{key:"noblockstoload",component:"tool_dataprivacy"},{key:"noactivitiestoload",component:"tool_dataprivacy"},{key:"nocoursestoload",component:"tool_dataprivacy"}];this.strings=b.get_strings(a),this.registerEventListeners(),this.currentContextId?this.loadForm("context_form",[this.currentContextId],this.submitContextFormAjax.bind(this)):this.loadForm("contextlevel_form",[this.currentContextLevel],this.submitContextLevelFormAjax.bind(this))},l.prototype.registerEventListeners=function(){a(k.TREE_NODES).on("click",function(b){b.preventDefault();var c=a(b.currentTarget);a(k.TREE_NODES).removeClass("active"),c.addClass("active");var d=c.data("contextlevel"),e=c.data("contextid");if(d)window.history.pushState({},null,"?contextlevel="+d),this.addpurpose.removeListeners(),this.addcategory.removeListeners(),this.currentContextLevel=d,this.loadForm("contextlevel_form",[this.currentContextLevel],this.submitContextLevelFormAjax.bind(this));else if(e)window.history.pushState({},null,"?contextid="+e),this.addpurpose.removeListeners(),this.addcategory.removeListeners(),this.currentContextId=e,this.loadForm("context_form",[this.currentContextId],this.submitContextFormAjax.bind(this));else{var f=c.data("expandcontextid"),g=c.data("expandelement"),h=c.data("expanded");g&&(h?this.collapse(c):!c.data("loaded")&&f&&g?(c.find("> i").removeClass("fa-plus"),c.find("> i").addClass("fa-circle-o-notch fa-spin"),this.loadExtra(c,f,g)):this.expand(c))}}.bind(this))},l.prototype.removeListeners=function(){a(k.TREE_NODES).off("click")},l.prototype.loadForm=function(b,c,f){this.clearForm();var g=h.loadFragment("tool_dataprivacy",b,this.systemContextId,c);g.done(function(b,c){a(k.FORM_CONTAINER).html(b),e.runTemplateJS(c),this.addpurpose.registerEventListeners(),this.addcategory.registerEventListeners(),a(k.FORM_CONTAINER).on("submit","form",f)}.bind(this)).fail(d.exception)},l.prototype.clearForm=function(){Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()}),a(k.FORM_CONTAINER).off("submit","form")},l.prototype.submitForm=function(b){b.preventDefault(),a(k.FORM_CONTAINER).find("form").submit()},l.prototype.submitContextLevelFormAjax=function(a){this.submitFormAjax(a,"tool_dataprivacy_set_contextlevel_form")},l.prototype.submitContextFormAjax=function(a){this.submitFormAjax(a,"tool_dataprivacy_set_context_form")},l.prototype.submitFormAjax=function(b,e){b.preventDefault();var f=a(k.FORM_CONTAINER).find("form").serialize();return this.strings.then(function(a){c.call([{methodname:e,args:{jsonformdata:JSON.stringify(f)},done:function(){d.alert(a[0],a[1])},fail:d.exception}])})["catch"](d.exception)},l.prototype.loadExtra=function(a,b,f){c.call([{methodname:"tool_dataprivacy_tree_extra_branches",args:{contextid:b,element:f},done:function(b){return 0==b.branches.length?void this.noElements(a,f):void e.render("tool_dataprivacy/context_tree_branches",b).then(function(b){a.after(b),this.removeListeners(),this.registerEventListeners(),this.expand(a),a.data("loaded",1)}.bind(this)).fail(d.exception)}.bind(this),fail:d.exception}])},l.prototype.noElements=function(a,b){a.data("expandcontextid",""),a.data("expandelement",""),this.strings.then(function(c){var d=2;"module"==b?d=3:"course"==b&&(d=4),a.text(c[d])}).fail(d.exception)},l.prototype.collapse=function(a){a.data("expanded",0),a.siblings("nav").addClass("hidden"),a.find("> i").removeClass("fa-minus"),a.find("> i").addClass("fa-plus")},l.prototype.expand=function(a){a.data("expanded",1),a.siblings("nav").removeClass("hidden"),a.find("> i").removeClass("fa-plus"),a.find("> i").removeClass("fa-circle-o-notch fa-spin"),a.find("> i").addClass("fa-minus")},{init:function(a,b,c){return new l(a,b,c)}}});
define('tool_dataprivacy/add_purpose', ["jquery","core/str","core/ajax","core/notification","core/modal_factory","core/modal_events","core/fragment"],function(a,b,c,d,e,f,g){var h={PURPOSE_LINK:'[data-add-element="purpose"]'},i=function(a){this.contextId=a;var c=[{key:"addpurpose",component:"tool_dataprivacy"},{key:"save",component:"admin"}];this.strings=b.get_strings(c),this.registerEventListeners()};return i.prototype.contextId=0,i.prototype.strings=0,i.prototype.registerEventListeners=function(){var b=a(h.PURPOSE_LINK);b.on("click",function(){return this.strings.then(function(a){e.create({type:e.types.SAVE_CANCEL,title:a[0],body:""},b).done(function(b){this.setupFormModal(b,a[1])}.bind(this))}.bind(this)).fail(d.exception)}.bind(this))},i.prototype.getBody=function(a){var b=null;return"undefined"!=typeof a&&(b={jsonformdata:JSON.stringify(a)}),g.loadFragment("tool_dataprivacy","addpurpose_form",this.contextId,b)},i.prototype.setupFormModal=function(a,b){a.setLarge(),a.setSaveButtonText(b),a.getRoot().on(f.hidden,this.destroy.bind(this)),a.setBody(this.getBody()),a.getRoot().on(f.save,this.submitForm.bind(this)),a.getRoot().on("submit","form",this.submitFormAjax.bind(this)),this.modal=a,a.show()},i.prototype.submitForm=function(a){a.preventDefault(),this.modal.getRoot().find("form").submit()},i.prototype.submitFormAjax=function(a){a.preventDefault();var b=this.modal.getRoot().find("form").serialize();c.call([{methodname:"tool_dataprivacy_create_purpose_form",args:{jsonformdata:JSON.stringify(b)},done:function(a){a.validationerrors?this.modal.setBody(this.getBody(b)):this.close()}.bind(this),fail:d.exception}])},i.prototype.close=function(){this.destroy(),document.location.reload()},i.prototype.destroy=function(){Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()}),this.modal.destroy()},i.prototype.removeListeners=function(){a(h.PURPOSE_LINK).off("click")},{getInstance:function(a){return new i(a)}}});
define('tool_dataprivacy/add_category', ["jquery","core/str","core/ajax","core/notification","core/modal_factory","core/modal_events","core/fragment"],function(a,b,c,d,e,f,g){var h={CATEGORY_LINK:'[data-add-element="category"]'},i=function(a){this.contextId=a;var c=[{key:"addcategory",component:"tool_dataprivacy"},{key:"save",component:"admin"}];this.strings=b.get_strings(c),this.registerEventListeners()};return i.prototype.contextId=0,i.prototype.strings=0,i.prototype.registerEventListeners=function(){var b=a(h.CATEGORY_LINK);b.on("click",function(){return this.strings.then(function(a){e.create({type:e.types.SAVE_CANCEL,title:a[0],body:""},b).done(function(b){this.setupFormModal(b,a[1])}.bind(this))}.bind(this)).fail(d.exception)}.bind(this))},i.prototype.getBody=function(a){var b=null;return"undefined"!=typeof a&&(b={jsonformdata:JSON.stringify(a)}),g.loadFragment("tool_dataprivacy","addcategory_form",this.contextId,b)},i.prototype.setupFormModal=function(a,b){a.setLarge(),a.setSaveButtonText(b),a.getRoot().on(f.hidden,this.destroy.bind(this)),a.setBody(this.getBody()),a.getRoot().on(f.save,this.submitForm.bind(this)),a.getRoot().on("submit","form",this.submitFormAjax.bind(this)),this.modal=a,a.show()},i.prototype.submitForm=function(a){a.preventDefault(),this.modal.getRoot().find("form").submit()},i.prototype.submitFormAjax=function(a){a.preventDefault();var b=this.modal.getRoot().find("form").serialize();c.call([{methodname:"tool_dataprivacy_create_category_form",args:{jsonformdata:JSON.stringify(b)},done:function(a){a.validationerrors?this.modal.setBody(this.getBody(b)):this.close()}.bind(this),fail:d.exception}])},i.prototype.close=function(){this.destroy(),document.location.reload()},i.prototype.destroy=function(){Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()}),this.modal.destroy()},i.prototype.removeListeners=function(){a(h.CATEGORY_LINK).off("click")},{getInstance:function(a){return new i(a)}}});
define('tool_dataprivacy/expand_contract', ["jquery","core/url","core/str"],function(a,b,c){var d=a('<img alt="" src="'+b.imageUrl("t/expanded")+'"/>'),e=a('<img alt="" src="'+b.imageUrl("t/collapsed")+'"/>');return{expandCollapse:function(a,b){a.hasClass("hide")?(a.removeClass("hide"),a.addClass("visible"),a.attr("aria-expanded",!0),b.find(":header i.fa").removeClass("fa-plus-square"),b.find(":header i.fa").addClass("fa-minus-square"),b.find(":header img.icon").attr("src",d.attr("src"))):(a.removeClass("visible"),a.addClass("hide"),a.attr("aria-expanded",!1),b.find(":header i.fa").removeClass("fa-minus-square"),b.find(":header i.fa").addClass("fa-plus-square"),b.find(":header img.icon").attr("src",e.attr("src")))},expandCollapseAll:function(b){var f="visible"==b?"hide":"visible",g="visible"==b,h="visible"==b?"fa-plus-square":"fa-minus-square",i="visible"==b?"fa-minus-square":"fa-plus-square",j="visible"==b?d.attr("src"):e.attr("src");a("."+f).each(function(){a(this).removeClass(f),a(this).addClass(b),a(this).attr("aria-expanded",g)}),a(".tool_dataprivacy-expand-all").data("visibilityState",f),c.get_string(f,"tool_dataprivacy").then(function(b){a(".tool_dataprivacy-expand-all").html(b)})["catch"](Notification.exception),a(":header i.fa").each(function(){a(this).removeClass(h),a(this).addClass(i)}),a(":header img.icon").each(function(){a(this).attr("src",j)})}}});
define('tool_dataprivacy/form-user-selector', ["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.id,label:b._label})}),d},transport:function(d,e,f,g){var h;h=b.call([{methodname:"tool_dataprivacy_get_users",args:{query:e}}]),h[0].then(function(b){var d=[],e=0;return a.each(b,function(a,b){d.push(c.render("tool_dataprivacy/form-user-selector-suggestion",b))}),a.when.apply(a.when,d).then(function(){var c=arguments;a.each(b,function(a,b){b._label=c[e],e++}),f(b)})}).fail(g)}}});
define('tool_dataprivacy/effective_retention_period', ["jquery"],function(a){var b={PURPOSE_SELECT:"#id_purposeid",RETENTION_FIELD_BOOST:"#id_error_retention_current",RETENTION_FIELD_CLEAN:"#fitem_id_retention_current [data-fieldtype=static]"},c=function(a){this.purposeRetentionPeriods=a,this.registerEventListeners()},d=function(){a(b.PURPOSE_SELECT).off("change")};return c.prototype.purposeRetentionPeriods=[],c.prototype.registerEventListeners=function(){a(b.PURPOSE_SELECT).on("change",function(c){var d=a(c.currentTarget).val(),e=this.purposeRetentionPeriods[d],f=a(b.RETENTION_FIELD_CLEAN);if(f.length>0)f.text(e);else{var g=a(b.RETENTION_FIELD_BOOST),h=g.siblings();h.length>0&&h.text(e)}}.bind(this))},{init:function(a){return d(),new c(a)}}});
define('tool_lp/grade_dialogue', ["jquery","core/notification","core/templates","tool_lp/dialogue","tool_lp/event_base","core/str"],function(a,b,c,d,e,f){var g=function(a){e.prototype.constructor.apply(this,[]),this._ratingOptions=a};return g.prototype=Object.create(e.prototype),g.prototype._popup=null,g.prototype._ratingOptions=null,g.prototype._afterRender=function(){var b=this._find('[data-action="rate"]'),c=this._find('[name="rating"]'),d=this._find('[name="comment"]');this._find('[data-action="cancel"]').click(function(a){a.preventDefault(),this._trigger("cancelled"),this.close()}.bind(this)),c.change(function(){var c=a(this);c.val()?b.prop("disabled",!1):b.prop("disabled",!0)}).change(),b.click(function(a){a.preventDefault();var b=c.val();b&&(this._trigger("rated",{rating:b,note:d.val()}),this.close())}.bind(this))},g.prototype.close=function(){this._popup.close(),this._popup=null},g.prototype.display=function(){return M.util.js_pending("tool_lp/grade_dialogue:display"),a.when(f.get_string("rate","tool_lp"),this._render()).then(function(a,b){return this._popup=new d(a,b[0],function(){this._afterRender(),M.util.js_complete("tool_lp/grade_dialogue:display")}.bind(this)),this._popup}.bind(this))["catch"](b.exception)},g.prototype._find=function(b){return a(this._popup.getContent()).find(b)},g.prototype._render=function(){var a={cangrade:this._canGrade,ratings:this._ratingOptions};return c.render("tool_lp/competency_grader",a)},g});
define('tool_lp/tree', ["jquery","core/url","core/log"],function(a,b,c){var d=a('<img alt="" src="'+b.imageUrl("t/expanded")+'"/>'),e=a('<img alt="" src="'+b.imageUrl("t/collapsed")+'"/>'),f=function(b,c){this.treeRoot=a(b),this.multiSelect="undefined"==typeof c||c===!0,this.items=this.treeRoot.find("li"),this.expandAll=this.items.length<20,this.parents=this.treeRoot.find("li:has(ul)"),c&&this.treeRoot.attr("aria-multiselectable","true"),this.items.attr("aria-selected","false"),this.visibleItems=null,this.activeItem=null,this.lastActiveItem=null,this.keys={tab:9,enter:13,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,eight:56,asterisk:106},this.init(),this.bindEventHandlers()};return f.prototype.init=function(){this.parents.attr("aria-expanded","true"),this.parents.prepend(d.clone()),this.items.attr("role","tree-item"),this.items.attr("tabindex","-1"),this.parents.attr("role","group"),this.treeRoot.attr("role","tree"),this.visibleItems=this.treeRoot.find("li");var b=this;this.expandAll||(this.parents.each(function(){b.collapseGroup(a(this))}),this.expandGroup(this.parents.first()))},f.prototype.expandGroup=function(a){var b=a.children("ul");b.show().attr("aria-hidden","false"),a.attr("aria-expanded","true"),a.children("img").attr("src",d.attr("src")),this.visibleItems=this.treeRoot.find("li:visible")},f.prototype.collapseGroup=function(a){var b=a.children("ul");b.hide().attr("aria-hidden","true"),a.attr("aria-expanded","false"),a.children("img").attr("src",e.attr("src")),this.visibleItems=this.treeRoot.find("li:visible")},f.prototype.toggleGroup=function(a){"true"==a.attr("aria-expanded")?this.collapseGroup(a):this.expandGroup(a)},f.prototype.triggerChange=function(){var a=this.items.filter("[aria-selected=true]");this.multiSelect||(a=a.first()),this.treeRoot.trigger("selectionchanged",{selected:a})},f.prototype.multiSelectItem=function(b){if(this.multiSelect){if(null!==this.lastActiveItem){for(var c=this.visibleItems.index(this.lastActiveItem),d=this.visibleItems.index(this.activeItem),e=null;c<d;)e=a(this.visibleItems.get(c)),e.attr("aria-selected","true"),c++;for(;c>d;)e=a(this.visibleItems.get(c)),e.attr("aria-selected","true"),c--}}else this.items.attr("aria-selected","false");b.attr("aria-selected","true"),this.triggerChange()},f.prototype.selectItem=function(a){for(var b=a.parent();"tree"!=b.attr("role");)b=b.parent(),"false"==b.attr("aria-expanded")&&this.expandGroup(b),b=b.parent();this.items.attr("aria-selected","false"),a.attr("aria-selected","true"),this.triggerChange()},f.prototype.toggleItem=function(a){if(!this.multiSelect)return void this.selectItem(a);var b=a.attr("aria-selected");b="true"===b?"false":"true",a.attr("aria-selected",b),this.triggerChange()},f.prototype.updateFocus=function(a){this.lastActiveItem=this.activeItem,this.activeItem=a;for(var b=a.parent();"tree"!=b.attr("role");)b=b.parent(),"false"==b.attr("aria-expanded")&&this.expandGroup(b),b=b.parent();this.items.attr("tabindex","-1"),a.attr("tabindex",0)},f.prototype.handleKeyDown=function(b,c){var d=this.visibleItems.index(b),e=null,f=c.shiftKey||c.ctrlKey||c.metaKey||c.altKey,g=this;switch(c.keyCode){case this.keys.home:return e=this.parents.first(),e.focus(),c.shiftKey?this.multiSelectItem(e):f||this.selectItem(e),c.stopPropagation(),!1;case this.keys.end:return e=this.visibleItems.last(),e.focus(),c.shiftKey?this.multiSelectItem(e):f||this.selectItem(e),c.stopPropagation(),!1;case this.keys.enter:case this.keys.space:return c.shiftKey?this.multiSelectItem(b):c.metaKey||c.ctrlKey?this.toggleItem(b):this.selectItem(b),c.stopPropagation(),!1;case this.keys.left:if(b.has("ul")&&"true"==b.attr("aria-expanded"))this.collapseGroup(b);else{var h=b.parent(),i=h.parent();i.is("li")&&(i.focus(),c.shiftKey?this.multiSelectItem(i):f||this.selectItem(i))}return c.stopPropagation(),!1;case this.keys.right:return b.has("ul")&&"false"==b.attr("aria-expanded")?this.expandGroup(b):(e=b.children("ul").children("li").first(),e.length>0&&(e.focus(),c.shiftKey?this.multiSelectItem(e):f||this.selectItem(e))),c.stopPropagation(),!1;case this.keys.up:if(d>0){var j=this.visibleItems.eq(d-1);j.focus(),c.shiftKey?this.multiSelectItem(j):f||this.selectItem(j)}return c.stopPropagation(),!1;case this.keys.down:if(d<this.visibleItems.length-1){var k=this.visibleItems.eq(d+1);k.focus(),c.shiftKey?this.multiSelectItem(k):f||this.selectItem(k)}return c.stopPropagation(),!1;case this.keys.asterisk:return this.parents.each(function(){g.expandGroup(a(this))}),c.stopPropagation(),!1;case this.keys.eight:return c.shiftKey&&(this.parents.each(function(){g.expandGroup(a(this))}),c.stopPropagation()),!1}return!0},f.prototype.handleKeyPress=function(a,b){if(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)return!0;switch(b.keyCode){case this.keys.tab:return!0;case this.keys.enter:case this.keys.home:case this.keys.end:case this.keys.left:case this.keys.right:case this.keys.up:case this.keys.down:return b.stopPropagation(),!1;default:var c=String.fromCharCode(b.which),d=!1,e=this.visibleItems.index(a),f=this.visibleItems.length,g=e+1;for(g==f&&(g=0);g!=e;){var h=this.visibleItems.eq(g),i=h.text().charAt(0);if(h.has("ul")&&(i=h.find("span").text().charAt(0)),i.toLowerCase()==c){d=!0;break}g+=1,g==f&&(g=0)}return d===!0&&this.updateFocus(this.visibleItems.eq(g)),b.stopPropagation(),!1}return!0},f.prototype.on=function(a,b){"selectionchanged"!==a?c.warning('Invalid custom event name for tree. Only "selectionchanged" is supported.'):this.treeRoot.on(a,b)},f.prototype.handleDblClick=function(a,b){return!!(b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)||(this.updateFocus(a),this.toggleGroup(a),b.stopPropagation(),!1)},f.prototype.handleExpandCollapseClick=function(a,b){return this.toggleGroup(a),b.stopPropagation(),!1},f.prototype.handleClick=function(a,b){return b.shiftKey?this.multiSelectItem(a):b.metaKey||b.ctrlKey?this.toggleItem(a):this.selectItem(a),this.updateFocus(a),b.stopPropagation(),!1},f.prototype.handleBlur=function(){return!0},f.prototype.handleFocus=function(a){return this.updateFocus(a),!0},f.prototype.bindEventHandlers=function(){var b=this;this.parents.dblclick(function(c){return b.handleDblClick(a(this),c)}),this.items.click(function(c){return b.handleClick(a(this),c)}),this.items.children("img").click(function(c){return b.handleExpandCollapseClick(a(this).parent(),c)}),this.items.keydown(function(c){return b.handleKeyDown(a(this),c)}),this.items.keypress(function(c){return b.handleKeyPress(a(this),c)}),this.items.focus(function(c){return b.handleFocus(a(this),c)}),this.items.blur(function(c){return b.handleBlur(a(this),c)})},f});
define('tool_lp/competencytree', ["core/ajax","core/notification","core/templates","tool_lp/tree","tool_lp/competency_outcomes","jquery"],function(a,b,c,d,e,f){var g={},h=0,i="",j="",k="",l=!1,m=function(a,b){var c=0,d=!1;for(a.haschildren=!1,a.children=[],c=0;c<b.length;c++)d=b[c],d.parentid==a.id&&(a.haschildren=!0,a.children.push(d),m(d,b))},n=function(b){var e=f.Deferred();return c.render("tool_lp/loading",{}).done(function(n,o){c.replaceNodeContents(f(j),n,o);var p=a.call([{methodname:"core_competency_search_competencies",args:{searchtext:b,competencyframeworkid:h}}]);p[0].done(function(a){g={};var b=0;for(b=0;b<a.length;b++)g[a[b].id]=a[b];var h=[],n=!1;for(b=0;b<a.length;b++)n=a[b],0===parseInt(n.parentid,10)&&(h.push(n),m(n,a));var o={shortname:i,canmanage:l,competencies:h};c.render("tool_lp/competencies_tree_root",o).done(function(a,b){c.replaceNodeContents(f(j),f(a).html(),b);var h=new d(j,(!1));if(k){var i=f(j).find("[data-id="+k+"]");i.length&&(h.selectItem(i),h.updateFocus(i))}e.resolve(g)}).fail(e.reject)}).fail(e.reject)}),e.promise()},o=function(a,b){var c=b.selected;k=c.attr("data-id")};return{init:function(a,c,d,e,f){h=a,i=c,l=f,j=e,n(d).fail(b.exception),this.on("selectionchanged",o)},on:function(a,b){f(j).on(a,b)},getChildren:function(a){var b=[];return f.each(g,function(c,d){d.parentid==a&&b.push(d)}),b},getCompetencyFrameworkId:function(){return h},getCompetency:function(a){return g[a]},getCompetencyLevel:function(a){var b=this.getCompetency(a),c=b.path.replace(/^\/|\/$/g,"").split("/").length;return c},hasChildren:function(a){return this.getChildren(a).length>0},hasRule:function(a){var b=this.getCompetency(a);return!!b&&(b.ruleoutcome!=e.OUTCOME_NONE&&b.ruletype)},reloadCompetencies:function(){return n("").fail(b.exception)},listCompetencies:function(){return g}}});
define('tool_lp/planactions', ["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/menubar","tool_lp/dialogue"],function(a,b,c,d,e,f,g){var h=function(a){if(this._type=a,"plan"===a)this._region='[data-region="plan-page"]',this._planNode='[data-region="plan-page"]',this._template="tool_lp/plan_page",this._contextMethod="tool_lp_data_for_plan_page";else{if("plans"!==a)throw new TypeError("Unexpected type.");this._region='[data-region="plans"]',this._planNode='[data-region="plan-node"]',this._template="tool_lp/plans_page",this._contextMethod="tool_lp_data_for_plans_page"}};return h.prototype._contextMethod=null,h.prototype._planNode=null,h.prototype._region=null,h.prototype._template=null,h.prototype._type=null,h.prototype._getContextArgs=function(a){var b=this,c={};return"plan"===b._type?c={planid:a.id}:"plans"===b._type&&(c={userid:a.userid}),c},h.prototype.refresh=function(b){var c=this._findPlanData(a(b));this._callAndRefresh([],c)},h.prototype._renderView=function(c){var d=this;return b.render(d._template,c).then(function(c,e){a(d._region).replaceWith(c),b.runTemplateJS(e)})},h.prototype._callAndRefresh=function(b,e){var f="tool_lp/planactions:_callAndRefresh-"+Math.floor(Math.random()*Math.floor(1e3));M.util.js_pending(f);var g=this;return b.push({methodname:g._contextMethod,args:g._getContextArgs(e)}),a.when.apply(a,c.call(b)).then(function(){return g._renderView(arguments[arguments.length-1])}).fail(d.exception).always(function(){return M.util.js_complete(f)})},h.prototype._doDelete=function(a){var b=this,c=[{methodname:"core_competency_delete_plan",args:{id:a.id}}];b._callAndRefresh(c,a)},h.prototype.deletePlan=function(a){var b,f=this;b=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]),b[0].done(function(b){e.get_strings([{key:"confirm",component:"moodle"},{key:"deleteplan",component:"tool_lp",param:b.name},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(b){d.confirm(b[0],b[1],b[2],b[3],function(){f._doDelete(a)})}).fail(d.exception)}).fail(d.exception)},h.prototype._doReopenPlan=function(a){var b=this,c=[{methodname:"core_competency_reopen_plan",args:{planid:a.id}}];b._callAndRefresh(c,a)},h.prototype.reopenPlan=function(a){var b=this,f=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"reopenplanconfirm",component:"tool_lp",param:c.name},{key:"reopenplan",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doReopenPlan(a)})}).fail(d.exception)}).fail(d.exception)},h.prototype._doCompletePlan=function(a){var b=this,c=[{methodname:"core_competency_complete_plan",args:{planid:a.id}}];b._callAndRefresh(c,a)},h.prototype.completePlan=function(a){var b=this,f=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"completeplanconfirm",component:"tool_lp",param:c.name},{key:"completeplan",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doCompletePlan(a)})}).fail(d.exception)}).fail(d.exception)},h.prototype._doUnlinkPlan=function(a){var b=this,c=[{methodname:"core_competency_unlink_plan_from_template",args:{planid:a.id}}];b._callAndRefresh(c,a)},h.prototype.unlinkPlan=function(a){var b=this,f=c.call([{methodname:"core_competency_read_plan",args:{id:a.id}}]);f[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:"unlinkplantemplateconfirm",component:"tool_lp",param:c.name},{key:"unlinkplantemplate",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(c){d.confirm(c[0],c[1],c[2],c[3],function(){b._doUnlinkPlan(a)})}).fail(d.exception)}).fail(d.exception)},h.prototype._doRequestReview=function(a){var b=[{methodname:"core_competency_plan_request_review",args:{id:a.id}}];this._callAndRefresh(b,a)},h.prototype.requestReview=function(a){this._doRequestReview(a)},h.prototype._doCancelReviewRequest=function(a){var b=[{methodname:"core_competency_plan_cancel_review_request",args:{id:a.id}}];this._callAndRefresh(b,a)},h.prototype.cancelReviewRequest=function(a){this._doCancelReviewRequest(a)},h.prototype._doStartReview=function(a){var b=[{methodname:"core_competency_plan_start_review",args:{id:a.id}}];this._callAndRefresh(b,a)},h.prototype.startReview=function(a){this._doStartReview(a)},h.prototype._doStopReview=function(a){var b=[{methodname:"core_competency_plan_stop_review",args:{id:a.id}}];this._callAndRefresh(b,a)},h.prototype.stopReview=function(a){this._doStopReview(a)},h.prototype._doApprove=function(a){var b=[{methodname:"core_competency_approve_plan",args:{id:a.id}}];this._callAndRefresh(b,a)},h.prototype.approve=function(a){this._doApprove(a)},h.prototype._doUnapprove=function(a){var b=[{methodname:"core_competency_unapprove_plan",args:{id:a.id}}];this._callAndRefresh(b,a)},h.prototype.unapprove=function(a){this._doUnapprove(a)},h.prototype._showLinkedCoursesHandler=function(f){f.preventDefault();var h=a(f.target).data("id"),i=c.call([{methodname:"tool_lp_list_courses_using_competency",args:{id:h}}]);i[0].done(function(a){var c={courses:a};b.render("tool_lp/linked_courses_summary",c).done(function(a){e.get_string("linkedcourses","tool_lp").done(function(b){new g(b,a)}).fail(d.exception)}).fail(d.exception)}).fail(d.exception)},h.prototype._eventHandler=function(b,c){c.preventDefault();var d=this._findPlanData(a(c.target));this[b](d)},h.prototype._findPlanData=function(b){var c,d=b.parentsUntil(a(this._region).parent(),this._planNode);if(1!=d.length)throw new Error("The plan node was not located.");if(c=d.data(),"undefined"==typeof c||"undefined"==typeof c.id)throw new Error("Plan data could not be found.");return c},h.prototype.enhanceMenubar=function(a){f.enhance(a,{'[data-action="plan-delete"]':this._eventHandler.bind(this,"deletePlan"),'[data-action="plan-complete"]':this._eventHandler.bind(this,"completePlan"),'[data-action="plan-reopen"]':this._eventHandler.bind(this,"reopenPlan"),'[data-action="plan-unlink"]':this._eventHandler.bind(this,"unlinkPlan"),'[data-action="plan-request-review"]':this._eventHandler.bind(this,"requestReview"),'[data-action="plan-cancel-review-request"]':this._eventHandler.bind(this,"cancelReviewRequest"),'[data-action="plan-start-review"]':this._eventHandler.bind(this,"startReview"),'[data-action="plan-stop-review"]':this._eventHandler.bind(this,"stopReview"),'[data-action="plan-approve"]':this._eventHandler.bind(this,"approve"),'[data-action="plan-unapprove"]':this._eventHandler.bind(this,"unapprove")})},h.prototype.registerEvents=function(){var b=a(this._region);b.find('[data-action="plan-delete"]').click(this._eventHandler.bind(this,"deletePlan")),b.find('[data-action="plan-complete"]').click(this._eventHandler.bind(this,"completePlan")),b.find('[data-action="plan-reopen"]').click(this._eventHandler.bind(this,"reopenPlan")),b.find('[data-action="plan-unlink"]').click(this._eventHandler.bind(this,"unlinkPlan")),b.find('[data-action="plan-request-review"]').click(this._eventHandler.bind(this,"requestReview")),b.find('[data-action="plan-cancel-review-request"]').click(this._eventHandler.bind(this,"cancelReviewRequest")),b.find('[data-action="plan-start-review"]').click(this._eventHandler.bind(this,"startReview")),b.find('[data-action="plan-stop-review"]').click(this._eventHandler.bind(this,"stopReview")),b.find('[data-action="plan-approve"]').click(this._eventHandler.bind(this,"approve")),b.find('[data-action="plan-unapprove"]').click(this._eventHandler.bind(this,"unapprove")),b.find('[data-action="find-courses-link"]').click(this._showLinkedCoursesHandler.bind(this))},h});
define('tool_lp/grade_user_competency_inline', ["jquery","core/notification","core/ajax","core/log","tool_lp/grade_dialogue","tool_lp/event_base","tool_lp/scalevalues"],function(a,b,c,d,e,f,g){var h=function(b,c,d,e,g,h,i){f.prototype.constructor.apply(this,[]);var j=a(b);if(!j.length)throw new Error("Could not find the trigger");this._scaleId=c,this._competencyId=d,this._userId=e,this._planId=g,this._courseId=h,this._chooseStr=i,this._setUp(),j.click(function(a){a.preventDefault(),this._dialogue.display()}.bind(this)),this._planId?(this._methodName="core_competency_grade_competency_in_plan",this._args={competencyid:this._competencyId,planid:this._planId}):this._courseId?(this._methodName="core_competency_grade_competency_in_course",this._args={competencyid:this._competencyId,courseid:this._courseId,userid:this._userId}):(this._methodName="core_competency_grade_competency",this._args={userid:this._userId,competencyid:this._competencyId})};return h.prototype=Object.create(f.prototype),h.prototype._setUp=function(){var a=[],d=this;M.util.js_pending("tool_lp/grade_user_competency_inline:_setUp");var f=g.get_values(d._scaleId);f.then(function(b){a.push({value:"",name:d._chooseStr});for(var c=0;c<b.length;c++){var e=b[c];a.push({value:e.id,name:e.name})}return a}).then(function(a){return new e(a)}).then(function(a){return a.on("rated",function(a,e){var f=d._args;f.grade=e.rating,f.note=e.note,c.call([{methodname:d._methodName,args:f,done:function(a){d._trigger("competencyupdated",{args:f,evidence:a})},fail:b.exception}])}),a}).then(function(a){d._dialogue=a,M.util.js_complete("tool_lp/grade_user_competency_inline:_setUp")}).fail(b.exception)},h.prototype._scaleId=null,h.prototype._competencyId=null,h.prototype._userId=null,h.prototype._planId=null,h.prototype._courseId=null,h.prototype._chooseStr=null,h.prototype._dialogue=null,h});
define('tool_lp/menubar', ["jquery"],function(a){var b=!1,c=!1,d=function(){a(".tool-lp-menu .tool-lp-sub-menu").attr("aria-hidden","true"),c=!1},e=function(a,b){this.menuRoot=a,this.handlers=b,this.rootMenus=this.menuRoot.children("li"),this.subMenus=this.rootMenus.children("ul"),this.subMenuItems=this.subMenus.children("li"),this.allItems=this.rootMenus.add(this.subMenuItems),this.activeItem=null,this.isChildOpen=!1,this.keys={tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40},this.addAriaAttributes(),this.addEventListeners()};return e.prototype.openSubMenu=function(a){this.setOpenDirection(),d(),a.attr("aria-hidden","false"),c=!0},e.prototype.addEventListeners=function(){var e=this;b===!1&&(a(document).click(function(){c&&d()}),b=!0),this.subMenuItems.mouseenter(function(){return a(this).addClass("menu-hover"),!0}),this.subMenuItems.mouseout(function(){return a(this).removeClass("menu-hover"),!0}),this.allItems.click(function(b){return e.handleClick(a(this),b)}),this.allItems.keydown(function(b){return e.handleKeyDown(a(this),b)}),this.allItems.focus(function(){return e.handleFocus(a(this))}),this.allItems.blur(function(){return e.handleBlur(a(this))})},e.prototype.handleClick=function(b,c){c.stopPropagation();var d=b.parent();if(d.is(".tool-lp-menu"))"true"==b.children("ul").first().attr("aria-hidden")?this.openSubMenu(b.children("ul").first()):b.children("ul").first().attr("aria-hidden","true");else{this.allItems.removeClass("menu-hover menu-focus"),this.activeItem=null,this.menuRoot.find("ul").not(".root-level").attr("aria-hidden","true");var e=b.find("a").first(),f=new a.Event("click");f.target=e;var g=!1;this.handlers&&a.each(this.handlers,function(c,d){if(!g&&b.find(c).length>0){var h=a.proxy(d,e);g=h(f)===!1||f.isDefaultPrevented()}}),g||"#"===e.attr("href")||(window.location.href=e.attr("href"))}return!1},e.prototype.handleFocus=function(a){if(null===this.activeItem)this.activeItem=a;else if(a[0]!=this.activeItem[0])return!0;var b=this.activeItem.parentsUntil("ul.tool-lp-menu").filter("li");if(this.allItems.removeClass("menu-focus"),this.activeItem.addClass("menu-focus"),b.addClass("menu-focus"),this.isChildOpen===!0){var c=a.parent();c.is(".tool-lp-menu")&&"true"==a.attr("aria-haspopup")&&this.openSubMenu(a.children("ul").first())}return!0},e.prototype.handleBlur=function(a){return a.removeClass("menu-focus"),!0},e.prototype.setOpenDirection=function(){var b=this.menuRoot.offset(),c=a(document.body).hasClass("dir-rtl"),d=!0,e=this.rootMenus.outerHeight(),f=this.rootMenus.outerWidth(),g=this.rootMenus.find("ul.tool-lp-sub-menu");g.css("margin-right",""),g.css("margin-left",""),g.css("margin-top",""),g.attr("aria-hidden",!1);var h=g.outerWidth(),i=g.outerHeight(),j=null,k=null,l=null,m=b.top-a(window).scrollTop();m+i>a(window).height()&&(j=i+e,g.css("margin-top","-"+j+"px")),c?b.left-h<0&&(k=h-f,g.css("margin-right","-"+k+"px")):b.left+h>a(window).width()&&(l=h-f,g.css("margin-left","-"+l+"px")),d?this.menuRoot.addClass("tool-lp-menu-open-left"):this.menuRoot.removeClass("tool-lp-menu-open-left")},e.prototype.handleKeyDown=function(a,b){if(b.altKey||b.ctrlKey)return!0;switch(b.keyCode){case this.keys.tab:this.menuRoot.find("ul").attr("aria-hidden","true"),this.allItems.removeClass("menu-focus"),this.activeItem=null,this.isChildOpen=!1;break;case this.keys.esc:var c=a.parent();return c.is(".tool-lp-menu")?a.children("ul").first().attr("aria-hidden","true"):(this.activeItem=c.parent(),this.isChildOpen=!1,this.activeItem.focus(),c.attr("aria-hidden","true")),b.stopPropagation(),!1;case this.keys.enter:case this.keys.space:return this.handleClick(a,b);case this.keys.left:return this.activeItem=this.moveToPrevious(a),this.activeItem.focus(),b.stopPropagation(),!1;case this.keys.right:return this.activeItem=this.moveToNext(a),this.activeItem.focus(),b.stopPropagation(),!1;case this.keys.up:return this.activeItem=this.moveUp(a),this.activeItem.focus(),b.stopPropagation(),!1;case this.keys.down:return this.activeItem=this.moveDown(a),this.activeItem.focus(),b.stopPropagation(),!1}return!0},e.prototype.moveToNext=function(a){var b=a.parent(),c=b.children("li"),d=c.length,e=c.index(a),f=null,g=null;if(b.is(".tool-lp-menu"))f=e<d-1?a.next():c.first(),"true"==a.attr("aria-haspopup")&&(g=a.children("ul").first(),"false"==g.attr("aria-hidden")&&(g.attr("aria-hidden","true"),this.isChildOpen=!0)),a.removeClass("menu-focus"),"true"===f.attr("aria-haspopup")&&this.isChildOpen===!0&&(g=f.children("ul").first(),this.openSubMenu(g));else if("true"==a.attr("aria-haspopup"))g=a.children("ul").first(),f=g.children("li").first(),this.openSubMenu(g);else{var h=null,i=null;h=a.parentsUntil("ul.tool-lp-menu").filter("ul").not(".tool-lp-menu"),h.attr("aria-hidden","true"),h.find("li").removeClass("menu-focus"),h.last().parent().removeClass("menu-focus"),i=h.last().parent(),e=this.rootMenus.index(i),f=e<this.rootMenus.length-1?i.next():this.rootMenus.first(),f.addClass("menu-focus"),"true"==f.attr("aria-haspopup")&&(g=f.children("ul").first(),f=g.children("li").first(),this.openSubMenu(g),this.isChildOpen=!0)}return f},e.prototype.moveToPrevious=function(a){var b=a.parent(),c=b.children("li"),d=c.index(a),e=null,f=null;if(b.is(".tool-lp-menu"))e=d>0?a.prev():c.last(),"true"==a.attr("aria-haspopup")&&(f=a.children("ul").first(),"false"==f.attr("aria-hidden")&&(f.attr("aria-hidden","true"),this.isChildOpen=!0)),a.removeClass("menu-focus"),"true"===e.attr("aria-haspopup")&&this.isChildOpen===!0&&(f=e.children("ul").first(),this.openSubMenu(f));else{var g=b.parent(),h=g.parent();h.is(".tool-lp-menu")?(b.attr("aria-hidden","true"),a.removeClass("menu-focus"),g.removeClass("menu-focus"),d=this.rootMenus.index(g),e=d>0?g.prev():this.rootMenus.last(),e.addClass("menu-focus"),"true"==e.attr("aria-haspopup")&&(f=e.children("ul").first(),this.openSubMenu(f),this.isChildOpen=!0,e=f.children("li").first())):(e=b.parent(),b.attr("aria-hidden","true"),a.removeClass("menu-focus"))}return e},e.prototype.moveDown=function(a,b){var c=a.parent(),d=c.children("li").not(".separator"),e=d.length,f=d.index(a),g=null,h=null;if(c.is(".tool-lp-menu"))return"true"!=a.attr("aria-haspopup")?a:(h=a.children("ul").first(),g=h.children("li").first(),this.openSubMenu(h),g);if(b){var i=!1,j=f+1;for(j==e&&(j=0);j!=f;){var k=d.eq(j).html().charAt(0);if(k.toLowerCase()==b){i=!0;break}j+=1,j==e&&(j=0)}return i===!0?(g=d.eq(j),a.removeClass("menu-focus"),g):a}return g=f<e-1?d.eq(f+1):d.first(),a.removeClass("menu-focus"),g},e.prototype.moveUp=function(a){var b=a.parent(),c=b.children("li").not(".separator"),d=c.index(a),e=null;return b.is(".tool-lp-menu")?a:(e=d>0?c.eq(d-1):c.last(),a.removeClass("menu-focus"),e)},e.prototype.addAriaAttributes=function(){this.menuRoot.attr("role","menubar"),this.rootMenus.attr("role","menuitem"),this.rootMenus.attr("tabindex","0"),this.rootMenus.attr("aria-haspopup","true"),this.subMenus.attr("role","menu"),this.subMenus.attr("aria-hidden","true"),this.subMenuItems.attr("role","menuitem"),this.subMenuItems.attr("tabindex","-1"),this.menuRoot.addClass("tool-lp-menu"),this.allItems.addClass("tool-lp-menu-item"),this.rootMenus.addClass("tool-lp-root-menu"),this.subMenus.addClass("tool-lp-sub-menu"),this.subMenuItems.addClass("dropdown-item")},{enhance:function(b,c){a(b).each(function(b,d){var f=a(d);f.data("menubarEnhanced")!==!0&&(new e(f,c),f.data("menubarEnhanced",!0))})},closeAll:d}});
define('tool_lp/scaleconfig', ["jquery","core/notification","core/templates","core/ajax","tool_lp/dialogue","tool_lp/scalevalues"],function(a,b,c,d,e,f){var g=function(b,c,d){this.selectSelector=b,this.inputSelector=c,this.triggerSelector=d,this.originalscaleid=a(b).val(),a(b).on("change",this.scaleChangeHandler.bind(this)).change(),a(d).click(this.showConfig.bind(this))};return g.prototype.selectSelector=null,g.prototype.inputSelector=null,g.prototype.triggerSelector=null,g.prototype.scalevalues=null,g.prototype.originalscaleid=0,g.prototype.scaleid=0,g.prototype.popup=null,g.prototype.showConfig=function(){var d=this;if(this.scaleid=a(this.selectSelector).val(),!(this.scaleid<=0)){var f=a(this.selectSelector).find("option:selected").text();this.getScaleValues(this.scaleid).done(function(){var a={scalename:f,scales:d.scalevalues};c.render("tool_lp/scale_configuration_page",a).done(function(a){new e(f,a,d.initScaleConfig.bind(d))}).fail(b.exception)}).fail(b.exception)}},g.prototype.retrieveOriginalScaleConfig=function(){var b=a(this.inputSelector).val();if(""!==b){var c=a.parseJSON(b),d=c.shift();if(d.scaleid===this.originalscaleid)return c}return""},g.prototype.initScaleConfig=function(b){this.popup=b;var c=a(b.getContent());if(this.originalscaleid===this.scaleid){var d=this.retrieveOriginalScaleConfig();""!==d&&d.forEach(function(a){1===a.scaledefault&&c.find('[data-field="tool_lp_scale_default_'+a.id+'"]').attr("checked",!0),1===a.proficient&&c.find('[data-field="tool_lp_scale_proficient_'+a.id+'"]').attr("checked",!0)})}c.on("click",'[data-action="close"]',function(){this.setScaleConfig(),b.close()}.bind(this)),c.on("click",'[data-action="cancel"]',function(){b.close()})},g.prototype.setScaleConfig=function(){var b=a(this.popup.getContent()),c=[{scaleid:this.scaleid}];this.scalevalues.forEach(function(a){var d=0,e=0;b.find('[data-field="tool_lp_scale_default_'+a.id+'"]').is(":checked")&&(d=1),b.find('[data-field="tool_lp_scale_proficient_'+a.id+'"]').is(":checked")&&(e=1),(d||e)&&c.push({id:a.id,scaledefault:d,proficient:e})});var d=JSON.stringify(c);a(this.inputSelector).val(d),this.originalscaleid=this.scaleid},g.prototype.getScaleValues=function(a){return f.get_values(a).then(function(a){return this.scalevalues=a,a}.bind(this))},g.prototype.scaleChangeHandler=function(b){a(b.target).val()<=0?a(this.triggerSelector).prop("disabled",!0):a(this.triggerSelector).prop("disabled",!1)},{init:function(a,b,c){return new g(a,b,c)}}});
define('tool_lp/user_competency_info', ["jquery","core/notification","core/ajax","core/templates"],function(a,b,c,d){var e=function(a,b,c,d,e,f){this._rootElement=a,this._competencyId=b,this._userId=c,this._planId=d,this._courseId=e,this._valid=!0,this._displayuser="undefined"!=typeof f&&f,this._planId?(this._methodName="tool_lp_data_for_user_competency_summary_in_plan",this._args={competencyid:this._competencyId,planid:this._planId},this._templateName="tool_lp/user_competency_summary_in_plan"):this._courseId?(this._methodName="tool_lp_data_for_user_competency_summary_in_course",this._args={userid:this._userId,competencyid:this._competencyId,courseid:this._courseId},this._templateName="tool_lp/user_competency_summary_in_course"):(this._methodName="tool_lp_data_for_user_competency_summary",this._args={userid:this._userId,competencyid:this._competencyId},this._templateName="tool_lp/user_competency_summary")};return e.prototype.reload=function(){var a=this,e=[];this._valid&&(e=c.call([{methodname:this._methodName,args:this._args}]),e[0].done(function(c){a._displayuser&&(c.displayuser=!0),d.render(a._templateName,c).done(function(b,c){d.replaceNode(a._rootElement,b,c)}).fail(b.exception)}).fail(b.exception))},e.prototype._rootElement=null,e.prototype._courseId=null,e.prototype._valid=null,e.prototype._planId=null,e.prototype._competencyId=null,e.prototype._userId=null,e.prototype._methodName=null,e.prototype._args=null,e.prototype._templateName=null,e.prototype._displayuser=!1,e});
define('tool_lp/user_competency_workflow', ["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/menubar","tool_lp/event_base"],function(a,b,c,d,e,f,g){var h=function(){g.prototype.constructor.apply(this,[])};return h.prototype=Object.create(g.prototype),h.prototype._nodeSelector='[data-node="user-competency"]',h.prototype._cancelReviewRequest=function(a){var b={methodname:"core_competency_user_competency_cancel_review_request",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-request-cancelled",a),this._trigger("status-changed",a)}.bind(this))["catch"](function(){this._trigger("error-occured",a)}.bind(this))},h.prototype.cancelReviewRequest=function(a){this._cancelReviewRequest(a)},h.prototype._cancelReviewRequestHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.cancelReviewRequest(c)},h.prototype._requestReview=function(a){var b={methodname:"core_competency_user_competency_request_review",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-requested",a),this._trigger("status-changed",a)}.bind(this))["catch"](function(){this._trigger("error-occured",a)}.bind(this))},h.prototype.requestReview=function(a){this._requestReview(a)},h.prototype._requestReviewHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.requestReview(c)},h.prototype._startReview=function(a){var b={methodname:"core_competency_user_competency_start_review",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-started",a),this._trigger("status-changed",a)}.bind(this))["catch"](function(){this._trigger("error-occured",a)}.bind(this))},h.prototype.startReview=function(a){this._startReview(a)},h.prototype._startReviewHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.startReview(c)},h.prototype._stopReview=function(a){var b={methodname:"core_competency_user_competency_stop_review",args:{userid:a.userid,competencyid:a.competencyid}};c.call([b])[0].then(function(){this._trigger("review-stopped",a),this._trigger("status-changed",a)}.bind(this))["catch"](function(){this._trigger("error-occured",a)}.bind(this))},h.prototype.stopReview=function(a){this._stopReview(a)},h.prototype._stopReviewHandler=function(b){b.preventDefault();var c=this._findUserCompetencyData(a(b.target));this.stopReview(c)},h.prototype.enhanceMenubar=function(a){f.enhance(a,{'[data-action="request-review"]':this._requestReviewHandler.bind(this),'[data-action="cancel-review-request"]':this._cancelReviewRequestHandler.bind(this)})},h.prototype._findUserCompetencyData=function(a){var b,c=a.parents(this._nodeSelector);if(1!=c.length)throw new Error("The evidence node was not located.");if(b=c.data(),"undefined"==typeof b||"undefined"==typeof b.userid||"undefined"==typeof b.competencyid)throw new Error("User competency data could not be found.");return b},h.prototype.enhanceMenubar=function(a){f.enhance(a,{'[data-action="request-review"]':this._requestReviewHandler.bind(this),'[data-action="cancel-review-request"]':this._cancelReviewRequestHandler.bind(this),'[data-action="start-review"]':this._startReviewHandler.bind(this),'[data-action="stop-review"]':this._stopReviewHandler.bind(this)})},h.prototype.registerEvents=function(b){var c=a(b);c.find('[data-action="request-review"]').click(this._requestReviewHandler.bind(this)),c.find('[data-action="cancel-review-request"]').click(this._cancelReviewRequestHandler.bind(this)),c.find('[data-action="start-review"]').click(this._startReviewHandler.bind(this)),c.find('[data-action="stop-review"]').click(this._stopReviewHandler.bind(this))},h});
define('tool_lp/form-cohort-selector', ["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.id,label:b._label})}),d},transport:function(d,e,f,g){var h,i=parseInt(a(d).data("contextid"),10),j=a(d).data("includes");h=b.call([{methodname:"tool_lp_search_cohorts",args:{query:e,context:{contextid:i},includes:j}}]),h[0].then(function(b){var d=[],e=0;return a.each(b.cohorts,function(a,b){d.push(c.render("tool_lp/form-cohort-selector-suggestion",b))}),a.when.apply(a.when,d).then(function(){var c=arguments;a.each(b.cohorts,function(a,b){b._label=c[e],e++}),f(b.cohorts)})})["catch"](g)}}});
define('tool_lp/competencyruleconfig', ["jquery","core/notification","core/templates","tool_lp/dialogue","tool_lp/competency_outcomes","core/str"],function(a,b,c,d,e,f){var g=function(b,c){this._eventNode=a("<div></div>"),this._tree=b,this._rulesModules=c,this._setUp()};return g.prototype._competency=null,g.prototype._eventNode=null,g.prototype._outcomesOption=null,g.prototype._popup=null,g.prototype._ready=null,g.prototype._rules=null,g.prototype._rulesModules=null,g.prototype._tree=null,g.prototype._afterChange=function(){this._isValid()?this._find('[data-action="save"]').prop("disabled",!1):this._find('[data-action="save"]').prop("disabled",!0)},g.prototype._afterRuleConfigChange=function(a,b){b==this._getRule()&&this._afterChange()},g.prototype._afterRender=function(){var a=this;a._find('[name="outcome"]').on("change",function(){a._switchedOutcome()}).trigger("change"),a._find('[name="rule"]').on("change",function(){a._switchedRule()}).trigger("change"),a._find('[data-action="save"]').on("click",function(){a._trigger("save",a._getConfig()),a.close()}),a._find('[data-action="cancel"]').on("click",function(){a.close()})},g.prototype.canBeConfigured=function(){var b=!1;return a.each(this._rules,function(a,c){if(c.canConfig())return void(b=!0)}),b},g.prototype.close=function(){this._popup.close(),this._popup=null},g.prototype.display=function(){var c=this;return!!c._competency&&a.when(f.get_string("competencyrule","tool_lp"),c._render()).then(function(a,b){c._popup=new d(a,b[0],c._afterRender.bind(c))}).fail(b.exception)},g.prototype._find=function(b){return a(this._popup.getContent()).find(b)},g.prototype._getApplicableOutcomesOptions=function(){var b=this,c=[];return a.each(b._outcomesOption,function(a,d){c.push({code:d.code,name:d.name,selected:d.code==b._competency.ruleoutcome})}),c},g.prototype._getApplicableRulesOptions=function(){var b=this,c=[];return a.each(b._rules,function(a,d){d.canConfig()&&c.push({name:b._getRuleName(d.getType()),type:d.getType(),selected:d.getType()==b._competency.ruletype})}),c},g.prototype._getConfig=function(){var a=this._getRule();return{ruletype:a?a.getType():null,ruleconfig:a?a.getConfig():null,ruleoutcome:this._getOutcome()}},g.prototype._getOutcome=function(){return this._find('[name="outcome"]').val()},g.prototype._getRule=function(){var b,c=this._find('[name="rule"]').val();return a.each(this._rules,function(a,d){if(d.getType()==c)return void(b=d)}),b},g.prototype._getRuleName=function(b){var c,d=this;return a.each(d._rulesModules,function(a,d){if(d.type==b)return void(c=d.name)}),c},g.prototype._initOutcomes=function(){var a=this;return e.getAll().then(function(b){a._outcomesOption=b})},g.prototype._initRules=function(){var b=this,c=[];return a.each(b._rules,function(d,e){var f=e.init().then(function(){e.setTargetCompetency(b._competency),e.on("change",b._afterRuleConfigChange.bind(b))},function(){return b._rules.splice(d,1),a.when()});c.push(f)}),a.when.apply(a.when,c)},g.prototype._isValid=function(){var a=this._getOutcome(),b=this._getRule();return a==e.NONE||!!b&&b.isValid()},g.prototype.on=function(a,b){this._eventNode.on(a,b)},g.prototype._preRender=function(){return this.ready()},g.prototype.ready=function(){return this._ready.promise()},g.prototype._render=function(){var a=this;return this._preRender().then(function(){var b;a.canBeConfigured()?(b={},b.outcomes=a._getApplicableOutcomesOptions(),b.rules=a._getApplicableRulesOptions()):b=!1;var d={competencyshortname:a._competency.shortname,config:b};return c.render("tool_lp/competency_rule_config",d)})},g.prototype.setTargetCompetencyId=function(b){var c=this;c._competency=c._tree.getCompetency(b),a.each(c._rules,function(a,b){b.setTargetCompetency(c._competency)})},g.prototype._setUp=function(){var b=this,c=[],d=[];b._ready=a.Deferred(),b._rules=[],a.each(b._rulesModules,function(a,b){d.push(b.amd)}),require(d,function(){a.each(arguments,function(a,c){var d=new c(b._tree);b._rules.push(d)}),c.push(b._initRules()),c.push(b._initOutcomes()),a.when.apply(a.when,c).always(function(){b._ready.resolve()})})},g.prototype._switchedOutcome=function(){var a=this,b=a._getOutcome();return b==e.NONE?(a._find('[data-region="rule-type"]').hide().find('[name="rule"]').val(-1),a._find('[data-region="rule-config"]').empty().hide(),void a._afterChange()):(a._find('[data-region="rule-type"]').show(),a._find('[data-region="rule-config"]').show(),void a._afterChange())},g.prototype._switchedRule=function(){var a=this,b=a._find('[data-region="rule-config"]'),c=a._getRule();return c?void c.injectTemplate(b).then(function(){b.show()}).always(function(){a._afterChange()})["catch"](function(){b.empty().hide()}):(b.empty().hide(),void a._afterChange())},g.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])},g});
define('tool_lp/frameworks_datasource', ["jquery","core/ajax","core/notification"],function(a,b,c){return{list:function(c,d){var e={context:{contextid:c}};return a.extend(e,"undefined"==typeof d?{}:d),b.call([{methodname:"core_competency_list_competency_frameworks",args:e}])[0]},processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.id,label:b.shortname+" "+b.idnumber})}),d},transport:function(b,d,e){var f=a(b),g=f.data("contextid"),h=f.data("onlyvisible");if(!g)throw new Error("The attribute data-contextid is required on "+b);this.list(g,{query:d,onlyvisible:h}).then(e)["catch"](c.exception)}}});
define('tool_lp/competencies', ["jquery","core/notification","core/ajax","core/templates","core/str","tool_lp/competencypicker","tool_lp/dragdrop-reorder","core/pending"],function(a,b,c,d,e,f,g,h){var i=function(b,c,d){this.itemid=b,this.itemtype=c,this.pageContextId=d,this.pickerInstance=null,a('[data-region="actions"] button').prop("disabled",!1),this.registerEvents(),this.registerDragDrop()};return i.prototype.registerDragDrop=function(){var a=this;e.get_string("movecompetency","tool_lp").done(function(b){g.dragdrop("movecompetency",b,{identifier:"movecompetency",component:"tool_lp"},{identifier:"movecompetencyafter",component:"tool_lp"},"drag-samenode","drag-parentnode","drag-handlecontainer",function(b,c){a.handleDrop(b,c)})}).fail(b.exception)},i.prototype.handleDrop=function(d,e){var f=a(d).data("id"),g=a(e).data("id"),h=this,i=[];if("course"==h.itemtype)i=c.call([{methodname:"core_competency_reorder_course_competency",args:{courseid:h.itemid,competencyidfrom:f,competencyidto:g}}]);else if("template"==h.itemtype)i=c.call([{methodname:"core_competency_reorder_template_competency",args:{templateid:h.itemid,competencyidfrom:f,competencyidto:g}}]);else{if("plan"!=h.itemtype)return;i=c.call([{methodname:"core_competency_reorder_plan_competency",args:{planid:h.itemid,competencyidfrom:f,competencyidto:g}}])}i[0].fail(b.exception)},i.prototype.pickCompetency=function(){var e,g,i,j,k=this;return k.pickerInstance||("template"!==k.itemtype&&"course"!==k.itemtype||(j="parents"),k.pickerInstance=new f(k.pageContextId,(!1),j),k.pickerInstance.on("save",function(f,j){var l=j.competencyIds,m=new h;"course"===k.itemtype?(e=[],a.each(l,function(a,b){e.push({methodname:"core_competency_add_competency_to_course",args:{courseid:k.itemid,competencyid:b}})}),e.push({methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:k.itemid}}),g="tool_lp/course_competencies_page",i="coursecompetenciespage"):"template"===k.itemtype?(e=[],a.each(l,function(a,b){e.push({methodname:"core_competency_add_competency_to_template",args:{templateid:k.itemid,competencyid:b}})}),e.push({methodname:"tool_lp_data_for_template_competencies_page",args:{templateid:k.itemid,pagecontext:{contextid:k.pageContextId}}}),g="tool_lp/template_competencies_page",i="templatecompetenciespage"):"plan"===k.itemtype&&(e=[],a.each(l,function(a,b){e.push({methodname:"core_competency_add_competency_to_plan",args:{planid:k.itemid,competencyid:b}})}),e.push({methodname:"tool_lp_data_for_plan_page",args:{planid:k.itemid}}),g="tool_lp/plan_page",i="plan-page"),c.call(e)[e.length-1].then(function(a){return d.render(g,a)}).then(function(b,c){d.replaceNode(a('[data-region="'+i+'"]'),b,c)}).then(m.resolve)["catch"](b.exception)})),k.pickerInstance.display()},i.prototype.doDelete=function(e){var f=this,g=[],h="",i="";"course"==f.itemtype?(g=c.call([{methodname:"core_competency_remove_competency_from_course",args:{courseid:f.itemid,competencyid:e}},{methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:f.itemid}}]),h="tool_lp/course_competencies_page",i="coursecompetenciespage"):"template"==f.itemtype?(g=c.call([{methodname:"core_competency_remove_competency_from_template",args:{templateid:f.itemid,competencyid:e}},{methodname:"tool_lp_data_for_template_competencies_page",args:{templateid:f.itemid,pagecontext:{contextid:f.pageContextId}}}]),h="tool_lp/template_competencies_page",i="templatecompetenciespage"):"plan"==f.itemtype&&(g=c.call([{methodname:"core_competency_remove_competency_from_plan",args:{planid:f.itemid,competencyid:e}},{methodname:"tool_lp_data_for_plan_page",args:{planid:f.itemid}}]),h="tool_lp/plan_page",i="plan-page"),g[1].done(function(c){d.render(h,c).done(function(b,c){a('[data-region="'+i+'"]').replaceWith(b),d.runTemplateJS(c)}).fail(b.exception)}).fail(b.exception)},i.prototype.deleteHandler=function(a){var d,f=this,g=[];if("course"==f.itemtype)d="unlinkcompetencycourse";else if("template"==f.itemtype)d="unlinkcompetencytemplate";else{if("plan"!=f.itemtype)return;d="unlinkcompetencyplan"}g=c.call([{methodname:"core_competency_read_competency",args:{id:a}}]),g[0].done(function(c){e.get_strings([{key:"confirm",component:"moodle"},{key:d,component:"tool_lp",param:c.shortname},{key:"confirm",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(c){b.confirm(c[0],c[1],c[2],c[3],function(){f.doDelete(a)})}).fail(b.exception)}).fail(b.exception)},i.prototype.registerEvents=function(){var e=this;"course"==e.itemtype&&a('[data-region="coursecompetenciespage"]').on("change",'select[data-field="ruleoutcome"]',function(f){var g=new h,i=[],j="tool_lp/course_competencies_page",k="coursecompetenciespage",l=a(f.target).data("id"),m=a(f.target).val();i=c.call([{methodname:"core_competency_set_course_competency_ruleoutcome",args:{coursecompetencyid:l,ruleoutcome:m}},{methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:e.itemid}}]),i[1].then(function(a){return d.render(j,a)}).then(function(b,c){return d.replaceNode(a('[data-region="'+k+'"]'),b,c)}).then(g.resolve)["catch"](b.exception)}),a('[data-region="actions"] button').click(function(a){var b=new h;a.preventDefault(),e.pickCompetency().then(b.resolve)["catch"]()}),a('[data-action="delete-competency-link"]').click(function(b){b.preventDefault();var c=a(b.target).closest("[data-id]").data("id");e.deleteHandler(c)})},i});
define('tool_lp/course_competency_settings', ["jquery","core/notification","tool_lp/dialogue","core/str","core/ajax","core/templates","core/pending"],function(a,b,c,d,e,f,g){var h=function(b){a(b).on("click",this.configureSettings.bind(this))};return h.prototype._dialogue=null,h.prototype.configureSettings=function(e){var h=new g,i=a(e.target).closest("a").data("courseid"),j=a(e.target).closest("a").data("pushratingstouserplans"),k={courseid:i,settings:{pushratingstouserplans:j}};e.preventDefault(),a.when(d.get_string("configurecoursecompetencysettings","tool_lp"),f.render("tool_lp/course_competency_settings",k)).then(function(a,b){return this._dialogue=new c(a,b[0],this.addListeners.bind(this)),this._dialogue}.bind(this)).then(h.resolve)["catch"](b.exception)},h.prototype.addListeners=function(){var a=this._find('[data-action="save"]');a.on("click",this.saveSettings.bind(this));var b=this._find('[data-action="cancel"]');b.on("click",this.cancelChanges.bind(this))},h.prototype.cancelChanges=function(a){a.preventDefault(),this._dialogue.close()},h.prototype._find=function(b){return a('[data-region="coursecompetencysettings"]').find(b)},h.prototype.saveSettings=function(a){var c=new g;a.preventDefault();var d=this._find('input[name="pushratingstouserplans"]:checked').val(),f=this._find('input[name="courseid"]').val(),h={pushratingstouserplans:d};e.call([{methodname:"core_competency_update_course_competency_settings",args:{courseid:f,settings:h}}])[0].then(function(){return this.refreshCourseCompetenciesPage()}.bind(this)).then(c.resolve)["catch"](b.exception)},h.prototype.refreshCourseCompetenciesPage=function(){var c=this._find('input[name="courseid"]').val(),d=new g;e.call([{methodname:"tool_lp_data_for_course_competencies_page",args:{courseid:c}}])[0].then(function(a){return f.render("tool_lp/course_competencies_page",a)}).then(function(b,c){f.replaceNode(a('[data-region="coursecompetenciespage"]'),b,c),this._dialogue.close()}.bind(this)).then(d.resolve)["catch"](b.exception)},h});
define('tool_lp/competencydialogue', ["jquery","core/notification","core/ajax","core/templates","core/str","tool_lp/dialogue"],function(a,b,c,d,e,f){var g,h=function(){};return h.prototype.triggerCompetencyViewedEvent=function(a){c.call([{methodname:"core_competency_competency_viewed",args:{id:a}}])},h.prototype.showDialogue=function(a,c){var e=this.getCompetencyDataPromise(a,c),g=this;e.done(function(c){d.render("tool_lp/competency_summary",c).done(function(b){g.triggerCompetencyViewedEvent(a),new f(c.competency.shortname,b)}).fail(b.exception)}).fail(b.exception)},h.prototype.showDialogueFromData=function(a){var c=this;d.render("tool_lp/competency_summary",a).done(function(b){c.triggerCompetencyViewedEvent(a.id),new f(a.shortname,b,c.enhanceDialogue)}).fail(b.exception)},h.prototype.clickEventHandler=function(b){var c=b.data.compdialogue,d=a(b.currentTarget),e=d.data("id"),f=!d.data("excluderelated"),g=d.data("includecourses");c.showDialogue(e,{includerelated:f,includecourses:g}),b.preventDefault()},h.prototype.getCompetencyDataPromise=function(a,d){var e=c.call([{methodname:"tool_lp_data_for_competency_summary",args:{competencyid:a,includerelated:d.includerelated||!1,includecourses:d.includecourses||!1}}]);return e[0].then(function(a){return a}).fail(b.exception)},{init:function(){"undefined"==typeof g&&(g=new h,a("body").delegate('[data-action="competency-dialogue"]',"click",{compdialogue:g},g.clickEventHandler.bind(g)))}}});
define('tool_lp/event_base', ["jquery"],function(a){var b=function(){this._eventNode=a("<div></div>")};return b.prototype._eventNode=null,b.prototype.on=function(a,b){this._eventNode.on(a,b)},b.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])},b});
define('tool_lp/scalevalues', ["jquery","core/ajax"],function(a,b){var c=[];return{get_values:function(d){var e=a.Deferred();return"undefined"==typeof c[d]?b.call([{methodname:"core_competency_get_scale_values",args:{scaleid:d},done:function(a){c[d]=a,e.resolve(a)},fail:e.reject}]):e.resolve(c[d]),e.promise()}}});
define('tool_lp/evidence_delete', ["jquery","core/notification","core/ajax","core/str","core/log"],function(a,b,c,d,e){var f={},g=function(g,h){"undefined"==typeof f[g]&&(f[g]=a("body").delegate(g,"click",function(f){var g=a(f.currentTarget).parents(h);if(!g.length||g.length>1)return void e.error("None or too many evidence container were found.");var i=g.data("id");return i?(f.preventDefault(),f.stopPropagation(),void d.get_strings([{key:"confirm",component:"moodle"},{key:"areyousure",component:"moodle"},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){b.confirm(a[0],a[1],a[2],a[3],function(){var a=c.call([{methodname:"core_competency_delete_evidence",args:{id:i}}]);a[0].then(function(){g.remove()}).fail(b.exception)})}).fail(b.exception)):void e.error("Evidence ID was not found.")}))};return{register:g}});
define('tool_lp/parentcompetency_form', ["jquery","core/ajax","core/str","tool_lp/competencypicker","core/templates","core/notification"],function(a,b,c,d,e,f){var g=function(a,b,c,d,e){this.buttonSelector=a,this.inputHiddenSelector=b,this.staticElementSelector=c,this.frameworkId=d,this.pageContextId=e,this.registerEvents()};return g.prototype.buttonSelector=null,g.prototype.inputHiddenSelector=null,g.prototype.staticElementSelector=null,g.prototype.frameworkId=null,g.prototype.pageContextId=null,g.prototype.setParent=function(d){var e=this;0!==d.competencyId?b.call([{methodname:"core_competency_read_competency",args:{id:d.competencyId}}])[0].done(function(b){a(e.staticElementSelector).html(b.shortname),a(e.inputHiddenSelector).val(b.id)}).fail(f.exception):c.get_string("competencyframeworkroot","tool_lp").then(function(b){a(e.staticElementSelector).html(b),a(e.inputHiddenSelector).val(d.competencyId)}).fail(f.exception)},g.prototype.registerEvents=function(){var b=this;a(b.buttonSelector).on("click",function(a){a.preventDefault();var c=new d(b.pageContextId,b.frameworkId,"self",(!1));c._render=function(){var a=this;return a._preRender().then(function(){var b={competencies:a._competencies,framework:a._getFramework(a._frameworkId),frameworks:a._frameworks,search:a._searchText,singleFramework:a._singleFramework};return e.render("tool_lp/competency_picker_competencyform",b)})},c.on("save",function(a,c){b.setParent(c)}),c.display()})},{init:function(a,b,c,d,e){new g(a,b,c,d,e)}}});
define('tool_lp/competency_plan_navigation', ["jquery"],function(a){var b=function(b,c,d,e,f){this._baseUrl=c,this._userId=d+"",this._competencyId=e+"",this._planId=f,this._ignoreFirstCompetency=!0,a(b).on("change",this._competencyChanged.bind(this))};return b.prototype._competencyChanged=function(b){if(this._ignoreFirstCompetency)return void(this._ignoreFirstCompetency=!1);var c=a(b.target).val(),d="?userid="+this._userId+"&planid="+this._planId+"&competencyid="+c;document.location=this._baseUrl+d},b.prototype._competencyId=null,b.prototype._userId=null,b.prototype._planId=null,b.prototype._baseUrl=null,b.prototype._ignoreFirstCompetency=null,b});
define('tool_lp/templateactions', ["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/actionselector"],function(a,b,c,d,e,f){var g=0,h=0,i=!0,j=function(c,d){a('[data-region="managetemplates"]').replaceWith(c),b.runTemplateJS(d)},k=function(a){b.render("tool_lp/manage_templates_page",a).done(j).fail(d.exception)},l=function(){var a=c.call([{methodname:"core_competency_delete_template",args:{id:h,deleteplans:i}},{methodname:"tool_lp_data_for_templates_manage_page",args:{pagecontext:{contextid:g}}}]);a[1].done(k).fail(d.exception)},m=function(b){b.preventDefault(),h=a(this).attr("data-templateid");var e=c.call([{methodname:"core_competency_duplicate_template",args:{id:h}},{methodname:"tool_lp_data_for_templates_manage_page",args:{pagecontext:{contextid:g}}}]);e[1].done(k).fail(d.exception)},n=function(b){b.preventDefault();var g=a(this).attr("data-templateid");h=g,i=!0;var j=c.call([{methodname:"core_competency_read_template",args:{id:h}},{methodname:"core_competency_template_has_related_data",args:{id:h}}]);j[0].done(function(a){j[1].done(function(b){b?e.get_strings([{key:"deletetemplate",component:"tool_lp",param:a.shortname},{key:"deletetemplatewithplans",component:"tool_lp"},{key:"deleteplans",component:"tool_lp"},{key:"unlinkplanstemplate",component:"tool_lp"},{key:"confirm",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){var b=[{text:a[2],value:"delete"},{text:a[3],value:"unlink"}],c=new f(a[0],a[1],b,a[4],a[5]);c.display(),c.on("save",function(a,b){"delete"!=b.action&&(i=!1),l()})}).fail(d.exception):e.get_strings([{key:"confirm",component:"moodle"},{key:"deletetemplate",component:"tool_lp",param:a.shortname},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],l)}).fail(d.exception)}).fail(d.exception)}).fail(d.exception)};return{deleteHandler:n,duplicateHandler:m,init:function(a){g=a}}});
define('tool_lp/competency_rule', ["jquery"],function(a){var b=function(b){this._eventNode=a("<div>"),this._ready=a.Deferred(),this._tree=b};return b.prototype._competency=null,b.prototype._eventNode=null,b.prototype._ready=null,b.prototype._tree=null,b.prototype.canConfig=function(){return this._tree.hasChildren(this._competency.id)},b.prototype.getConfig=function(){return null},b.prototype.getType=function(){throw new Error("Not implemented")},b.prototype.init=function(){return this._load()},b.prototype.injectTemplate=function(){return a.Deferred().reject().promise()},b.prototype.isValid=function(){return!1},b.prototype._load=function(){return a.when()},b.prototype.on=function(a,b){this._eventNode.on(a,b)},b.prototype.setTargetCompetency=function(a){this._competency=a},b.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])},b.prototype._triggerChange=function(){this._trigger("change",this)},b});
define('tool_lp/frameworkactions', ["jquery","core/templates","core/ajax","core/notification","core/str"],function(a,b,c,d,e){var f=0,g=0,h=function(c,d){a('[data-region="managecompetencies"]').replaceWith(c),b.runTemplateJS(d)},i=function(a){b.render("tool_lp/manage_competency_frameworks_page",a).done(h).fail(d.exception)},j=function(b){b.preventDefault(),g=a(this).attr("data-frameworkid");var e=c.call([{methodname:"core_competency_duplicate_competency_framework",args:{id:g}},{methodname:"tool_lp_data_for_competency_frameworks_manage_page",args:{pagecontext:{contextid:f}}}]);e[1].done(i).fail(d.exception)},k=function(){var a=c.call([{methodname:"core_competency_delete_competency_framework",args:{id:g}},{methodname:"tool_lp_data_for_competency_frameworks_manage_page",args:{pagecontext:{contextid:f}}}]);a[0].done(function(a){if(a===!1){var b=c.call([{methodname:"core_competency_read_competency_framework",args:{id:g}}]);b[0].done(function(a){e.get_strings([{key:"frameworkcannotbedeleted",component:"tool_lp",param:a.shortname},{key:"cancel",component:"moodle"}]).done(function(a){d.alert(null,a[0])}).fail(d.exception)})}}).fail(d.exception),a[1].done(i).fail(d.exception)},l=function(b){b.preventDefault();var f=a(this).attr("data-frameworkid");g=f;var h=c.call([{methodname:"core_competency_read_competency_framework",args:{id:g}}]);h[0].done(function(a){e.get_strings([{key:"confirm",component:"moodle"},{key:"deletecompetencyframework",component:"tool_lp",param:a.shortname},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],k)}).fail(d.exception)}).fail(d.exception)};return{deleteHandler:l,duplicateHandler:j,init:function(a){f=a}}});
define('tool_lp/dragdrop-reorder', ["core/str","core/yui"],function(a,b){var c=null,d=function(a){var b=a.drag.get("node"),c=a.drop.get("node");this.callback(b.getDOMNode(),c.getDOMNode())};return{dragdrop:function(e,f,g,h,i,j,k,l){a.get_strings([{key:"emptydragdropregion",component:"moodle"},{key:"movecontent",component:"moodle"},{key:"tocontent",component:"moodle"}]).done(function(){b.use("moodle-tool_lp-dragdrop-reorder",function(){var a={callback:l};c&&c.destroy(),c=M.tool_lp.dragdrop_reorder({group:e,dragHandleText:f,sameNodeText:g,parentNodeText:h,sameNodeClass:i,parentNodeClass:j,dragHandleInsertClass:k,callback:b.bind(d,a)})})})}}});
define('tool_lp/competencyactions', ["jquery","core/url","core/templates","core/notification","core/str","core/ajax","tool_lp/dragdrop-reorder","tool_lp/tree","tool_lp/dialogue","tool_lp/menubar","tool_lp/competencypicker","tool_lp/competency_outcomes","tool_lp/competencyruleconfig","core/pending"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p,q,r,s,t,u=null,v=null,w=null,x=null,y=function(){var c=a('[data-region="competencyactions"]').data("competency"),f={competencyframeworkid:u.getCompetencyFrameworkId(),pagecontextid:o};null!==c&&(f.parentid=c.id);var g=function(){var c=a.param(f);window.location=b.relativeUrl("/admin/tool/lp/editcompetency.php?"+c)};null!==c&&u.hasRule(c.id)?e.get_strings([{key:"confirm",component:"moodle"},{key:"addingcompetencywillresetparentrule",component:"tool_lp",param:c.shortname},{key:"yes",component:"core"},{key:"no",component:"core"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],g)}).fail(d.exception):g()},z=function(){var b=a('[data-region="filtercompetencies"]').data("frameworkid"),c=f.call([{methodname:"core_competency_set_parent_competency",args:{competencyid:v,parentid:w}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b,search:a('[data-region="filtercompetencies"] input').val()}}]);c[1].done(F).fail(d.exception)},A=function(){if(w="undefined"==typeof w?0:w,w!=v){var a=u.getCompetency(w)||{},b=u.getCompetency(v)||{},c="movecompetencywillresetrules",f=!1;b.parentid!=w&&(a.path&&a.path.indexOf("/"+b.id+"/")>=0&&(c="movecompetencytochildofselfwillresetrules",f=f||u.hasRule(b.id)),f=f||u.hasRule(a.id)||u.hasRule(b.parentid),f?e.get_strings([{key:"confirm",component:"moodle"},{key:c,component:"tool_lp"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],z)}).fail(d.exception):z())}},B=function(b){var c=a(b.getContent()),d=c.find("[data-enhance=movetree]"),e=new h(d,(!1));e.on("selectionchanged",function(b,c){var d=c.selected;w=a(d).data("id")}),d.show(),c.on("click",'[data-action="move"]',function(){b.close(),A()}),c.on("click",'[data-action="cancel"]',function(){b.close()})},C=function(a,b){var c;for(c=0;c<b.length;c++)b[c].parentid==a.id&&(a.haschildren=!0,b[c].children=[],b[c].haschildren=!1,a.children[a.children.length]=b[c],C(b[c],b))},D=function(b){b.preventDefault();var g=a('[data-region="competencyactions"]').data("competency");v=g.id;var h=f.call([{methodname:"core_competency_search_competencies",args:{competencyframeworkid:g.competencyframeworkid,searchtext:""}},{methodname:"core_competency_read_competency_framework",args:{id:g.competencyframeworkid}}]);a.when.apply(null,h).done(function(a,b){var f,h=[];for(f=0;f<a.length;f++){var j=a[f];"0"==j.parentid&&(j.children=[],j.haschildren=0,h[h.length]=j,C(j,a))}e.get_strings([{key:"movecompetency",component:"tool_lp",param:g.shortname},{key:"move",component:"tool_lp"},{key:"cancel",component:"moodle"}]).done(function(a){var e={framework:b,competencies:h};c.render("tool_lp/competencies_move_tree",e).done(function(b){new i(a[0],b,B)}).fail(d.exception)}).fail(d.exception)}).fail(d.exception)},E=function(){var c=a('[data-region="competencyactions"]').data("competency"),d={competencyframeworkid:u.getCompetencyFrameworkId(),id:c.id,parentid:c.parentid,pagecontextid:o},e=a.param(d);window.location=b.relativeUrl("/admin/tool/lp/editcompetency.php?"+e)},F=function(b){c.render("tool_lp/manage_competencies_page",b).done(function(b,d){a('[data-region="managecompetencies"]').replaceWith(b),c.runTemplateJS(d)}).fail(d.exception)},G=function(b){b.preventDefault();var c=a('[data-region="filtercompetencies"]').data("frameworkid"),e=f.call([{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:c,search:a('[data-region="filtercompetencies"] input').val()}}]);e[0].done(F).fail(d.exception)},H=function(){var b=a('[data-region="competencyactions"]').data("competency"),c=f.call([{methodname:"core_competency_move_up_competency",args:{id:b.id}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b.competencyframeworkid,search:a('[data-region="filtercompetencies"] input').val()}}]);c[1].done(F).fail(d.exception)},I=function(){var b=a('[data-region="competencyactions"]').data("competency"),c=f.call([{methodname:"core_competency_move_down_competency",args:{id:b.id}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b.competencyframeworkid,search:a('[data-region="filtercompetencies"] input').val()}}]);c[1].done(F).fail(d.exception)},J=function(){var b=a('[data-region="competencyactions"]').data("competency"),g=f.call([{methodname:"tool_lp_list_courses_using_competency",args:{id:b.id}}]);g[0].done(function(a){var b={courses:a};c.render("tool_lp/linked_courses_summary",b).done(function(a){e.get_string("linkedcourses","tool_lp").done(function(b){new i(b,a,B)}).fail(d.exception)}).fail(d.exception)}).fail(d.exception)},K=function(){r=a('[data-region="competencyactions"]').data("competency"),p||(p=new k(o,r.competencyframeworkid),p.on("save",function(b,e){var g=new n,h=e.competencyIds,i=[];a.each(h,function(a,b){i.push({methodname:"core_competency_add_related_competency",args:{competencyid:b,relatedcompetencyid:r.id}})}),i.push({methodname:"tool_lp_data_for_related_competencies_section",args:{competencyid:r.id}});var j=f.call(i);j[i.length-1].then(function(a){return c.render("tool_lp/related_competencies",a)}).then(function(b,d){a('[data-region="relatedcompetencies"]').replaceWith(b),c.runTemplateJS(d),V()}).then(g.resolve)["catch"](d.exception)})),p.setDisallowedCompetencyIDs([r.id]),p.display()},L=function(b){b.preventDefault(),r=a('[data-region="competencyactions"]').data("competency"),q.setTargetCompetencyId(r.id),q.display()},M=function(a,b){var c={id:r.id,shortname:r.shortname,idnumber:r.idnumber,description:r.description,descriptionformat:r.descriptionformat,ruletype:b.ruletype,ruleoutcome:b.ruleoutcome,ruleconfig:b.ruleconfig},e=f.call([{methodname:"core_competency_update_competency",args:{competency:c}}]);e[0].then(function(a){a&&(r.ruletype=b.ruletype,r.ruleoutcome=b.ruleoutcome,r.ruleconfig=b.ruleconfig,Y(r))})["catch"](d.exception)},N=function(){var b=a('[data-region="competencyactions"]').data("competency"),c=f.call([{methodname:"core_competency_delete_competency",args:{id:b.id}},{methodname:"tool_lp_data_for_competencies_manage_page",args:{competencyframeworkid:b.competencyframeworkid,search:a('[data-region="filtercompetencies"] input').val()}}]);c[0].done(function(a){a===!1&&e.get_strings([{key:"competencycannotbedeleted",component:"tool_lp",param:b.shortname},{key:"cancel",component:"moodle"}]).done(function(a){d.alert(null,a[0])}).fail(d.exception)}).fail(d.exception),c[1].done(F).fail(d.exception)},O=function(){var b=a('[data-region="competencyactions"]').data("competency"),c="deletecompetency";u.hasRule(b.parentid)&&(c="deletecompetencyparenthasrule"),e.get_strings([{key:"confirm",component:"moodle"},{key:c,component:"tool_lp",param:b.shortname},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(a){d.confirm(a[0],a[1],a[2],a[3],N)}).fail(d.exception)},P=function(b){b.originalEvent.dataTransfer.setData("text",a(b.target).parent().data("id"))},Q=function(a){a.originalEvent.dataTransfer.dropEffect="move",a.preventDefault()},R=function(b){b.preventDefault(),a(this).addClass("currentdragtarget")},S=function(b){b.preventDefault(),a(this).removeClass("currentdragtarget")},T=function(b){b.preventDefault(),v=b.originalEvent.dataTransfer.getData("text"),w=a(b.target).parent().data("id"),a(this).removeClass("currentdragtarget"),A()},U=function(b){b.preventDefault();var e=this.id.substr(11),g=a('[data-region="competencyactions"]').data("competency"),h=f.call([{methodname:"core_competency_remove_related_competency",args:{relatedcompetencyid:e,competencyid:g.id}},{methodname:"tool_lp_data_for_related_competencies_section",args:{competencyid:g.id}}]);h[1].done(function(b){c.render("tool_lp/related_competencies",b).done(function(b){a('[data-region="relatedcompetencies"]').replaceWith(b),V()}).fail(d.exception)}).fail(d.exception)},V=function(){a('[data-action="deleterelation"]').on("click",U)},W=function(a){a.id!==x&&(x=a.id,f.call([{methodname:"core_competency_competency_viewed",args:{id:a.id}}]))},X=function(a){var b=s[a];return b||(b="competency"),b},Y=function(b){var e=a.Deferred().resolve().promise(),g={};g.competency=b,g.showdeleterelatedaction=!0,g.showrelatedcompetencies=!0,g.showrule=!1,b.ruleoutcome!=l.NONE&&(e=l.getString(b.ruleoutcome).then(function(c){var d;return a.each(t,function(a,c){c.type==b.ruletype&&(d=c.name)}),[c,d]})),e.then(function(a){return"undefined"!=typeof a&&(g.showrule=!0,g.rule={outcome:a[0],type:a[1]}),g}).then(function(a){return c.render("tool_lp/competency_summary",a)}).then(function(b){return a('[data-region="competencyinfo"]').html(b),a('[data-action="deleterelation"]').on("click",U),c.render("tool_lp/loading",{})}).then(function(a,d){return c.replaceNodeContents('[data-region="relatedcompetencies"]',a,d),f.call([{methodname:"tool_lp_data_for_related_competencies_section",args:{competencyid:b.id}}])[0]}).then(function(a){return c.render("tool_lp/related_competencies",a)}).then(function(b,d){a('[data-region="relatedcompetencies"]').replaceWith(b),c.runTemplateJS(d),V()})["catch"](d.exception)},Z=function(a){return e.get_string("taxonomy_add_"+X(a),"tool_lp")},$=function(a){return e.get_string("taxonomy_selected_"+X(a),"tool_lp")},_=function(b,c){var e=c.selected,f=a(e).data("id"),g=a('[data-region="competencyactions"] [data-action="add"]'),h=a('[data-region="competencyactionsmenu"]'),i=a('[data-region="selected-competency"]'),k=0,l=1;if(j.closeAll(),"undefined"==typeof f)a('[data-region="competencyinfo"]').html(e.clone().children().remove().end().text()),a('[data-region="competencyactions"]').data("competency",null),h.hide();else{var m=u.getCompetency(f);k=u.getCompetencyLevel(f),l=k+1,h.show(),a('[data-region="competencyactions"]').data("competency",m),Y(m),W(m)}return $(k).then(function(a){i.text(a)})["catch"](d.exception),Z(l).then(function(a){g.show().find('[data-region="term"]').text(a)})["catch"](d.exception),b.preventDefault(),!1},aa=function(a){var b=a.split(",");return b.unshift(""),delete b[0],b};return{init:function(b,c,d,e){u=b,o=c,s=aa(d),t=e,a('[data-region="competencyactions"] [data-action="add"]').on("click",y),j.enhance(".competencyactionsmenu",{'[data-action="edit"]':E,'[data-action="delete"]':O,'[data-action="move"]':D,'[data-action="moveup"]':H,'[data-action="movedown"]':I,'[data-action="linkedcourses"]':J,'[data-action="relatedcompetencies"]':K.bind(this),'[data-action="competencyrules"]':L.bind(this)}),a('[data-region="competencyactionsmenu"]').hide(),a('[data-region="competencyactions"] [data-action="add"]').hide(),a('[data-region="filtercompetencies"]').on("submit",G);var f=a('[data-region="managecompetencies"] [data-enhance="tree"]');f.on("dragstart","li>span",P).on("dragover","li>span",Q).on("dragenter","li>span",R).on("dragleave","li>span",S).on("drop","li>span",T),b.on("selectionchanged",_),q=new m(u,t),q.on("save",M.bind(this))}}});
define('tool_lp/user_competency_plan_popup', ["jquery","core/notification","core/str","core/ajax","core/templates","tool_lp/dialogue"],function(a,b,c,d,e,f){var g=function(b,c,d){this._regionSelector=b,this._userCompetencySelector=c,this._planId=d,a(this._regionSelector).on("click",this._userCompetencySelector,this._handleClick.bind(this))};return g.prototype._handleClick=function(c){c.preventDefault();var e=a(c.target).closest("tr"),f=a(e).data("competencyid"),g=a(e).data("userid"),h=this._planId,i=d.call([{methodname:"tool_lp_data_for_user_competency_summary_in_plan",args:{competencyid:f,planid:h},done:this._contextLoaded.bind(this),fail:b.exception}]);i[0].then(function(a){var b="core_competency_user_competency_viewed_in_plan";return a.plan.iscompleted&&(b="core_competency_user_competency_plan_viewed"),d.call([{methodname:b,args:{competencyid:f,userid:g,planid:h}}])[0]})["catch"](b.exception)},g.prototype._contextLoaded=function(a){var d=this;e.render("tool_lp/user_competency_summary_in_plan",a).done(function(a,g){c.get_string("usercompetencysummary","report_competency").done(function(b){new f(b,a,e.runTemplateJS.bind(e,g),d._refresh.bind(d),(!0))}).fail(b.exception)}).fail(b.exception)},g.prototype._refresh=function(){var a=this._planId;d.call([{methodname:"tool_lp_data_for_plan_page",args:{planid:a},done:this._pageContextLoaded.bind(this),fail:b.exception}])},g.prototype._pageContextLoaded=function(a){var c=this;e.render("tool_lp/plan_page",a).done(function(a,b){e.replaceNode(c._regionSelector,a,b)}).fail(b.exception)},g.prototype._regionSelector=null,g.prototype._userCompetencySelector=null,g.prototype._planId=null,g});
define('tool_lp/competencypicker_user_plans', ["jquery","core/notification","core/ajax","core/templates","core/str","tool_lp/tree","tool_lp/competencypicker"],function(a,b,c,d,e,f,g){var h=function(a,b,c){g.prototype.constructor.apply(this,[1,!1,"self",c]),this._userId=a,this._plans=[],b&&(this._planId=b,this._singlePlan=!0)};return h.prototype=Object.create(g.prototype),h.prototype._plans=null,h.prototype._planId=null,h.prototype._singlePlan=!1,h.prototype._userId=null,h.prototype._afterRender=function(){var c=this;g.prototype._afterRender.apply(c,arguments),c._singlePlan||c._find('[data-action="chooseplan"]').change(function(d){c._planId=a(d.target).val(),c._loadCompetencies().then(c._refresh.bind(c))["catch"](b.exception)})},h.prototype._fetchCompetencies=function(a,d){var e=this;return c.call([{methodname:"core_competency_list_plan_competencies",args:{id:a}}])[0].done(function(a){var b,c,f=[];for(b=0;b<a.length;b++)c=a[b].competency,c.shortname.toLowerCase().indexOf(d.toLowerCase())<0||(c.children=[],c.haschildren=0,f.push(c));e._competencies=f}).fail(b.exception)},h.prototype._getPlan=function(b){var c;return a.each(this._plans,function(a,d){if(d.id==b)return void(c=d)}),c},h.prototype._loadCompetencies=function(){return this._fetchCompetencies(this._planId,this._searchText)},h.prototype._loadPlans=function(){var d,e=this;return e._plans.length>0?a.when():(d=e._singlePlan?c.call([{methodname:"core_competency_read_plan",args:{id:this._planId}}])[0].then(function(a){return[a]}):c.call([{methodname:"core_competency_list_user_plans",args:{userid:e._userId}}])[0],d.done(function(a){e._plans=a}).fail(b.exception))},h.prototype._preRender=function(){var b=this;return b._loadPlans().then(function(){return!b._planId&&b._plans.length>0&&(b._planId=b._plans[0].id),b._planId?b._loadCompetencies():(b._plans=[],a.when())})},h.prototype._render=function(){var b=this;return b._preRender().then(function(){b._singlePlan||a.each(b._plans,function(a,c){c.id==b._planId?c.selected=!0:c.selected=!1});var c={competencies:b._competencies,plan:b._getPlan(b._planId),plans:b._plans,search:b._searchText,singlePlan:b._singlePlan};return d.render("tool_lp/competency_picker_user_plans",c)})},h});
define('tool_lp/user_competency_course_navigation', ["jquery"],function(a){var b=function(b,c,d,e,f,g){this._baseUrl=d,this._userId=e+"",this._competencyId=f+"",this._courseId=g,a(b).on("change",this._userChanged.bind(this)),a(c).on("change",this._competencyChanged.bind(this))};return b.prototype._userChanged=function(b){var c=a(b.target).val(),d="?userid="+c+"&courseid="+this._courseId+"&competencyid="+this._competencyId;document.location=this._baseUrl+d},b.prototype._competencyChanged=function(b){var c=a(b.target).val(),d="?userid="+this._userId+"&courseid="+this._courseId+"&competencyid="+c;document.location=this._baseUrl+d},b.prototype._competencyId=null,b.prototype._userId=null,b.prototype._courseId=null,b.prototype._baseUrl=null,b.prototype._ignoreFirstCompetency=null,b});
define('tool_lp/competency_rule_all', ["jquery","core/str","tool_lp/competency_rule"],function(a,b,c){var d=function(){c.apply(this,arguments)};return d.prototype=Object.create(c.prototype),d.prototype.getType=function(){return"core_competency\\competency_rule_all"},d.prototype.isValid=function(){return!0},d});
define('tool_lp/competencypicker', ["jquery","core/notification","core/ajax","core/templates","tool_lp/dialogue","core/str","tool_lp/tree","core/pending"],function(a,b,c,d,e,f,g,h){var i=function(b,c,d,e){var f=this;f._eventNode=a("<div></div>"),f._frameworks=[],f._reset(),f._pageContextId=b,f._pageContextIncludes=d||"children",f._multiSelect="undefined"==typeof e||e===!0,c&&(f._frameworkId=c,f._singleFramework=!0)};return i.prototype._competencies=null,i.prototype._disallowedCompetencyIDs=null,i.prototype._eventNode=null,i.prototype._frameworks=null,i.prototype._frameworkId=null,i.prototype._pageContextId=null,i.prototype._pageContextIncludes=null,i.prototype._popup=null,i.prototype._searchText="",i.prototype._selectedCompetencies=null,i.prototype._singleFramework=!1,i.prototype._multiSelect=!0,i.prototype._onlyVisible=!0,i.prototype._afterRender=function(){var c=this,d=new g(c._find("[data-enhance=linktree]"),c._multiSelect);c._find("[data-enhance=linktree]").show(),d.on("selectionchanged",function(b,d){var e=d.selected;b.preventDefault();var f=[];a.each(e,function(b,d){var e=a(d).data("id"),g=!0;"undefined"==typeof e?g=!1:a.each(c._disallowedCompetencyIDs,function(a,b){b==e&&(g=!1)}),g&&f.push(e)}),c._selectedCompetencies=f,c._selectedCompetencies.length?c._find('[data-region="competencylinktree"] [data-action="add"]').removeAttr("disabled"):c._find('[data-region="competencylinktree"] [data-action="add"]').attr("disabled","disabled")}),c._singleFramework||c._find('[data-action="chooseframework"]').change(function(d){c._frameworkId=a(d.target).val(),c._loadCompetencies().then(c._refresh.bind(c))["catch"](b.exception)}),c._find('[data-region="filtercompetencies"] button').click(function(b){return b.preventDefault(),a(b.target).attr("disabled","disabled"),c._searchText=c._find('[data-region="filtercompetencies"] input').val()||"",c._refresh().always(function(){a(b.target).removeAttr("disabled")})}),c._find('[data-region="competencylinktree"] [data-action="cancel"]').click(function(a){a.preventDefault(),c.close()}),c._find('[data-region="competencylinktree"] [data-action="add"]').click(function(a){a.preventDefault();var b=new h;c._selectedCompetencies.length&&(c._multiSelect?c._trigger("save",{competencyIds:c._selectedCompetencies}):c._trigger("save",{competencyId:c._selectedCompetencies[0]}),c.close(),b.resolve())});var e=c._selectedCompetencies.slice(0);a.each(e,function(a,b){var e=c._find("[data-id="+b+"]");e.length&&(d.toggleItem(e),d.updateFocus(e))})},i.prototype.close=function(){var a=this;a._popup.close(),a._reset()},i.prototype.display=function(){var c=this;return a.when(f.get_string("competencypicker","tool_lp"),c._render()).then(function(a,b){c._popup=new e(a,b[0],c._afterRender.bind(c))})["catch"](b.exception)},i.prototype._fetchCompetencies=function(a,d){var e=this;return c.call([{methodname:"core_competency_search_competencies",args:{searchtext:d,competencyframeworkid:a}}])[0].done(function(a){function b(a,c){for(var d=0;d<c.length;d++)c[d].parentid==a.id&&(a.haschildren=!0,c[d].children=[],c[d].haschildren=!1,a.children[a.children.length]=c[d],b(c[d],c))}var c,d,f=[];for(c=0;c<a.length;c++)d=a[c],"0"==d.parentid&&(d.children=[],d.haschildren=0,f[f.length]=d,b(d,a));e._competencies=f}).fail(b.exception)},i.prototype._find=function(b){return a(this._popup.getContent()).find(b)},i.prototype._getFramework=function(b){var c;return a.each(this._frameworks,function(a,d){if(d.id==b)return void(c=d)}),c},i.prototype._loadCompetencies=function(){return this._fetchCompetencies(this._frameworkId,this._searchText)},i.prototype._loadFrameworks=function(){var d,e=this;return e._frameworks.length>0?a.when():(d=e._singleFramework?c.call([{methodname:"core_competency_read_competency_framework",args:{id:this._frameworkId}}])[0].then(function(a){return[a]}):c.call([{methodname:"core_competency_list_competency_frameworks",args:{sort:"shortname",context:{contextid:e._pageContextId},includes:e._pageContextIncludes,onlyvisible:e._onlyVisible}}])[0],d.done(function(a){e._frameworks=a}).fail(b.exception))},i.prototype.on=function(a,b){this._eventNode.on(a,b)},i.prototype._preRender=function(){var b=this;return b._loadFrameworks().then(function(){return!b._frameworkId&&b._frameworks.length>0&&(b._frameworkId=b._frameworks[0].id),b._frameworkId?b._loadCompetencies():(b._frameworks=[],a.when())})},i.prototype._refresh=function(){var a=this;return a._render().then(function(b){a._find('[data-region="competencylinktree"]').replaceWith(b),a._afterRender()})},i.prototype._render=function(){var b=this;return b._preRender().then(function(){b._singleFramework||a.each(b._frameworks,function(a,c){c.id==b._frameworkId?c.selected=!0:c.selected=!1});var c={competencies:b._competencies,framework:b._getFramework(b._frameworkId),frameworks:b._frameworks,search:b._searchText,singleFramework:b._singleFramework};return d.render("tool_lp/competency_picker",c)})},i.prototype._reset=function(){this._competencies=[],this._disallowedCompetencyIDs=[],this._popup=null,this._searchText="",this._selectedCompetencies=[]},i.prototype.setDisallowedCompetencyIDs=function(a){this._disallowedCompetencyIDs=a},i.prototype._trigger=function(a,b){this._eventNode.trigger(a,[b])},i});
define('tool_lp/user_evidence_actions', ["jquery","core/templates","core/ajax","core/notification","core/str","tool_lp/menubar","tool_lp/competencypicker_user_plans"],function(a,b,c,d,e,f,g){var h=function(a){if(this._type=a,"evidence"===a)this._region='[data-region="user-evidence-page"]',this._evidenceNode='[data-region="user-evidence-page"]',this._template="tool_lp/user_evidence_page",this._contextMethod="tool_lp_data_for_user_evidence_page";else{if("list"!==a)throw new TypeError("Unexpected type.");this._region='[data-region="user-evidence-list"]',this._evidenceNode='[data-region="user-evidence-node"]',this._template="tool_lp/user_evidence_list_page",this._contextMethod="tool_lp_data_for_user_evidence_list_page"}};return h.prototype._contextMethod=null,h.prototype._evidenceNode=null,h.prototype._region=null,h.prototype._template=null,h.prototype._type=null,h.prototype._getContextArgs=function(a){var b=this,c={};return"evidence"===b._type?c={id:a.id}:"list"===b._type&&(c={userid:a.userid}),c},h.prototype._renderView=function(c){var d=this;return b.render(d._template,c).then(function(c,e){b.replaceNode(a(d._region),c,e)})},h.prototype._callAndRefresh=function(b,e){var f=this;return b.push({methodname:f._contextMethod,args:f._getContextArgs(e)}),a.when.apply(a.when,c.call(b)).then(function(){return f._renderView(arguments[arguments.length-1])}).fail(d.exception)},h.prototype._doDelete=function(a){var b=this,c=[{methodname:"core_competency_delete_user_evidence",args:{id:a.id}}];b._callAndRefresh(c,a)},h.prototype.deleteEvidence=function(a){var b,f=this;b=c.call([{methodname:"core_competency_read_user_evidence",args:{id:a.id}}]),b[0].done(function(b){e.get_strings([{key:"confirm",component:"moodle"},{key:"deleteuserevidence",component:"tool_lp",param:b.name},{key:"delete",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(b){d.confirm(b[0],b[1],b[2],b[3],function(){f._doDelete(a)})}).fail(d.exception)}).fail(d.exception)},h.prototype._deleteEvidenceHandler=function(b){b.preventDefault();var c=this._findEvidenceData(a(b.target));this.deleteEvidence(c)},h.prototype._doCreateUserEvidenceCompetency=function(b,c){var d=this,e=[];a.each(c,function(a,c){e.push({methodname:"core_competency_create_user_evidence_competency",args:{userevidenceid:b.id,competencyid:c}})}),d._callAndRefresh(e,b)},h.prototype.createUserEvidenceCompetency=function(a){var b=this,c=new g(a.userid);c.on("save",function(c,d){var e=d.competencyIds;b._doCreateUserEvidenceCompetency(a,e,d.requestReview)}),c.display()},h.prototype._createUserEvidenceCompetencyHandler=function(b){b.preventDefault();var c=this._findEvidenceData(a(b.target));this.createUserEvidenceCompetency(c)},h.prototype._doDeleteUserEvidenceCompetency=function(a,b){var c=this,d=[];d.push({methodname:"core_competency_delete_user_evidence_competency",args:{userevidenceid:a.id,competencyid:b}}),c._callAndRefresh(d,a)},h.prototype.deleteUserEvidenceCompetency=function(a,b){this._doDeleteUserEvidenceCompetency(a,b)},h.prototype._deleteUserEvidenceCompetencyHandler=function(b){var c=this._findEvidenceData(a(b.currentTarget)),d=a(b.currentTarget).data("id");b.preventDefault(),this.deleteUserEvidenceCompetency(c,d)},h.prototype._doReviewUserEvidenceCompetencies=function(a){var b=this,c=[{methodname:"core_competency_request_review_of_user_evidence_linked_competencies",args:{id:a.id}}];b._callAndRefresh(c,a)},h.prototype.reviewUserEvidenceCompetencies=function(a){var b,f=this;b=c.call([{methodname:"core_competency_read_user_evidence",args:{id:a.id}}]),b[0].done(function(b){e.get_strings([{key:"confirm",component:"moodle"},{key:"sendallcompetenciestoreview",component:"tool_lp",param:b.name},{key:"confirm",component:"moodle"},{key:"cancel",component:"moodle"}]).done(function(b){d.confirm(b[0],b[1],b[2],b[3],function(){f._doReviewUserEvidenceCompetencies(a)})}).fail(d.exception)}).fail(d.exception)},h.prototype._reviewUserEvidenceCompetenciesHandler=function(b){b.preventDefault();var c=this._findEvidenceData(a(b.target));this.reviewUserEvidenceCompetencies(c)},h.prototype._findEvidenceData=function(b){var c,d=b.parentsUntil(a(this._region).parent(),this._evidenceNode);if(1!=d.length)throw new Error("The evidence node was not located.");if(c=d.data(),"undefined"==typeof c||"undefined"==typeof c.id)throw new Error("Evidence data could not be found.");return c},h.prototype.enhanceMenubar=function(a){var b=this;f.enhance(a,{'[data-action="user-evidence-delete"]':b._deleteEvidenceHandler.bind(b),'[data-action="link-competency"]':b._createUserEvidenceCompetencyHandler.bind(b),'[data-action="send-competencies-review"]':b._reviewUserEvidenceCompetenciesHandler.bind(b)})},h.prototype.registerEvents=function(){var b=a(this._region),c=this;b.find('[data-action="user-evidence-delete"]').click(c._deleteEvidenceHandler.bind(c)),b.find('[data-action="link-competency"]').click(c._createUserEvidenceCompetencyHandler.bind(c)),b.find('[data-action="delete-competency-link"]').click(c._deleteUserEvidenceCompetencyHandler.bind(c)),b.find('[data-action="send-competencies-review"]').click(c._reviewUserEvidenceCompetenciesHandler.bind(c))},h});
define('tool_lp/competency_rule_points', ["jquery","core/str","core/templates","tool_lp/competency_rule"],function(a,b,c,d){var e=function(){d.apply(this,arguments)};return e.prototype=Object.create(d.prototype),e.prototype._container=null,e.prototype._templateLoaded=!1,e.prototype.getConfig=function(){return JSON.stringify({base:{points:this._getRequiredPoints()},competencies:this._getCompetenciesConfig()})},e.prototype._getCompetenciesConfig=function(){var b=[];return this._container.find("[data-competency]").each(function(){var c=a(this),d=c.data("competency"),e=parseInt(c.find('[name="points"]').val(),10),f=c.find('[name="required"]').prop("checked");b.push({id:d,points:e,required:f?1:0})}),b},e.prototype._getRequiredPoints=function(){return parseInt(this._container.find('[name="requiredpoints"]').val()||1,10)},e.prototype.getType=function(){return"core_competency\\competency_rule_points"},e.prototype.injectTemplate=function(b){var d,e=this,f=this._tree.getChildren(this._competency.id),g={base:{points:2},competencies:[]};if(this._templateLoaded=!1,e._competency.ruletype==e.getType())try{g=JSON.parse(e._competency.ruleconfig)}catch(h){}return d={requiredpoints:g&&g.base?g.base.points:2,competency:e._competency,children:[]},a.each(f,function(b,c){var e={id:c.id,shortname:c.shortname,required:!1,points:0};g&&a.each(g.competencies,function(a,b){b.id==e.id&&(e.required=!!b.required,e.points=b.points)}),d.children.push(e)}),c.render("tool_lp/competency_rule_points",d).then(function(a){e._container=b,b.html(a),b.find("input").change(function(){e._triggerChange()}),e._templateLoaded=!0,e._triggerChange()})},e.prototype.isValid=function(){if(!this._templateLoaded)return!1;var b=this._getRequiredPoints(),c=0,d=!0;return a.each(this._getCompetenciesConfig(),function(a,b){b.points<0&&(d=!1),c+=b.points}),d=d&&c>=b},e});
define('tool_lp/form-user-selector', ["jquery","core/ajax","core/templates"],function(a,b,c){return{processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.id,label:b._label})}),d},transport:function(d,e,f,g){var h,i=a(d).data("capability");"undefined"==typeof i&&(i=""),h=b.call([{methodname:"tool_lp_search_users",args:{query:e,capability:i}}]),h[0].then(function(b){var d=[],e=0;return a.each(b.users,function(b,e){var f=e,g=[];a.each(["idnumber","email","phone1","phone2","department","institution"],function(a,b){"undefined"!=typeof e[b]&&""!==e[b]&&(f.hasidentity=!0,g.push(e[b]))}),f.identity=g.join(", "),d.push(c.render("tool_lp/form-user-selector-suggestion",f))}),a.when.apply(a.when,d).then(function(){var c=arguments;a.each(b.users,function(a,b){b._label=c[e],e++}),f(b.users)})})["catch"](g)}}});
define('tool_lp/dialogue', ["core/yui"],function(a){var b=function(b,c,d,e,f){M.util.js_pending("tool_lp/dialogue:dialogue"),this.yuiDialogue=null;var g=this;"undefined"==typeof f&&(f=!1),a.use("moodle-core-notification","timers",function(){var h="480px";f&&(h="800px"),g.yuiDialogue=new M.core.dialogue({headerContent:b,bodyContent:c,draggable:!0,visible:!1,center:!0,modal:!0,width:h}),g.yuiDialogue.before("visibleChange",function(){M.util.js_pending("tool_lp/dialogue:before:visibleChange")}),g.yuiDialogue.after("visibleChange",function(b){b.newVal?"undefined"!=typeof d?a.soon(function(){d(g),g.yuiDialogue.centerDialogue(),M.util.js_complete("tool_lp/dialogue:before:visibleChange")}):M.util.js_complete("tool_lp/dialogue:before:visibleChange"):"undefined"!=typeof e?a.soon(function(){e(g),M.util.js_complete("tool_lp/dialogue:before:visibleChange")}):M.util.js_complete("tool_lp/dialogue:before:visibleChange")}),g.yuiDialogue.show(),M.util.js_complete("tool_lp/dialogue:dialogue")})};return b.prototype.close=function(){this.yuiDialogue.hide(),this.yuiDialogue.destroy()},b.prototype.getContent=function(){return this.yuiDialogue.bodyNode.getDOMNode()},b});
define('tool_lp/competency_outcomes', ["jquery","core/str"],function(a,b){var c=0,d=1,e=2,f=3;return{NONE:c,EVIDENCE:d,COMPLETE:e,RECOMMEND:f,getAll:function(){var a=this;return b.get_strings([{key:"competencyoutcome_none",component:"tool_lp"},{key:"competencyoutcome_evidence",component:"tool_lp"},{key:"competencyoutcome_recommend",component:"tool_lp"},{key:"competencyoutcome_complete",component:"tool_lp"}]).then(function(b){var c={};return c[a.NONE]={code:a.NONE,name:b[0]},c[a.EVIDENCE]={code:a.EVIDENCE,name:b[1]},c[a.RECOMMEND]={code:a.RECOMMEND,name:b[2]},c[a.COMPLETE]={code:a.COMPLETE,name:b[3]},c})},getString:function(b){var c=this,d=c.getAll();return d.then(function(c){return"undefined"==typeof c[b]?a.Deferred().reject().promise():c[b].name})}}});
define('tool_lp/actionselector', ["jquery","core/notification","core/ajax","core/templates","tool_lp/dialogue","tool_lp/event_base"],function(a,b,c,d,e,f){var g=function(a,b,c,d,e){var g=this;f.prototype.constructor.apply(this,[]),g._title=a,g._message=b,g._actions=c,g._confirm=d,g._cancel=e,g._selectedValue=null,g._reset()};return g.prototype=Object.create(f.prototype),g.prototype._selectedValue=null,g.prototype._popup=null,g.prototype._title=null,g.prototype._message=null,g.prototype._actions=null,g.prototype._confirm=null,g.prototype._cancel=null,g.prototype._afterRender=function(){var b=this;b._find('[data-action="action-selector-confirm"]').attr("disabled","disabled"),b._find('[data-region="action-selector-radio-buttons"]').change(function(){b._selectedValue=a("input[type='radio']:checked").val(),b._find('[data-action="action-selector-confirm"]').removeAttr("disabled"),b._refresh.bind(b)}),b._find('[data-action="action-selector-cancel"]').click(function(a){a.preventDefault(),b.close()}),b._find('[data-action="action-selector-confirm"]').click(function(a){a.preventDefault(),b._selectedValue.length&&(b._trigger("save",{action:b._selectedValue}),b.close())})},g.prototype.close=function(){var a=this;a._popup.close(),a._reset()},g.prototype.display=function(){var a=this;return a._render().then(function(b){a._popup=new e(a._title,b,a._afterRender.bind(a))}).fail(b.exception)},g.prototype._find=function(b){return a(this._popup.getContent()).find(b)},g.prototype._refresh=function(){var a=this;return a._render().then(function(b){a._find('[data-region="action-selector"]').replaceWith(b),a._afterRender()})},g.prototype._render=function(){var a=this,b=[];for(var c in a._actions)b.push(a._actions[c]);var e={message:a._message,choices:b,confirm:a._confirm,cancel:a._cancel};return d.render("tool_lp/action_selector",e)},g.prototype._reset=function(){this._popup=null,this._selectedValue=""},g});
define('tool_policy/acceptmodal', ["jquery","core/str","core/modal_factory","core/modal_events","core/notification","core/fragment","core/ajax","core/yui"],function(a,b,c,d,e,f,g,h){"use strict";var i=function(a){this.contextid=a,this.init()};return i.prototype.modal=null,i.prototype.contextid=-1,i.prototype.stringKeys=[{key:"consentdetails",component:"tool_policy"},{key:"iagreetothepolicy",component:"tool_policy"},{key:"selectusersforconsent",component:"tool_policy"},{key:"ok"},{key:"revokedetails",component:"tool_policy"},{key:"irevokethepolicy",component:"tool_policy"}],i.prototype.currentTrigger=null,i.prototype.triggers={SINGLE:"a[data-action=acceptmodal]",BULK:"input[data-action=acceptmodal]"},i.prototype.init=function(){a(this.triggers.SINGLE).on("click",function(b){b.preventDefault(),this.currentTrigger=a(b.currentTarget);var c=a(b.currentTarget).attr("href"),d=c.slice(c.indexOf("?")+1);this.showFormModal(d)}.bind(this)),a(this.triggers.BULK).on("click",function(c){c.preventDefault(),this.currentTrigger=a(c.currentTarget);var d=a(c.currentTarget).closest("form");if(d.find('input[type=checkbox][name="userids[]"]:checked').length){var f=d.serialize();this.showFormModal(f)}else b.get_strings(this.stringKeys).done(function(a){e.alert("",a[2],a[3])})}.bind(this))},i.prototype.showFormModal=function(a){for(var d,f=a.split("&"),g=0;g<f.length;g++){var h=f[g].split("=");"action"==h[0]&&(d=h[1])}b.get_strings(this.stringKeys).done(function(b){var e,f;"revoke"==d?(e=b[4],f=b[5]):(e=b[0],f=b[1]),c.create({type:c.types.SAVE_CANCEL,title:e,body:""}).done(function(b){this.modal=b,this.setupFormModal(a,f)}.bind(this))}.bind(this)).fail(e.exception)},i.prototype.setupFormModal=function(a,b){var c=this.modal;c.setLarge(),c.setSaveButtonText(b),c.getRoot().on(d.hidden,this.destroy.bind(this)),c.setBody(this.getBody(a)),c.getRoot().on(d.save,this.submitForm.bind(this)),c.getRoot().on("submit","form",this.submitFormAjax.bind(this)),c.show()},i.prototype.getBody=function(a){"undefined"==typeof a&&(a={});var b={jsonformdata:JSON.stringify(a)};return f.loadFragment("tool_policy","accept_on_behalf",this.contextid,b)},i.prototype.submitFormAjax=function(a){a.preventDefault();var b=this.modal.getRoot().find("form").serialize(),c=g.call([{methodname:"tool_policy_submit_accept_on_behalf",args:{jsonformdata:JSON.stringify(b)}}]);c[0].done(function(a){a.validationerrors?this.modal.setBody(this.getBody(b)):this.close()}.bind(this)).fail(e.exception)},i.prototype.submitForm=function(a){a.preventDefault(),this.modal.getRoot().find("form").submit()},i.prototype.close=function(){this.destroy(),document.location.reload()},i.prototype.destroy=function(){h.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.reset_form_dirty_state()}),this.modal.destroy(),this.currentTrigger.focus()},{getInstance:function(a){return new i(a)}}});
define('tool_policy/policyactions', ["jquery","core/ajax","core/notification","core/modal_factory","core/modal_events"],function(a,b,c,d,e){var f=function(a){this.registerEvents(a)};return f.prototype.registerEvents=function(f){f.on("click",function(f){f.preventDefault();var g=a(this).data("versionid"),h=a(this).data("behalfid"),i={versionid:g,behalfid:h},j={methodname:"tool_policy_get_policy_version",args:i},k=a.Deferred(),l=a.Deferred(),m=d.create({title:k,body:l,large:!0}).then(function(a){return a.getRoot().on(e.hidden,function(){a.destroy()}),a}).then(function(a){return a.show(),a})["catch"](c.exception),n=b.call([j]);a.when(n[0]).then(function(a){if(a.result.policy)return k.resolve(a.result.policy.name),l.resolve(a.result.policy.content),a;throw new Error(a.warnings[0].message)})["catch"](function(a){return m.then(function(a){return a.hide(),a.destroy(),a})["catch"](c.exception),c.addNotification({message:a,type:"error"})})})},{init:function(b){return b=a(b),new f(b)}}});
define('tool_policy/acceptances_filter_datasource', ["jquery","core/ajax","core/notification"],function(a,b,c){return{list:function(b,c){var d=[],e=a(b),f=a(b).data("originaloptionsjson"),g=e.val();a.each(f,function(b,e){return""!==c.trim()&&e.label.toLocaleLowerCase().indexOf(c.toLocaleLowerCase())===-1||(a.inArray(e.value,g)>-1||(d.push(e),!0))});var h=new a.Deferred;return h.resolve(d),h.promise()},processResults:function(b,c){var d=[];return a.each(c,function(a,b){d.push({value:b.value,label:b.label})}),d},transport:function(a,b,d){this.list(a,b).then(d)["catch"](c.exception)}}});
define('tool_policy/acceptances_filter', ["jquery","core/form-autocomplete","core/str","core/notification"],function(a,b,c,d){var e={UNIFIED_FILTERS:"#unified-filters"},f=function(){var f=[{key:"filterplaceholder",component:"tool_policy"},{key:"nofiltersapplied",component:"tool_policy"}];M.util.js_pending("acceptances_filter_datasource"),c.get_strings(f).done(function(a){var c=a[0],f=a[1];b.enhance(e.UNIFIED_FILTERS,!0,"tool_policy/acceptances_filter_datasource",c,!1,!0,f,!0).then(function(){M.util.js_complete("acceptances_filter_datasource")}).fail(d.exception)}).fail(d.exception);var g=a(e.UNIFIED_FILTERS).val();a(e.UNIFIED_FILTERS).on("change",function(){var b=a(this).val(),c=[],d=[],e=!1;if(a.each(b,function(a,b){var f=b.split(":",2);if(2!==f.length)return d.push(b),!0;var g=f[0],h=f[1];return"undefined"!=typeof c[g]&&(e=!0),c[g]=h,!0}),e){var f=[];for(var h in c)f.push(h+":"+c[h]);f=f.concat(d),a(this).val(f)}g.join(",")!=b.join(",")&&this.form.submit()})},g=function(){return a(e.UNIFIED_FILTERS).closest("form")};return{init:function(){f()},getForm:function(){return g()}}});
define('tool_policy/jquery-eu-cookie-law-popup', ["jquery"],function(a){window.console||(window.console={}),window.console.log||(window.console.log=function(){}),a.fn.euCookieLawPopup=function(){var b=this;b.params={cookiePolicyUrl:"http://www.wimagguc.com/?cookie-policy",popupPosition:"top",colorStyle:"default",compactStyle:!1,popupTitle:"This website is using cookies",popupText:"We use cookies to ensure that we give you the best experience on our website. If you continue without changing your settings, we'll assume that you are happy to receive all cookies on this website.",buttonContinueTitle:"Continue",buttonLearnmoreTitle:"Learn&nbsp;more",buttonLearnmoreOpenInNewWindow:!0,agreementExpiresInDays:30,autoAcceptCookiePolicy:!1,htmlMarkup:null},b.vars={INITIALISED:!1,HTML_MARKUP:null,COOKIE_NAME:"EU_COOKIE_LAW_CONSENT"};var c=function(c,d,e){if(c){var f=a(c).attr("class")?a(c).attr("class"):"";f.indexOf("eupopup-top")>-1?b.params.popupPosition="top":f.indexOf("eupopup-fixedtop")>-1?b.params.popupPosition="fixedtop":f.indexOf("eupopup-bottomright")>-1?b.params.popupPosition="bottomright":f.indexOf("eupopup-bottomleft")>-1?b.params.popupPosition="bottomleft":f.indexOf("eupopup-bottom")>-1?b.params.popupPosition="bottom":f.indexOf("eupopup-block")>-1&&(b.params.popupPosition="block"),f.indexOf("eupopup-color-default")>-1?b.params.colorStyle="default":f.indexOf("eupopup-color-inverse")>-1&&(b.params.colorStyle="inverse"),f.indexOf("eupopup-style-compact")>-1&&(b.params.compactStyle=!0)}d&&(b.params.htmlMarkup=d),e&&("undefined"!=typeof e.cookiePolicyUrl&&(b.params.cookiePolicyUrl=e.cookiePolicyUrl),"undefined"!=typeof e.popupPosition&&(b.params.popupPosition=e.popupPosition),"undefined"!=typeof e.colorStyle&&(b.params.colorStyle=e.colorStyle),"undefined"!=typeof e.popupTitle&&(b.params.popupTitle=e.popupTitle),"undefined"!=typeof e.popupText&&(b.params.popupText=e.popupText),"undefined"!=typeof e.buttonContinueTitle&&(b.params.buttonContinueTitle=e.buttonContinueTitle),"undefined"!=typeof e.buttonLearnmoreTitle&&(b.params.buttonLearnmoreTitle=e.buttonLearnmoreTitle),"undefined"!=typeof e.buttonLearnmoreOpenInNewWindow&&(b.params.buttonLearnmoreOpenInNewWindow=e.buttonLearnmoreOpenInNewWindow),"undefined"!=typeof e.agreementExpiresInDays&&(b.params.agreementExpiresInDays=e.agreementExpiresInDays),"undefined"!=typeof e.autoAcceptCookiePolicy&&(b.params.autoAcceptCookiePolicy=e.autoAcceptCookiePolicy),"undefined"!=typeof e.htmlMarkup&&(b.params.htmlMarkup=e.htmlMarkup))},d=function(){if(b.params.htmlMarkup)return b.params.htmlMarkup;var a='<div class="eupopup-container eupopup-container-'+b.params.popupPosition+(b.params.compactStyle?" eupopup-style-compact":"")+" eupopup-color-"+b.params.colorStyle+'"><div class="eupopup-head">'+b.params.popupTitle+'</div><div class="eupopup-body">'+b.params.popupText+'</div><div class="eupopup-buttons"><a href="#" class="eupopup-button eupopup-button_1">'+b.params.buttonContinueTitle+'</a><a href="'+b.params.cookiePolicyUrl+'"'+(b.params.buttonLearnmoreOpenInNewWindow?" target=_blank ":"")+' class="eupopup-button eupopup-button_2">'+b.params.buttonLearnmoreTitle+'</a><div class="clearfix"></div></div><a href="#" class="eupopup-closebutton">x</a></div>';return a},e=function(c){var d=new Date,e=24*b.params.agreementExpiresInDays*60*60*1e3;d.setTime(d.getTime()+e);var f="expires="+d.toGMTString();document.cookie=b.vars.COOKIE_NAME+"="+c+"; "+f+";path=/",a(document).trigger("user_cookie_consent_changed",{consent:c})},f=function(){for(var a=!1,c=document.cookie.split(";"),d=0;d<c.length;d++){var e=c[d].trim();0==e.indexOf(b.vars.COOKIE_NAME)&&(a=e.substring(b.vars.COOKIE_NAME.length+1,e.length))}return a},g=function(){a(".eupopup-container").animate({opacity:0,height:0},200,function(){a(".eupopup-container").hide(0)})},h={init:function(h){c(a(".eupopup").first(),a(".eupopup-markup").html(),h),f()||b.vars.INITIALISED||(b.vars.INITIALISED=!0,b.vars.HTML_MARKUP=d(),a(".eupopup-block").length>0?a(".eupopup-block").append(b.vars.HTML_MARKUP):a("BODY").append(b.vars.HTML_MARKUP),a(".eupopup-button_1").click(function(){return e(!0),g(),!1}),a(".eupopup-closebutton").click(function(){return e(!0),g(),!1}),a(".eupopup-container").show(),b.params.autoAcceptCookiePolicy&&e(!0))}};return h}});
define('tool_policy/managedocsactions', ["jquery","core/log","core/config","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f){"use strict";function g(a){this.base=a,this.initEvents()}var h={LINKS:"[data-action]",MAKE_CURRENT:'[data-action="makecurrent"]',INACTIVATE:'[data-action="inactivate"]',DELETE:'[data-action="delete"]'};return g.prototype.initEvents=function(){var g=this;g.base.on("click",h.LINKS,function(g){g.stopPropagation();var i,j,k=a(g.currentTarget);if(k.is(h.MAKE_CURRENT))i=d.get_strings([{key:"activating",component:"tool_policy"},{key:"activateconfirm",component:"tool_policy",param:{name:k.closest("[data-policy-name]").attr("data-policy-name"),revision:k.closest("[data-policy-revision]").attr("data-policy-revision")}},{key:"activateconfirmyes",component:"tool_policy"}]);else if(k.is(h.INACTIVATE))i=d.get_strings([{key:"inactivating",component:"tool_policy"},{key:"inactivatingconfirm",component:"tool_policy",param:{name:k.closest("[data-policy-name]").attr("data-policy-name"),revision:k.closest("[data-policy-revision]").attr("data-policy-revision")}},{key:"inactivatingconfirmyes",component:"tool_policy"}]);else{if(!k.is(h.DELETE))return void b.error("unknown action type detected","tool_policy/managedocsactions");i=d.get_strings([{key:"deleting",component:"tool_policy"},{key:"deleteconfirm",component:"tool_policy",param:{name:k.closest("[data-policy-name]").attr("data-policy-name"),revision:k.closest("[data-policy-revision]").attr("data-policy-revision")}},{key:"delete",component:"core"}])}g.preventDefault(),i.then(function(a){return j=a,e.create({title:j[0],body:j[1],type:e.types.SAVE_CANCEL})}).then(function(a){return a.setSaveButtonText(j[2]),a.getRoot().on(f.save,function(){window.location.href=k.attr("href")+"&sesskey="+c.sesskey+"&confirm=1"}),a.getRoot().on(f.hidden,function(){a.destroy()}),a.show(),!0})["catch"](function(a){return b.error(a),!1})})},{init:function(b){var c=a(document.getElementById(b));if(c.length)return new g(c);throw new Error("managedocsactions: Invalid base element identifier")}}});
define('tool_templatelibrary/search', ["jquery","core/ajax","core/log","core/notification","core/templates","core/config"],function(a,b,c,d,e,f){var g=function(b){e.render("tool_templatelibrary/search_results",{templates:b}).done(function(b,c){e.replaceNode(a('[data-region="searchresults"]'),b,c)}).fail(d.exception)},h=function(c){var e=a('[data-field="component"]').val(),f=a('[data-field="search"]').val();document.location.hash=f,b.call([{methodname:"tool_templatelibrary_list_templates",args:{component:e,search:f,themename:c},done:g,fail:d.exception}],!0,!1)},i=null,j=function(a,b){null!==i&&window.clearTimeout(i),i=window.setTimeout(function(){a(),i=null},b)},k=function(){j(h.bind(this,f.theme),400)};return a('[data-region="list-templates"]').on("change",'[data-field="component"]',k),a('[data-region="list-templates"]').on("input",'[data-field="search"]',k),a('[data-field="search"]').val(document.location.hash.replace("#","")),h(f.theme),{}});
define('tool_templatelibrary/display', ["jquery","core/ajax","core/log","core/notification","core/templates","core/config","core/str"],function(a,b,c,d,e,f,g){var h=function(a,b){if(!a)return!1;var c="@template "+b,d=0,e=[];if(e=a.match(/{{!([\s\S]*?)}}/g),null!==e)for(d=0;d<e.length;d++){var f=e[d],g=f.indexOf(c);if(g!==-1){var h=g+c.length+1;return f=f.substr(h,f.length-2-h)}}return!1},i=function(b,f,i){g.get_string("templateselected","tool_templatelibrary",b).done(function(b){a('[data-region="displaytemplateheader"]').text(b)}).fail(d.exception);var j=h(f,b);j===!1&&(j=h(i,b)),j&&(f=j),a('[data-region="displaytemplatesource"]').text(f);var k=f.match(/Example context \(json\):([\s\S]*)/),l=!1;if(k){var m=k[1].trim();try{l=a.parseJSON(m)}catch(n){c.debug("Could not parse json example context for template."),c.debug(n)}}l?e.render(b,l).done(function(b,c){e.replaceNodeContents(a('[data-region="displaytemplateexample"]'),b,c)}).fail(d.exception):g.get_string("templatehasnoexample","tool_templatelibrary").done(function(b){a('[data-region="displaytemplateexample"]').text(b)}).fail(d.exception)},j=function(c){var e=c.split("/"),g=e.shift(),h=e.shift(),j=b.call([{methodname:"core_output_load_template",args:{component:g,template:h,themename:f.theme,includecomments:!0}},{methodname:"tool_templatelibrary_load_canonical_template",args:{component:g,template:h}}],!0,!1);a.when.apply(a,j).done(function(a,b){i(c,a,b)}).fail(d.exception)};return a('[data-region="list-templates"]').on("click","[data-templatename]",function(b){var c=a(this).data("templatename");b.preventDefault(),j(c)}),{}});
!function(a,b){"function"==typeof define&&define.amd?define('tool_usertours/tour', ["jquery","core/popper"],function(c,d){return a.Tour=b(c,d)}):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("popper.js")):a.Tour=b(a.$,a.Popper)}(this,function(a,b){"use strict";function c(a){this.init(a)}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};return c.prototype.tourName,c.prototype.storageKey,c.prototype.storage,c.prototype.originalConfiguration,c.prototype.listeners,c.prototype.eventHandlers,c.prototype.steps,c.prototype.currentStepNode,c.prototype.currentStepNumber,c.prototype.currentStepPopper,c.prototype.currentStepConfig,c.prototype.templateContent,c.prototype.init=function(a){this.eventHandlers={},this.reset(),this.originalConfiguration=a||{},this.configure.apply(this,arguments);try{this.storage=window.sessionStorage,this.storageKey="tourstate_"+this.tourName}catch(b){this.storage=!1,this.storageKey=""}return this},c.prototype.reset=function(){return this.hide(),this.eventHandlers=[],this.resetStepListeners(),this.originalConfiguration={},this.steps=[],this.currentStepNumber=0,this},c.prototype.configure=function(a){var b=this;return"object"===("undefined"==typeof a?"undefined":d(a))&&("undefined"!=typeof a.tourName&&(this.tourName=a.tourName),a.eventHandlers&&!function(){var c=void 0;for(c in a.eventHandlers)a.eventHandlers[c].forEach(function(a){this.addEventHandler(c,a)},b)}(),this.resetStepDefaults(!0),"object"===d(a.steps)&&(this.steps=a.steps),"undefined"!=typeof a.template&&(this.templateContent=a.template)),this.checkMinimumRequirements(),this},c.prototype.checkMinimumRequirements=function(){if(!this.tourName)throw new Error("Tour Name required");if(!this.steps||!this.steps.length)throw new Error("Steps must be specified")},c.prototype.resetStepDefaults=function(a){return"undefined"==typeof a&&(a=!0),this.stepDefaults={},a&&"undefined"!=typeof this.originalConfiguration.stepDefaults?this.setStepDefaults(this.originalConfiguration.stepDefaults):this.setStepDefaults({}),this},c.prototype.setStepDefaults=function(b){return this.stepDefaults||(this.stepDefaults={}),a.extend(this.stepDefaults,{element:"",placement:"top",delay:0,moveOnClick:!1,moveAfterTime:0,orphan:!1,direction:1},b),this},c.prototype.getCurrentStepNumber=function(){return parseInt(this.currentStepNumber,10)},c.prototype.setCurrentStepNumber=function(a){if(this.currentStepNumber=a,this.storage)try{this.storage.setItem(this.storageKey,a)}catch(b){b.code===DOMException.QUOTA_EXCEEDED_ERR&&this.storage.removeItem(this.storageKey)}},c.prototype.getNextStepNumber=function(a){"undefined"==typeof a&&(a=this.getCurrentStepNumber());for(var b=a+1;b<=this.steps.length;){if(this.isStepPotentiallyVisible(this.getStepConfig(b)))return b;b++}return null},c.prototype.getPreviousStepNumber=function(a){"undefined"==typeof a&&(a=this.getCurrentStepNumber());for(var b=a-1;b>=0;){if(this.isStepPotentiallyVisible(this.getStepConfig(b)))return b;b--}return null},c.prototype.isLastStep=function(a){var b=this.getNextStepNumber(a);return null===b},c.prototype.isFirstStep=function(a){var b=this.getPreviousStepNumber(a);return null===b},c.prototype.isStepPotentiallyVisible=function(a){return!!a&&(!!this.isStepActuallyVisible(a)||(!("undefined"==typeof a.orphan||!a.orphan)||!("undefined"==typeof a.delay||!a.delay)))},c.prototype.isStepActuallyVisible=function(a){if(!a)return!1;var b=this.getStepTarget(a);return!!(b&&b.length&&b.is(":visible"))&&!!b.length},c.prototype.next=function(){return this.gotoStep(this.getNextStepNumber())},c.prototype.previous=function(){return this.gotoStep(this.getPreviousStepNumber(),-1)},c.prototype.gotoStep=function(a,b){if(a<0)return this.endTour();var c=this.getStepConfig(a);return null===c?this.endTour():this._gotoStep(c,b)},c.prototype._gotoStep=function(a,b){if(!a)return this.endTour();if("undefined"!=typeof a.delay&&a.delay&&!a.delayed)return a.delayed=!0,window.setTimeout(this._gotoStep.bind(this),a.delay,a,b),this;if(!a.orphan&&!this.isStepActuallyVisible(a)){var c=b==-1?"getPreviousStepNumber":"getNextStepNumber";return this.gotoStep(this[c](a.stepNumber),b)}return this.hide(),this.fireEventHandlers("beforeRender",a),this.renderStep(a),this.fireEventHandlers("afterRender",a),this},c.prototype.getStepConfig=function(b){if(null===b||b<0||b>=this.steps.length)return null;var c=this.normalizeStepConfig(this.steps[b]);return c=a.extend(c,{stepNumber:b})},c.prototype.normalizeStepConfig=function(b){return"undefined"!=typeof b.reflex&&"undefined"==typeof b.moveAfterClick&&(b.moveAfterClick=b.reflex),"undefined"!=typeof b.element&&"undefined"==typeof b.target&&(b.target=b.element),"undefined"!=typeof b.content&&"undefined"==typeof b.body&&(b.body=b.content),b=a.extend({},this.stepDefaults,b),b=a.extend({},{attachTo:b.target,attachPoint:"after"},b),b.attachTo&&(b.attachTo=a(b.attachTo).first()),b},c.prototype.getStepTarget=function(b){return b.target?a(b.target):null},c.prototype.fireEventHandlers=function(a,b){return"undefined"==typeof this.eventHandlers[a]?this:(this.eventHandlers[a].forEach(function(a){a.call(this,b)},this),this)},c.prototype.addEventHandler=function(a,b){return"undefined"==typeof this.eventHandlers[a]&&(this.eventHandlers[a]=[]),this.eventHandlers[a].push(b),this},c.prototype.processStepListeners=function(b){if(this.listeners.push({node:this.currentStepNode,args:["click",'[data-role="next"]',a.proxy(this.next,this)]},{node:this.currentStepNode,args:["click",'[data-role="previous"]',a.proxy(this.previous,this)]},{node:this.currentStepNode,args:["click",'[data-role="end"]',a.proxy(this.endTour,this)]},{node:a('[data-flexitour="backdrop"]'),args:["click",a.proxy(this.hide,this)]},{node:a("body"),args:["keydown",a.proxy(this.handleKeyDown,this)]}),b.moveOnClick){var c=this.getStepTarget(b);this.listeners.push({node:c,args:["click",a.proxy(function(b){0===a(b.target).parents('[data-flexitour="container"]').length&&window.setTimeout(a.proxy(this.next,this),500)},this)]})}return this.listeners.forEach(function(a){a.node.on.apply(a.node,a.args)}),this},c.prototype.resetStepListeners=function(){return this.listeners&&this.listeners.forEach(function(a){a.node.off.apply(a.node,a.args)}),this.listeners=[],this},c.prototype.renderStep=function(b){this.currentStepConfig=b,this.setCurrentStepNumber(b.stepNumber);var c=a(this.getTemplateContent());return c.find('[data-placeholder="title"]').html(b.title),c.find('[data-placeholder="body"]').html(b.body),this.isFirstStep(b.stepNumber)?c.find('[data-role="previous"]').prop("disabled",!0):c.find('[data-role="previous"]').prop("disabled",!1),this.isLastStep(b.stepNumber)?c.find('[data-role="next"]').prop("disabled",!0):c.find('[data-role="next"]').prop("disabled",!1),c.find('[data-role="previous"]').attr("role","button"),c.find('[data-role="next"]').attr("role","button"),c.find('[data-role="end"]').attr("role","button"),b.template=c,this.addStepToPage(b),this.processStepListeners(b),this},c.prototype.getTemplateContent=function(){return a(this.templateContent).clone()},c.prototype.addStepToPage=function(c){var d=(c.template,a('<span data-flexitour="container"></span>').html(c.template).hide()),e=a("body, html").stop(!0,!0);if(this.isStepActuallyVisible(c)){var f=this.getStepTarget(c);f.data("flexitour","target");var g=this.calculateZIndex(f);g&&(c.zIndex=g+1),c.zIndex&&d.css("zIndex",c.zIndex+1),this.positionBackdrop(c),a(document.body).append(d),this.currentStepNode=d,this.currentStepNode.css({top:0,left:0}),e.animate({scrollTop:this.calculateScrollTop(c)}).promise().then(function(){this.positionStep(c),this.revealStep(c)}.bind(this))}else c.orphan&&(c.isOrphan=!0,c.attachTo=a("body").first(),c.attachPoint="append",this.positionBackdrop(c),d.addClass("orphan"),a(document.body).append(d),this.currentStepNode=d,this.currentStepNode.offset(this.calculateStepPositionInPage()),this.currentStepNode.css("position","fixed"),this.currentStepPopper=new b(a("body"),this.currentStepNode[0],{removeOnDestroy:!0,placement:c.placement+"-start",arrowElement:'[data-role="arrow"]',modifiers:{hide:{enabled:!1},applyStyle:{onLoad:null,enabled:!1}}}),this.revealStep(c));return this},c.prototype.revealStep=function(b){return this.currentStepNode.fadeIn("",a.proxy(function(){this.announceStep(b),this.currentStepNode.focus(),window.setTimeout(a.proxy(function(){this.currentStepNode&&this.currentStepNode.focus()},this),100)},this)),this},c.prototype.announceStep=function(a){var b="tour-step-"+this.tourName+"-"+a.stepNumber;this.currentStepNode.attr("id",b);var c=this.currentStepNode.find('[data-placeholder="body"]').first();c.attr("id",b+"-body"),c.attr("role","document");var d=this.currentStepNode.find('[data-placeholder="title"]').first();d.attr("id",b+"-title"),d.attr("aria-labelledby",b+"-body"),this.currentStepNode.attr("role","dialog"),this.currentStepNode.attr("tabindex",0),this.currentStepNode.attr("aria-labelledby",b+"-title"),this.currentStepNode.attr("aria-describedby",b+"-body");var e=this.getStepTarget(a);return e&&(e.attr("tabindex")||e.attr("tabindex",0),e.data("original-describedby",e.attr("aria-describedby")).attr("aria-describedby",b+"-body")),this.accessibilityShow(a),this},c.prototype.handleKeyDown=function(b){var c="a[href], link[href], [draggable=true], [contenteditable=true], :input:enabled, [tabindex], button:enabled";switch(b.keyCode){case 27:this.endTour();break;case 9:(function(){if(this.currentStepConfig.hasBackdrop){var d=a(document.activeElement),e=this.getStepTarget(this.currentStepConfig),f=a(c),g=a('span[data-flexitour="container"]'),h=void 0;e&&(f=f.filter(function(a,b){return null!=e&&(e.has(b).length||g.has(b).length||e.is(b)||g.is(b))})),f.each(function(a,b){if(d.is(b))return h=a,!1});var i=void 0,j=void 0,k=void 0;if(void 0!=h){var l=1;b.shiftKey&&(l=-1),i=h;do i+=l,j=a(f[i]);while(j.length&&j.is(":disabled")||j.is(":hidden"));j.length?(k=j.closest(e).length,k=k||j.closest(this.currentStepNode).length):k=!1}k?j.focus():b.shiftKey?this.currentStepNode.find(c).last().focus():this.currentStepConfig.isOrphan?this.currentStepNode.focus():e.focus(),b.preventDefault()}}).call(this)}},c.prototype.startTour=function(a){if(this.storage&&"undefined"==typeof a){var b=this.storage.getItem(this.storageKey);if(b){var c=parseInt(b,10);c<=this.steps.length&&(a=c)}}return"undefined"==typeof a&&(a=this.getCurrentStepNumber()),this.fireEventHandlers("beforeStart",a),this.gotoStep(a),this.fireEventHandlers("afterStart",a),this},c.prototype.restartTour=function(){return this.startTour(0)},c.prototype.endTour=function(){if(this.fireEventHandlers("beforeEnd"),this.currentStepConfig){var a=this.getStepTarget(this.currentStepConfig);a&&(a.attr("tabindex")||a.attr("tabindex","-1"),a.focus())}return this.hide(!0),this.fireEventHandlers("afterEnd"),this},c.prototype.hide=function(b){if(this.fireEventHandlers("beforeHide"),this.currentStepNode&&this.currentStepNode.length&&(this.currentStepNode.hide(),this.currentStepPopper&&this.currentStepPopper.destroy()),this.currentStepConfig){var c=this.getStepTarget(this.currentStepConfig);c&&(c.data("original-labelledby")&&c.attr("aria-labelledby",c.data("original-labelledby")),c.data("original-describedby")&&c.attr("aria-describedby",c.data("original-describedby")),c.data("original-tabindex")&&c.attr("tabindex",c.data("tabindex"))),this.currentStepConfig=null}var d=0;if(b&&(d=400),a('[data-flexitour="step-background"]').remove(),a('[data-flexitour="step-backdrop"]').removeAttr("data-flexitour"),a('[data-flexitour="backdrop"]').fadeOut(d,function(){a(this).remove()}),this.currentStepNode&&this.currentStepNode.length){var e=this.currentStepNode.attr("id");if(e){var f='[aria-describedby="'+e+'-body"]';a(f).removeAttr("tabindex"),a(f).removeAttr("aria-describedby")}}return this.resetStepListeners(),this.accessibilityHide(),this.fireEventHandlers("afterHide"),this.currentStepNode=null,this.currentStepPopper=null,this},c.prototype.show=function(){var a=this.getCurrentStepNumber();return this.gotoStep(a)},c.prototype.getStepContainer=function(){return a(this.currentStepNode)},c.prototype.calculateScrollTop=function(b){var c=a(window).scrollTop(),d=a(window).height(),e=this.getStepTarget(b);return c="top"===b.placement?e.offset().top-d/2:"bottom"===b.placement?e.offset().top+e.height()-d/2:e.height()<=.8*d?e.offset().top-(d-e.height())/2:e.offset().top-.2*d,c=Math.max(0,c),c=Math.min(a(document).height()-d,c),Math.ceil(c)},c.prototype.calculateStepPositionInPage=function(){var b=a(window).height(),c=this.currentStepNode.height(),d=a(window).width(),e=this.currentStepNode.width();return{top:Math.ceil((b-c)/2),left:Math.ceil((d-e)/2)}},c.prototype.positionStep=function(c){var d=this.currentStepNode;if(!d||!d.length)return this;var e=void 0;switch(c.placement){case"left":e=["left","right","top","bottom"];break;case"right":e=["right","left","top","bottom"];break;case"top":e=["top","bottom","right","left"];break;case"bottom":e=["bottom","top","right","left"];break;default:e="flip"}var f=this.getStepTarget(c),g={placement:c.placement+"-start",removeOnDestroy:!0,modifiers:{flip:{behaviour:e},arrow:{element:'[data-role="arrow"]'}},onCreate:function(a){h(a)},onUpdate:function(a){h(a)}},h=function(b){var c=b.placement.split("-")[0],d=["left","right"].indexOf(c)!==-1,e=b.instance.popper.querySelector('[data-role="arrow"]'),f=a(b.instance.popper.querySelector('[data-role="flexitour-step"]'));if(d){var g=parseFloat(window.getComputedStyle(e).height),h=parseFloat(window.getComputedStyle(e).top),i=parseFloat(window.getComputedStyle(b.instance.popper).height),j=parseFloat(window.getComputedStyle(b.instance.popper).top),k=parseFloat(f.css("borderTopWidth")),l=2*parseFloat(f.css("borderTopLeftRadius")),m=h+g/2,n=i+j-k-l,o=j+k+l;if(m>=n||m<=o){var p=0;p=m>i/2?n-g:o+g,a(e).css("top",p)}}else{var q=parseFloat(window.getComputedStyle(e).width),r=parseFloat(window.getComputedStyle(e).left),s=parseFloat(window.getComputedStyle(b.instance.popper).width),t=parseFloat(window.getComputedStyle(b.instance.popper).left),u=parseFloat(f.css("borderTopWidth")),v=2*parseFloat(f.css("borderTopLeftRadius")),w=r+q/2,x=s+t-u-v,y=t+u+v;if(w>=x||w<=y){var z=0;z=w>s/2?x-q:y+q,a(e).css("left",z)}}},i=a('[data-flexitour="step-background"]');return i.length&&(f=i),this.currentStepPopper=new b(f,d[0],g),this},c.prototype.positionBackdrop=function(b){if(b.backdrop){this.currentStepConfig.hasBackdrop=!0;var c=a('<div data-flexitour="backdrop"></div>');if(b.zIndex?"append"===b.attachPoint?b.attachTo.append(c):c.insertAfter(b.attachTo):a("body").append(c),this.isStepActuallyVisible(b)){var d=a('<div data-flexitour="step-background"></div>'),e=this.getStepTarget(b),f=10,g=e;f&&(g=a("body")),d.css({width:e.outerWidth()+f+f,height:e.outerHeight()+f+f,left:e.offset().left-f,top:e.offset().top-f,backgroundColor:this.calculateInherittedBackgroundColor(g)}),e.offset().left<f&&d.css({width:e.outerWidth()+e.offset().left+f,left:e.offset().left}),e.offset().top<f&&d.css({height:e.outerHeight()+e.offset().top+f,top:e.offset().top});var h=e.css("borderRadius");h&&h!==a("body").css("borderRadius")&&d.css("borderRadius",h);var i=this.calculatePosition(e);"fixed"===i?d.css("top",0):"absolute"===i&&d.css("position","fixed");var j=d.clone();j.css({backgroundColor:c.css("backgroundColor"),opacity:c.css("opacity")}),j.attr("data-flexitour","step-background-fader"),b.zIndex?"append"===b.attachPoint?b.attachTo.append(d):(j.insertAfter(b.attachTo),d.insertAfter(b.attachTo)):(a("body").append(j),a("body").append(d)),e.attr("data-flexitour","step-backdrop"),b.zIndex&&(c.css("zIndex",b.zIndex),d.css("zIndex",b.zIndex+1),e.css("zIndex",b.zIndex+2)),j.fadeOut("2000",function(){a(this).remove()})}}return this},c.prototype.calculateZIndex=function(b){for(b=a(b);b.length&&b[0]!==document;){var c=b.css("position");if("absolute"===c||"relative"===c||"fixed"===c){var d=parseInt(b.css("zIndex"),10);if(!isNaN(d)&&0!==d)return d}b=b.parent()}return 0},c.prototype.calculateInherittedBackgroundColor=function(b){var c=a("<div>").hide();a("body").append(c);var d=c.css("backgroundColor");for(c.remove(),b=a(b);b.length&&b[0]!==document;){var e=b.css("backgroundColor");if(e!==d)return e;b=b.parent()}return null},c.prototype.calculatePosition=function(b){for(b=a(b);b.length&&b[0]!==document;){var c=b.css("position");if("static"!==c)return c;b=b.parent()}return null},c.prototype.accessibilityShow=function(){var b="data-has-hidden",c="aria-hidden",d=function(a){var d=a.data("flexitour");if(d)switch(d){case"container":case"target":return}var e=a.attr(c);e||(a.attr(b,!0),a.attr(c,!0))};this.currentStepNode.siblings().each(function(b,c){d(a(c))}),this.currentStepNode.parentsUntil("body").siblings().each(function(b,c){d(a(c))})},c.prototype.accessibilityHide=function(){var b="data-has-hidden",c="aria-hidden",d=function(a){var d=a.attr(b);"undefined"!=typeof d&&(a.removeAttr(b),a.removeAttr(c))};a("["+b+"]").each(function(b,c){d(a(c))})},"object"===("undefined"==typeof exports?"undefined":d(exports))&&(module.exports=c),c});
define('tool_usertours/usertours', ["core/ajax","tool_usertours/tour","jquery","core/templates","core/str","core/log","core/notification"],function(a,b,c,d,e,f,g){var h={tourId:null,currentTour:null,context:null,init:function(a,b,d){h.tourId=a,h.context=d,"undefined"==typeof b&&(b=!0),b&&h.fetchTour(a),h.addResetLink(),c("body").on("click",'[data-action="tool_usertours/resetpagetour"]',function(a){a.preventDefault(),h.resetTourState(h.tourId)})},fetchTour:function(b){M.util.js_pending("admin_usertour_fetchTour"+b),c.when(a.call([{methodname:"tool_usertours_fetch_and_start_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0],d.render("tool_usertours/tourstep",{})).then(function(a,c){return h.startBootstrapTour(b,c[0],a.tourconfig)}).always(function(){M.util.js_complete("admin_usertour_fetchTour"+b)}).fail(g.exception)},addResetLink:function(){var a;M.util.js_pending("admin_usertour_addResetLink"),a=c(c(".tool_usertours-resettourcontainer").length?".tool_usertours-resettourcontainer":c(".logininfo").length?".logininfo":c("footer").length?"footer":"body"),d.render("tool_usertours/resettour",{}).then(function(b,c){d.appendNodeContents(a,b,c)}).always(function(){M.util.js_complete("admin_usertour_addResetLink")}).fail()},startBootstrapTour:function(a,c,d){return h.currentTour&&(d.onEnd=null,h.currentTour.endTour(),delete h.currentTour),d.eventHandlers={afterEnd:[h.markTourComplete],afterRender:[h.markStepShown]},d.tourName=d.name,delete d.name,d.template=c,d.steps=d.steps.map(function(a){return"undefined"!=typeof a.element&&(a.target=a.element,delete a.element),"undefined"!=typeof a.reflex&&(a.moveOnClick=!!a.reflex,delete a.reflex),"undefined"!=typeof a.content&&(a.body=a.content,delete a.content),a}),h.currentTour=new b(d),h.currentTour.startTour()},markStepShown:function(){var b=this.getStepConfig(this.getCurrentStepNumber());c.when(a.call([{methodname:"tool_usertours_step_shown",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:b.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},markTourComplete:function(){var b=this.getStepConfig(this.getCurrentStepNumber());c.when(a.call([{methodname:"tool_usertours_complete_tour",args:{tourid:h.tourId,context:h.context,pageurl:window.location.href,stepid:b.stepid,stepindex:this.getCurrentStepNumber()}}])[0]).fail(f.error)},resetTourState:function(b){c.when(a.call([{methodname:"tool_usertours_reset_tour",args:{tourid:b,context:h.context,pageurl:window.location.href}}])[0]).then(function(a){a.startTour&&h.fetchTour(a.startTour)}).fail(g.exception)}};return{init:h.init,resetTourState:h.resetTourState}});
define('tool_usertours/managesteps', ["jquery","core/str","core/notification"],function(a,b,c){var d={removeStep:function(d){d.preventDefault();var e=a(d.currentTarget).attr("href");b.get_strings([{key:"confirmstepremovaltitle",component:"tool_usertours"},{key:"confirmstepremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).then(function(a){c.confirm(a[0],a[1],a[2],a[3],function(){window.location=e})})["catch"]()},setup:function(){a("body").delegate('[data-action="delete"]',"click",d.removeStep)}};return{setup:d.setup}});
define('tool_usertours/managetours', ["jquery","core/ajax","core/str","core/notification"],function(a,b,c,d){var e={removeTour:function(b){b.preventDefault();var e=a(b.currentTarget).attr("href");c.get_strings([{key:"confirmtourremovaltitle",component:"tool_usertours"},{key:"confirmtourremovalquestion",component:"tool_usertours"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).then(function(a){d.confirm(a[0],a[1],a[2],a[3],function(){window.location=e})})["catch"]()},setup:function(){a("body").delegate('[data-action="delete"]',"click",e.removeTour)}};return{setup:e.setup}});
define('theme_boost/popover', ["exports","jquery","./tooltip"],function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function g(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function h(a,b,c){return b&&g(a.prototype,b),c&&g(a,c),a}function i(a,b){if(b&&("object"===e(b)||"function"==typeof b))return b;if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function j(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function k(){return k=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},k.apply(this,arguments)}Object.defineProperty(a,"__esModule",{value:!0});var l=d(b),m=d(c),n=function(a){var b="popover",c="4.0.0",d="bs.popover",g=".".concat(d),l=a.fn[b],n="bs-popover",o=new RegExp("(^|\\s)".concat(n,"\\S+"),"g"),p=k({},m["default"].Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),q=k({},m["default"].DefaultType,{content:"(string|element|function)"}),r={FADE:"fade",SHOW:"show"},s={TITLE:".popover-header",CONTENT:".popover-body"},t={HIDE:"hide".concat(g),HIDDEN:"hidden".concat(g),SHOW:"show".concat(g),SHOWN:"shown".concat(g),INSERTED:"inserted".concat(g),CLICK:"click".concat(g),FOCUSIN:"focusin".concat(g),FOCUSOUT:"focusout".concat(g),MOUSEENTER:"mouseenter".concat(g),MOUSELEAVE:"mouseleave".concat(g)},u=function(k){function l(){return f(this,l),i(this,(l.__proto__||Object.getPrototypeOf(l)).apply(this,arguments))}return j(l,k),h(l,[{key:"isWithContent",value:function(){return this.getTitle()||this._getContent()}},{key:"addAttachmentClass",value:function(b){a(this.getTipElement()).addClass("".concat(n,"-").concat(b))}},{key:"getTipElement",value:function(){return this.tip=this.tip||a(this.config.template)[0],this.tip}},{key:"setContent",value:function(){var b=a(this.getTipElement());this.setElementContent(b.find(s.TITLE),this.getTitle());var c=this._getContent();"function"==typeof c&&(c=c.call(this.element)),this.setElementContent(b.find(s.CONTENT),c),b.removeClass("".concat(r.FADE," ").concat(r.SHOW))}},{key:"_getContent",value:function(){return this.element.getAttribute("data-content")||this.config.content}},{key:"_cleanTipClass",value:function(){var b=a(this.getTipElement()),c=b.attr("class").match(o);null!==c&&c.length>0&&b.removeClass(c.join(""))}}],[{key:"_jQueryInterface",value:function(b){return this.each(function(){var c=a(this).data(d),f="object"===e(b)?b:null;if((c||!/destroy|hide/.test(b))&&(c||(c=new l(this,f),a(this).data(d,c)),"string"==typeof b)){if("undefined"==typeof c[b])throw new TypeError('No method named "'.concat(b,'"'));c[b]()}})}},{key:"VERSION",get:function(){return c}},{key:"Default",get:function(){return p}},{key:"NAME",get:function(){return b}},{key:"DATA_KEY",get:function(){return d}},{key:"Event",get:function(){return t}},{key:"EVENT_KEY",get:function(){return g}},{key:"DefaultType",get:function(){return q}}]),l}(m["default"]);return a.fn[b]=u._jQueryInterface,a.fn[b].Constructor=u,a.fn[b].noConflict=function(){return a.fn[b]=l,u._jQueryInterface},u}(l["default"]);a["default"]=n});
define('theme_boost/util', ["exports","jquery"],function(a,b){"use strict";function c(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0});var d=c(b),e=function(a){function b(a){return{}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function c(){return{bindType:h.end,delegateType:h.end,handle:function(b){if(a(b.target).is(this))return b.handleObj.handler.apply(this,arguments)}}}function d(){return("undefined"==typeof window||!window.QUnit)&&{end:"transitionend"}}function e(b){var c=this,d=!1;return a(this).one(j.TRANSITION_END,function(){d=!0}),setTimeout(function(){d||j.triggerTransitionEnd(c)},b),this}function f(){h=d(),a.fn.emulateTransitionEnd=e,j.supportsTransitionEnd()&&(a.event.special[j.TRANSITION_END]=c())}function g(b){return b="function"==typeof a.escapeSelector?a.escapeSelector(b).substr(1):b.replace(/(:|\.|\[|\]|,|=|@)/g,"\\$1")}var h=!1,i=1e6,j={TRANSITION_END:"bsTransitionEnd",getUID:function(a){do a+=~~(Math.random()*i);while(document.getElementById(a));return a},getSelectorFromElement:function(b){var c=b.getAttribute("data-target");c&&"#"!==c||(c=b.getAttribute("href")||""),"#"===c.charAt(0)&&(c=g(c));try{var d=a(document).find(c);return d.length>0?c:null}catch(e){return null}},reflow:function(a){return a.offsetHeight},triggerTransitionEnd:function(b){a(b).trigger(h.end)},supportsTransitionEnd:function(){return Boolean(h)},isElement:function(a){return(a[0]||a).nodeType},typeCheckConfig:function(a,c,d){for(var e in d)if(Object.prototype.hasOwnProperty.call(d,e)){var f=d[e],g=c[e],h=g&&j.isElement(g)?"element":b(g);if(!new RegExp(f).test(h))throw new Error("".concat(a.toUpperCase(),": ")+'Option "'.concat(e,'" provided type "').concat(h,'" ')+'but expected type "'.concat(f,'".'))}}};return f(),j}(d["default"]);a["default"]=e});
define('theme_boost/dropdown', ["exports","jquery","core/popper","./util"],function(a,b,c,d){"use strict";function e(a){return a&&a.__esModule?a:{"default":a}}function f(a){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function g(){return g=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},g.apply(this,arguments)}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function j(a,b,c){return b&&i(a.prototype,b),c&&i(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var k=e(b),l=e(c),m=e(d),n=function(a){var b="dropdown",c="4.0.0",d="bs.dropdown",e=".".concat(d),i=".data-api",k=a.fn[b],n=27,o=32,p=9,q=38,r=40,s=3,t=new RegExp("".concat(q,"|").concat(r,"|").concat(n)),u={HIDE:"hide".concat(e),HIDDEN:"hidden".concat(e),SHOW:"show".concat(e),SHOWN:"shown".concat(e),CLICK:"click".concat(e),CLICK_DATA_API:"click".concat(e).concat(i),KEYDOWN_DATA_API:"keydown".concat(e).concat(i),KEYUP_DATA_API:"keyup".concat(e).concat(i)},v={DISABLED:"disabled",SHOW:"show",DROPUP:"dropup",DROPRIGHT:"dropright",DROPLEFT:"dropleft",MENURIGHT:"dropdown-menu-right",MENULEFT:"dropdown-menu-left",POSITION_STATIC:"position-static"},w={DATA_TOGGLE:'[data-toggle="dropdown"]',FORM_CHILD:".dropdown form",MENU:".dropdown-menu",NAVBAR_NAV:".navbar-nav",VISIBLE_ITEMS:".dropdown-menu .dropdown-item:not(.disabled)"},x={TOP:"top-start",TOPEND:"top-end",BOTTOM:"bottom-start",BOTTOMEND:"bottom-end",RIGHT:"right-start",RIGHTEND:"right-end",LEFT:"left-start",LEFTEND:"left-end"},y={offset:0,flip:!1,boundary:"scrollParent"},z={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)"},A=function(){function i(a,b){h(this,i),this._element=a,this._popper=null,this._config=this._getConfig(b),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}return j(i,[{key:"toggle",value:function(){if(!this._element.disabled&&!a(this._element).hasClass(v.DISABLED)){var b=i._getParentFromElement(this._element),c=a(this._menu).hasClass(v.SHOW);if(i._clearMenus(),!c){var d={relatedTarget:this._element},e=a.Event(u.SHOW,d);if(a(b).trigger(e),!e.isDefaultPrevented()){if(!this._inNavbar){if("undefined"==typeof l["default"])throw new TypeError("Bootstrap dropdown require Popper.js (https://popper.js.org)");var f=this._element;a(b).hasClass(v.DROPUP)&&(a(this._menu).hasClass(v.MENULEFT)||a(this._menu).hasClass(v.MENURIGHT))&&(f=b),"scrollParent"!==this._config.boundary&&a(b).addClass(v.POSITION_STATIC),this._popper=new l["default"](f,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===a(b).closest(w.NAVBAR_NAV).length&&a("body").children().on("mouseover",null,a.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),a(this._menu).toggleClass(v.SHOW),a(b).toggleClass(v.SHOW).trigger(a.Event(u.SHOWN,d))}}}}},{key:"dispose",value:function(){a.removeData(this._element,d),a(this._element).off(e),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)}},{key:"update",value:function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()}},{key:"_addEventListeners",value:function(){var b=this;a(this._element).on(u.CLICK,function(a){a.preventDefault(),a.stopPropagation(),b.toggle()})}},{key:"_getConfig",value:function(c){return c=g({},this.constructor.Default,a(this._element).data(),c),m["default"].typeCheckConfig(b,c,this.constructor.DefaultType),c}},{key:"_getMenuElement",value:function(){if(!this._menu){var b=i._getParentFromElement(this._element);this._menu=a(b).find(w.MENU)[0]}return this._menu}},{key:"_getPlacement",value:function(){var b=a(this._element).parent(),c=x.BOTTOM;return b.hasClass(v.DROPUP)?(c=x.TOP,a(this._menu).hasClass(v.MENURIGHT)&&(c=x.TOPEND)):b.hasClass(v.DROPRIGHT)?c=x.RIGHT:b.hasClass(v.DROPLEFT)?c=x.LEFT:a(this._menu).hasClass(v.MENURIGHT)&&(c=x.BOTTOMEND),c}},{key:"_detectNavbar",value:function(){return a(this._element).closest(".navbar").length>0}},{key:"_getPopperConfig",value:function(){var a=this,b={};"function"==typeof this._config.offset?b.fn=function(b){return b.offsets=g({},b.offsets,a._config.offset(b.offsets)||{}),b}:b.offset=this._config.offset;var c={placement:this._getPlacement(),modifiers:{offset:b,flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return c}}],[{key:"_jQueryInterface",value:function(b){return this.each(function(){var c=a(this).data(d),e="object"===f(b)?b:null;if(c||(c=new i(this,e),a(this).data(d,c)),"string"==typeof b){if("undefined"==typeof c[b])throw new TypeError('No method named "'.concat(b,'"'));c[b]()}})}},{key:"_clearMenus",value:function(b){if(!b||b.which!==s&&("keyup"!==b.type||b.which===p))for(var c=a.makeArray(a(w.DATA_TOGGLE)),e=0;e<c.length;e++){var f=i._getParentFromElement(c[e]),g=a(c[e]).data(d),h={relatedTarget:c[e]};if(g){var j=g._menu;if(a(f).hasClass(v.SHOW)&&!(b&&("click"===b.type&&/input|textarea/i.test(b.target.tagName)||"keyup"===b.type&&b.which===p)&&a.contains(f,b.target))){var k=a.Event(u.HIDE,h);a(f).trigger(k),k.isDefaultPrevented()||("ontouchstart"in document.documentElement&&a("body").children().off("mouseover",null,a.noop),c[e].setAttribute("aria-expanded","false"),a(j).removeClass(v.SHOW),a(f).removeClass(v.SHOW).trigger(a.Event(u.HIDDEN,h)))}}}}},{key:"_getParentFromElement",value:function(b){var c,d=m["default"].getSelectorFromElement(b);return d&&(c=a(d)[0]),c||b.parentNode}},{key:"_dataApiKeydownHandler",value:function(b){if((/input|textarea/i.test(b.target.tagName)?!(b.which===o||b.which!==n&&(b.which!==r&&b.which!==q||a(b.target).closest(w.MENU).length)):t.test(b.which))&&(b.preventDefault(),b.stopPropagation(),!this.disabled&&!a(this).hasClass(v.DISABLED))){var c=i._getParentFromElement(this),d=a(c).hasClass(v.SHOW);if(!d&&(b.which!==n||b.which!==o)||d&&(b.which===n||b.which===o)){if(b.which===n){var e=a(c).find(w.DATA_TOGGLE)[0];a(e).trigger("focus")}return void a(this).trigger("click")}var f=a(c).find(w.VISIBLE_ITEMS).get();if(0!==f.length){var g=f.indexOf(b.target);b.which===q&&g>0&&g--,b.which===r&&g<f.length-1&&g++,g<0&&(g=0),f[g].focus()}}}},{key:"VERSION",get:function(){return c}},{key:"Default",get:function(){return y}},{key:"DefaultType",get:function(){return z}}]),i}();return a(document).on(u.KEYDOWN_DATA_API,w.DATA_TOGGLE,A._dataApiKeydownHandler).on(u.KEYDOWN_DATA_API,w.MENU,A._dataApiKeydownHandler).on("".concat(u.CLICK_DATA_API," ").concat(u.KEYUP_DATA_API),A._clearMenus).on(u.CLICK_DATA_API,w.DATA_TOGGLE,function(b){b.preventDefault(),b.stopPropagation(),A._jQueryInterface.call(a(this),"toggle")}).on(u.CLICK_DATA_API,w.FORM_CHILD,function(a){a.stopPropagation()}),a.fn[b]=A._jQueryInterface,a.fn[b].Constructor=A,a.fn[b].noConflict=function(){return a.fn[b]=k,A._jQueryInterface},A}(k["default"],l["default"]);a["default"]=n});
define('theme_boost/carousel', ["exports","jquery","./util"],function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(){return f=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},f.apply(this,arguments)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function i(a,b,c){return b&&h(a.prototype,b),c&&h(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var j=d(b),k=d(c),l=function(a){var b="carousel",c="4.0.0",d="bs.carousel",h=".".concat(d),j=".data-api",l=a.fn[b],m=600,n=37,o=39,p=500,q={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0},r={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean"},s={NEXT:"next",PREV:"prev",LEFT:"left",RIGHT:"right"},t={SLIDE:"slide".concat(h),SLID:"slid".concat(h),KEYDOWN:"keydown".concat(h),MOUSEENTER:"mouseenter".concat(h),MOUSELEAVE:"mouseleave".concat(h),TOUCHEND:"touchend".concat(h),LOAD_DATA_API:"load".concat(h).concat(j),CLICK_DATA_API:"click".concat(h).concat(j)},u={CAROUSEL:"carousel",ACTIVE:"active",SLIDE:"slide",RIGHT:"carousel-item-right",LEFT:"carousel-item-left",NEXT:"carousel-item-next",PREV:"carousel-item-prev",ITEM:"carousel-item"},v={ACTIVE:".active",ACTIVE_ITEM:".active.carousel-item",ITEM:".carousel-item",NEXT_PREV:".carousel-item-next, .carousel-item-prev",INDICATORS:".carousel-indicators",DATA_SLIDE:"[data-slide], [data-slide-to]",DATA_RIDE:'[data-ride="carousel"]'},w=function(){function j(b,c){g(this,j),this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this._config=this._getConfig(c),this._element=a(b)[0],this._indicatorsElement=a(this._element).find(v.INDICATORS)[0],this._addEventListeners()}return i(j,[{key:"next",value:function(){this._isSliding||this._slide(s.NEXT)}},{key:"nextWhenVisible",value:function(){!document.hidden&&a(this._element).is(":visible")&&"hidden"!==a(this._element).css("visibility")&&this.next()}},{key:"prev",value:function(){this._isSliding||this._slide(s.PREV)}},{key:"pause",value:function(b){b||(this._isPaused=!0),a(this._element).find(v.NEXT_PREV)[0]&&k["default"].supportsTransitionEnd()&&(k["default"].triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null}},{key:"cycle",value:function(a){a||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))}},{key:"to",value:function(b){var c=this;this._activeElement=a(this._element).find(v.ACTIVE_ITEM)[0];var d=this._getItemIndex(this._activeElement);if(!(b>this._items.length-1||b<0)){if(this._isSliding)return void a(this._element).one(t.SLID,function(){return c.to(b)});if(d===b)return this.pause(),void this.cycle();var e=b>d?s.NEXT:s.PREV;this._slide(e,this._items[b])}}},{key:"dispose",value:function(){a(this._element).off(h),a.removeData(this._element,d),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null}},{key:"_getConfig",value:function(a){return a=f({},q,a),k["default"].typeCheckConfig(b,a,r),a}},{key:"_addEventListeners",value:function(){var b=this;this._config.keyboard&&a(this._element).on(t.KEYDOWN,function(a){return b._keydown(a)}),"hover"===this._config.pause&&(a(this._element).on(t.MOUSEENTER,function(a){return b.pause(a)}).on(t.MOUSELEAVE,function(a){return b.cycle(a)}),"ontouchstart"in document.documentElement&&a(this._element).on(t.TOUCHEND,function(){b.pause(),b.touchTimeout&&clearTimeout(b.touchTimeout),b.touchTimeout=setTimeout(function(a){return b.cycle(a)},p+b._config.interval)}))}},{key:"_keydown",value:function(a){if(!/input|textarea/i.test(a.target.tagName))switch(a.which){case n:a.preventDefault(),this.prev();break;case o:a.preventDefault(),this.next()}}},{key:"_getItemIndex",value:function(b){return this._items=a.makeArray(a(b).parent().find(v.ITEM)),this._items.indexOf(b)}},{key:"_getItemByDirection",value:function(a,b){var c=a===s.NEXT,d=a===s.PREV,e=this._getItemIndex(b),f=this._items.length-1,g=d&&0===e||c&&e===f;if(g&&!this._config.wrap)return b;var h=a===s.PREV?-1:1,i=(e+h)%this._items.length;return i===-1?this._items[this._items.length-1]:this._items[i]}},{key:"_triggerSlideEvent",value:function(b,c){var d=this._getItemIndex(b),e=this._getItemIndex(a(this._element).find(v.ACTIVE_ITEM)[0]),f=a.Event(t.SLIDE,{relatedTarget:b,direction:c,from:e,to:d});return a(this._element).trigger(f),f}},{key:"_setActiveIndicatorElement",value:function(b){if(this._indicatorsElement){a(this._indicatorsElement).find(v.ACTIVE).removeClass(u.ACTIVE);var c=this._indicatorsElement.children[this._getItemIndex(b)];c&&a(c).addClass(u.ACTIVE)}}},{key:"_slide",value:function(b,c){var d,e,f,g=this,h=a(this._element).find(v.ACTIVE_ITEM)[0],i=this._getItemIndex(h),j=c||h&&this._getItemByDirection(b,h),l=this._getItemIndex(j),n=Boolean(this._interval);if(b===s.NEXT?(d=u.LEFT,e=u.NEXT,f=s.LEFT):(d=u.RIGHT,e=u.PREV,f=s.RIGHT),j&&a(j).hasClass(u.ACTIVE))return void(this._isSliding=!1);var o=this._triggerSlideEvent(j,f);if(!o.isDefaultPrevented()&&h&&j){this._isSliding=!0,n&&this.pause(),this._setActiveIndicatorElement(j);var p=a.Event(t.SLID,{relatedTarget:j,direction:f,from:i,to:l});k["default"].supportsTransitionEnd()&&a(this._element).hasClass(u.SLIDE)?(a(j).addClass(e),k["default"].reflow(j),a(h).addClass(d),a(j).addClass(d),a(h).one(k["default"].TRANSITION_END,function(){a(j).removeClass("".concat(d," ").concat(e)).addClass(u.ACTIVE),a(h).removeClass("".concat(u.ACTIVE," ").concat(e," ").concat(d)),g._isSliding=!1,setTimeout(function(){return a(g._element).trigger(p)},0)}).emulateTransitionEnd(m)):(a(h).removeClass(u.ACTIVE),a(j).addClass(u.ACTIVE),this._isSliding=!1,a(this._element).trigger(p)),n&&this.cycle()}}}],[{key:"_jQueryInterface",value:function(b){return this.each(function(){var c=a(this).data(d),g=f({},q,a(this).data());"object"===e(b)&&(g=f({},g,b));var h="string"==typeof b?b:g.slide;if(c||(c=new j(this,g),a(this).data(d,c)),"number"==typeof b)c.to(b);else if("string"==typeof h){if("undefined"==typeof c[h])throw new TypeError('No method named "'.concat(h,'"'));c[h]()}else g.interval&&(c.pause(),c.cycle())})}},{key:"_dataApiClickHandler",value:function(b){var c=k["default"].getSelectorFromElement(this);if(c){var e=a(c)[0];if(e&&a(e).hasClass(u.CAROUSEL)){var g=f({},a(e).data(),a(this).data()),h=this.getAttribute("data-slide-to");h&&(g.interval=!1),j._jQueryInterface.call(a(e),g),h&&a(e).data(d).to(h),b.preventDefault()}}}},{key:"VERSION",get:function(){return c}},{key:"Default",get:function(){return q}}]),j}();return a(document).on(t.CLICK_DATA_API,v.DATA_SLIDE,w._dataApiClickHandler),a(window).on(t.LOAD_DATA_API,function(){a(v.DATA_RIDE).each(function(){var b=a(this);w._jQueryInterface.call(b,b.data())})}),a.fn[b]=w._jQueryInterface,a.fn[b].Constructor=w,a.fn[b].noConflict=function(){return a.fn[b]=l,w._jQueryInterface},w}(j["default"]);a["default"]=l});
define('theme_boost/alert', ["exports","jquery","./util"],function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var h=d(b),i=d(c),j=function(a){var b="alert",c="4.0.0",d="bs.alert",f=".".concat(d),h=".data-api",j=a.fn[b],k=150,l={DISMISS:'[data-dismiss="alert"]'},m={CLOSE:"close".concat(f),CLOSED:"closed".concat(f),CLICK_DATA_API:"click".concat(f).concat(h)},n={ALERT:"alert",FADE:"fade",SHOW:"show"},o=function(){function b(a){e(this,b),this._element=a}return g(b,[{key:"close",value:function(a){a=a||this._element;var b=this._getRootElement(a),c=this._triggerCloseEvent(b);c.isDefaultPrevented()||this._removeElement(b)}},{key:"dispose",value:function(){a.removeData(this._element,d),this._element=null}},{key:"_getRootElement",value:function(b){var c=i["default"].getSelectorFromElement(b),d=!1;return c&&(d=a(c)[0]),d||(d=a(b).closest(".".concat(n.ALERT))[0]),d}},{key:"_triggerCloseEvent",value:function(b){var c=a.Event(m.CLOSE);return a(b).trigger(c),c}},{key:"_removeElement",value:function(b){var c=this;return a(b).removeClass(n.SHOW),i["default"].supportsTransitionEnd()&&a(b).hasClass(n.FADE)?void a(b).one(i["default"].TRANSITION_END,function(a){return c._destroyElement(b,a)}).emulateTransitionEnd(k):void this._destroyElement(b)}},{key:"_destroyElement",value:function(b){a(b).detach().trigger(m.CLOSED).remove()}}],[{key:"_jQueryInterface",value:function(c){return this.each(function(){var e=a(this),f=e.data(d);f||(f=new b(this),e.data(d,f)),"close"===c&&f[c](this)})}},{key:"_handleDismiss",value:function(a){return function(b){b&&b.preventDefault(),a.close(this)}}},{key:"VERSION",get:function(){return c}}]),b}();return a(document).on(m.CLICK_DATA_API,l.DISMISS,o._handleDismiss(new o)),a.fn[b]=o._jQueryInterface,a.fn[b].Constructor=o,a.fn[b].noConflict=function(){return a.fn[b]=j,o._jQueryInterface},o}(h["default"]);a["default"]=j});
define('theme_boost/form-display-errors', ["jquery","core/event"],function(a,b){return{enhance:function(c){var d=document.getElementById(c);a(d).on(b.Events.FORM_FIELD_VALIDATION,function(b,c){b.preventDefault();var e=a(d).closest(".form-group"),f=e.find(".form-control-feedback");"TEXTAREA"==a(d).prop("tagName")&&e.find("[contenteditable]")&&(d=e.find("[contenteditable]")),""!==c?(e.addClass("has-danger"),e.data("client-validation-error",!0),a(d).addClass("is-invalid"),a(d).attr("aria-describedby",f.attr("id")),a(d).attr("aria-invalid",!0),f.attr("tabindex",0),f.html(c),f.is(":visible")||(f.show(),f.focus())):e.data("client-validation-error")===!0&&(e.removeClass("has-danger"),e.data("client-validation-error",!1),a(d).removeClass("is-invalid"),a(d).removeAttr("aria-describedby"),a(d).attr("aria-invalid",!1),f.hide())})}}});
define('theme_boost/collapse', ["exports","jquery","./util"],function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(){return f=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},f.apply(this,arguments)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function i(a,b,c){return b&&h(a.prototype,b),c&&h(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var j=d(b),k=d(c),l=function(a){var b="collapse",c="4.0.0",d="bs.collapse",h=".".concat(d),j=".data-api",l=a.fn[b],m=600,n={toggle:!0,parent:""},o={toggle:"boolean",parent:"(string|element)"},p={SHOW:"show".concat(h),SHOWN:"shown".concat(h),HIDE:"hide".concat(h),HIDDEN:"hidden".concat(h),CLICK_DATA_API:"click".concat(h).concat(j)},q={SHOW:"show",COLLAPSE:"collapse",COLLAPSING:"collapsing",COLLAPSED:"collapsed"},r={WIDTH:"width",HEIGHT:"height"},s={ACTIVES:".show, .collapsing",DATA_TOGGLE:'[data-toggle="collapse"]'},t=function(){function h(b,c){g(this,h),this._isTransitioning=!1,this._element=b,this._config=this._getConfig(c),this._triggerArray=a.makeArray(a('[data-toggle="collapse"][href="#'.concat(b.id,'"],')+'[data-toggle="collapse"][data-target="#'.concat(b.id,'"]')));for(var d=a(s.DATA_TOGGLE),e=0;e<d.length;e++){var f=d[e],i=k["default"].getSelectorFromElement(f);null!==i&&a(i).filter(b).length>0&&(this._selector=i,this._triggerArray.push(f))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}return i(h,[{key:"toggle",value:function(){a(this._element).hasClass(q.SHOW)?this.hide():this.show()}},{key:"show",value:function(){var b=this;if(!this._isTransitioning&&!a(this._element).hasClass(q.SHOW)){var c,e;if(this._parent&&(c=a.makeArray(a(this._parent).find(s.ACTIVES).filter('[data-parent="'.concat(this._config.parent,'"]'))),0===c.length&&(c=null)),!(c&&(e=a(c).not(this._selector).data(d),e&&e._isTransitioning))){var f=a.Event(p.SHOW);if(a(this._element).trigger(f),!f.isDefaultPrevented()){c&&(h._jQueryInterface.call(a(c).not(this._selector),"hide"),e||a(c).data(d,null));var g=this._getDimension();a(this._element).removeClass(q.COLLAPSE).addClass(q.COLLAPSING),this._element.style[g]=0,this._triggerArray.length>0&&a(this._triggerArray).removeClass(q.COLLAPSED).attr("aria-expanded",!0),this.setTransitioning(!0);var i=function(){a(b._element).removeClass(q.COLLAPSING).addClass(q.COLLAPSE).addClass(q.SHOW),b._element.style[g]="",b.setTransitioning(!1),a(b._element).trigger(p.SHOWN)};if(!k["default"].supportsTransitionEnd())return void i();var j=g[0].toUpperCase()+g.slice(1),l="scroll".concat(j);a(this._element).one(k["default"].TRANSITION_END,i).emulateTransitionEnd(m),this._element.style[g]="".concat(this._element[l],"px")}}}}},{key:"hide",value:function(){var b=this;if(!this._isTransitioning&&a(this._element).hasClass(q.SHOW)){var c=a.Event(p.HIDE);if(a(this._element).trigger(c),!c.isDefaultPrevented()){var d=this._getDimension();if(this._element.style[d]="".concat(this._element.getBoundingClientRect()[d],"px"),k["default"].reflow(this._element),a(this._element).addClass(q.COLLAPSING).removeClass(q.COLLAPSE).removeClass(q.SHOW),this._triggerArray.length>0)for(var e=0;e<this._triggerArray.length;e++){var f=this._triggerArray[e],g=k["default"].getSelectorFromElement(f);if(null!==g){var h=a(g);h.hasClass(q.SHOW)||a(f).addClass(q.COLLAPSED).attr("aria-expanded",!1)}}this.setTransitioning(!0);var i=function(){b.setTransitioning(!1),a(b._element).removeClass(q.COLLAPSING).addClass(q.COLLAPSE).trigger(p.HIDDEN)};return this._element.style[d]="",k["default"].supportsTransitionEnd()?void a(this._element).one(k["default"].TRANSITION_END,i).emulateTransitionEnd(m):void i()}}}},{key:"setTransitioning",value:function(a){this._isTransitioning=a}},{key:"dispose",value:function(){a.removeData(this._element,d),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null}},{key:"_getConfig",value:function(a){return a=f({},n,a),a.toggle=Boolean(a.toggle),k["default"].typeCheckConfig(b,a,o),a}},{key:"_getDimension",value:function(){var b=a(this._element).hasClass(r.WIDTH);return b?r.WIDTH:r.HEIGHT}},{key:"_getParent",value:function(){var b=this,c=null;k["default"].isElement(this._config.parent)?(c=this._config.parent,"undefined"!=typeof this._config.parent.jquery&&(c=this._config.parent[0])):c=a(this._config.parent)[0];var d='[data-toggle="collapse"][data-parent="'.concat(this._config.parent,'"]');return a(c).find(d).each(function(a,c){b._addAriaAndCollapsedClass(h._getTargetFromElement(c),[c])}),c}},{key:"_addAriaAndCollapsedClass",value:function(b,c){if(b){var d=a(b).hasClass(q.SHOW);c.length>0&&a(c).toggleClass(q.COLLAPSED,!d).attr("aria-expanded",d)}}}],[{key:"_getTargetFromElement",value:function(b){var c=k["default"].getSelectorFromElement(b);return c?a(c)[0]:null}},{key:"_jQueryInterface",value:function(b){return this.each(function(){var c=a(this),g=c.data(d),i=f({},n,c.data(),"object"===e(b)&&b);if(!g&&i.toggle&&/show|hide/.test(b)&&(i.toggle=!1),g||(g=new h(this,i),c.data(d,g)),"string"==typeof b){if("undefined"==typeof g[b])throw new TypeError('No method named "'.concat(b,'"'));g[b]()}})}},{key:"VERSION",get:function(){return c}},{key:"Default",get:function(){return n}}]),h}();return a(document).on(p.CLICK_DATA_API,s.DATA_TOGGLE,function(b){"A"===b.currentTarget.tagName&&b.preventDefault();var c=a(this),e=k["default"].getSelectorFromElement(this);a(e).each(function(){var b=a(this),e=b.data(d),f=e?"toggle":c.data();t._jQueryInterface.call(b,f)})}),a.fn[b]=t._jQueryInterface,a.fn[b].Constructor=t,a.fn[b].noConflict=function(){return a.fn[b]=l,t._jQueryInterface},t}(j["default"]);a["default"]=l});
define('theme_boost/modal', ["exports","jquery","./util"],function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(){return f=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},f.apply(this,arguments)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function i(a,b,c){return b&&h(a.prototype,b),c&&h(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var j=d(b),k=d(c),l=function(a){var b="modal",c="4.0.0",d="bs.modal",h=".".concat(d),j=".data-api",l=a.fn[b],m=300,n=150,o=27,p={backdrop:!0,keyboard:!0,focus:!0,show:!0},q={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},r={HIDE:"hide".concat(h),HIDDEN:"hidden".concat(h),SHOW:"show".concat(h),SHOWN:"shown".concat(h),FOCUSIN:"focusin".concat(h),RESIZE:"resize".concat(h),CLICK_DISMISS:"click.dismiss".concat(h),KEYDOWN_DISMISS:"keydown.dismiss".concat(h),MOUSEUP_DISMISS:"mouseup.dismiss".concat(h),MOUSEDOWN_DISMISS:"mousedown.dismiss".concat(h),CLICK_DATA_API:"click".concat(h).concat(j)},s={SCROLLBAR_MEASURER:"modal-scrollbar-measure",BACKDROP:"modal-backdrop",OPEN:"modal-open",FADE:"fade",SHOW:"show"},t={DIALOG:".modal-dialog",DATA_TOGGLE:'[data-toggle="modal"]',DATA_DISMISS:'[data-dismiss="modal"]',FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"},u=function(){function j(b,c){g(this,j),this._config=this._getConfig(c),this._element=b,this._dialog=a(b).find(t.DIALOG)[0],this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._originalBodyPadding=0,this._scrollbarWidth=0}return i(j,[{key:"toggle",value:function(a){return this._isShown?this.hide():this.show(a)}},{key:"show",value:function(b){var c=this;if(!this._isTransitioning&&!this._isShown){k["default"].supportsTransitionEnd()&&a(this._element).hasClass(s.FADE)&&(this._isTransitioning=!0);var d=a.Event(r.SHOW,{relatedTarget:b});a(this._element).trigger(d),this._isShown||d.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),a(document.body).addClass(s.OPEN),this._setEscapeEvent(),this._setResizeEvent(),a(this._element).on(r.CLICK_DISMISS,t.DATA_DISMISS,function(a){return c.hide(a)}),a(this._dialog).on(r.MOUSEDOWN_DISMISS,function(){a(c._element).one(r.MOUSEUP_DISMISS,function(b){a(b.target).is(c._element)&&(c._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return c._showElement(b)}))}}},{key:"hide",value:function(b){var c=this;if(b&&b.preventDefault(),!this._isTransitioning&&this._isShown){var d=a.Event(r.HIDE);if(a(this._element).trigger(d),this._isShown&&!d.isDefaultPrevented()){this._isShown=!1;var e=k["default"].supportsTransitionEnd()&&a(this._element).hasClass(s.FADE);e&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),a(document).off(r.FOCUSIN),a(this._element).removeClass(s.SHOW),a(this._element).off(r.CLICK_DISMISS),a(this._dialog).off(r.MOUSEDOWN_DISMISS),e?a(this._element).one(k["default"].TRANSITION_END,function(a){return c._hideModal(a)}).emulateTransitionEnd(m):this._hideModal()}}}},{key:"dispose",value:function(){a.removeData(this._element,d),a(window,document,this._element,this._backdrop).off(h),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._scrollbarWidth=null}},{key:"handleUpdate",value:function(){this._adjustDialog()}},{key:"_getConfig",value:function(a){return a=f({},p,a),k["default"].typeCheckConfig(b,a,q),a}},{key:"_showElement",value:function(b){var c=this,d=k["default"].supportsTransitionEnd()&&a(this._element).hasClass(s.FADE);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.scrollTop=0,d&&k["default"].reflow(this._element),a(this._element).addClass(s.SHOW),this._config.focus&&this._enforceFocus();var e=a.Event(r.SHOWN,{relatedTarget:b}),f=function(){c._config.focus&&c._element.focus(),c._isTransitioning=!1,a(c._element).trigger(e)};d?a(this._dialog).one(k["default"].TRANSITION_END,f).emulateTransitionEnd(m):f()}},{key:"_enforceFocus",value:function(){var b=this;a(document).off(r.FOCUSIN).on(r.FOCUSIN,function(c){document!==c.target&&b._element!==c.target&&0===a(b._element).has(c.target).length&&b._element.focus()})}},{key:"_setEscapeEvent",value:function(){var b=this;this._isShown&&this._config.keyboard?a(this._element).on(r.KEYDOWN_DISMISS,function(a){a.which===o&&(a.preventDefault(),b.hide())}):this._isShown||a(this._element).off(r.KEYDOWN_DISMISS)}},{key:"_setResizeEvent",value:function(){var b=this;this._isShown?a(window).on(r.RESIZE,function(a){return b.handleUpdate(a)}):a(window).off(r.RESIZE)}},{key:"_hideModal",value:function(){var b=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._isTransitioning=!1,this._showBackdrop(function(){a(document.body).removeClass(s.OPEN),b._resetAdjustments(),b._resetScrollbar(),a(b._element).trigger(r.HIDDEN)})}},{key:"_removeBackdrop",value:function(){this._backdrop&&(a(this._backdrop).remove(),this._backdrop=null)}},{key:"_showBackdrop",value:function(b){var c=this,d=a(this._element).hasClass(s.FADE)?s.FADE:"";if(this._isShown&&this._config.backdrop){var e=k["default"].supportsTransitionEnd()&&d;if(this._backdrop=document.createElement("div"),this._backdrop.className=s.BACKDROP,d&&a(this._backdrop).addClass(d),a(this._backdrop).appendTo(document.body),a(this._element).on(r.CLICK_DISMISS,function(a){return c._ignoreBackdropClick?void(c._ignoreBackdropClick=!1):void(a.target===a.currentTarget&&("static"===c._config.backdrop?c._element.focus():c.hide()))}),e&&k["default"].reflow(this._backdrop),a(this._backdrop).addClass(s.SHOW),!b)return;if(!e)return void b();a(this._backdrop).one(k["default"].TRANSITION_END,b).emulateTransitionEnd(n)}else if(!this._isShown&&this._backdrop){a(this._backdrop).removeClass(s.SHOW);var f=function(){c._removeBackdrop(),b&&b()};k["default"].supportsTransitionEnd()&&a(this._element).hasClass(s.FADE)?a(this._backdrop).one(k["default"].TRANSITION_END,f).emulateTransitionEnd(n):f()}else b&&b()}},{key:"_adjustDialog",value:function(){var a=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&a&&(this._element.style.paddingLeft="".concat(this._scrollbarWidth,"px")),this._isBodyOverflowing&&!a&&(this._element.style.paddingRight="".concat(this._scrollbarWidth,"px"))}},{key:"_resetAdjustments",value:function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}},{key:"_checkScrollbar",value:function(){var a=document.body.getBoundingClientRect();this._isBodyOverflowing=a.left+a.right<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()}},{key:"_setScrollbar",value:function(){var b=this;if(this._isBodyOverflowing){a(t.FIXED_CONTENT).each(function(c,d){var e=a(d)[0].style.paddingRight,f=a(d).css("padding-right");a(d).data("padding-right",e).css("padding-right","".concat(parseFloat(f)+b._scrollbarWidth,"px"))}),a(t.STICKY_CONTENT).each(function(c,d){var e=a(d)[0].style.marginRight,f=a(d).css("margin-right");a(d).data("margin-right",e).css("margin-right","".concat(parseFloat(f)-b._scrollbarWidth,"px"))}),a(t.NAVBAR_TOGGLER).each(function(c,d){var e=a(d)[0].style.marginRight,f=a(d).css("margin-right");a(d).data("margin-right",e).css("margin-right","".concat(parseFloat(f)+b._scrollbarWidth,"px"))});var c=document.body.style.paddingRight,d=a("body").css("padding-right");a("body").data("padding-right",c).css("padding-right","".concat(parseFloat(d)+this._scrollbarWidth,"px"))}}},{key:"_resetScrollbar",value:function(){a(t.FIXED_CONTENT).each(function(b,c){var d=a(c).data("padding-right");"undefined"!=typeof d&&a(c).css("padding-right",d).removeData("padding-right")}),a("".concat(t.STICKY_CONTENT,", ").concat(t.NAVBAR_TOGGLER)).each(function(b,c){var d=a(c).data("margin-right");"undefined"!=typeof d&&a(c).css("margin-right",d).removeData("margin-right")});var b=a("body").data("padding-right");"undefined"!=typeof b&&a("body").css("padding-right",b).removeData("padding-right")}},{key:"_getScrollbarWidth",value:function(){var a=document.createElement("div");a.className=s.SCROLLBAR_MEASURER,document.body.appendChild(a);var b=a.getBoundingClientRect().width-a.clientWidth;return document.body.removeChild(a),b}}],[{key:"_jQueryInterface",value:function(b,c){return this.each(function(){var g=a(this).data(d),h=f({},j.Default,a(this).data(),"object"===e(b)&&b);if(g||(g=new j(this,h),a(this).data(d,g)),"string"==typeof b){if("undefined"==typeof g[b])throw new TypeError('No method named "'.concat(b,'"'));g[b](c)}else h.show&&g.show(c)})}},{key:"VERSION",get:function(){return c}},{key:"Default",get:function(){return p}}]),j}();return a(document).on(r.CLICK_DATA_API,t.DATA_TOGGLE,function(b){var c,e=this,g=k["default"].getSelectorFromElement(this);g&&(c=a(g)[0]);var h=a(c).data(d)?"toggle":f({},a(c).data(),a(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||b.preventDefault();var i=a(c).one(r.SHOW,function(b){b.isDefaultPrevented()||i.one(r.HIDDEN,function(){a(e).is(":visible")&&e.focus()})});u._jQueryInterface.call(a(c),h,this)}),a.fn[b]=u._jQueryInterface,a.fn[b].Constructor=u,a.fn[b].noConflict=function(){return a.fn[b]=l,u._jQueryInterface},u}(j["default"]);a["default"]=l});
define('theme_boost/tab', ["exports","jquery","./util"],function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var h=d(b),i=d(c),j=function(a){var b="tab",c="4.0.0",d="bs.tab",f=".".concat(d),h=".data-api",j=a.fn[b],k=150,l={HIDE:"hide".concat(f),HIDDEN:"hidden".concat(f),SHOW:"show".concat(f),SHOWN:"shown".concat(f),CLICK_DATA_API:"click".concat(f).concat(h)},m={DROPDOWN_MENU:"dropdown-menu",ACTIVE:"active",DISABLED:"disabled",FADE:"fade",SHOW:"show"},n={DROPDOWN:".dropdown",NAV_LIST_GROUP:".nav, .list-group",ACTIVE:".active",ACTIVE_UL:"> li > .active",DATA_TOGGLE:'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',DROPDOWN_TOGGLE:".dropdown-toggle",DROPDOWN_ACTIVE_CHILD:"> .dropdown-menu .active"},o=function(){function b(a){e(this,b),this._element=a}return g(b,[{key:"show",value:function(){var b=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&a(this._element).hasClass(m.ACTIVE)||a(this._element).hasClass(m.DISABLED))){var c,d,e=a(this._element).closest(n.NAV_LIST_GROUP)[0],f=i["default"].getSelectorFromElement(this._element);if(e){var g="UL"===e.nodeName?n.ACTIVE_UL:n.ACTIVE;d=a.makeArray(a(e).find(g)),d=d[d.length-1]}var h=a.Event(l.HIDE,{relatedTarget:this._element}),j=a.Event(l.SHOW,{relatedTarget:d});if(d&&a(d).trigger(h),a(this._element).trigger(j),!j.isDefaultPrevented()&&!h.isDefaultPrevented()){f&&(c=a(f)[0]),this._activate(this._element,e);var k=function(){var c=a.Event(l.HIDDEN,{relatedTarget:b._element}),e=a.Event(l.SHOWN,{relatedTarget:d});a(d).trigger(c),a(b._element).trigger(e)};c?this._activate(c,c.parentNode,k):k()}}}},{key:"dispose",value:function(){a.removeData(this._element,d),this._element=null}},{key:"_activate",value:function(b,c,d){var e,f=this;e="UL"===c.nodeName?a(c).find(n.ACTIVE_UL):a(c).children(n.ACTIVE);var g=e[0],h=d&&i["default"].supportsTransitionEnd()&&g&&a(g).hasClass(m.FADE),j=function(){return f._transitionComplete(b,g,d)};g&&h?a(g).one(i["default"].TRANSITION_END,j).emulateTransitionEnd(k):j()}},{key:"_transitionComplete",value:function(b,c,d){if(c){a(c).removeClass("".concat(m.SHOW," ").concat(m.ACTIVE));var e=a(c.parentNode).find(n.DROPDOWN_ACTIVE_CHILD)[0];e&&a(e).removeClass(m.ACTIVE),"tab"===c.getAttribute("role")&&c.setAttribute("aria-selected",!1)}if(a(b).addClass(m.ACTIVE),"tab"===b.getAttribute("role")&&b.setAttribute("aria-selected",!0),i["default"].reflow(b),a(b).addClass(m.SHOW),b.parentNode&&a(b.parentNode).hasClass(m.DROPDOWN_MENU)){var f=a(b).closest(n.DROPDOWN)[0];f&&a(f).find(n.DROPDOWN_TOGGLE).addClass(m.ACTIVE),b.setAttribute("aria-expanded",!0)}d&&d()}}],[{key:"_jQueryInterface",value:function(c){return this.each(function(){var e=a(this),f=e.data(d);if(f||(f=new b(this),e.data(d,f)),"string"==typeof c){if("undefined"==typeof f[c])throw new TypeError('No method named "'.concat(c,'"'));f[c]()}})}},{key:"VERSION",get:function(){return c}}]),b}();return a(document).on(l.CLICK_DATA_API,n.DATA_TOGGLE,function(b){b.preventDefault(),o._jQueryInterface.call(a(this),"show")}),a.fn[b]=o._jQueryInterface,a.fn[b].Constructor=o,a.fn[b].noConflict=function(){return a.fn[b]=j,o._jQueryInterface},o}(h["default"]);a["default"]=j});
define('theme_boost/drawer', ["jquery","core/custom_interaction_events","core/log"],function(a,b,c){var d={TOGGLE_REGION:'[data-region="drawer-toggle"]',TOGGLE_ACTION:'[data-action="toggle-drawer"]',TOGGLE_TARGET:"aria-controls",TOGGLE_SIDE:"left",BODY:"body",SECTION:'.list-group-item[href*="#section-"]'},e=function(){a(d.TOGGLE_REGION).length||c.debug("Page is missing a drawer region"),a(d.TOGGLE_ACTION).length||c.debug("Page is missing a drawer toggle link"),a(d.TOGGLE_REGION).each(function(b,c){var e=a(c).find(d.TOGGLE_ACTION),f=e.attr("aria-controls"),g=a(document.getElementById(f)),h="false"==e.attr("aria-expanded"),i=e.attr("data-side"),j=a(d.BODY);g.on("mousewheel DOMMouseScroll",this.preventPageScroll),h?e.attr("aria-expanded","false"):(j.addClass("drawer-open-"+i),e.attr("aria-expanded","true"))}.bind(this)),this.registerEventListeners();var b=a(document).width()<768;b&&this.closeAll()};return e.prototype.closeAll=function(){a(d.TOGGLE_REGION).each(function(b,c){var e=a(c).find(d.TOGGLE_ACTION),f=e.attr("data-side"),g=a(d.BODY),h=e.attr("aria-controls"),i=a(document.getElementById(h)),j=e.attr("data-preference");e.attr("aria-expanded","false"),g.removeClass("drawer-open-"+f),i.attr("aria-hidden","true"),i.addClass("closed"),M.util.set_user_preference(j,"false")})},e.prototype.toggleDrawer=function(b){var c=a(b.target).closest("[data-action=toggle-drawer]"),e=c.attr("aria-controls"),f=a(document.getElementById(e)),g=a(d.BODY),h=c.attr("data-side"),i=c.attr("data-preference");g.addClass("drawer-ease");var j="true"==c.attr("aria-expanded");j?(g.removeClass("drawer-open-"+h),c.attr("aria-expanded","false"),f.attr("aria-hidden","true"),f.addClass("closed"),M.util.set_user_preference(i,"false")):(c.attr("aria-expanded","true"),f.attr("aria-hidden","false"),f.focus(),g.addClass("drawer-open-"+h),f.removeClass("closed"),M.util.set_user_preference(i,"true"))},e.prototype.preventPageScroll=function(b){var c=b.wheelDelta||b.originalEvent&&b.originalEvent.wheelDelta||-b.originalEvent.detail,d=this.scrollTop+a(this).outerHeight()-this.scrollHeight>=0,e=this.scrollTop<=0;(c<0&&d||c>0&&e)&&b.preventDefault()},e.prototype.registerEventListeners=function(){a(d.TOGGLE_ACTION).each(function(c,d){b.define(a(d),[b.events.activate]),a(d).on(b.events.activate,function(a,b){this.toggleDrawer(b.originalEvent),b.originalEvent.preventDefault()}.bind(this))}.bind(this)),a(d.SECTION).click(function(){var b=a(document).width()<768;b&&this.closeAll()}.bind(this))},{init:function(){return new e}}});
!function(a,b){"function"==typeof define&&define.amd?define('theme_boost/tether', b):"object"==typeof exports?module.exports=b(require,exports,module):a.Tether=b()}(this,function(a,b,c){"use strict";function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a){var b=a.getBoundingClientRect(),c={};for(var d in b)c[d]=b[d];if(a.ownerDocument!==document){var f=a.ownerDocument.defaultView.frameElement;if(f){var g=e(f);c.top+=g.top,c.bottom+=g.top,c.left+=g.left,c.right+=g.left}}return c}function f(a){var b=getComputedStyle(a)||{},c=b.position,d=[];if("fixed"===c)return[a];for(var e=a;(e=e.parentNode)&&e&&1===e.nodeType;){var f=void 0;try{f=getComputedStyle(e)}catch(g){}if("undefined"==typeof f||null===f)return d.push(e),d;var h=f,i=h.overflow,j=h.overflowX,k=h.overflowY;/(auto|scroll)/.test(i+k+j)&&("absolute"!==c||["relative","absolute","fixed"].indexOf(f.position)>=0)&&d.push(e)}return d.push(a.ownerDocument.body),a.ownerDocument!==document&&d.push(a.ownerDocument.defaultView),d}function g(){z&&document.body.removeChild(z),z=null}function h(a){var b=void 0;a===document?(b=document,a=document.documentElement):b=a.ownerDocument;var c=b.documentElement,d=e(a),f=C();return d.top-=f.top,d.left-=f.left,"undefined"==typeof d.width&&(d.width=document.body.scrollWidth-d.left-d.right),"undefined"==typeof d.height&&(d.height=document.body.scrollHeight-d.top-d.bottom),d.top=d.top-c.clientTop,d.left=d.left-c.clientLeft,d.right=b.body.clientWidth-d.width-d.left,d.bottom=b.body.clientHeight-d.height-d.top,d}function i(a){return a.offsetParent||document.documentElement}function j(){var a=document.createElement("div");a.style.width="100%",a.style.height="200px";var b=document.createElement("div");k(b.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),b.appendChild(a),document.body.appendChild(b);var c=a.offsetWidth;b.style.overflow="scroll";var d=a.offsetWidth;c===d&&(d=b.clientWidth),document.body.removeChild(b);var e=c-d;return{width:e,height:e}}function k(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],b=[];return Array.prototype.push.apply(b,arguments),b.slice(1).forEach(function(b){if(b)for(var c in b)({}).hasOwnProperty.call(b,c)&&(a[c]=b[c])}),a}function l(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.remove(b)});else{var c=new RegExp("(^| )"+b.split(" ").join("|")+"( |$)","gi"),d=o(a).replace(c," ");p(a,d)}}function m(a,b){if("undefined"!=typeof a.classList)b.split(" ").forEach(function(b){b.trim()&&a.classList.add(b)});else{l(a,b);var c=o(a)+(" "+b);p(a,c)}}function n(a,b){if("undefined"!=typeof a.classList)return a.classList.contains(b);var c=o(a);return new RegExp("(^| )"+b+"( |$)","gi").test(c)}function o(a){return a.className instanceof a.ownerDocument.defaultView.SVGAnimatedString?a.className.baseVal:a.className}function p(a,b){a.setAttribute("class",b)}function q(a,b,c){c.forEach(function(c){b.indexOf(c)===-1&&n(a,c)&&l(a,c)}),b.forEach(function(b){n(a,b)||m(a,b)})}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function r(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function s(a,b){var c=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return a+c>=b&&b>=a-c}function t(){return"undefined"!=typeof performance&&"undefined"!=typeof performance.now?performance.now():+new Date}function u(){for(var a={top:0,left:0},b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return c.forEach(function(b){var c=b.top,d=b.left;"string"==typeof c&&(c=parseFloat(c,10)),"string"==typeof d&&(d=parseFloat(d,10)),a.top+=c,a.left+=d}),a}function v(a,b){return"string"==typeof a.left&&a.left.indexOf("%")!==-1&&(a.left=parseFloat(a.left,10)/100*b.width),"string"==typeof a.top&&a.top.indexOf("%")!==-1&&(a.top=parseFloat(a.top,10)/100*b.height),a}function w(a,b){return"scrollParent"===b?b=a.scrollParents[0]:"window"===b&&(b=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),b===document&&(b=b.documentElement),"undefined"!=typeof b.nodeType&&!function(){var a=b,c=h(b),d=c,e=getComputedStyle(b);if(b=[d.left,d.top,c.width+d.left,c.height+d.top],a.ownerDocument!==document){var f=a.ownerDocument.defaultView;b[0]+=f.pageXOffset,b[1]+=f.pageYOffset,b[2]+=f.pageXOffset,b[3]+=f.pageYOffset}W.forEach(function(a,c){a=a[0].toUpperCase()+a.substr(1),"Top"===a||"Left"===a?b[c]+=parseFloat(e["border"+a+"Width"]):b[c]-=parseFloat(e["border"+a+"Width"])})}(),b}var x=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),y=void 0;"undefined"==typeof y&&(y={modules:[]});var z=null,A=function(){var a=0;return function(){return++a}}(),B={},C=function(){var a=z;a||(a=document.createElement("div"),a.setAttribute("data-tether-id",A()),k(a.style,{top:0,left:0,position:"absolute"}),document.body.appendChild(a),z=a);var b=a.getAttribute("data-tether-id");return"undefined"==typeof B[b]&&(B[b]=e(a),E(function(){delete B[b]})),B[b]},D=[],E=function(a){D.push(a)},F=function(){for(var a=void 0;a=D.pop();)a()},G=function(){function a(){d(this,a)}return x(a,[{key:"on",value:function(a,b,c){var d=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];"undefined"==typeof this.bindings&&(this.bindings={}),"undefined"==typeof this.bindings[a]&&(this.bindings[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})}},{key:"once",value:function(a,b,c){this.on(a,b,c,!0)}},{key:"off",value:function(a,b){if("undefined"!=typeof this.bindings&&"undefined"!=typeof this.bindings[a])if("undefined"==typeof b)delete this.bindings[a];else for(var c=0;c<this.bindings[a].length;)this.bindings[a][c].handler===b?this.bindings[a].splice(c,1):++c}},{key:"trigger",value:function(a){if("undefined"!=typeof this.bindings&&this.bindings[a]){for(var b=0,c=arguments.length,d=Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];for(;b<this.bindings[a].length;){var f=this.bindings[a][b],g=f.handler,h=f.ctx,i=f.once,j=h;"undefined"==typeof j&&(j=this),g.apply(j,d),i?this.bindings[a].splice(b,1):++b}}}}]),a}();y.Utils={getActualBoundingClientRect:e,getScrollParents:f,getBounds:h,getOffsetParent:i,extend:k,addClass:m,removeClass:l,hasClass:n,updateClasses:q,defer:E,flush:F,uniqueId:A,Evented:G,getScrollBarSize:j,removeUtilElements:g};var H=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),x=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),I=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;if(void 0===i)return;return i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return;a=j,b=f,c=g,d=!0,h=j=void 0}};if("undefined"==typeof y)throw new Error("You must include the utils.js file before tether.js");var J=y.Utils,f=J.getScrollParents,h=J.getBounds,i=J.getOffsetParent,k=J.extend,m=J.addClass,l=J.removeClass,q=J.updateClasses,E=J.defer,F=J.flush,j=J.getScrollBarSize,g=J.removeUtilElements,K=function(){if("undefined"==typeof document)return"";for(var a=document.createElement("div"),b=["transform","WebkitTransform","OTransform","MozTransform","msTransform"],c=0;c<b.length;++c){var d=b[c];if(void 0!==a.style[d])return d}}(),L=[],M=function(){L.forEach(function(a){a.position(!1)}),F()};!function(){var a=null,b=null,c=null,d=function e(){return"undefined"!=typeof b&&b>16?(b=Math.min(b-16,250),void(c=setTimeout(e,250))):void("undefined"!=typeof a&&t()-a<10||(null!=c&&(clearTimeout(c),c=null),a=t(),M(),b=t()-a))};"undefined"!=typeof window&&"undefined"!=typeof window.addEventListener&&["resize","scroll","touchmove"].forEach(function(a){window.addEventListener(a,d)})}();var N={center:"center",left:"right",right:"left"},O={middle:"middle",top:"bottom",bottom:"top"},P={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},Q=function(a,b){var c=a.left,d=a.top;return"auto"===c&&(c=N[b.left]),"auto"===d&&(d=O[b.top]),{left:c,top:d}},R=function(a){var b=a.left,c=a.top;return"undefined"!=typeof P[a.left]&&(b=P[a.left]),"undefined"!=typeof P[a.top]&&(c=P[a.top]),{left:b,top:c}},S=function(a){var b=a.split(" "),c=H(b,2),d=c[0],e=c[1];return{top:d,left:e}},T=S,U=function(a){function b(a){var c=this;d(this,b),I(Object.getPrototypeOf(b.prototype),"constructor",this).call(this),this.position=this.position.bind(this),L.push(this),this.history=[],this.setOptions(a,!1),y.modules.forEach(function(a){"undefined"!=typeof a.initialize&&a.initialize.call(c)}),this.position()}return r(b,a),x(b,[{key:"getClass",value:function(){var a=arguments.length<=0||void 0===arguments[0]?"":arguments[0],b=this.options.classes;return"undefined"!=typeof b&&b[a]?this.options.classes[a]:this.options.classPrefix?this.options.classPrefix+"-"+a:a}},{key:"setOptions",value:function(a){var b=this,c=arguments.length<=1||void 0===arguments[1]||arguments[1],d={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"};this.options=k(d,a);var e=this.options,g=e.element,h=e.target,i=e.targetModifier;if(this.element=g,this.target=h,this.targetModifier=i,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),["element","target"].forEach(function(a){if("undefined"==typeof b[a])throw new Error("Tether Error: Both element and target must be defined");"undefined"!=typeof b[a].jquery?b[a]=b[a][0]:"string"==typeof b[a]&&(b[a]=document.querySelector(b[a]))}),m(this.element,this.getClass("element")),this.options.addTargetClasses!==!1&&m(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=T(this.options.targetAttachment),this.attachment=T(this.options.attachment),this.offset=S(this.options.offset),this.targetOffset=S(this.options.targetOffset),"undefined"!=typeof this.scrollParents&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParents=[this.target]:this.scrollParents=f(this.target),this.options.enabled!==!1&&this.enable(c)}},{key:"getTargetBounds",value:function(){if("undefined"==typeof this.targetModifier)return h(this.target);if("visible"===this.targetModifier){if(this.target===document.body)return{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth};var a=h(this.target),b={height:a.height,width:a.width,top:a.top,left:a.left};return b.height=Math.min(b.height,a.height-(pageYOffset-a.top)),b.height=Math.min(b.height,a.height-(a.top+a.height-(pageYOffset+innerHeight))),b.height=Math.min(innerHeight,b.height),b.height-=2,b.width=Math.min(b.width,a.width-(pageXOffset-a.left)),b.width=Math.min(b.width,a.width-(a.left+a.width-(pageXOffset+innerWidth))),b.width=Math.min(innerWidth,b.width),b.width-=2,b.top<pageYOffset&&(b.top=pageYOffset),b.left<pageXOffset&&(b.left=pageXOffset),b}if("scroll-handle"===this.targetModifier){var a=void 0,c=this.target;c===document.body?(c=document.documentElement,a={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):a=h(c);var d=getComputedStyle(c),e=c.scrollWidth>c.clientWidth||[d.overflow,d.overflowX].indexOf("scroll")>=0||this.target!==document.body,f=0;e&&(f=15);var g=a.height-parseFloat(d.borderTopWidth)-parseFloat(d.borderBottomWidth)-f,b={width:15,height:.975*g*(g/c.scrollHeight),left:a.left+a.width-parseFloat(d.borderLeftWidth)-15},i=0;g<408&&this.target===document.body&&(i=-11e-5*Math.pow(g,2)-.00727*g+22.58),this.target!==document.body&&(b.height=Math.max(b.height,24));var j=this.target.scrollTop/(c.scrollHeight-g);return b.top=j*(g-b.height-i)+a.top+parseFloat(d.borderTopWidth),this.target===document.body&&(b.height=Math.max(b.height,24)),b}}},{key:"clearCache",value:function(){this._cache={}}},{key:"cache",value:function(a,b){return"undefined"==typeof this._cache&&(this._cache={}),"undefined"==typeof this._cache[a]&&(this._cache[a]=b.call(this)),this._cache[a]}},{key:"enable",value:function(){var a=this,b=arguments.length<=0||void 0===arguments[0]||arguments[0];this.options.addTargetClasses!==!1&&m(this.target,this.getClass("enabled")),m(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParents.forEach(function(b){b!==a.target.ownerDocument&&b.addEventListener("scroll",a.position)}),b&&this.position()}},{key:"disable",value:function(){var a=this;l(this.target,this.getClass("enabled")),l(this.element,this.getClass("enabled")),this.enabled=!1,"undefined"!=typeof this.scrollParents&&this.scrollParents.forEach(function(b){b.removeEventListener("scroll",a.position)})}},{key:"destroy",value:function(){var a=this;this.disable(),L.forEach(function(b,c){b===a&&L.splice(c,1)}),0===L.length&&g()}},{key:"updateAttachClasses",value:function(a,b){var c=this;a=a||this.attachment,b=b||this.targetAttachment;var d=["left","top","bottom","right","middle","center"];"undefined"!=typeof this._addAttachClasses&&this._addAttachClasses.length&&this._addAttachClasses.splice(0,this._addAttachClasses.length),"undefined"==typeof this._addAttachClasses&&(this._addAttachClasses=[]);var e=this._addAttachClasses;a.top&&e.push(this.getClass("element-attached")+"-"+a.top),a.left&&e.push(this.getClass("element-attached")+"-"+a.left),b.top&&e.push(this.getClass("target-attached")+"-"+b.top),b.left&&e.push(this.getClass("target-attached")+"-"+b.left);var f=[];d.forEach(function(a){f.push(c.getClass("element-attached")+"-"+a),f.push(c.getClass("target-attached")+"-"+a)}),E(function(){"undefined"!=typeof c._addAttachClasses&&(q(c.element,c._addAttachClasses,f),c.options.addTargetClasses!==!1&&q(c.target,c._addAttachClasses,f),delete c._addAttachClasses)})}},{key:"position",value:function(){var a=this,b=arguments.length<=0||void 0===arguments[0]||arguments[0];if(this.enabled){this.clearCache();var c=Q(this.targetAttachment,this.attachment);this.updateAttachClasses(this.attachment,c);var d=this.cache("element-bounds",function(){return h(a.element)}),e=d.width,f=d.height;if(0===e&&0===f&&"undefined"!=typeof this.lastSize){var g=this.lastSize;e=g.width,f=g.height}else this.lastSize={width:e,height:f};var k=this.cache("target-bounds",function(){return a.getTargetBounds()}),l=k,m=v(R(this.attachment),{width:e,height:f}),n=v(R(c),l),o=v(this.offset,{width:e,height:f}),p=v(this.targetOffset,l);m=u(m,o),n=u(n,p);for(var q=k.left+n.left-m.left,r=k.top+n.top-m.top,s=0;s<y.modules.length;++s){var t=y.modules[s],w=t.position.call(this,{left:q,top:r,targetAttachment:c,targetPos:k,elementPos:d,offset:m,targetOffset:n,manualOffset:o,manualTargetOffset:p,scrollbarSize:B,attachment:this.attachment});if(w===!1)return!1;"undefined"!=typeof w&&"object"==typeof w&&(r=w.top,q=w.left)}var x={page:{top:r,left:q},viewport:{top:r-pageYOffset,bottom:pageYOffset-r-f+innerHeight,left:q-pageXOffset,right:pageXOffset-q-e+innerWidth}},z=this.target.ownerDocument,A=z.defaultView,B=void 0;return z.body.scrollWidth>A.innerWidth&&(B=this.cache("scrollbar-size",j),x.viewport.bottom-=B.height),z.body.scrollHeight>A.innerHeight&&(B=this.cache("scrollbar-size",j),x.viewport.right-=B.width),["","static"].indexOf(z.body.style.position)!==-1&&["","static"].indexOf(z.body.parentElement.style.position)!==-1||(x.page.bottom=z.body.scrollHeight-r-f,x.page.right=z.body.scrollWidth-q-e),"undefined"!=typeof this.options.optimizations&&this.options.optimizations.moveElement!==!1&&"undefined"==typeof this.targetModifier&&!function(){var b=a.cache("target-offsetparent",function(){return i(a.target)}),c=a.cache("target-offsetparent-bounds",function(){return h(b)}),d=getComputedStyle(b),e=c,f={};if(["Top","Left","Bottom","Right"].forEach(function(a){f[a.toLowerCase()]=parseFloat(d["border"+a+"Width"])}),c.right=z.body.scrollWidth-c.left-e.width+f.right,c.bottom=z.body.scrollHeight-c.top-e.height+f.bottom,x.page.top>=c.top+f.top&&x.page.bottom>=c.bottom&&x.page.left>=c.left+f.left&&x.page.right>=c.right){var g=b.scrollTop,j=b.scrollLeft;x.offset={top:x.page.top-c.top+g-f.top,left:x.page.left-c.left+j-f.left}}}(),this.move(x),this.history.unshift(x),this.history.length>3&&this.history.pop(),b&&F(),!0}}},{key:"move",value:function(a){var b=this;if("undefined"!=typeof this.element.parentNode){var c={};for(var d in a){c[d]={};for(var e in a[d]){for(var f=!1,g=0;g<this.history.length;++g){var h=this.history[g];if("undefined"!=typeof h[d]&&!s(h[d][e],a[d][e])){f=!0;break}}f||(c[d][e]=!0)}}var j={top:"",left:"",right:"",bottom:""},l=function(a,c){var d="undefined"!=typeof b.options.optimizations,e=d?b.options.optimizations.gpu:null;if(e!==!1){var f=void 0,g=void 0;a.top?(j.top=0,f=c.top):(j.bottom=0,f=-c.bottom),a.left?(j.left=0,g=c.left):(j.right=0,g=-c.right),j[K]="translateX("+Math.round(g)+"px) translateY("+Math.round(f)+"px)","msTransform"!==K&&(j[K]+=" translateZ(0)")}else a.top?j.top=c.top+"px":j.bottom=c.bottom+"px",a.left?j.left=c.left+"px":j.right=c.right+"px"},m=!1;if((c.page.top||c.page.bottom)&&(c.page.left||c.page.right)?(j.position="absolute",l(c.page,a.page)):(c.viewport.top||c.viewport.bottom)&&(c.viewport.left||c.viewport.right)?(j.position="fixed",l(c.viewport,a.viewport)):"undefined"!=typeof c.offset&&c.offset.top&&c.offset.left?!function(){j.position="absolute";var d=b.cache("target-offsetparent",function(){return i(b.target)});i(b.element)!==d&&E(function(){b.element.parentNode.removeChild(b.element),d.appendChild(b.element)}),l(c.offset,a.offset),m=!0}():(j.position="absolute",l({top:!0,left:!0},a.page)),!m){for(var n=!0,o=this.element.parentNode;o&&1===o.nodeType&&"BODY"!==o.tagName;){if("static"!==getComputedStyle(o).position){n=!1;break}o=o.parentNode}n||(this.element.parentNode.removeChild(this.element),this.element.ownerDocument.body.appendChild(this.element))}var p={},q=!1;for(var e in j){var r=j[e],t=this.element.style[e];t!==r&&(q=!0,p[e]=r)}q&&E(function(){k(b.element.style,p)})}}}]),b}(G);U.modules=[],y.position=M;var V=k(U,y),H=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),J=y.Utils,h=J.getBounds,k=J.extend,q=J.updateClasses,E=J.defer,W=["left","top","right","bottom"];y.modules.push({position:function(a){var b=this,c=a.top,d=a.left,e=a.targetAttachment;if(!this.options.constraints)return!0;var f=this.cache("element-bounds",function(){return h(b.element)}),g=f.height,i=f.width;if(0===i&&0===g&&"undefined"!=typeof this.lastSize){var j=this.lastSize;i=j.width,g=j.height}var l=this.cache("target-bounds",function(){return b.getTargetBounds()}),m=l.height,n=l.width,o=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach(function(a){var b=a.outOfBoundsClass,c=a.pinnedClass;b&&o.push(b),c&&o.push(c)}),o.forEach(function(a){["left","top","right","bottom"].forEach(function(b){o.push(a+"-"+b)})});var p=[],r=k({},e),s=k({},this.attachment);return this.options.constraints.forEach(function(a){var f=a.to,h=a.attachment,j=a.pin;"undefined"==typeof h&&(h="");var k=void 0,l=void 0;if(h.indexOf(" ")>=0){var o=h.split(" "),q=H(o,2);l=q[0],k=q[1]}else k=l=h;var t=w(b,f);"target"!==l&&"both"!==l||(c<t[1]&&"top"===r.top&&(c+=m,r.top="bottom"),c+g>t[3]&&"bottom"===r.top&&(c-=m,r.top="top")),"together"===l&&("top"===r.top&&("bottom"===s.top&&c<t[1]?(c+=m,r.top="bottom",c+=g,s.top="top"):"top"===s.top&&c+g>t[3]&&c-(g-m)>=t[1]&&(c-=g-m,r.top="bottom",s.top="bottom")),"bottom"===r.top&&("top"===s.top&&c+g>t[3]?(c-=m,r.top="top",c-=g,s.top="bottom"):"bottom"===s.top&&c<t[1]&&c+(2*g-m)<=t[3]&&(c+=g-m,r.top="top",s.top="top")),"middle"===r.top&&(c+g>t[3]&&"top"===s.top?(c-=g,s.top="bottom"):c<t[1]&&"bottom"===s.top&&(c+=g,s.top="top"))),"target"!==k&&"both"!==k||(d<t[0]&&"left"===r.left&&(d+=n,r.left="right"),d+i>t[2]&&"right"===r.left&&(d-=n,r.left="left")),"together"===k&&(d<t[0]&&"left"===r.left?"right"===s.left?(d+=n,r.left="right",d+=i,s.left="left"):"left"===s.left&&(d+=n,r.left="right",d-=i,s.left="right"):d+i>t[2]&&"right"===r.left?"left"===s.left?(d-=n,r.left="left",d-=i,s.left="right"):"right"===s.left&&(d-=n,r.left="left",d+=i,s.left="left"):"center"===r.left&&(d+i>t[2]&&"left"===s.left?(d-=i,s.left="right"):d<t[0]&&"right"===s.left&&(d+=i,s.left="left"))),"element"!==l&&"both"!==l||(c<t[1]&&"bottom"===s.top&&(c+=g,s.top="top"),c+g>t[3]&&"top"===s.top&&(c-=g,s.top="bottom")),"element"!==k&&"both"!==k||(d<t[0]&&("right"===s.left?(d+=i,s.left="left"):"center"===s.left&&(d+=i/2,s.left="left")),d+i>t[2]&&("left"===s.left?(d-=i,s.left="right"):"center"===s.left&&(d-=i/2,s.left="right"))),"string"==typeof j?j=j.split(",").map(function(a){return a.trim()}):j===!0&&(j=["top","left","right","bottom"]),j=j||[];var u=[],v=[];c<t[1]&&(j.indexOf("top")>=0?(c=t[1],u.push("top")):v.push("top")),c+g>t[3]&&(j.indexOf("bottom")>=0?(c=t[3]-g,u.push("bottom")):v.push("bottom")),d<t[0]&&(j.indexOf("left")>=0?(d=t[0],u.push("left")):v.push("left")),d+i>t[2]&&(j.indexOf("right")>=0?(d=t[2]-i,u.push("right")):v.push("right")),u.length&&!function(){var a=void 0;a="undefined"!=typeof b.options.pinnedClass?b.options.pinnedClass:b.getClass("pinned"),p.push(a),u.forEach(function(b){p.push(a+"-"+b)})}(),v.length&&!function(){var a=void 0;a="undefined"!=typeof b.options.outOfBoundsClass?b.options.outOfBoundsClass:b.getClass("out-of-bounds"),p.push(a),v.forEach(function(b){p.push(a+"-"+b)})}(),(u.indexOf("left")>=0||u.indexOf("right")>=0)&&(s.left=r.left=!1),(u.indexOf("top")>=0||u.indexOf("bottom")>=0)&&(s.top=r.top=!1),r.top===e.top&&r.left===e.left&&s.top===b.attachment.top&&s.left===b.attachment.left||(b.updateAttachClasses(s,r),b.trigger("update",{attachment:s,targetAttachment:r}))}),E(function(){b.options.addTargetClasses!==!1&&q(b.target,p,o),q(b.element,p,o)}),{top:c,left:d}}});var J=y.Utils,h=J.getBounds,q=J.updateClasses,E=J.defer;y.modules.push({position:function(a){var b=this,c=a.top,d=a.left,e=this.cache("element-bounds",function(){return h(b.element)}),f=e.height,g=e.width,i=this.getTargetBounds(),j=c+f,k=d+g,l=[];c<=i.bottom&&j>=i.top&&["left","right"].forEach(function(a){var b=i[a];b!==d&&b!==k||l.push(a)}),d<=i.right&&k>=i.left&&["top","bottom"].forEach(function(a){var b=i[a];b!==c&&b!==j||l.push(a)});var m=[],n=[],o=["left","top","right","bottom"];return m.push(this.getClass("abutted")),o.forEach(function(a){m.push(b.getClass("abutted")+"-"+a)}),l.length&&n.push(this.getClass("abutted")),l.forEach(function(a){n.push(b.getClass("abutted")+"-"+a)}),E(function(){b.options.addTargetClasses!==!1&&q(b.target,n,m),q(b.element,n,m)}),!0}});var H=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{!d&&h["return"]&&h["return"]()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();return y.modules.push({position:function(a){var b=a.top,c=a.left;if(this.options.shift){var d=this.options.shift;"function"==typeof this.options.shift&&(d=this.options.shift.call(this,{top:b,left:c}));var e=void 0,f=void 0;if("string"==typeof d){d=d.split(" "),d[1]=d[1]||d[0];var g=d,h=H(g,2);e=h[0],f=h[1],e=parseFloat(e,10),f=parseFloat(f,10)}else e=d.top,f=d.left;return b+=e,c+=f,{top:b,left:c}}}}),V});
define('theme_boost/aria', ["jquery"],function(a){return{init:function(){var b=!1,c=function(){b=!0},d=function(){var a=b;return b=!1,a};a('[data-toggle="dropdown"]').keydown(function(b){var d,e=b.which||b.keyCode;38==e&&c(),27==e&&(d=a(b.target).attr("aria-expanded"),b.preventDefault(),"false"==d&&a(b.target).click()),32!=e&&13!=e||(b.preventDefault(),a(b.target).click())});var e=function(b){var c=function(){a(this).focus()}.bind(b);setTimeout(c,50)};a(".dropdown").on("shown.bs.dropdown",function(b){var c=a(b.target).find('[role="menu"]'),f=!1,g=!1;c&&(f=a(c).find('[role="menuitem"]')),f&&f.length>0&&(g=d()?f[f.length-1]:f[0]),g&&e(g)}),a('.dropdown [role="menu"] [role="menuitem"]').keypress(function(b){var c,d=String.fromCharCode(b.which||b.keyCode),f=a(b.target).closest('[role="menu"]'),g=0,h=!1;if(f&&(h=a(f).find('[role="menuitem"]')))for(d=d.toLowerCase(),g=0;g<h.length;g++)if(c=a(h[g]),0==c.text().trim().indexOf(d)||0==c.text().trim().indexOf(d.toUpperCase())){e(c);break}}),a('.dropdown [role="menu"] [role="menuitem"]').keydown(function(b){var c=b.which||b.keyCode,d=!1,f=a(b.target).closest('[role="menu"]'),g=0,h=!1;if(f&&(h=a(f).find('[role="menuitem"]'))){if(40==c){for(g=0;g<h.length-1;g++)h[g]==b.target&&(d=h[g+1]);d||(c=36)}if(38==c){for(g=1;g<h.length;g++)h[g]==b.target&&(d=h[g-1]);d||(c=35)}36==c&&(d=h[0]),35==c&&(d=h[h.length-1]),d&&(b.preventDefault(),e(d))}}),a(".dropdown").on("hidden.bs.dropdown",function(b){var c=a(b.target).find('[data-toggle="dropdown"]');c&&e(c)})}}});
define('theme_boost/button', ["exports","jquery"],function(a,b){"use strict";function c(a){return a&&a.__esModule?a:{"default":a}}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var g=c(b),h=function(a){var b="button",c="4.0.0",e="bs.button",g=".".concat(e),h=".data-api",i=a.fn[b],j={ACTIVE:"active",BUTTON:"btn",FOCUS:"focus"},k={DATA_TOGGLE_CARROT:'[data-toggle^="button"]',DATA_TOGGLE:'[data-toggle="buttons"]',INPUT:"input",ACTIVE:".active",BUTTON:".btn"},l={CLICK_DATA_API:"click".concat(g).concat(h),FOCUS_BLUR_DATA_API:"focus".concat(g).concat(h," ")+"blur".concat(g).concat(h)},m=function(){function b(a){d(this,b),this._element=a}return f(b,[{key:"toggle",value:function(){var b=!0,c=!0,d=a(this._element).closest(k.DATA_TOGGLE)[0];if(d){var e=a(this._element).find(k.INPUT)[0];if(e){if("radio"===e.type)if(e.checked&&a(this._element).hasClass(j.ACTIVE))b=!1;else{var f=a(d).find(k.ACTIVE)[0];f&&a(f).removeClass(j.ACTIVE)}if(b){if(e.hasAttribute("disabled")||d.hasAttribute("disabled")||e.classList.contains("disabled")||d.classList.contains("disabled"))return;e.checked=!a(this._element).hasClass(j.ACTIVE),a(e).trigger("change")}e.focus(),c=!1}}c&&this._element.setAttribute("aria-pressed",!a(this._element).hasClass(j.ACTIVE)),b&&a(this._element).toggleClass(j.ACTIVE)}},{key:"dispose",value:function(){a.removeData(this._element,e),this._element=null}}],[{key:"_jQueryInterface",value:function(c){return this.each(function(){var d=a(this).data(e);d||(d=new b(this),a(this).data(e,d)),"toggle"===c&&d[c]()})}},{key:"VERSION",get:function(){return c}}]),b}();return a(document).on(l.CLICK_DATA_API,k.DATA_TOGGLE_CARROT,function(b){b.preventDefault();var c=b.target;a(c).hasClass(j.BUTTON)||(c=a(c).closest(k.BUTTON)),m._jQueryInterface.call(a(c),"toggle")}).on(l.FOCUS_BLUR_DATA_API,k.DATA_TOGGLE_CARROT,function(b){var c=a(b.target).closest(k.BUTTON)[0];a(c).toggleClass(j.FOCUS,/^focus(in)?$/.test(b.type))}),a.fn[b]=m._jQueryInterface,a.fn[b].Constructor=m,a.fn[b].noConflict=function(){return a.fn[b]=i,m._jQueryInterface},m}(g["default"]);a["default"]=h});
define('theme_boost/scrollspy', ["exports","jquery","./util"],function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function f(){return f=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},f.apply(this,arguments)}function g(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function h(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function i(a,b,c){return b&&h(a.prototype,b),c&&h(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var j=d(b),k=d(c),l=function(a){var b="scrollspy",c="4.0.0",d="bs.scrollspy",h=".".concat(d),j=".data-api",l=a.fn[b],m={offset:10,method:"auto",target:""},n={offset:"number",method:"string",target:"(string|element)"},o={ACTIVATE:"activate".concat(h),SCROLL:"scroll".concat(h),LOAD_DATA_API:"load".concat(h).concat(j)},p={DROPDOWN_ITEM:"dropdown-item",DROPDOWN_MENU:"dropdown-menu",ACTIVE:"active"},q={DATA_SPY:'[data-spy="scroll"]',ACTIVE:".active",NAV_LIST_GROUP:".nav, .list-group",NAV_LINKS:".nav-link",NAV_ITEMS:".nav-item",LIST_ITEMS:".list-group-item",DROPDOWN:".dropdown",DROPDOWN_ITEMS:".dropdown-item",DROPDOWN_TOGGLE:".dropdown-toggle"},r={OFFSET:"offset",POSITION:"position"},s=function(){function j(b,c){var d=this;g(this,j),this._element=b,this._scrollElement="BODY"===b.tagName?window:b,this._config=this._getConfig(c),this._selector="".concat(this._config.target," ").concat(q.NAV_LINKS,",")+"".concat(this._config.target," ").concat(q.LIST_ITEMS,",")+"".concat(this._config.target," ").concat(q.DROPDOWN_ITEMS),this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,a(this._scrollElement).on(o.SCROLL,function(a){return d._process(a)}),this.refresh(),this._process()}return i(j,[{key:"refresh",value:function(){var b=this,c=this._scrollElement===this._scrollElement.window?r.OFFSET:r.POSITION,d="auto"===this._config.method?c:this._config.method,e=d===r.POSITION?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight();var f=a.makeArray(a(this._selector));f.map(function(b){var c,f=k["default"].getSelectorFromElement(b);if(f&&(c=a(f)[0]),c){var g=c.getBoundingClientRect();if(g.width||g.height)return[a(c)[d]().top+e,f]}return null}).filter(function(a){return a}).sort(function(a,b){return a[0]-b[0]}).forEach(function(a){b._offsets.push(a[0]),b._targets.push(a[1])})}},{key:"dispose",value:function(){a.removeData(this._element,d),a(this._scrollElement).off(h),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null}},{key:"_getConfig",value:function(c){if(c=f({},m,c),"string"!=typeof c.target){var d=a(c.target).attr("id");d||(d=k["default"].getUID(b),a(c.target).attr("id",d)),c.target="#".concat(d)}return k["default"].typeCheckConfig(b,c,n),c}},{key:"_getScrollTop",value:function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}},{key:"_getScrollHeight",value:function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}},{key:"_getOffsetHeight",value:function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}},{key:"_process",value:function(){var a=this._getScrollTop()+this._config.offset,b=this._getScrollHeight(),c=this._config.offset+b-this._getOffsetHeight();if(this._scrollHeight!==b&&this.refresh(),a>=c){var d=this._targets[this._targets.length-1];return void(this._activeTarget!==d&&this._activate(d))}if(this._activeTarget&&a<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var e=this._offsets.length;e--;){var f=this._activeTarget!==this._targets[e]&&a>=this._offsets[e]&&("undefined"==typeof this._offsets[e+1]||a<this._offsets[e+1]);f&&this._activate(this._targets[e])}}},{key:"_activate",value:function(b){this._activeTarget=b,this._clear();var c=this._selector.split(",");c=c.map(function(a){return"".concat(a,'[data-target="').concat(b,'"],')+"".concat(a,'[href="').concat(b,'"]')});var d=a(c.join(","));d.hasClass(p.DROPDOWN_ITEM)?(d.closest(q.DROPDOWN).find(q.DROPDOWN_TOGGLE).addClass(p.ACTIVE),d.addClass(p.ACTIVE)):(d.addClass(p.ACTIVE),d.parents(q.NAV_LIST_GROUP).prev("".concat(q.NAV_LINKS,", ").concat(q.LIST_ITEMS)).addClass(p.ACTIVE),d.parents(q.NAV_LIST_GROUP).prev(q.NAV_ITEMS).children(q.NAV_LINKS).addClass(p.ACTIVE)),a(this._scrollElement).trigger(o.ACTIVATE,{relatedTarget:b})}},{key:"_clear",value:function(){a(this._selector).filter(q.ACTIVE).removeClass(p.ACTIVE)}}],[{key:"_jQueryInterface",value:function(b){return this.each(function(){var c=a(this).data(d),f="object"===e(b)&&b;if(c||(c=new j(this,f),a(this).data(d,c)),"string"==typeof b){if("undefined"==typeof c[b])throw new TypeError('No method named "'.concat(b,'"'));c[b]()}})}},{key:"VERSION",get:function(){return c}},{key:"Default",get:function(){return m}}]),j}();return a(window).on(o.LOAD_DATA_API,function(){for(var b=a.makeArray(a(q.DATA_SPY)),c=b.length;c--;){var d=a(b[c]);s._jQueryInterface.call(d,d.data())}}),a.fn[b]=s._jQueryInterface,a.fn[b].Constructor=s,a.fn[b].noConflict=function(){return a.fn[b]=l,s._jQueryInterface},s}(j["default"]);a["default"]=l});
define('theme_boost/loader', ["jquery","./tether","core/event"],function(a,b,c){return window.jQuery=a,window.Tether=b,M.util.js_pending("theme_boost/loader:children"),require(["theme_boost/aria","theme_boost/util","theme_boost/alert","theme_boost/button","theme_boost/carousel","theme_boost/collapse","theme_boost/dropdown","theme_boost/modal","theme_boost/scrollspy","theme_boost/tab","theme_boost/tooltip","theme_boost/popover"],function(b){a("body").popover({trigger:"focus",selector:"[data-toggle=popover][data-trigger!=hover]"}),a("html").popover({container:"body",selector:"[data-toggle=popover][data-trigger=hover]",trigger:"hover",delay:{hide:500}}),c.getLegacyEvents().done(function(b){a(document).on(b.FILTER_CONTENT_UPDATED,function(){a("body").popover({selector:'[data-toggle="popover"]',trigger:"focus"})})}),b.init(),M.util.js_complete("theme_boost/loader:children")}),{}});
define('theme_boost/tooltip', ["exports","jquery","core/popper","./util"],function(a,b,c,d){"use strict";function e(a){return a&&a.__esModule?a:{"default":a}}function f(){return f=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},f.apply(this,arguments)}function g(a){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function j(a,b,c){return b&&i(a.prototype,b),c&&i(a,c),a}Object.defineProperty(a,"__esModule",{value:!0});var k=e(b),l=e(c),m=e(d),n=function(a){var b="tooltip",c="4.0.0",d="bs.tooltip",e=".".concat(d),i=a.fn[b],k=150,n="bs-tooltip",o=new RegExp("(^|\\s)".concat(n,"\\S+"),"g"),p={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)"},q={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},r={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent"},s={SHOW:"show",OUT:"out"},t={HIDE:"hide".concat(e),HIDDEN:"hidden".concat(e),SHOW:"show".concat(e),SHOWN:"shown".concat(e),INSERTED:"inserted".concat(e),CLICK:"click".concat(e),FOCUSIN:"focusin".concat(e),FOCUSOUT:"focusout".concat(e),MOUSEENTER:"mouseenter".concat(e),MOUSELEAVE:"mouseleave".concat(e)},u={FADE:"fade",SHOW:"show"},v={TOOLTIP:".tooltip",TOOLTIP_INNER:".tooltip-inner",ARROW:".arrow"},w={HOVER:"hover",FOCUS:"focus",CLICK:"click",MANUAL:"manual"},x=function(){function i(a,b){if(h(this,i),"undefined"==typeof l["default"])throw new TypeError("Bootstrap tooltips require Popper.js (https://popper.js.org)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=a,this.config=this._getConfig(b),this.tip=null,this._setListeners()}return j(i,[{key:"enable",value:function(){this._isEnabled=!0}},{key:"disable",value:function(){this._isEnabled=!1}},{key:"toggleEnabled",value:function(){this._isEnabled=!this._isEnabled}},{key:"toggle",value:function(b){if(this._isEnabled)if(b){var c=this.constructor.DATA_KEY,d=a(b.currentTarget).data(c);d||(d=new this.constructor(b.currentTarget,this._getDelegateConfig()),a(b.currentTarget).data(c,d)),d._activeTrigger.click=!d._activeTrigger.click,d._isWithActiveTrigger()?d._enter(null,d):d._leave(null,d)}else{if(a(this.getTipElement()).hasClass(u.SHOW))return void this._leave(null,this);this._enter(null,this)}}},{key:"dispose",value:function(){clearTimeout(this._timeout),a.removeData(this.element,this.constructor.DATA_KEY),a(this.element).off(this.constructor.EVENT_KEY),a(this.element).closest(".modal").off("hide.bs.modal"),this.tip&&a(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,null!==this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null}},{key:"show",value:function(){var b=this;if("none"===a(this.element).css("display"))throw new Error("Please use show on visible elements");var c=a.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){a(this.element).trigger(c);var d=a.contains(this.element.ownerDocument.documentElement,this.element);if(c.isDefaultPrevented()||!d)return;var e=this.getTipElement(),f=m["default"].getUID(this.constructor.NAME);e.setAttribute("id",f),this.element.setAttribute("aria-describedby",f),this.setContent(),this.config.animation&&a(e).addClass(u.FADE);var g="function"==typeof this.config.placement?this.config.placement.call(this,e,this.element):this.config.placement,h=this._getAttachment(g);this.addAttachmentClass(h);var j=this.config.container===!1?document.body:a(this.config.container);a(e).data(this.constructor.DATA_KEY,this),a.contains(this.element.ownerDocument.documentElement,this.tip)||a(e).appendTo(j),a(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new l["default"](this.element,e,{placement:h,modifiers:{offset:{offset:this.config.offset},flip:{behavior:this.config.fallbackPlacement},arrow:{element:v.ARROW},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(a){a.originalPlacement!==a.placement&&b._handlePopperPlacementChange(a)},onUpdate:function(a){b._handlePopperPlacementChange(a)}}),a(e).addClass(u.SHOW),"ontouchstart"in document.documentElement&&a("body").children().on("mouseover",null,a.noop);var k=function(){b.config.animation&&b._fixTransition();var c=b._hoverState;b._hoverState=null,a(b.element).trigger(b.constructor.Event.SHOWN),c===s.OUT&&b._leave(null,b)};m["default"].supportsTransitionEnd()&&a(this.tip).hasClass(u.FADE)?a(this.tip).one(m["default"].TRANSITION_END,k).emulateTransitionEnd(i._TRANSITION_DURATION):k()}}},{key:"hide",value:function(b){var c=this,d=this.getTipElement(),e=a.Event(this.constructor.Event.HIDE),f=function(){c._hoverState!==s.SHOW&&d.parentNode&&d.parentNode.removeChild(d),c._cleanTipClass(),c.element.removeAttribute("aria-describedby"),a(c.element).trigger(c.constructor.Event.HIDDEN),null!==c._popper&&c._popper.destroy(),b&&b()};a(this.element).trigger(e),e.isDefaultPrevented()||(a(d).removeClass(u.SHOW),"ontouchstart"in document.documentElement&&a("body").children().off("mouseover",null,a.noop),this._activeTrigger[w.CLICK]=!1,this._activeTrigger[w.FOCUS]=!1,this._activeTrigger[w.HOVER]=!1,m["default"].supportsTransitionEnd()&&a(this.tip).hasClass(u.FADE)?a(d).one(m["default"].TRANSITION_END,f).emulateTransitionEnd(k):f(),this._hoverState="")}},{key:"update",value:function(){null!==this._popper&&this._popper.scheduleUpdate()}},{key:"isWithContent",value:function(){return Boolean(this.getTitle())}},{key:"addAttachmentClass",value:function(b){a(this.getTipElement()).addClass("".concat(n,"-").concat(b))}},{key:"getTipElement",value:function(){return this.tip=this.tip||a(this.config.template)[0],this.tip}},{key:"setContent",value:function(){var b=a(this.getTipElement());this.setElementContent(b.find(v.TOOLTIP_INNER),this.getTitle()),b.removeClass("".concat(u.FADE," ").concat(u.SHOW))}},{key:"setElementContent",value:function(b,c){var d=this.config.html;"object"===g(c)&&(c.nodeType||c.jquery)?d?a(c).parent().is(b)||b.empty().append(c):b.text(a(c).text()):b[d?"html":"text"](c)}},{key:"getTitle",value:function(){var a=this.element.getAttribute("data-original-title");return a||(a="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),a}},{key:"_getAttachment",value:function(a){return q[a.toUpperCase()]}},{key:"_setListeners",value:function(){var b=this,c=this.config.trigger.split(" ");c.forEach(function(c){if("click"===c)a(b.element).on(b.constructor.Event.CLICK,b.config.selector,function(a){return b.toggle(a)});else if(c!==w.MANUAL){var d=c===w.HOVER?b.constructor.Event.MOUSEENTER:b.constructor.Event.FOCUSIN,e=c===w.HOVER?b.constructor.Event.MOUSELEAVE:b.constructor.Event.FOCUSOUT;a(b.element).on(d,b.config.selector,function(a){return b._enter(a)}).on(e,b.config.selector,function(a){return b._leave(a)})}a(b.element).closest(".modal").on("hide.bs.modal",function(){return b.hide()})}),this.config.selector?this.config=f({},this.config,{trigger:"manual",selector:""}):this._fixTitle()}},{key:"_fixTitle",value:function(){var a=g(this.element.getAttribute("data-original-title"));(this.element.getAttribute("title")||"string"!==a)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))}},{key:"_enter",value:function(b,c){var d=this.constructor.DATA_KEY;return c=c||a(b.currentTarget).data(d),c||(c=new this.constructor(b.currentTarget,this._getDelegateConfig()),a(b.currentTarget).data(d,c)),b&&(c._activeTrigger["focusin"===b.type?w.FOCUS:w.HOVER]=!0),a(c.getTipElement()).hasClass(u.SHOW)||c._hoverState===s.SHOW?void(c._hoverState=s.SHOW):(clearTimeout(c._timeout),c._hoverState=s.SHOW,c.config.delay&&c.config.delay.show?void(c._timeout=setTimeout(function(){c._hoverState===s.SHOW&&c.show()},c.config.delay.show)):void c.show())}},{key:"_leave",value:function(b,c){var d=this.constructor.DATA_KEY;if(c=c||a(b.currentTarget).data(d),c||(c=new this.constructor(b.currentTarget,this._getDelegateConfig()),a(b.currentTarget).data(d,c)),b&&(c._activeTrigger["focusout"===b.type?w.FOCUS:w.HOVER]=!1),!c._isWithActiveTrigger())return clearTimeout(c._timeout),c._hoverState=s.OUT,c.config.delay&&c.config.delay.hide?void(c._timeout=setTimeout(function(){c._hoverState===s.OUT&&c.hide()},c.config.delay.hide)):void c.hide()}},{key:"_isWithActiveTrigger",value:function(){for(var a in this._activeTrigger)if(this._activeTrigger[a])return!0;return!1}},{key:"_getConfig",value:function(c){return c=f({},this.constructor.Default,a(this.element).data(),c),"number"==typeof c.delay&&(c.delay={show:c.delay,hide:c.delay}),"number"==typeof c.title&&(c.title=c.title.toString()),"number"==typeof c.content&&(c.content=c.content.toString()),m["default"].typeCheckConfig(b,c,this.constructor.DefaultType),c}},{key:"_getDelegateConfig",value:function(){var a={};if(this.config)for(var b in this.config)this.constructor.Default[b]!==this.config[b]&&(a[b]=this.config[b]);return a}},{key:"_cleanTipClass",value:function(){var b=a(this.getTipElement()),c=b.attr("class").match(o);null!==c&&c.length>0&&b.removeClass(c.join(""))}},{key:"_handlePopperPlacementChange",value:function(a){this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(a.placement))}},{key:"_fixTransition",value:function(){var b=this.getTipElement(),c=this.config.animation;null===b.getAttribute("x-placement")&&(a(b).removeClass(u.FADE),this.config.animation=!1,this.hide(),this.show(),this.config.animation=c)}}],[{key:"_jQueryInterface",value:function(b){return this.each(function(){var c=a(this).data(d),e="object"===g(b)&&b;if((c||!/dispose|hide/.test(b))&&(c||(c=new i(this,e),a(this).data(d,c)),"string"==typeof b)){if("undefined"==typeof c[b])throw new TypeError('No method named "'.concat(b,'"'));c[b]()}})}},{key:"VERSION",get:function(){return c}},{key:"Default",get:function(){return r}},{key:"NAME",get:function(){return b}},{key:"DATA_KEY",get:function(){return d}},{key:"Event",get:function(){return t}},{key:"EVENT_KEY",get:function(){return e}},{key:"DefaultType",get:function(){return p}}]),i}();return a.fn[b]=x._jQueryInterface,a.fn[b].Constructor=x,a.fn[b].noConflict=function(){return a.fn[b]=i,x._jQueryInterface},x}(k["default"],l["default"]);a["default"]=n});
define('theme_bootstrapbase/bootstrap', ["jquery"],function(a){function b(b){a(".dropdown-backdrop").remove(),a(k).each(function(){var d=c(a(this));void 0!=b&&0!=d.find(b).length||d.removeClass("open")})}function c(b){var c,d=b.attr("data-target");return d||(d=b.attr("href"),d=d&&/#/.test(d)&&d.replace(/.*(?=#[^\s]*$)/,"")),c=d&&a(d),c&&c.length||(c=b.parent()),c}function d(b,c){var d,e=a.proxy(this.process,this),f=a(a(b).is("body")?window:b);this.options=a.extend({},a.fn.scrollspy.defaults,c),this.$scrollElement=f.on("scroll.scroll-spy.data-api",e),this.selector=(this.options.target||(d=a(b).attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=a("body"),this.refresh(),this.process()}a(".h1").hide(),a(function(){a.support.transition=function(){var a=function(){var a,b=document.createElement("bootstrap"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(a in c)if(void 0!==b.style[a])return c[a]}();return a&&{end:a}}()});var e='[data-dismiss="alert"]',f=function(b){a(b).on("click",e,this.close)};f.prototype.close=function(b){function c(){d.trigger("closed").remove()}var d,e=a(this),f=e.attr("data-target");f||(f=e.attr("href"),f=f&&f.replace(/.*(?=#[^\s]*$)/,"")),d=a(f),b&&b.preventDefault(),d.length||(d=e.hasClass("alert")?e:e.parent()),d.trigger(b=a.Event("close")),b.isDefaultPrevented()||(d.removeClass("in"),a.support.transition&&d.hasClass("fade")?d.on(a.support.transition.end,c):c())};var g=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var c=a(this),d=c.data("alert");d||c.data("alert",d=new f(this)),"string"==typeof b&&d[b].call(c)})},a.fn.alert.Constructor=f,a.fn.alert.noConflict=function(){return a.fn.alert=g,this},a(document).on("click.alert.data-api",e,f.prototype.close);var h=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.button.defaults,c)};h.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.data(),e=c.is("input")?"val":"html";a+="Text",d.resetText||c.data("resetText",c[e]()),c[e](d[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},h.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons-radio"]');a&&a.find(".active").removeClass("active"),this.$element.toggleClass("active")};var g=a.fn.button;a.fn.button=function(b){return this.each(function(){var c=a(this),d=c.data("button"),e="object"==typeof b&&b;d||c.data("button",d=new h(this,e)),"toggle"==b?d.toggle():b&&d.setState(b)})},a.fn.button.defaults={loadingText:"loading..."},a.fn.button.Constructor=h,a.fn.button.noConflict=function(){return a.fn.button=g,this},a(document).on("click.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle")});var i=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,"hover"==this.options.pause&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};i.prototype={cycle:function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},getActiveIndex:function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},to:function(b){var c=this.getActiveIndex(),d=this;if(!(b>this.$items.length-1||b<0))return this.sliding?this.$element.one("slid",function(){d.to(b)}):c==b?this.pause().cycle():this.slide(b>c?"next":"prev",a(this.$items[b]))},pause:function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition.end&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),clearInterval(this.interval),this.interval=null,this},next:function(){if(!this.sliding)return this.slide("next")},prev:function(){if(!this.sliding)return this.slide("prev")},slide:function(b,c){var d,e=this.$element.find(".item.active"),f=c||e[b](),g=this.interval,h="next"==b?"left":"right",i="next"==b?"first":"last",j=this;if(this.sliding=!0,g&&this.pause(),f=f.length?f:this.$element.find(".item")[i](),d=a.Event("slide",{relatedTarget:f[0],direction:h}),!f.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var b=a(j.$indicators.children()[j.getActiveIndex()]);b&&b.addClass("active")})),a.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(d),d.isDefaultPrevented())return;f.addClass(b),f[0].offsetWidth,e.addClass(h),f.addClass(h),this.$element.one(a.support.transition.end,function(){f.removeClass([b,h].join(" ")).addClass("active"),e.removeClass(["active",h].join(" ")),j.sliding=!1,setTimeout(function(){j.$element.trigger("slid")},0)})}else{if(this.$element.trigger(d),d.isDefaultPrevented())return;e.removeClass("active"),f.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return g&&this.cycle(),this}}};var g=a.fn.carousel;a.fn.carousel=function(b){return this.each(function(){var c=a(this),d=c.data("carousel"),e=a.extend({},a.fn.carousel.defaults,"object"==typeof b&&b),f="string"==typeof b?b:e.slide;d||c.data("carousel",d=new i(this,e)),"number"==typeof b?d.to(b):f?d[f]():e.interval&&d.pause().cycle()})},a.fn.carousel.defaults={interval:5e3,pause:"hover"},a.fn.carousel.Constructor=i,a.fn.carousel.noConflict=function(){return a.fn.carousel=g,this},a(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(b){var c,d,e=a(this),f=a(e.attr("data-target")||(c=e.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),g=a.extend({},f.data(),e.data());f.carousel(g),(d=e.attr("data-slide-to"))&&f.data("carousel").pause().to(d).cycle(),b.preventDefault()});var j=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.collapse.defaults,c),this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};j.prototype={constructor:j,dimension:function(){var a=this.$element.hasClass("width");return a?"width":"height"},show:function(){var b,c,d,e;if(!this.transitioning&&!this.$element.hasClass("in")){if(b=this.dimension(),c=a.camelCase(["scroll",b].join("-")),d=this.$parent&&this.$parent.find("> .accordion-group > .in"),d&&d.length){if(e=d.data("collapse"),e&&e.transitioning)return;d.collapse("hide"),e||d.data("collapse",null)}this.$element[b](0),this.transition("addClass",a.Event("show"),"shown"),a.support.transition&&this.$element[b](this.$element[0][c])}},hide:function(){var b;!this.transitioning&&this.$element.hasClass("in")&&(b=this.dimension(),this.reset(this.$element[b]()),this.transition("removeClass",a.Event("hide"),"hidden"),this.$element[b](0))},reset:function(a){var b=this.dimension();return this.$element.removeClass("collapse")[b](a||"auto")[0].offsetWidth,this.$element[null!==a?"addClass":"removeClass"]("collapse"),this},transition:function(b,c,d){var e=this,f=function(){"show"==c.type&&e.reset(),e.transitioning=0,e.$element.trigger(d)};this.$element.trigger(c),c.isDefaultPrevented()||(this.transitioning=1,this.$element[b]("in"),a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,f):f())},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};var g=a.fn.collapse;a.fn.collapse=function(b){return this.each(function(){var c=a(this),d=c.data("collapse"),e=a.extend({},a.fn.collapse.defaults,c.data(),"object"==typeof b&&b);d||c.data("collapse",d=new j(this,e)),"string"==typeof b&&d[b]()})},a.fn.collapse.defaults={toggle:!0},a.fn.collapse.Constructor=j,a.fn.collapse.noConflict=function(){return a.fn.collapse=g,this},a(document).on("click.collapse.data-api","[data-toggle=collapse]",function(b){var c,d=a(this),e=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=a(e).data("collapse")?"toggle":d.data();d[a(e).hasClass("in")?"addClass":"removeClass"]("collapsed"),a(e).collapse(f)});var k="[data-toggle=dropdown]",l=function(b){var c=a(b).on("click.dropdown.data-api",this.toggle);a("html").on("click.dropdown.data-api",function(){c.parent().removeClass("open")})};l.prototype={constructor:l,toggle:function(d){var e,f,g=a(this);if(!g.is(".disabled, :disabled"))return e=c(g),f=e.hasClass("open"),b(g),f||"ontouchstart"in document.documentElement&&a('<div class="dropdown-backdrop"/>').insertBefore(a(this)).on("click",b),e.toggleClass("open"),g.focus(),!1},keydown:function(b){var d,e,f,g,h;if(/(38|40|27)/.test(b.keyCode)&&(d=a(this),b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled"))){if(f=c(d),g=f.hasClass("open"),!g||g&&27==b.keyCode)return 27==b.which&&f.find(k).focus(),d.click();e=a("[role=menu] li:not(.divider):visible a",f),e.length&&(h=e.index(e.filter(":focus")),38==b.keyCode&&h>0&&h--,40==b.keyCode&&h<e.length-1&&h++,~h||(h=0),e.eq(h).focus())}}};var g=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("dropdown");d||c.data("dropdown",d=new l(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=l,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=g,this},a(document).on("click.dropdown.data-api",b).on("click.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.dropdown.data-api",k,l.prototype.toggle).on("keydown.dropdown.data-api",k+", [role=menu]",l.prototype.keydown);var m=function(b,c){this.options=c,this.$element=a(b).delegate('[data-dismiss="modal"]',"click.dismiss.modal",a.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};m.prototype={constructor:m,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var b=this,c=a.Event("show");this.$element.trigger(c),this.isShown||c.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.backdrop(function(){var c=a.support.transition&&b.$element.hasClass("fade");b.$element.parent().length||b.$element.appendTo(document.body),b.$element.show(),c&&b.$element[0].offsetWidth,b.$element.addClass("in").attr("aria-hidden",!1),b.enforceFocus(),c?b.$element.one(a.support.transition.end,function(){b.$element.focus().trigger("shown")}):b.$element.focus().trigger("shown")}))},hide:function(b){b&&b.preventDefault();b=a.Event("hide"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),a.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var b=this;a(document).on("focusin.modal",function(a){b.$element[0]===a.target||b.$element.has(a.target).length||b.$element.focus()})},escape:function(){var a=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(b){27==b.which&&a.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var b=this,c=setTimeout(function(){b.$element.off(a.support.transition.end),b.hideModal()},500);this.$element.one(a.support.transition.end,function(){clearTimeout(c),b.hideModal()})},hideModal:function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$backdrop.click("static"==this.options.backdrop?a.proxy(this.$element[0].focus,this.$element[0]):a.proxy(this.hide,this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;d?this.$backdrop.one(a.support.transition.end,b):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b):b()):b&&b()}};var g=a.fn.modal;a.fn.modal=function(b){return this.each(function(){var c=a(this),d=c.data("modal"),e=a.extend({},a.fn.modal.defaults,c.data(),"object"==typeof b&&b);d||c.data("modal",d=new m(this,e)),"string"==typeof b?d[b]():e.show&&d.show()})},a.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},a.fn.modal.Constructor=m,a.fn.modal.noConflict=function(){return a.fn.modal=g,this},a(document).on("click.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f).one("hide",function(){c.focus()})});var n=function(a,b){this.init("tooltip",a,b)};n.prototype={constructor:n,init:function(b,c,d){var e,f,g,h,i;for(this.type=b,this.$element=a(c),this.options=this.getOptions(d),this.enabled=!0,g=this.options.trigger.split(" "),i=g.length;i--;)h=g[i],"click"==h?this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this)):"manual"!=h&&(e="hover"==h?"mouseenter":"focus",f="hover"==h?"mouseleave":"blur",this.$element.on(e+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,a.proxy(this.leave,this)));this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(b){return b=a.extend({},a.fn[this.type].defaults,this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},enter:function(b){var c,d=a.fn[this.type].defaults,e={};return this._options&&a.each(this._options,function(a,b){d[a]!=b&&(e[a]=b)},this),c=a(b.currentTarget)[this.type](e).data(this.type),c.options.delay&&c.options.delay.show?(clearTimeout(this.timeout),c.hoverState="in",void(this.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show))):c.show()},leave:function(b){var c=a(b.currentTarget)[this.type](this._options).data(this.type);return this.timeout&&clearTimeout(this.timeout),c.options.delay&&c.options.delay.hide?(c.hoverState="out",void(this.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide))):c.hide()},show:function(){var b,c,d,e,f,g,h=a.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(h),h.isDefaultPrevented())return;switch(b=this.tip(),this.setContent(),this.options.animation&&b.addClass("fade"),f="function"==typeof this.options.placement?this.options.placement.call(this,b[0],this.$element[0]):this.options.placement,b.detach().css({top:0,left:0,display:"block"}),this.options.container?b.appendTo(this.options.container):b.insertAfter(this.$element),c=this.getPosition(),d=b[0].offsetWidth,e=b[0].offsetHeight,f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}this.applyPlacement(g,f),this.$element.trigger("shown")}},applyPlacement:function(a,b){var c,d,e,f,g=this.tip(),h=g[0].offsetWidth,i=g[0].offsetHeight;g.offset(a).addClass(b).addClass("in"),c=g[0].offsetWidth,d=g[0].offsetHeight,"top"==b&&d!=i&&(a.top=a.top+i-d,f=!0),"bottom"==b||"top"==b?(e=0,a.left<0&&(e=a.left*-2,a.left=0,g.offset(a),c=g[0].offsetWidth,d=g[0].offsetHeight),this.replaceArrow(e-h+c,c,"left")):this.replaceArrow(d-i,d,"top"),f&&g.offset(a)},replaceArrow:function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},setContent:function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},hide:function(){function b(){var b=setTimeout(function(){c.off(a.support.transition.end).detach()},500);c.one(a.support.transition.end,function(){clearTimeout(b),c.detach()})}var c=this.tip(),d=a.Event("hide");if(this.$element.trigger(d),!d.isDefaultPrevented())return c.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?b():c.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},getTitle:function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},tip:function(){return this.$tip=this.$tip||a(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(b){var c=b?a(b.currentTarget)[this.type](this._options).data(this.type):this;c.tip().hasClass("in")?c.hide():c.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var g=a.fn.tooltip;a.fn.tooltip=function(b){return this.each(function(){var c=a(this),d=c.data("tooltip"),e="object"==typeof b&&b;d||c.data("tooltip",d=new n(this,e)),"string"==typeof b&&d[b]()})},a.fn.tooltip.Constructor=n,a.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},a.fn.tooltip.noConflict=function(){return a.fn.tooltip=g,this};var o=function(a,b){this.init("popover",a,b)};o.prototype=a.extend({},a.fn.tooltip.Constructor.prototype,{constructor:o,setContent:function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var a,b=this.$element,c=this.options;return a=("function"==typeof c.content?c.content.call(b[0]):c.content)||b.attr("data-content")},tip:function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}});var g=a.fn.popover;a.fn.popover=function(b){return this.each(function(){var c=a(this),d=c.data("popover"),e="object"==typeof b&&b;d||c.data("popover",d=new o(this,e)),"string"==typeof b&&d[b]()})},a.fn.popover.Constructor=o,a.fn.popover.defaults=a.extend({},a.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),a.fn.popover.noConflict=function(){return a.fn.popover=g,this},d.prototype={constructor:d,refresh:function(){var b,c=this;this.offsets=a([]),this.targets=a([]),b=this.$body.find(this.selector).map(function(){var b=a(this),d=b.data("target")||b.attr("href"),e=/^#\w/.test(d)&&a(d);return e&&e.length&&[[e.position().top+(!a.isWindow(c.$scrollElement.get(0))&&c.$scrollElement.scrollTop()),d]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){c.offsets.push(this[0]),c.targets.push(this[1])})},process:function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,d=c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(b>=d)return g!=(a=f.last()[0])&&this.activate(a);for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(!e[a+1]||b<=e[a+1])&&this.activate(f[a])},activate:function(b){var c,d;this.activeTarget=b,a(this.selector).parent(".active").removeClass("active"),d=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',c=a(d).parent("li").addClass("active"),c.parent(".dropdown-menu").length&&(c=c.closest("li.dropdown").addClass("active")),c.trigger("activate")}};var g=a.fn.scrollspy;a.fn.scrollspy=function(b){return this.each(function(){var c=a(this),e=c.data("scrollspy"),f="object"==typeof b&&b;e||c.data("scrollspy",e=new d(this,f)),"string"==typeof b&&e[b]()})},a.fn.scrollspy.Constructor=d,a.fn.scrollspy.defaults={offset:10},a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=g,this},a(window).on("load",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})});var p=function(b){this.element=a(b)};p.prototype={constructor:p,show:function(){var b,c,d,e=this.element,f=e.closest("ul:not(.dropdown-menu)"),g=e.attr("data-target");g||(g=e.attr("href"),g=g&&g.replace(/.*(?=#[^\s]*$)/,"")),e.parent("li").hasClass("active")||(b=f.find(".active:last a")[0],d=a.Event("show",{relatedTarget:b}),e.trigger(d),d.isDefaultPrevented()||(c=a(g),this.activate(e.parent("li"),f),this.activate(c,c.parent(),function(){e.trigger({type:"shown",relatedTarget:b})})))},activate:function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&f.hasClass("fade");g?f.one(a.support.transition.end,e):e(),f.removeClass("in")}};var g=a.fn.tab;a.fn.tab=function(b){return this.each(function(){var c=a(this),d=c.data("tab");d||c.data("tab",d=new p(this)),"string"==typeof b&&d[b]()})},a.fn.tab.Constructor=p,a.fn.tab.noConflict=function(){return a.fn.tab=g,this},a(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")});var q=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.typeahead.defaults,c),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=a(this.options.menu),this.shown=!1,this.listen()};q.prototype={constructor:q,select:function(){var a=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(a)).change(),this.hide()},updater:function(a){return a},show:function(){var b=a.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:b.top+b.height,left:b.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(b){var c;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(c=a.isFunction(this.source)?this.source(this.query,a.proxy(this.process,this)):this.source,c?this.process(c):this)},process:function(b){var c=this;return b=a.grep(b,function(a){return c.matcher(a)}),b=this.sorter(b),b.length?this.render(b.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(a){return~a.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(a){for(var b,c=[],d=[],e=[];b=a.shift();)b.toLowerCase().indexOf(this.query.toLowerCase())?~b.indexOf(this.query)?d.push(b):e.push(b):c.push(b);return c.concat(d,e)},highlighter:function(a){var b=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return a.replace(new RegExp("("+b+")","ig"),function(a,b){return"<strong>"+b+"</strong>"})},render:function(b){var c=this;return b=a(b).map(function(b,d){return b=a(c.options.item).attr("data-value",d),b.find("a").html(c.highlighter(d)),b[0]}),b.first().addClass("active"),this.$menu.html(b),this},next:function(b){var c=this.$menu.find(".active").removeClass("active"),d=c.next();d.length||(d=a(this.$menu.find("li")[0])),d.addClass("active")},prev:function(a){var b=this.$menu.find(".active").removeClass("active"),c=b.prev();c.length||(c=this.$menu.find("li").last()),c.addClass("active")},listen:function(){this.$element.on("focus",a.proxy(this.focus,this)).on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",a.proxy(this.keydown,this)),this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this)).on("mouseleave","li",a.proxy(this.mouseleave,this))},eventSupported:function(a){var b=a in this.$element;return b||(this.$element.setAttribute(a,"return;"),b="function"==typeof this.$element[a]),b},move:function(a){if(this.shown){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(b){this.suppressKeyPressRepeat=~a.inArray(b.keyCode,[40,38,9,13,27]),this.move(b)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}a.stopPropagation(),a.preventDefault()},focus:function(a){this.focused=!0},blur:function(a){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(a){a.stopPropagation(),a.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(b){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),a(b.currentTarget).addClass("active")},mouseleave:function(a){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var g=a.fn.typeahead;a.fn.typeahead=function(b){return this.each(function(){var c=a(this),d=c.data("typeahead"),e="object"==typeof b&&b;d||c.data("typeahead",d=new q(this,e)),"string"==typeof b&&d[b]()})},a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},a.fn.typeahead.Constructor=q,a.fn.typeahead.noConflict=function(){return a.fn.typeahead=g,this},a(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(b){var c=a(this);c.data("typeahead")||c.typeahead(c.data())});var r=function(b,c){this.options=a.extend({},a.fn.affix.defaults,c),this.$window=a(window).on("scroll.affix.data-api",a.proxy(this.checkPosition,this)).on("click.affix.data-api",a.proxy(function(){setTimeout(a.proxy(this.checkPosition,this),1)},this)),this.$element=a(b),this.checkPosition()};r.prototype.checkPosition=function(){if(this.$element.is(":visible")){var b,c=a(document).height(),d=this.$window.scrollTop(),e=this.$element.offset(),f=this.options.offset,g=f.bottom,h=f.top,i="affix affix-top affix-bottom";"object"!=typeof f&&(g=h=f),"function"==typeof h&&(h=f.top()),"function"==typeof g&&(g=f.bottom()),b=!(null!=this.unpin&&d+this.unpin<=e.top)&&(null!=g&&e.top+this.$element.height()>=c-g?"bottom":null!=h&&d<=h&&"top"),this.affixed!==b&&(this.affixed=b,this.unpin="bottom"==b?e.top-d:null,this.$element.removeClass(i).addClass("affix"+(b?"-"+b:"")))}};var g=a.fn.affix;a.fn.affix=function(b){return this.each(function(){var c=a(this),d=c.data("affix"),e="object"==typeof b&&b;d||c.data("affix",d=new r(this,e)),"string"==typeof b&&d[b]()})},a.fn.affix.Constructor=r,a.fn.affix.defaults={offset:0},a.fn.affix.noConflict=function(){return a.fn.affix=g,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},c.offsetBottom&&(c.offset.bottom=c.offsetBottom),c.offsetTop&&(c.offset.top=c.offsetTop),b.affix(c)})})});
define ("assignsubmission_onlinepoodll/submissionhelper",["jquery","core/log","core/str"],function(a,b,c){"use strict";b.debug("submission helper: initialising");return{uploadstate:!1,togglestate:0,strings:{},init:function init(a){this.component=a.component;this.filecontrolid=a.filecontrolid;this.togglingthing=a.togglingthing;this.register_controls();this.register_events();if("currentsubmission"==this.togglingthing){if(a.expandcurrentsubmission){this.toggle_currentsubmission(this)}}},register_controls:function register_controls(){var b=this;this.controls={};this.controls.deletebutton=a("."+this.component+"_deletesubmissionbutton");this.controls.updatecontrol=a("#"+this.filecontrolid);this.controls.currentcontainer=a("."+this.component+"_currentsubmission");this.controls.reccontainer=a("."+this.component+"_recorder");this.controls.togglecontainer=a("."+this.component+"_togglecontainer");this.controls.togglebutton=a("."+this.component+"_togglecontainer .togglebutton");this.controls.toggletext=a("."+this.component+"_togglecontainer .toggletext");c.get_string("clicktohide",b.component).done(function(a){b.strings.clicktohide=a});c.get_string("clicktoshow",b.component).done(function(a){b.strings.clicktoshow=a})},register_events:function register_events(){var a=this;this.controls.deletebutton.click(function(){if(a.controls.updatecontrol){if(confirm(M.util.get_string("reallydeletesubmission",a.component))){a.controls.updatecontrol.val(-1);a.controls.currentcontainer.html("")}}});if("currentsubmission"===this.togglingthing){this.controls.togglebutton.click(function(){a.toggle_currentsubmission(a)});this.controls.toggletext.click(function(){a.toggle_currentsubmission(a)})}else if("recorder"===this.togglingthing){this.controls.togglebutton.click(function(){a.toggle_recorder(a)});this.controls.toggletext.click(function(){a.toggle_recorder(a)})}},do_toggle:function do_toggle(a){if(0===a.togglestate){a.controls.togglebutton.removeClass("fa-toggle-off");a.controls.togglebutton.addClass("fa-toggle-on");a.controls.toggletext.text(a.strings.clicktohide);a.togglestate=1}else{a.controls.togglebutton.removeClass("fa-toggle-on");a.controls.togglebutton.addClass("fa-toggle-off");a.controls.toggletext.text(a.strings.clicktoshow);a.togglestate=0}},toggle_currentsubmission:function toggle_currentsubmission(a){a.controls.currentcontainer.toggle({duration:300,complete:function complete(){a.do_toggle(a)}});return!1},toggle_recorder:function toggle_recorder(a){a.controls.reccontainer.toggle({duration:300,complete:function complete(){a.do_toggle(a)}});return!1}}});
//# sourceMappingURL=submissionhelper.min.js.map

