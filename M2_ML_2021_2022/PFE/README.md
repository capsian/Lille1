PFE: Drone Detection & Position Estimation
--------------------------------------

# Author
- Selim Lakhdar
  - selim.lakhdar.etu@univ-lille.fr
  - selim.lakhdar@gmail.com

# Project Objectif
- Detect the drone swarm in real time.
- Localize each drone (x,y,z).

# Repository Content
```shell
â”œâ”€â”€ data
â”‚Â Â  â”œâ”€â”€ base_weights # Initial Weights
â”‚Â Â  â”œâ”€â”€ colab_weights
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ v1 # First Version
â”‚Â Â  â”‚Â Â  â””â”€â”€ v2 # Last Version
â”‚Â Â  â”œâ”€â”€ images  # Collected images
â”‚Â Â  â”œâ”€â”€ labels  # Image Labels
â”‚Â Â  â””â”€â”€ videos  # Collected videos
â”œâ”€â”€ doc
â”‚Â Â  â”œâ”€â”€ articles
â”‚Â Â  â””â”€â”€ aruco
â”œâ”€â”€ notebooks # Notebook used in google colab (Using GPU)
â”œâ”€â”€ scripts # Scripts
â””â”€â”€ tools
    â”œâ”€â”€ Yolo-Annotation-Tool-New- # Annotation tool
    â””â”€â”€ yolov5  # Yolo v5
```

# Detect Drone
This project uses the weights generated by [Detect Drone](https://github.com/tusharsarkar3/Detect_Drone). 
This drone detection system uses YOLOv5 which is a family of object detection architectures which was trained on [Drone Dataset](https://www.kaggle.com/dasmehdixtr/drone-dataset-uav). 

Weights are stored under [./data/base_weights](./data/base_weights])

# Install
### [Yolov5](https://github.com/ultralytics/yolov5)

<div align="center">
<p>
   <a align="left" href="https://ultralytics.com/yolov5" target="_blank">
   <img width="850" src="https://github.com/ultralytics/yolov5/releases/download/v1.0/splash.jpg"></a>
</p>
<br>
<p>
YOLOv5 ðŸš€ is a family of object detection architectures and models pretrained on the COCO dataset, and represents <a href="https://ultralytics.com">Ultralytics</a>
 open-source research into future vision AI methods, incorporating lessons learned and best practices evolved over thousands of hours of research and development.
</p>
</div>

```shell
pip install -r tools/yolov5/requirements.txt
```

### [Yolo-Annotation-Tool-New](https://github.com/ManivannanMurugavel/Yolo-Annotation-Tool-New-)

This tool is used to annotate new images for YOLO.

```shell
pip install Pillow tk
```

# HowTO
## Annotate new images
```shell
make annotation
```

## Train
To train with base weights. It use [./data/train.txt](./data/train.txt) images for training and [./data/val.txt](./data/val.txt) images for validation.
```shell
make train_from_base
```

## Detect
```shell
make detect_base_weights # to detect with base weights (adapt the source)
make detect_base_weights_test # to detect with base weights (adapt the source)
make detect_colab_weights_v1 # to detect with colab v1 weights (adapt the source)
make detect_colab_weights_v2 # to detect with colab v2 weights (adapt the source)
make live_cam0 # to detect in real time with colab v2 weights (source 0)
make live_cam2 # to detect in real time with colab v2 weights (source 2)
```

# Next Step
- Estimate the drone position (x,y,z)
  - [Dist-YOLO: Fast Object Detection with Distance Estimation](doc/articles/Dist-YOLO_Fast_Object_Detection_with_Distance_Estimation.pdf)
  - [Learning Object-Specific Distance From a Monocular Image](doc/articles/Zhu_Learning_Object-Specific_Distance_From_a_Monocular_Image_ICCV_2019_paper.pdf)

